import e from"../../../../src/list/Base.mjs";import t from"../../../../src/collection/Base.mjs";class s extends e{static config={className:"Docs.view.classdetails.MembersList",ntype:"classdetails-memberslist",baseCls:["docs-classhierarchy-memberslist"],filterMembersQuery_:"",showPrivateMembers_:!0,showProtectedMembers_:!0,showStaticMembers_:!0,store:null,targetClassName:null,_vdom:{cn:[]}};onConstructed(){super.onConstructed();let e=this,s=e.up("classdetails-maincontainer").down("classhierarchy-treelist"),r=e.up("main-container").store;s.on({refreshClassMembers:e.onRefreshClassMembers,scope:e}),e.store=Neo.create(t,{filterMode:"advanced",sourceId:r.id}),e.onRefreshClassMembers()}afterSetFilterMembersQuery(e,t){void 0!==t&&this.onRefreshClassMembers()}afterSetShowProtectedMembers(e,t){void 0!==t&&this.onRefreshClassMembers()}afterSetShowPrivateMembers(e,t){void 0!==t&&this.onRefreshClassMembers()}afterSetShowStaticMembers(e,t){void 0!==t&&this.onRefreshClassMembers()}applyConfigsHeader(e,t){return"member"===e.items[0]?.kind&&t.cn.push({},{cls:["neo-docs-memberlist-group-header"],innerHTML:"Configs","data-list-header":"Configs"}),t}applyEventsHeader(e,t,s,r){return"event"===e.kind&&"event"!==s.items[t-1]?.kind&&r.cn.push({},{cls:["neo-docs-memberlist-group-header"],innerHTML:"Events",style:{zIndex:3},"data-list-header":"Events"}),r}applyMethodsHeader(e,t,s,r){return"function"!==e.kind||s.items[t-1]&&"function"===s.items[t-1]?.kind||r.cn.push({},{cls:["neo-docs-memberlist-group-header"],innerHTML:"Methods",style:{zIndex:2},"data-list-header":"Methods"}),r}createItems(){let e,t,r,n,a=this,i=new RegExp(a.filterMembersQuery||"","gi"),o=!1,l=a.targetClassName,c=a.vdom;c.cn=[],c=a.applyConfigsHeader(a.store,c),a.store.items.forEach(((m,p)=>{c=a.applyEventsHeader(m,p,a.store,c),c=a.applyMethodsHeader(m,p,a.store,c),t=[],"_"===m.name.substr(-1)&&(m.name=m.name.slice(0,-1),t.push("GS")),m.neoClassName!==l&&t.push("inherited"),"private"!==m.access&&"protected"!==m.access||t.push(m.access),"static"===m.scope&&t.push("static"),e=m.name,""!==a.filterMembersQuery&&null!==a.filterMembersQuery&&(e=e.replace(i,(e=>`<span class="neo-highlight-search">${e}</span>`))),m.type?.names&&(e+=": {"+s.escapeHtml(m.type.names.join("|"))+"}"),m.hasOwnProperty("defaultvalue")&&(e+=" = "+m.defaultvalue),m.params&&"event"!==m.kind&&("property"===m.$kind&&(e="get "+e),e+="("+m.params.reduce(((e,t)=>(t.name.indexOf(".")<0&&(t.optional?e.push("["+t.name+"]"):e.push(t.name)),e)),[]).join(", ")+")"),m.returns?.[0].type&&(e+=" â†’ {"+s.escapeHtml(m.returns[0].type.names.join("|")+"}")),n=m.meta.path,n.includes("/neo.mjs/")?n=n.substr(n.indexOf("/neo.mjs/")+9):n.includes("/neomjs/")?n=n.substr(n.indexOf("/neomjs/")+8):n.includes("/neo/")&&(n=n.substr(n.indexOf("/neo/")+5)),r={cls:["neo-list-item"],cn:[{cls:["neo-list-item-header-container"],cn:[{cls:["neo-list-item-header"],innerHTML:e},{style:{flex:1}},{cls:["neo-list-item-header"],innerHTML:t.join(", ")}]},{cls:"neo-docs-view-source-link-container",cn:[{tag:"a",cls:["neo-docs-view-source-link"],href:`#/viewSource/${m.neoClassName}/line/${m.meta.lineno}`,innerHTML:`Source: ${n}/${m.meta.filename} (Line ${m.meta.lineno})`}]},{innerHTML:m.description}]},m.examples?.length>0&&(o=!0,m.examples.forEach((e=>{r.cn.push({tag:"pre",cls:["hljs"],cn:[{tag:"code",html:e}]})}))),m.params?.length>0&&r.cn.push(s.createParametersTable(m.params)),m.returns?.[0].type&&"event"!==m.kind&&r.cn.push({innerHTML:"Returns {"+s.escapeHtml(m.returns[0].type.names.join("|")+"} ")+(m.returns[0].description||"")}),c.cn.push(r)})),a.update(),a.timeout(100).then((()=>{Neo.main.addon.HighlightJS.syntaxHighlightInit()}))}static createParametersTable(e){let t,r,n,a=!1,i=!1;return e.forEach((e=>{e.hasOwnProperty("defaultvalue")&&(a=!0),e.hasOwnProperty("optional")&&(i=!0)})),n={tag:"table",cls:"docs-param-table",cn:[{tag:"thead",cn:[{tag:"th",innerHTML:"Name"},{tag:"th",innerHTML:"Type"},{tag:"th",innerHTML:"Description"}]}]},a&&n.cn[0].cn.splice(2,0,{tag:"th",innerHTML:"Default"}),i&&n.cn[0].cn.splice(2,0,{tag:"th",innerHTML:"Optional"}),e.forEach((o=>{o.name.indexOf(".")<0&&(t={tag:"td",innerHTML:o.description},r=[],e.forEach((e=>{0===e.name.indexOf(o.name+".")&&((e=Neo.clone(e,!0)).name=e.name.split("."),e.name.shift(),e.name=e.name.join("."),r.push(e))})),r.length>0&&(t={tag:"td",cn:[{innerHTML:t.innerHTML},s.createParametersTable(r)]}),n.cn.push({tag:"tr",cn:[{tag:"td",innerHTML:o.name},{tag:"td",innerHTML:o.type?s.escapeHtml(o.type.names.join(" | ")):""},t]}),a&&n.cn[n.cn.length-1].cn.splice(2,0,{tag:"td",innerHTML:void 0===o.defaultvalue?"":o.defaultvalue+""}),i&&n.cn[n.cn.length-1].cn.splice(2,0,{tag:"td",innerHTML:o.optional}))})),n}static escapeHtml(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}filterAndSortItems(){let e,t,s=this,r={},n=s.up("classdetails-maincontainer").down("classhierarchy-treelist").store.items,a=0,i=[];for(n.forEach((e=>{!0===e.checked&&i.push(e.name)})),t=i.length;a<t;a++)r[i[a]]=a;s.targetClassName=n[n.length-1].name,e=[{operator:"included",property:"neoClassName",value:i},{operator:"!==",property:"kind",value:"class"},{operator:"!==",property:"kind",value:"constant"},{operator:"!==",property:"kind",value:"module"},{operator:"isUndefined",property:"inherited"}],s.showPrivateMembers||e.push({operator:"!==",property:"access",value:"private"}),s.showProtectedMembers||e.push({operator:"!==",property:"access",value:"protected"}),s.showStaticMembers||e.push({operator:"!==",property:"scope",value:"static"}),""!==s.filterMembersQuery&&null!==s.filterMembersQuery&&e.push({operator:"like",property:"name",value:s.filterMembersQuery}),e.push({scope:s,filterBy:function(e){let t,s,n,a=e.filteredItems,i=e.item,o=this.targetClassName;if("ntype"===i.name&&i.neoClassName!==o)return!0;if(i.neoClassName!==o)for(s=0,n=a.length;s<n;s++)if(t=a[s],i.id!==t.id&&i.name===t.name&&i.scope===t.scope&&r[i.neoClassName]<r[t.neoClassName])return!0;return!1}}),s.store.filters=e,s.store.sorters=[{sortBy:function(e,t){return(e="member"===e.kind?0:"function"===e.kind?1:2)>(t="member"===t.kind?0:"function"===t.kind?1:2)?1:e<t?-1:0}},{direction:"ASC",property:"name"}],s.fire("mutateItems",s.store)}onStoreFilter(){}onRefreshClassMembers(){this.filterAndSortItems(),this.createItems()}}export default Neo.setupClass(s);