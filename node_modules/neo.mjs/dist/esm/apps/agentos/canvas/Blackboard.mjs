import t from"../../../src/core/Base.mjs";export default Neo.setupClass(class extends t{static config={className:"AgentOS.canvas.Blackboard",remote:{app:["updateGraphData","updateSize","initGraph"]},singleton:!0};canvasId=null;canvasSize=null;context=null;links=[];nodes=[];construct(t){super.construct(t),this.nodes=[{id:"root",x:100,y:100,label:"Root Agent",color:"#4CAF50"},{id:"task1",x:200,y:150,label:"Task 1",color:"#2196F3"},{id:"task2",x:300,y:100,label:"Task 2",color:"#FFC107"}],this.links=[{source:"root",target:"task1"},{source:"root",target:"task2"}]}initGraph({canvasId:t,windowId:e}){let a=this,n=a.canvasId!==t;console.log("Blackboard: initGraph",t,n),this.canvasId=t;const o=()=>{const s=Neo.currentWorker.canvasWindowMap[t]?.[e];s?(a.context=s.getContext("2d"),n&&a.render()):setTimeout(o,50)};o()}updateGraphData(t){this.nodes=t.nodes||[],this.links=t.links||[]}updateSize(t){let e=this;e.canvasSize=t,e.context&&(e.context.canvas.width=t.width,e.context.canvas.height=t.height)}render(){let t=this;if(!t.context)return;const e=t.context,a=t.canvasSize?.width||800,n=t.canvasSize?.height||600;e.fillStyle="#000000",e.fillRect(0,0,a,n),e.fillStyle="#ffffff",e.font="20px Arial",e.fillText("Agent Swarm Blackboard (Canvas 2D)",20,30),e.strokeStyle="#666",e.lineWidth=2,t.links.forEach(a=>{const n=t.nodes.find(t=>t.id===a.source),o=t.nodes.find(t=>t.id===a.target);n&&o&&(e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(o.x,o.y),e.stroke())}),t.nodes.forEach(t=>{e.beginPath(),e.arc(t.x,t.y,15,0,2*Math.PI),e.fillStyle=t.color||"#ccc",e.fill(),e.strokeStyle="#fff",e.lineWidth=2,e.stroke(),e.fillStyle="#eee",e.font="12px Arial",e.fillText(t.label||t.id,t.x+20,t.y+5)}),t.nodes.length>0&&(t.nodes[0].x=100+20*Math.sin(Date.now()/1e3)),setTimeout(t.render.bind(t),1e3/60)}});