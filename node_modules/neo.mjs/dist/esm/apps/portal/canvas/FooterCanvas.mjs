import t from"../../../src/canvas/Base.mjs";const e="function"==typeof requestAnimationFrame;export default Neo.setupClass(class extends t{static colors={dark:{core:"#FFFFFF",inner:"#00BFFF",outer:"#3E63DD",void:"rgba(0,0,0,0)"},light:{core:"#3E63DD",inner:"#536DFE",outer:"#8BA6FF",void:"rgba(255,255,255,0)"}};static config={className:"Portal.canvas.FooterCanvas",remote:{app:["updateActiveId","updateHoverId","updateNavRects"]},singleton:!0};buffer=null;hoverId=null;navRects=[];gravityBoost=1;clearGraph(){let t=this;super.clearGraph(),t.buffer=null,t.hoverId=null,t.navRects=[],t.gravityBoost=1}onGraphMounted(t,e){this.initParticles(t,e)}initParticles(t,e){let a=this;a.buffer=new Float32Array(4800);for(let r=0;r<800;r++)a.resetParticle(r,t,e,!0)}resetParticle(t,e,a,r=!1){let o=this,i=6*t,l=.7*Math.max(e,a);o.buffer[i+2]=Math.random()*Math.PI*2,o.buffer[i+3]=r?Math.random()*l:l,o.buffer[i+4]=.5+1.5*Math.random(),o.buffer[i+5]=2*Math.random()+.5}render(){let t=this;if(!t.canRender)return;const a=t.context,r=t.canvasSize?.width||100,o=t.canvasSize?.height||50,i=t.buffer,l=t.constructor.colors[t.theme];if(!i)return void t.initParticles(r,o);t.gravityBoost>1&&(t.gravityBoost*=.9),a.clearRect(0,0,r,o);const s=r/2,n=.8*o;let h=200*(1+.1*(t.gravityBoost-1)),c=a.createRadialGradient(s,n,0,s,n,h);c.addColorStop(0,l.inner),c.addColorStop(1,l.void),a.globalCompositeOperation="lighter",a.fillStyle=c,a.globalAlpha=.2,a.beginPath(),a.arc(s,n,h,0,2*Math.PI),a.fill();let d=null;if(t.hoverId&&t.navRects.length>0)for(const e of t.navRects)if(e.id===t.hoverId){d={x:e.x+e.width/2,y:e.y+e.height/2,r:Math.max(e.width,e.height)/2};break}for(let e=0;e<800;e++){let h=6*e,c=i[h+2],f=i[h+3],u=i[h+4],v=i[h+5],p=s+Math.cos(c)*f,g=n+Math.sin(c)*(.4*f),m=!1;if(d){let a=d.x-p,r=d.y-g,o=Math.sqrt(a*a+r*r);const i=150*(1+.5*(t.gravityBoost-1));if(o<i&&e%3==0){m=!0;let e=(i-o)/i;e*=t.gravityBoost,p+=a*e*.1,g+=r*e*.1}}if(!m){let e=u*(1+500/(f+10));if(e*=1+.2*(t.gravityBoost-1),f-=.5*e,c+=.005*e,f<10){f=.7*Math.max(r,o),c=Math.random()*Math.PI*2}p=s+Math.cos(c)*f,g=n+Math.sin(c)*(.4*f)}i[h+2]=c,i[h+3]=f;let M=f/(.6*Math.max(r,o)),y=1-M;if(a.beginPath(),m?(a.fillStyle=l.inner,a.globalAlpha=.6):(a.fillStyle=M<.3?l.core:l.outer,a.globalAlpha=y),f<100&&!m){let t=s+Math.cos(c-.2)*(f+20),e=n+Math.sin(c-.2)*(.4*(f+20));a.strokeStyle=l.core,a.lineWidth=v,a.moveTo(p,g),a.lineTo(t,e),a.stroke()}else a.arc(p,g,v,0,2*Math.PI),a.fill()}a.globalCompositeOperation="source-over",a.globalAlpha=1,t.animationId=e?requestAnimationFrame(t.renderLoop):setTimeout(t.renderLoop,1e3/60)}updateActiveId(t){}updateHoverId(t){let e=this;e.hoverId!==t?.id&&(e.gravityBoost=5),e.hoverId=t?.id||null}updateNavRects(t){let e=t?.rects;this.navRects=Array.isArray(e)?e:[]}updateResources(t,e){this.initParticles(t,e)}});