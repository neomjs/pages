import e from"../../../../../src/component/Markdown.mjs";class t extends e{static config={className:"Portal.view.shared.content.Component",baseCls:["portal-content-component","neo-markdown-component"],bind:{record:e=>e.currentPageRecord},record_:null,replaceTicketIds:!0,tag:"article"};construct(e){super.construct(e);let t=this;t.addDomListeners({click:t.onClick,intersect:"onIntersect",scope:t})}afterSetMounted(e,t){super.afterSetMounted(e,t);let o=this;e&&o.timeout(50).then(()=>{Neo.main.addon.IntersectionObserver.register({callback:"findTopmostItem",id:o.id,root:`#${o.parentId}`,windowId:o.windowId})})}async afterSetRecord(e,t){if(e){let o=this;await o.doFetchContent(e),t&&(await o.timeout(50),Neo.main.DomAccess.scrollTo({direction:"top",id:o.parentId,value:0,windowId:o.windowId}))}}async doFetchContent(e){let t,o,n,a=this,{windowId:r}=a;n=a.getContentPath(e),e.isLeaf&&n&&(o=await fetch(n),t=await o.text(),a.value=t,a.toggleCls("lab",e.name?.startsWith("Lab:")),Neo.main.addon.IntersectionObserver.observe({disconnect:!0,id:a.id,observe:[".neo-h2",".neo-h3"],windowId:r}))}getContentPath(e){return null}headlineData=null;onClick({altKey:e,metaKey:t,shiftKey:o}){let n=this,{record:a}=n;e&&!t&&o?n.fire("edit",{component:n,record:a}):!e&&t&&o&&n.fire("refresh",{component:n,record:a})}modifyMarkdown(e){this.headlineData=[];const t=super.modifyMarkdown(e);return this.getStateProvider().getStore("sections").data=this.headlineData,this.headlineData=null,t}onHeadline(e,o,n){const a=o.replaceAll("`","");this.headlineData.push({id:n,name:a,sourceId:this.id,tag:e});return`<${e} class="neo-${e}" data-record-id="${n}">${o.replace(t.regexInlineCode,"<code>$1</code>")}</${e}>`}}export default Neo.setupClass(t);