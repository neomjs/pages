import e from"../../../../src/component/Markdown.mjs";class t extends e{static config={className:"Portal.view.learn.ContentComponent",baseCls:["learn-content","neo-markdown-component"],bind:{record:e=>e.currentPageRecord},record_:null,tag:"article"};construct(e){super.construct(e);let t=this;t.addDomListeners({click:t.onClick,intersect:"onIntersect",scope:t})}afterSetMounted(e,t){super.afterSetMounted(e,t);let n=this;e&&n.timeout(50).then(()=>{Neo.main.addon.IntersectionObserver.register({callback:"findTopmostItem",id:n.id,root:`#${n.parentId}`,windowId:n.windowId})})}async afterSetRecord(e,t){if(e){let n=this;await n.doFetchContent(e),t&&(await n.timeout(50),Neo.main.DomAccess.scrollTo({direction:"top",id:n.parentId,value:0,windowId:n.windowId}))}}async doFetchContent(e){let t,n,o=this,{windowId:a}=o,r=o.getStateProvider().getData("contentPath"),i=r.includes("/learn/")?"":"pages/";r+=`${i+e.id.replaceAll(".","/")}.md`,e.isLeaf&&r&&(n=await fetch(r),t=await n.text(),o.value=t,o.toggleCls("lab",e.name?.startsWith("Lab:")),Neo.main.addon.IntersectionObserver.observe({disconnect:!0,id:o.id,observe:[".neo-h2",".neo-h3"],windowId:a}))}headlineData=null;onClick({altKey:e,metaKey:t,shiftKey:n}){let o=this,{record:a}=o;e&&!t&&n?o.fire("edit",{component:o,record:a}):!e&&t&&n&&o.fire("refresh",{component:o,record:a})}modifyMarkdown(e){this.headlineData=[];const t=super.modifyMarkdown(e);return this.getStateProvider().getStore("contentSections").data=this.headlineData,this.headlineData=null,t}onHeadline(e,n,o){const a=n.replaceAll("`","");this.headlineData.push({id:o,name:a,sourceId:this.id,tag:e});return`<${e} class="neo-${e}" data-record-id="${o}">${n.replace(t.regexInlineCode,"<code>$1</code>")}</${e}>`}}export default Neo.setupClass(t);