import e from"../../../src/controller/Component.mjs";import t from"../../../src/layout/Cube.mjs";import o from"../../../src/util/Array.mjs";import{getSearchParams as n}from"../Util.mjs";export default Neo.setupClass(class extends e{static mainContentLayouts=["card","cube","mixed"];static routeMetadata={"/about-us":{title:"About Us - Neo.mjs",description:"Learn more about the team behind Neo.mjs."},"/blog":{title:"Neo.mjs Blog",description:"The official blog for the Neo.mjs platform."},"/docs":{title:"Neo.mjs Docs",description:"Official documentation for the Neo.mjs platform."},"/examples":{title:"Neo.mjs Examples",description:"A collection of examples for the Neo.mjs platform."},"/home":{title:"Neo.mjs",description:"Solve your toughest UI performance challenges with Neo.mjs: a multi-threaded JavaScript platform for extreme real-time web applications, complex dashboards, and unmatched developer productivity."},"/learn":{title:"Learn Neo.mjs",description:"Learn the fundamentals of the Neo.mjs platform."},"/services":{title:"Neo.mjs Services",description:"Professional services for the Neo.mjs platform."}};static config={className:"Portal.view.ViewportController",ntype:"viewport-controller",activeIndex_:null,defaultHash:"/home",mainContentLayout_:"card",routes:{"/about-us":"onAboutUsRoute","/blog":"onBlogRoute","/docs":"onDocsRoute","/examples":"onExamplesRoute","/examples/{itemId}":"onExamplesRoute","/home":"onHomeRoute","/learn":"onLearnRoute","/learn/{*itemId}":"onLearnRoute","/services":"onServicesRoute"},size_:null};connectedApps=[];#e=0;afterSetActiveIndex(e,t){null!==e&&this.updateHeaderToolbar()}afterSetMainContentLayout(e,t){let o=this,{activeIndex:n,windowId:a}=o,i=o.component.getItem("main-content");void 0===t&&Neo.main.addon.LocalStorage.readLocalStorageItem({key:"mainContentLayout",windowId:a}).then(({value:e})=>{e&&"card"!==e&&(o.mainContentLayout=e)}),i.layout="cube"===e?{ntype:"cube",activeIndex:n,fitContainer:!0,hideInactiveCardsOnDestroy:!0}:{ntype:"card",activeIndex:n},Neo.main.addon.LocalStorage.updateLocalStorageItem({key:"mainContentLayout",value:e,windowId:a})}afterSetSize(e,t){e&&this.updateHeaderToolbar()}beforeSetMainContentLayout(e,t){return this.beforeSetEnumValue(e,t,"mainContentLayout")}onAboutUsRoute(e,t,o){this.setMainContentIndex(5)}async onAppConnect(e){let{appName:t,windowId:o}=e,a=Neo.apps[t].mainView;if("PortalPreview"===t){let e=await Neo.Main.getByPath({path:"location.search",windowId:o}),t=n(e).id,i=Neo.getComponent(t),s=i.getReference("preview"),{tabContainer:r}=i,d=s.removeAt(0,!1);i.previewContainer=a,a.add(d),r.activeIndex=0,r.getTabAtIndex(1).disabled=!0}}async onAppDisconnect(e){let{appName:t,windowId:o}=e,a=Neo.apps[t].mainView;if("PortalPreview"===t){let e=await Neo.Main.getByPath({path:"location.search",windowId:o}),t=n(e).id,i=Neo.getComponent(t),s=i.getReference("preview"),{tabContainer:r}=i,d=a.removeAt(0,!1);i.previewContainer=null,s.add(d),i.disableRunSource=!0,r.activeIndex=1,i.getReference("popout-window-button").disabled=!1,r.getTabAtIndex(1).disabled=!1}else"Portal"===t&&Neo.Main.windowCloseAll({windowId:o})}onBlogPostStoreLoad(e){this.getReference("blog-header-button").badgeText=e.length+""}onBlogRoute(e,t,o){this.setMainContentIndex(2)}onBlogSearchFieldChange(e){this.getReference("blog-list").filterItems(e)}onConstructed(){super.onConstructed();let e=this;Neo.currentWorker.on({connect:e.onAppConnect,disconnect:e.onAppDisconnect,scope:e})}onDocsRoute(e,t,o){this.setMainContentIndex(6)}onExamplesRoute(e,t,o){this.setMainContentIndex(4)}async onHashChange(e,t){await super.onHashChange(e,t);const o=this.constructor.routeMetadata[e?.hashString];o&&await this.updateDocumentHead({description:o.description,title:o.title})}onHomeRoute(e,t,o){this.setMainContentIndex(0)}onLearnRoute(e,t,o){this.setMainContentIndex(1)}onServicesRoute(e,t,o){this.setMainContentIndex(3)}async setMainContentIndex(e){let t,o=this,{activeIndex:n,mainContentLayout:a}=o,i=o.getReference("main-content"),s=!0;e!==n&&(o.activeIndex=e,"mixed"===a&&Neo.isNumber(n)&&e<6&&n<6&&(o.#e++,t=o.#e,s=!1,"layout-cube"!==i.layout.ntype&&(await i.set({layout:{ntype:"cube",activeIndex:n,fitContainer:!0,hideInactiveCardsOnDestroy:!0}}),await o.timeout(20)),i.layout.activeIndex=e,await o.timeout(1100),t===o.#e&&(await i.set({layout:{ntype:"card",activeIndex:e}}),await o.timeout(20))),s&&(i.layout.activeIndex=e))}async updateDocumentHead({description:e,title:t}){let{windowId:o}=this,n=await Neo.currentWorker.getAddon("DocumentHead",o);n.setTitle({value:t,windowId:o}),n.setTag({content:e,name:"description",tag:"meta",windowId:o})}async updateHeaderToolbar(){let e=this,{activeIndex:t,size:n}=e;if(Neo.isNumber(t)&&n){let a=e.getReference("header-social-icons"),{cls:i}=a,s="x-small"===n,r=0!==t&&s;o.toggle(i,"hide-sidebar",r),r||o.toggle(i,"separate-bar",s),a.cls=i,r&&s&&await e.timeout(200),a.hidden=r}}});