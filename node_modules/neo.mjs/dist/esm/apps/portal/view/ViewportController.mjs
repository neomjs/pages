import e from"../../../src/controller/Component.mjs";import t from"../../../src/layout/Cube.mjs";import n from"../../../src/util/Array.mjs";import o from"../service/Seo.mjs";export default Neo.setupClass(class extends e{static mainContentLayouts=["card","cube","mixed"];static config={className:"Portal.view.ViewportController",ntype:"viewport-controller",activeIndex_:null,defaultHash:"/home",mainContentLayout_:"card",routes:{"/about-us":"onAboutUsRoute","/blog":"onBlogRoute","/docs":"onDocsRoute","/examples":"onExamplesRoute","/examples/{itemId}":"onExamplesRoute","/home":"onHomeRoute","/learn":"onLearnRoute","/learn/{*itemId}":"onLearnRoute","/services":"onServicesRoute"},size_:null};connectedApps=[];#e=0;afterSetActiveIndex(e,t){null!==e&&this.updateHeaderToolbar()}afterSetMainContentLayout(e,t){let n=this,{activeIndex:o,windowId:a}=n,i=n.component.getItem("main-content");void 0===t&&Neo.main.addon.LocalStorage.readLocalStorageItem({key:"mainContentLayout",windowId:a}).then(({value:e})=>{e&&"card"!==e&&(n.mainContentLayout=e)}),i.layout="cube"===e?{ntype:"cube",activeIndex:o,fitContainer:!0,hideInactiveCardsOnDestroy:!0}:{ntype:"card",activeIndex:o},Neo.main.addon.LocalStorage.updateLocalStorageItem({key:"mainContentLayout",value:e,windowId:a})}afterSetSize(e,t){e&&this.updateHeaderToolbar()}beforeSetMainContentLayout(e,t){return this.beforeSetEnumValue(e,t,"mainContentLayout")}onAboutUsRoute(e,t,n){this.setMainContentIndex(5)}async onAppDisconnect({appName:e,windowId:t}){"Portal"===e&&Neo.Main.windowCloseAll({windowId:t})}onBlogPostStoreLoad(e){this.getReference("blog-header-button").badgeText=e.length+""}onBlogRoute(e,t,n){this.setMainContentIndex(2)}onBlogSearchFieldChange(e){this.getReference("blog-list").filterItems(e)}onConstructed(){super.onConstructed();Neo.currentWorker.on({disconnect:this.onAppDisconnect,scope:this})}onDocsRoute(e,t,n){this.setMainContentIndex(6)}onExamplesRoute(e,t,n){this.setMainContentIndex(4)}async onHashChange(e,t){await super.onHashChange(e,t),o.onRouteChanged(e)}onHomeRoute(e,t,n){this.setMainContentIndex(0)}onLearnRoute(e,t,n){this.setMainContentIndex(1)}onServicesRoute(e,t,n){this.setMainContentIndex(3)}async setMainContentIndex(e){let t,n=this,{activeIndex:o,mainContentLayout:a}=n,i=n.getReference("main-content"),s=!0;e!==o&&(n.activeIndex=e,"mixed"===a&&Neo.isNumber(o)&&e<6&&o<6&&(n.#e++,t=n.#e,s=!1,"layout-cube"!==i.layout.ntype&&(await i.set({layout:{ntype:"cube",activeIndex:o,fitContainer:!0,hideInactiveCardsOnDestroy:!0}}),await n.timeout(20)),i.layout.activeIndex=e,await n.timeout(1100),t===n.#e&&(await i.set({layout:{ntype:"card",activeIndex:e}}),await n.timeout(20))),s&&(i.layout.activeIndex=e))}async updateHeaderToolbar(){let e=this,{activeIndex:t,size:o}=e;if(Neo.isNumber(t)&&o){let a=e.getReference("header-social-icons"),{cls:i}=a,s="x-small"===o,r=0!==t&&s;n.toggle(i,"hide-sidebar",r),r||n.toggle(i,"separate-bar",s),a.cls=i,r&&s&&await e.timeout(200),a.hidden=r}}});