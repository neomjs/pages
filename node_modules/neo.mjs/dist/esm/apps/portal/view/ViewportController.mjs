import e from"../../../src/controller/Component.mjs";import t from"../../../src/layout/Cube.mjs";import n from"../../../src/util/Array.mjs";import o from"../service/Seo.mjs";export default Neo.setupClass(class extends e{static mainContentLayouts=["card","cube","mixed"];static config={className:"Portal.view.ViewportController",ntype:"viewport-controller",activeIndex_:null,defaultHash:"/home",mainContentLayout_:"card",routes:{"/about-us":"onAboutUsRoute","/docs":"onDocsRoute","/examples":"onExamplesRoute","/examples/{itemId}":"onExamplesRoute","/home":"onHomeRoute","/learn":"onLearnRoute","/learn/{*itemId}":"onLearnRoute","/news":"onNewsRoute","/news/{*itemId}":"onNewsRoute","/services":"onServicesRoute"},size_:null};connectedApps=[];#e=0;afterSetActiveIndex(e,t){null!==e&&this.updateHeaderToolbar()}afterSetMainContentLayout(e,t){let n=this,{activeIndex:o,windowId:a}=n,i=n.component.getItem("main-content");void 0===t&&Neo.main.addon.LocalStorage.readLocalStorageItem({key:"mainContentLayout",windowId:a}).then(({value:e})=>{e&&"card"!==e&&(n.mainContentLayout=e)}),i.layout="cube"===e?{ntype:"cube",activeIndex:o,fitContainer:!0,hideInactiveCardsOnDestroy:!0}:{ntype:"card",activeIndex:o},Neo.main.addon.LocalStorage.updateLocalStorageItem({key:"mainContentLayout",value:e,windowId:a})}afterSetSize(e,t){e&&this.updateHeaderToolbar()}beforeSetMainContentLayout(e,t){return this.beforeSetEnumValue(e,t,"mainContentLayout")}onAboutUsRoute(e,t,n){this.setMainContentIndex(5)}async onAppDisconnect({appName:e,windowId:t}){"Portal"===e&&Neo.Main.windowCloseAll({windowId:t})}onMediumSearchFieldChange(e){this.getReference("medium-list").filterItems(e)}onConstructed(){super.onConstructed();let e=this;Neo.currentWorker.on({disconnect:e.onAppDisconnect,scope:e}),Neo.main.addon.LocalStorage.readLocalStorageItem({key:"portalTheme",windowId:e.windowId}).then(({value:t})=>{t?e.setTheme(t,!1):Neo.config.prefersDarkTheme&&e.setTheme("neo-theme-neo-dark",!1)})}onDocsRoute(e,t,n){this.setMainContentIndex(6)}onExamplesRoute(e,t,n){this.setMainContentIndex(4)}async onHashChange(e,t){await super.onHashChange(e,t),o.onRouteChanged(e)}onHomeRoute(e,t,n){this.setMainContentIndex(0)}onLearnRoute(e,t,n){this.setMainContentIndex(1)}onNewsRoute(e,t,n){this.setMainContentIndex(2)}onServicesRoute(e,t,n){this.setMainContentIndex(3)}async onSwitchTheme(e){let t,n,o,a=this,i="neo-theme-neo-light"===(a.component.theme||"neo-theme-neo-light")?"neo-theme-neo-dark":"neo-theme-neo-light";e.clientX&&(n=e.clientX,o=e.clientY,t=Math.hypot(Math.max(n,3e3-n),Math.max(o,3e3-o))),await Neo.main.DomAccess.startViewTransition({animate:{keyframes:[{clipPath:`circle(0px at ${n}px ${o}px)`},{clipPath:`circle(${t}px at ${n}px ${o}px)`}],options:{duration:500,easing:"ease-in",pseudoElement:"::view-transition-new(root)"}},delay:100,windowId:a.windowId}),a.setTheme(i)}async setMainContentIndex(e){let t,n=this,{activeIndex:o,mainContentLayout:a}=n,i=n.getReference("main-content"),s=!0;e!==o&&(n.activeIndex=e,"mixed"===a&&Neo.isNumber(o)&&e<6&&o<6&&(n.#e++,t=n.#e,s=!1,"layout-cube"!==i.layout.ntype&&(await i.set({layout:{ntype:"cube",activeIndex:o,fitContainer:!0,hideInactiveCardsOnDestroy:!0}}),await n.timeout(20)),i.layout.activeIndex=e,await n.timeout(1100),t===n.#e&&(await i.set({layout:{ntype:"card",activeIndex:e}}),await n.timeout(20))),s&&(i.layout.activeIndex=e))}setTheme(e,t=!0){let n=this,o=n.getReference("theme-switch-button"),a="neo-theme-neo-dark"===e?"fa-solid fa-sun":"fa-solid fa-moon";n.component.theme=e,o&&(o.iconCls=a),t&&Neo.main.addon.LocalStorage.updateLocalStorageItem({key:"portalTheme",value:e,windowId:n.windowId})}async updateHeaderToolbar(){let e=this,{activeIndex:t,size:o}=e;if(Neo.isNumber(t)&&o){let a=e.getReference("header-social-icons"),{cls:i}=a,s="x-small"===o,r=0!==t&&s;n.toggle(i,"hide-sidebar",r),r||n.toggle(i,"separate-bar",s),a.cls=i,r&&s&&await e.timeout(200),a.hidden=r}if(Neo.isNumber(t)){let n=e.getReference("header-canvas"),o=["home-button","learn-button","news-header-button","services-button","examples-button"],a=e.getReference(o[t]);n&&(n.activeId=a?.id||null)}}});