import e from"./Base.mjs";import t from"../DomAccess.mjs";import i from"../DomEvents.mjs";export default Neo.setupClass(class extends e{static config={className:"Neo.main.addon.ResizeObserver",instance:null,registerAttempts:3,remote:{app:["register","unregister"]}};construct(e){super.construct(e);let t=this;t.instance=new ResizeObserver(t.onResize.bind(t))}onResize(e,t){e.forEach(e=>{let t=e.borderBoxSize[0],n=e.contentBoxSize[0],s=e.devicePixelContentBoxSize?.[0]||{},o=i.getPathFromElement(e.target).map(e=>i.getTargetData(e));Neo.worker.Manager.sendMessage("app",{action:"domEvent",eventName:"resize",data:{contentRect:i.parseDomRect(e.contentRect),id:e.target.id,path:o,rect:o[0].rect,borderBoxSize:{blockSize:t.blockSize,inlineSize:t.inlineSize},contentBoxSize:{blockSize:n.blockSize,inlineSize:n.inlineSize},devicePixelContentBoxSize:{blockSize:s.blockSize,inlineSize:s.inlineSize}}})})}async register(e,i=0){let n=this,s=t.getElement(e.id);s?n.instance.observe(s):i<n.registerAttempts&&(await n.timeout(100),i++,n.register(e,i))}unregister(e){let i=t.getElement(e.id);i&&this.instance.unobserve(i)}});