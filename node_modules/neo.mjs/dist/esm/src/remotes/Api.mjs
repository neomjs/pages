import e from"../core/Base.mjs";export default Neo.setupClass(class extends e{static config={className:"Neo.remotes.Api",singleton:!0};generateRemote(e,t){return function(...r){return Neo.currentWorker.promiseMessage("data",{action:"rpc",method:t,params:[...r],service:e})}}load(){let{config:e}=Neo,t="development"===e.environment||"dist/esm"===e.environment,r=e.remotesApiUrl;r.includes("http")||(r=e.appPath.split("/"),r.pop(),r=`${r.join("/")}/${e.remotesApiUrl}`,r=(t?"../../":"./")+r),fetch(r).then((e=>e.json())).then((e=>{Neo.currentWorker.sendMessage("data",{action:"registerApi",data:e}),this.register(e)}))}register(e){let t;Object.entries(e.services).forEach((([r,s])=>{t=Neo.ns(`${e.namespace}.${r}`,!0),Object.entries(s.methods).forEach((([e,s])=>{t[e]=this.generateRemote(r,e)}))}))}});