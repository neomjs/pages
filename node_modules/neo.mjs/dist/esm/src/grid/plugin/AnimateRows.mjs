import t from"../../plugin/Base.mjs";import e from"../../util/Array.mjs";export default Neo.setupClass(class extends t{static transitionEasings=["ease","ease-in","ease-out","ease-in-out","linear"];static config={className:"Neo.grid.plugin.AnimateRows",ntype:"plugin-grid-animate-rows",transitionDuration_:500,transitionEasing_:"ease-out"};transitionTimeoutId=null;construct(t){super.construct(t);let e=this,{owner:o}=e,{store:n}=o;o.store=null,o.onStoreFilter=e.onStoreFilter.bind(e),o.onStoreLoad=e.onStoreLoad.bind(e),o.store=n,o.addCls("neo-animate-rows")}afterSetTransitionDuration(t,e){this.owner.addStyle({"--neo-duration":t+"ms"})}afterSetTransitionEasing(t,e){this.owner.addStyle({"--neo-easing":t})}beforeSetTransitionEasing(t,e){return this.beforeSetEnumValue(t,e,"transitionEasing")}destroy(...t){this.owner.addStyle({"--neo-duration":null,"--neo-easing":null}),super.destroy(...t)}onStoreFilter(t){this.updateView()}onStoreLoad(t){this.updateView()}updateView(){let t,o,n,i,s,a,r=this,{owner:l}=r,{mountedRows:u}=l,d=[],p=!1,c={},m=l.getVdomRoot().cn;for(m.forEach(t=>{c[t.id]=t}),l.updateMountedAndVisibleRows(),s=u[0];s<u[1];s++)n=l.store.getAt(s),t=l.getRowId(s),o=c[t],o?(a=`translate(0px, ${s*l.rowHeight}px)`,o.style.transform!==a&&(o.style.opacity=.9,o.style.transform=a,e.toggle(o.cls,"neo-even",s%2!=0),p=!0),delete c[t]):(i=l.createRow({record:n,rowIndex:s}),i.style.opacity=0,d.push(i),m.push(i),l.updateDepth=-1,p=!0);Object.values(c).forEach(t=>{t.style.opacity=0,p=!0}),p&&(clearTimeout(r.transitionTimeoutId),l.promiseUpdate().then(()=>{d.length>0&&(d.forEach(t=>{t.style.opacity=1}),l.update())}),r.transitionTimeoutId=setTimeout(()=>{r.transitionTimeoutId=null,l.createViewData()},r.transitionDuration))}});