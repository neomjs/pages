import t from"../../plugin/Base.mjs";import e from"../../util/Css.mjs";import o from"../../util/Array.mjs";export default Neo.setupClass(class extends t{static transitionEasings=["ease","ease-in","ease-out","ease-in-out","linear"];static config={className:"Neo.grid.plugin.AnimateRows",ntype:"plugin-grid-animate-rows",transitionDuration_:500,transitionEasing_:"ease-out"};transitionTimeoutId=null;construct(t){super.construct(t);let e=this,{owner:o}=e,{store:i}=o;o.store=null,o.onStoreFilter=e.onStoreFilter.bind(e),o.onStoreLoad=e.onStoreLoad.bind(e),o.store=i,o.addCls("neo-animate-rows")}afterSetTransitionDuration(t,e){this.owner.addStyle({"--neo-duration":t+"ms"})}afterSetTransitionEasing(t,e){this.owner.addStyle({"--neo-easing":t})}beforeSetTransitionEasing(t,e){return this.beforeSetEnumValue(t,e,"transitionEasing")}destroy(...t){this.owner.addStyle({"--neo-duration":null,"--neo-easing":null}),super.destroy(...t)}onStoreFilter(t){this.updateView()}onStoreLoad(t){this.updateView()}updateView(){let t,e,i,n,s,a,r=this,{owner:l}=r,{mountedRows:u}=l,d=[],p=!1,m={},c=l.getVdomRoot().cn;for(c.forEach(t=>{m[t.id]=t}),l.updateMountedAndVisibleRows(),s=u[0];s<u[1];s++)i=l.store.getAt(s),t=l.getRowId(i,s),e=m[t],e?(a=`translate(0px, ${s*l.rowHeight}px)`,e.style.transform!==a&&(e.style.opacity=.9,e.style.transform=a,o.toggle(e.cls,"neo-even",s%2!=0),p=!0),delete m[t]):(n=l.createRow({record:i,rowIndex:s}),n.style.opacity=0,d.push(n),c.push(n),l.updateDepth=-1,p=!0);Object.values(m).forEach(t=>{t.style.opacity=0,p=!0}),p&&(clearTimeout(r.transitionTimeoutId),l.promiseUpdate().then(()=>{d.length>0&&(d.forEach(t=>{t.style.opacity=1}),l.update())}),r.transitionTimeoutId=setTimeout(()=>{r.transitionTimeoutId=null,l.createViewData()},r.transitionDuration))}});