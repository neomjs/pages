import e from"../../button/Base.mjs";import t from"../../util/Array.mjs";import r from"../../form/field/Text.mjs";export default Neo.setupClass(class extends e{static cellAlignValues=["left","center","right"];static config={className:"Neo.grid.header.Button",ntype:"grid-header-button",baseCls:["neo-grid-header-button","neo-button"],cellAlign_:"left",dataField:null,defaultSortDirection:"ASC",editorConfig:null,filterConfig:null,filterField:null,iconCls:"fa fa-arrow-circle-up",iconPosition:"right",isSorted_:null,role:"columnheader",showHeaderFilter_:!1,sortable_:!0,useTriStateSorting_:!1};afterSetIsSorted(e,r){let i=this,{cls:l}=i,o=i.up("grid-container");switch(e){case null:t.add(l,"neo-sort-hidden");break;case"ASC":t.remove(l,"neo-sort-desc"),t.remove(l,"neo-sort-hidden"),t.add(l,"neo-sort-asc");break;case"DESC":t.remove(l,"neo-sort-asc"),t.remove(l,"neo-sort-hidden"),t.add(l,"neo-sort-desc")}i.cls=l,o&&o.store&&i.mounted&&i.fire("sort",{direction:e,property:i.dataField})}afterSetShowHeaderFilter(e,t){let i=this;e?i.filterField?delete i.filterField.vdom.removeDom:(i.filterField=Neo.create({module:r,appName:i.appName,flag:"filter-field",hideLabel:!0,parentId:i.id,style:{marginLeft:".5em",marginRight:".5em"},windowId:i.windowId,listeners:{change:i.changeFilterValue,operatorChange:i.changeFilterOperator,scope:i},...i.editorConfig}),i.vdom.cn.push(i.filterField.createVdomReference())):i.filterField&&(i.filterField.vdom.removeDom=!0),i.updateDepth=2,i.update()}afterSetSortable(e,r){let i=this,{cls:l}=i;t.toggle(l,"neo-sort-hidden",!e),i.cls=l,i.update()}beforeSetCellAlign(e,t){return this.beforeSetEnumValue(e,t,"cellAlign","cellAlignValues")}destroy(...e){this.filterField?.destroy(),super.destroy(...e)}onClick(e){let t,r=this;t="DESC"===r.defaultSortDirection?{ASC:r.useTriStateSorting?null:"DESC",DESC:"ASC",null:"DESC"}:{ASC:"DESC",DESC:r.useTriStateSorting?null:"ASC",null:"ASC"},r.isSorted=t[r.isSorted+""],super.onClick(e)}changeFilterOperator(e){let t,r,i=this,l=i.up("grid-container"),o=l?.store,a=e.value;o&&(t=o.getFilter(i.dataField),t?t.operator=a:(r=o.filters,r.push({property:i.dataField,operator:a,value:null,...i.filterConfig}),o.filters=r))}changeFilterValue(e){let t,r,i,l,o=this,a=o.up("grid-container"),d=a?.store,{value:n}=e;d&&(r=d.getFilter(o.dataField),l=d.model,t=l.getField(o.dataField),n&&"date"===t?.type.toLowerCase()&&(n=new Date(n)),r?r.value=n:(i=d.filters,i.push({property:o.dataField,operator:"like",value:n,...o.filterConfig}),d.filters=i))}removeSortingCss(){let e=this,{cls:r}=e;t.add(r,"neo-sort-hidden"),e.cls=r,e._isSorted=null}toJSON(){let e=this;return{...super.toJSON(),cellAlign:e.cellAlign,dataField:e.dataField,defaultSortDirection:e.defaultSortDirection,editorConfig:e.serializeConfig(e.editorConfig),filterConfig:e.serializeConfig(e.filterConfig),isSorted:e.isSorted,showHeaderFilter:e.showHeaderFilter,sortable:e.sortable,useTriStateSorting:e.useTriStateSorting}}});