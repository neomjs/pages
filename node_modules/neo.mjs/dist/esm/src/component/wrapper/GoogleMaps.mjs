import e from"../../component/Base.mjs";import o from"../../util/ClassSystem.mjs";import a from"../../data/Store.mjs";export default Neo.setupClass(class extends e{static config={className:"Neo.component.wrapper.GoogleMaps",ntype:"googlemaps",center_:{lat:-34.397,lng:150.644},markerStore_:{model:{fields:[{name:"anchorPoint",type:"Object"},{name:"icon",type:"Object"},{name:"id"},{name:"label",type:"String"},{name:"position",type:"Object"},{name:"title",type:"String"}]}},zoom_:8};fullscreenControl=!0;mapCreated=!1;mapOptions={};markerStoreConfig=null;maxZoom=null;minZoom=null;zoomControl=!0;construct(e){super.construct(e);let o=this;o.addDomListeners({googleMapZoomChange:o.onMapZoomChange,googleMarkerClick:o.parseMarkerClick,local:!1,scope:o})}addMarker(e){let{appName:o,windowId:a}=this;Neo.main.addon.GoogleMaps.addMarker({appName:o,windowId:a,...e})}afterSetCenter(e,o){let{appName:a,id:t,windowId:r}=this;this.mapCreated&&Neo.main.addon.GoogleMaps.setCenter({appName:a,id:t,value:e,windowId:r})}afterSetMarkerStore(e,o){let a=this;e.on({load:a.onMarkerStoreLoad,scope:a}),e.items.length>0&&a.onMarkerStoreLoad()}afterSetMounted(e,o){let a=this;if(!1===e&&void 0!==o&&a.removeMap(),super.afterSetMounted(e,o),e){let e={appName:a.appName,center:a.center,fullscreenControl:a.fullscreenControl,id:a.id,mapOptions:a.mapOptions,maxZoom:a.maxZoom,minZoom:a.minZoom,zoom:a.zoom,zoomControl:a.zoomControl};a.timeout(50).then((()=>{Neo.main.addon.GoogleMaps.create(e).then((()=>{a.mapCreated=!0,a.onComponentMounted()}))}))}}afterSetZoom(e,o){let a=this,{appName:t,id:r,windowId:d}=a;a.mapCreated&&(Neo.main.addon.GoogleMaps.setZoom({appName:t,id:r,value:e,windowId:d}),a.fire("zoomChange",{id:r,value:e}))}beforeSetMarkerStore(e,t){return t?.destroy(),o.beforeSetInstance(e,a,this.markerStoreConfig)}destroy(e=!1,o=!1){this.removeMap(),super.destroy(e,o)}hideMarker(e){let{appName:o,windowId:a}=this;Neo.main.addon.GoogleMaps.hideMarker({appName:o,id:e,mapId:this.id,windowId:a})}onComponentMounted(){}onMapZoomChange(e){this.zoom=e.value}onMarkerStoreLoad(){let{appName:e,id:o,windowId:a}=this;Neo.main.addon.GoogleMaps.destroyMarkers({appName:e,id:o,windowId:a}),this.markerStore.items.forEach((t=>{Neo.main.addon.GoogleMaps.addMarker({appName:e,mapId:o,windowId:a,...t})}))}panTo(e){let{appName:o,id:a,windowId:t}=this;Neo.main.addon.GoogleMaps.panTo({appName:o,mapId:a,position:e,windowId:t})}parseMarkerClick(e){let o=this;e.record=o.markerStore.get(e.id),o.onMarkerClick?.(e),o.fire("markerClick",{id:o.id,data:e})}removeMap(){let{appName:e,id:o,windowId:a}=this;Neo.main.addon.GoogleMaps.removeMap({appName:e,mapId:o,windowId:a})}removeMarker(e){let{appName:o,windowId:a}=this;Neo.main.addon.GoogleMaps.removeMarker({appName:o,id:e,mapId:this.id,windowId:a})}showMarker(e){let{appName:o,windowId:a}=this;Neo.main.addon.GoogleMaps.showMarker({appName:o,id:e,mapId:this.id,windowId:a})}});