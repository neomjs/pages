import e from"../Base.mjs";export default Neo.setupClass(class extends e{static config={className:"Neo.component.wrapper.MapboxGL",ntype:"mapboxgl",accessToken:null,chartData_:null,center_:{lat:0,lng:0},convertDataToGeoJson:!0,dataSourceId:null,layers_:null,mapboxStyle_:null,sources_:null,_vdom:{style:{position:"relative",height:"100%",width:"100%"},cn:[{style:{position:"absolute",height:"100%",width:"100%"},cn:[{style:{height:"100%"}}]}]},zoom_:3};afterSetCenter(e,a){this.centerMap(e)}afterSetChartData(e,a){let{appName:o,dataSourceId:t,id:d,windowId:n}=this;e&&Neo.main.addon.MapboxGL.updateData({appName:o,data:e,dataSourceId:t,id:d,windowId:n})}afterSetLayers(e,a){let{appName:o,id:t,windowId:d}=this;e&&Neo.main.addon.MapboxGL.addLayers({appName:o,id:t,layers:e,windowId:d})}afterSetMapboxStyle(e,a){let{accessToken:o,appName:t,id:d,windowId:n}=this;this.mounted&&Neo.main.addon.MapboxGL.setStyle({accessToken:o,appName:t,id:d,style:e,windowId:n})}afterSetMounted(e,a){let o=this,{appName:t,id:d,layers:n,sources:i,windowId:s}=o;if(!1===e&&void 0!==a&&Neo.main.addon.MapboxGL.destroy({appName:t,id:d,windowId:s}),super.afterSetMounted(e,a),e){const e={accessToken:o.accessToken,appName:t,center:o.center,id:d,mapboxStyle:o.mapboxStyle,zoom:o.zoom,windowId:s};o.chartData&&(e.data=o.chartData,e.dataSourceId=o.dataSourceId),n&&(e.layers=n),i&&(e.sources=i),Neo.main.addon.MapboxGL.create(e).then(o.onMapMounted)}}afterSetSources(e,a){if(e){let{appName:a,id:o,windowId:t}=this;Neo.main.addon.MapboxGL.addSources({appName:a,id:o,sources:e,windowId:t})}}afterSetZoom(e,a){if(this.mounted){let{appName:a,id:o,windowId:t}=this;Neo.main.addon.MapboxGL.zoom({appName:a,id:o,zoom:e,windowId:t})}}autoResize(){let{appName:e,id:a,windowId:o}=this;Neo.main.addon.MapboxGL.autoResize({appName:e,id:a,windowId:o})}beforeSetCenter(e,a){return e&&e.long&&(e.lng=e.long,delete e.long),e}beforeSetChartData(e,a){return e&&this.convertDataToGeoJson&&(e=this.convertToGeoJson(e)),e}centerMap(e,a=!1){let{appName:o,id:t,windowId:d}=this;Neo.main.addon.MapboxGL.center({animate:a,appName:o,id:t,lat:e.lat,lng:e.lng,windowId:d})}convertToGeoJson(e){const a={type:"FeatureCollection",features:[]};return e.forEach((e=>{a.features.push({type:"Feature",properties:{active:e.active,cases:e.cases,deaths:e.deaths,id:e.countryInfo.iso2,recovered:e.recovered,time:e.updated},geometry:{type:"Point",coordinates:[e.countryInfo.long,e.countryInfo.lat]}})})),a}flyTo(e){let a=this;e=a.beforeSetCenter(e,null),a._center={lat:e.lat,lng:e.lng},a.centerMap(e,!0)}getVdomRoot(){return this.vdom.cn[0].cn[0]}getVnodeRoot(){return this.vnode.childNodes[0].childNodes[0]}onMapMounted(){}setFilter(e){let{appName:a,id:o,windowId:t}=this,{layerId:d,options:n,value:i}=e;Neo.main.addon.MapboxGL.setFilter({appName:a,id:o,layerId:d,options:n,value:i,windowId:t})}setLayoutProperty(e){let{appName:a,id:o,windowId:t}=this,{key:d,layerId:n,options:i,value:s}=e;Neo.main.addon.MapboxGL.setLayoutProperty({appName:a,id:o,key:d,layerId:n,options:i,value:s,windowId:t})}setPaintProperty(e){let{appName:a,id:o,windowId:t}=this,{key:d,layerId:n,options:i,value:s}=e;Neo.main.addon.MapboxGL.setPaintProperty({appName:a,id:o,key:d,layerId:n,options:i,value:s,windowId:t})}});