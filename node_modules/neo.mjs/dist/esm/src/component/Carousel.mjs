import e from"../util/ClassSystem.mjs";import t from"./Base.mjs";import o from"../data/Store.mjs";import a from"../manager/Task.mjs";export default Neo.setupClass(class extends t{itemIndex=1;positionArray=["neo-carousel--translate-x-full","neo-carousel-translate-x-0","neo-carousel-translate-x-full"];itemData={};static config={className:"Neo.component.Carousel",ntype:"carousel",autoRun_:0,baseCls:["neo-carousel"],itemCls:null,itemTpl_:null,store_:null,_vdom:{cn:[{cls:["neo-carousel"],cn:[{cls:["neo-carousel-btn-bar"],cn:[{tag:"a","data-carouselaction":"back",cls:["neo-carousel-btn","fa","fa-chevron-left"]},{tag:"a","data-carouselaction":"forward",cls:["neo-carousel-btn","fa","fa-chevron-right"]}]},{cls:["neo-carousel-inner"],cn:[]}]}]}};construct(e){super.construct(e);let t=this;t.addDomListeners([{click:t.onCarouselBtnClick,delegate:".neo-carousel-btn",scope:t},{click:t.onClick,delegate:".neo-carousel-item",scope:t}])}afterSetAutoRun(e,t){if(e){let t=this;a.start({id:t.id,interval:e,run(){t.onCarouselBtnClick("forward")}}),t.vdom.cn[0].cn[0].removeDom=!0,t.update()}}afterSetStore(e,t){e?.on({load:"onStoreLoad",scope:this}),e?.getCount()>0&&this.onStoreLoad()}beforeSetStore(t,a){return a?.destroy(),e.beforeSetInstance(t,o)}createBaseItems(){let e=this,t=e.#e(),o=[],a=0;for(;a<3;a++)o.push(e.createItem(a,a));t.cn=o,e.update()}createItem(e,t){let o=this,{itemCls:a,positionArray:r,store:n}=o,s=n.getAt(e),l=o.itemTpl(s),c={cls:[r[t],"neo-carousel-item"],cn:l,recordIndex:e};return a&&c.cls.push(a),o.itemData[t]=s,c}onCarouselBtnClick(e){let t,o,a,r,n=this,s=Neo.isString(e)?e:e.target.data.carouselaction,{positionArray:l,store:c}=n,i=c.getCount(),u=n.itemIndex,m=n.#e();"forward"===s?(r="neo-carousel-translate-x-full",u+=2,t=u%i,n.itemIndex=t-1,l=n.#t(l,-1)):(r="neo-carousel--translate-x-full",u-=2,t=u<0?i+u:u,n.itemIndex=t+1,l=n.#t(l,1)),n.positionArray=l,m.cn=m.cn.map(function(e,s){return o=l[s],a=e.recordIndex,e.cls.shift(),e.cls.unshift(o),o===r&&(a=t,e=n.createItem(a,s)),e}),n.update()}onClick(e){let t,o=this;if(e.path[0].id===o.id)o.onContainerClick(e);else for(t of e.path)if(t.cls.includes(o.itemCls)){o.onItemClick(t,e);break}}onContainerClick(e){}onItemClick(e,t){let o=this;o.fire("itemClick",o.itemData[o.itemIndex])}onStoreLoad(){this.createBaseItems()}#e(){return this.vdom.cn[0].cn[1]}#t(e,t){return t?[...e.slice(t,e.length),...e.slice(0,t)]:e}});