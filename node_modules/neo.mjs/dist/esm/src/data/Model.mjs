import e from"../core/Base.mjs";import s from"./RecordFactory.mjs";import{isDescriptor as l}from"../core/ConfigSymbols.mjs";export default Neo.setupClass(class extends e{static config={className:"Neo.data.Model",ntype:"model",fields_:{[l]:!0,merge:"deepArrays",value:null},keyProperty_:"id",storeId:null,trackModifiedFields:!1};calculatedFieldsMap=new Map;fieldsMap=new Map;hasComplexFields=!1;hasNestedFields=!1;afterSetFields(e,l){if(e){let l=this;l.updateFieldsMap(e),l.isConstructed&&s.createRecordClass(l,!0)}}getField(e){return this.fieldsMap.get(e)||null}getFieldType(e){return this.getField(e)?.type?.toLowerCase()||null}toJSON(){let e=this;return{...super.toJSON(),fields:e.serializeConfig(e.fields),keyProperty:e.keyProperty,storeId:e.storeId,trackModifiedFields:e.trackModifiedFields}}updateFieldsMap(e,s=!0,l=""){let t,a=this,{calculatedFieldsMap:d,fieldsMap:i}=a;s&&(d.clear(),i.clear(),a.hasComplexFields=!1,a.hasNestedFields=!1),e.forEach(e=>{t=l+e.name,e.fields?(a.hasNestedFields=!0,a.updateFieldsMap(e.fields,!1,e.name+".")):(i.set(t,e),e.calculate&&d.set(t,e),(e.calculate||e.convert||e.mapping)&&(a.hasComplexFields=!0))})}});