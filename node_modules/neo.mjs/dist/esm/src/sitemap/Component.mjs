import e from"../component/Base.mjs";import t from"../util/ClassSystem.mjs";import o from"./Store.mjs";export default Neo.setupClass(class extends e{static itemHideModes=["removeDom","visibility"];static config={className:"Neo.sitemap.Component",ntype:"sitemap",baseCls:["neo-sitemap"],itemHideMode_:"removeDom",store_:null};construct(e){super.construct(e);let t=this;t.addDomListeners([{click:t.onItemHandlerClick,delegate:".neo-action-handler",scope:t},{click:t.onItemClick,delegate:".neo-action",scope:t}])}afterSetStore(e,t){let o={filter:"onStoreFilter",load:"onStoreLoad",recordChange:"onStoreRecordChange",scope:this};t?.un(o),e?.on(o),e?.getCount()>0&&this.createItems()}beforeSetItemHideMode(e,t){return this.beforeSetEnumValue(e,t,"itemHideMode")}beforeSetStore(e,s){return s?.destroy(),t.beforeSetInstance(e,o)}createItems(){let e,t,o,s,r=this,i=r.store.items,n=-1,{vdom:a}=r;for(s of(a.cn=[],i)){if(s.column!==n&&(n++,t={...r.itemDefaults,cls:["neo-sitemap-column"],cn:[],id:`${r.id}__column-${n}`},a.cn.push(t)),e=s.action,o={tag:"a",cls:["neo-action",`neo-level-${s.level}`],id:r.getItemId(s.id),html:s.name},e&&""!==e)switch(s.actionType){case"handler":o.cls.push("neo-action-handler");break;case"route":o.href=`#${s.action}`;break;case"url":o.href=s.action,o.target="_blank"}s.disabled&&o.cls.push("neo-disabled"),s.hidden&&("removeDom"===r.itemHideMode?o.removeDom=!0:o.cls.push("neo-hidden")),t.cn.push(o)}r.update()}getItemId(e){return`${this.id}__${e}`}getRecordId(e){let t=e.split("__")[1],{model:o}=this.store,s=o?.getField(o.keyProperty),r=s?.type.toLowerCase();return"integer"!==r&&"number"!==r||(t=parseInt(t)),t}onItemClick(e){}onItemHandlerClick(e){let t=this,o=t.store.get(t.getRecordId(e.path[0].id));t[o.action](o)}onStoreFilter(){this.createItems()}onStoreLoad(){this.createItems()}onStoreRecordChange(){this.createItems()}});