import e from"../component/Base.mjs";import t from"../util/Date.mjs";import a from"../util/Array.mjs";const n=new Date,o=n.getDate(),r=n.getMonth(),s=n.getFullYear();export default Neo.setupClass(class extends e{static config={className:"Neo.date.DayViewComponent",ntype:"day-view-component",baseCls:["neo-day-view"],bind:{intlFormatDay:e=>e.intlFormatDay,weekStartDay:e=>e.weekStartDay},currentDate_:null,intlFormatDay:null,weekStartDay_:0,_vdom:{cn:[]}};construct(e){super.construct(e),this.createContent(!0)}afterSetCurrentDate(e,t){this.isConstructed&&this.recreateContent(!1)}afterSetWeekStartDay(e,t){this.isConstructed&&this.recreateContent(!1)}createDayNamesRow(){let e,a,n=this,o=t.clone(n.currentDate),r=0,s={cls:["neo-row","neo-header-row"],cn:[]};for(o.setDate(n.currentDate.getDate()-n.currentDate.getDay()+n.weekStartDay);r<7;r++)e={cls:["neo-cell"],cn:[{cls:["neo-cell-content"],text:n.intlFormatDay.format(o)}]},a=o.getDay(),n.showWeekends||0!==a&&6!==a||(e.removeDom=!0),s.cn.push(e),o.setDate(o.getDate()+1);return s}createContent(e=!1,n){let l,c,D,i,u,d,m,h,y=this,{currentDate:g}=y,w=g.getDate(),p=g.getMonth(),C=g.getFullYear(),f=y.currentDate,S=y.maxValue&&new Date(`${y.maxValue}T12:00:00.000Z`),v=y.minValue&&new Date(`${y.minValue}T12:00:00.000Z`),k=new Date(`${y.value}T12:00:00.000Z`),F=k.getMonth(),x=k.getFullYear(),b=t.getDaysInMonth(g),M=t.getFirstDayOfMonth(g)-y.weekStartDay,V=n||y.vdom,N=0;for(M=M<0?M+7:M,h=(b+M)/7>5?6:5,i=1-M,f.setDate(i),V.cn.push(y.createDayNamesRow());N<h;N++){for(m={cls:["neo-row"],cn:[]},d=0;d<7;d++)u=i>0&&i<=b,l=y.getCellId(C,p+1,i),D=f.getDay(),c={id:l,cls:u?["neo-cell"]:["neo-cell","neo-disabled"],tabIndex:u?-1:null,cn:[{cls:["neo-cell-content"],text:u?i:y.showDisabledDays?f.getDate():""}]},0!==D&&6!==D||(y.showWeekends||(c.removeDom=!0),c.cls.push("neo-weekend")),(S&&f>S||v&&f<v)&&a.add(c.cls,"neo-disabled"),s===C&&r===p&&o===i&&c.cn[0].cls.push("neo-today"),x===C&&F===p&&i===w&&(c.cls.push("neo-selected"),y.selectionModel.items=[l]),m.cn.push(c),f.setDate(f.getDate()+1),i++;V.cn.push(m)}!e&&y.update()}getCellId(e,t,a){return(a=a.toString()).length<2&&(a="0"+a),(t=t.toString()).length<2&&(t="0"+t),this.id+"__"+e+"-"+t+"-"+a}recreateContent(e=!0){let t=this;t.vdom.cn=[],t.createContent(!0),e&&t.syncVdomState(t.vnode,t.vdom,!0),t.update()}});