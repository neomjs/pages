import e from"../util/ClassSystem.mjs";import t from"../container/Base.mjs";import a from"../selection/DateSelectorModel.mjs";import o from"./DayViewComponent.mjs";import r from"../util/Date.mjs";import n from"../util/Array.mjs";import l from"./SelectorContainerStateProvider.mjs";import s from"../toolbar/Base.mjs";const i=new Date;class m extends t{static config={className:"Neo.date.SelectorContainer",ntype:"date-selector",baseCls:["neo-dateselector","neo-container"],bind:{intlFormatDay:{twoWay:!0,value:e=>e.intlFormatDay},weekStartDay:{twoWay:!0,value:e=>e.weekStartDay}},currentDate_:null,dateFormat:"Y-m-d",dayNameFormat_:"short",intlFormatDay_:null,isUpdating_:!1,items:[{module:s,cls:["neo-header-toolbar"],flex:"none",itemDefaults:{ntype:"button",ui:"tertiary"},items:[{handler:"up.onPrevButtonClick",iconCls:"fas fa-circle-chevron-left"},{flex:1,text:"2024"},{handler:"up.onNextButtonClick",iconCls:"fas fa-circle-chevron-right"}]},{module:t,layout:"card",items:[{module:o,reference:"day-view"},{module:o,reference:"day-view-next"}]}],keys:{},locale_:Neo.config.locale,maxValue_:null,minValue_:null,mouseWheelDelta:1,scrollNewYearFromTop:!1,selectionModel_:null,showCellBorders_:!1,showDisabledDays_:!0,showWeekends_:!0,stateProvider:l,useAnimations:!0,value_:r.convertToyyyymmdd(i),weekStartDay_:0};cachedUpdate=null;get dayView(){return this.getItem("day-view")}afterSetCurrentDate(e,t){let a=this;a.mounted||e&&(a.dayView.currentDate=e)}afterSetDayNameFormat(e,t){this.updateHeaderDays(e,t)}afterSetShowCellBorders(e,t){let{cls:a}=this;n.toggle(a,"neo-hide-inner-borders",!e),this.cls=a}afterSetValue(e,t){let a=this;e&&(a.isUpdating?a.cacheUpdate():(a.currentDate=new Date(`${e}T12:00:00.000Z`),a.fire("change",{component:a,oldValue:t,value:e})))}beforeSetDayNameFormat(e,t){return this.beforeSetEnumValue(e,t,"dayNameFormat",r.prototype.dayNameFormats)}beforeSetSelectionModel(t,o){return o&&o.destroy(),e.beforeSetInstance(t,a)}beforeSetWeekStartDay(e,t){return this.beforeSetEnumValue(e,t,"weekStartDay",r.prototype.weekStartDays)}cacheUpdate(e=this.currentDate){this.cachedUpdate=e}changeMonth(e){let t=this.currentDate;t.setMonth(t.getMonth()+e),this.value=r.convertToyyyymmdd(t)}onNextButtonClick(e){this.changeMonth(1)}onPrevButtonClick(e){this.changeMonth(-1)}updateHeaderDays(e,t,a=!1){let o=this;o.intlFormatDay;if(o.intlFormatDay=new Intl.DateTimeFormat(o.locale,{weekday:e}),void 0!==t){let e,t,r=o.dayView.vdom.cn[0],n=o.currentDate,l=0;for(n.setDate(o.currentDate.getDate()-o.currentDate.getDay()+o.weekStartDay);l<7;l++)t=r.cn[l],t.cn[0].html=o.intlFormatDay.format(n),e=n.getDay(),o.showWeekends||0!==e&&6!==e?delete t.removeDom:t.removeDom=!0,n.setDate(n.getDate()+1);!a&&o.update()}}}export default Neo.setupClass(m);