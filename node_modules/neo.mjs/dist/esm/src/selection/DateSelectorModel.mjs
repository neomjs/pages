import e from"../util/Date.mjs";import t from"./Model.mjs";export default Neo.setupClass(class extends t{static config={className:"Neo.selection.DateSelectorModel",ntype:"selection-dateselectormodel",stayInColumn:!1};getCellDate(e){let t,o,n=this.getSelection();return t=n[0]?n[0].split("__"):e.path[0].id.split("__"),o=t[1].split("-").map(e=>parseInt(e)),o[1]--,new Date(...o)}onKeyDownDown(e){this.onNavKeyRow(e,7)}onKeyDownLeft(e){this.onNavKeyColumn(e,-1)}onKeyDownRight(e){this.onNavKeyColumn(e,1)}onKeyDownUp(e){this.onNavKeyRow(e,-7)}onNavKeyColumn(t,o){let n,s,l,i=this,y=i.getCellDate(t),{view:a}=i;n=e.getDaysInMonth(y),l=(y.getDate()+o)%n,l=0===l?n:l,s=a.getCellId(y.getFullYear(),y.getMonth()+1,l),i.select(s),a.focus(s)}onNavKeyRow(t,o){let n,s,l,i=this,y=i.getCellDate(t),{view:a}=i;if(n=e.getDaysInMonth(y),l=y.getDate()+o,l>n)for(i.stayInColumn||(l+=1);l>7;)l-=o;else if(l<1)for(i.stayInColumn||(l-=1);l<n-6;)l-=o;s=a.getCellId(y.getFullYear(),y.getMonth()+1,l),i.select(s),a.focus(s)}register(e){super.register(e);let t={scope:this.id},{view:o}=this;o.keys?._keys.push({fn:"onKeyDownDown",key:"Down",...t},{fn:"onKeyDownLeft",key:"Left",...t},{fn:"onKeyDownRight",key:"Right",...t},{fn:"onKeyDownUp",key:"Up",...t})}unregister(){let e={scope:this.id},{view:t}=this;t.keys?.removeKeys([{fn:"onKeyDownDown",key:"Down",...e},{fn:"onKeyDownLeft",key:"Left",...e},{fn:"onKeyDownRight",key:"Right",...e},{fn:"onKeyDownUp",key:"Up",...e}]),super.unregister()}});