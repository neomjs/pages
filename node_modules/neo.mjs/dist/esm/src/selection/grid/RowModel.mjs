import e from"./BaseModel.mjs";export default Neo.setupClass(class extends e{static config={className:"Neo.selection.grid.RowModel",ntype:"selection-grid-rowmodel",cls:"neo-selection-rowmodel"};addDomListener(){let e=this;e.view.parent.on("rowClick",e.onRowClick,e)}destroy(...e){let o=this;o.view.parent.un("rowClick",o.onRowClick,o),super.destroy(...e)}onKeyDownDown(e){!this.hasEditorFocus(e)&&this.onNavKeyRow(1)}onKeyDownUp(e){!this.hasEditorFocus(e)&&this.onNavKeyRow(-1)}onNavKeyRow(e){let o=this,{view:t}=o,{store:s}=t,n=s.getCount(),i=s.getKeyProperty(),r=o.selectedRows[0]||s.getAt(0)[i],l=s.get(r),c=s.indexOf(l),w=(c+e)%n;for(;w<0;)w+=n;l=s.getAt(w),o.hasAnnotations(l)?o.updateAnnotations(l):(r=l[i],r&&(o.selectRow(r),t.scrollByRows(c,e),t.fire("select",{record:l})))}onRowClick({data:e}){let o,t=this,{view:s}=t,n=t.getRecord(e.path);n&&(t.hasAnnotations(n)?t.updateAnnotations(n):(o=n[s.store.getKeyProperty()],t.toggleRowSelection(o),s.fire(t.isSelectedRow(o)?"select":"deselect",{record:n})))}register(e){super.register(e);let{id:o,view:t}=this;t.keys?._keys.push({fn:"onKeyDownDown",key:"Down",scope:o},{fn:"onKeyDownUp",key:"Up",scope:o})}unregister(){let{id:e,view:o}=this;o.keys?.removeKeys([{fn:"onKeyDownDown",key:"Down",scope:e},{fn:"onKeyDownUp",key:"Up",scope:e}]),super.unregister()}updateAnnotations(e){let o=this,{view:t}=o,{store:s}=t,n=e[s.getKeyProperty()],i=o.isSelectedRow(n),r=t.selectedRecordField;o.singleSelect?i?e[r]=!1:(o.selectedRows.forEach(e=>{s.get(e).setSilent({[r]:!1})}),e[r]=!0):e[r]=!e[r]}});