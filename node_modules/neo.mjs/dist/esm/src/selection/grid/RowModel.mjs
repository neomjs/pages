import e from"./BaseModel.mjs";export default Neo.setupClass(class extends e{static config={className:"Neo.selection.grid.RowModel",ntype:"selection-grid-rowmodel",cls:"neo-selection-rowmodel"};addDomListener(){let e=this;e.view.parent.on("rowClick",e.onRowClick,e)}destroy(...e){let o=this;o.view.parent.un("rowClick",o.onRowClick,o),super.destroy(...e)}onKeyDownDown(e){!this.hasEditorFocus(e)&&this.onNavKeyRow(1)}onKeyDownUp(e){!this.hasEditorFocus(e)&&this.onNavKeyRow(-1)}onNavKeyRow(e){let o=this,{view:t}=o,{store:s}=t,n=s.getCount(),i=o.selectedRows[0]||t.getRecordId(s.getAt(0)),r=o.getRowRecord(i),c=s.indexOf(r),d=(c+e)%n;for(;d<0;)d+=n;r=s.getAt(d),o.hasAnnotations(r)?o.updateAnnotations(r):(i=t.getRecordId(r),i&&(o.selectRow(i),t.scrollByRows(c,e),t.fire("select",{record:r})))}onRowClick({data:e}){let o,t=this,{view:s}=t,n=t.getRecord(e.path);n&&(t.hasAnnotations(n)?t.updateAnnotations(n):(o=s.getRecordId(n),t.toggleRowSelection(o),s.fire(t.isSelectedRow(o)?"select":"deselect",{record:n})))}register(e){super.register(e);let{id:o,view:t}=this;t.keys?._keys.push({fn:"onKeyDownDown",key:"Down",scope:o},{fn:"onKeyDownUp",key:"Up",scope:o})}unregister(){let{id:e,view:o}=this;o.keys?.removeKeys([{fn:"onKeyDownDown",key:"Down",scope:e},{fn:"onKeyDownUp",key:"Up",scope:e}]),super.unregister()}updateAnnotations(e){let o=this,{view:t}=o,{store:s}=t,n=t.getRecordId(e),i=o.isSelectedRow(n),r=t.selectedRecordField;o.singleSelect?i?e[r]=!1:(o.selectedRows.forEach(e=>{s.get(e).setSilent({[r]:!1})}),e[r]=!0):e[r]=!e[r]}});