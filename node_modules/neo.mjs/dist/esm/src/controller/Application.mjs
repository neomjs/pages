import e from"./Base.mjs";import o from"../util/ClassSystem.mjs";import t from"../util/Array.mjs";class n extends e{static observable=!0;static config={className:"Neo.controller.Application",ntype:"application",appThemeFolder:null,mainView_:null,mounted:!1,name:"MyApp",parentId:"document.body",vnodeInitialising:!1,vnodeInitialized:!1,windowId:null};construct(e){let{mainView:o}=e;delete e.mainView,super.construct(e);let t=this,{name:n}=t;t.windowId=Neo.config.windowId,Neo.apps??={},Neo.apps[t.windowId]=t,Neo.appsByName??={},Neo.appsByName[n]??=[],Neo.appsByName[n].push(t),Neo.currentWorker.registerApp(n),o&&(t.mainView=o)}async afterSetMainView(e,o){if(e){let o=this,{config:t}=Neo;await o.timeout(t.hash?200:10),t.useSSR&&t.vnode?(e.onInitVnode(t.vnode,!0),delete t.vnode,e.updateDepth=-1,e.update()):await e.initVnode(!0)}}beforeSetMainView(e,t){if(e){let{config:t}=Neo,n={appName:this.name,parentId:this.parentId,windowId:t.windowId};return t.useSSR&&t.vnode&&(n.autoInitVnode=!1,n.autoMount=!1),o.beforeSetInstance(e,null,n)}return null}destroy(...e){let o=this,{name:n}=o;delete Neo.apps[o.windowId],Neo.appsByName?.[n]&&t.remove(Neo.appsByName[n],o),Neo.currentWorker.removeAppFromThemeMap(n),super.destroy(...e)}}n=Neo.setupClass(n),Neo.app=e=>Neo.create({module:n,...e});export default n;