import e from"../container/Base.mjs";import t from"../component/Label.mjs";let a={};export default Neo.setupClass(class extends e{static config={className:"Neo.tooltip.Base",ntype:"tooltip",baseCls:["neo-tooltip"],componentId_:null,delegate:null,dismissDelay:1e4,dismissDelayTaskId:null,floating:!0,hideDelay:400,hideDelayTaskId:null,showDelay:200,showDelayTaskId:null,stayOnHover_:!0,text_:null};addTimeout(e,t,a){e+="DelayTaskId",this.clearTimeout(this[e]),this[e]=setTimeout(t,a)}afterSetComponentId(e,t){if(e){let t=this;Neo.getComponent(e).addDomListeners({mouseenter:t.onDelegateMouseEnter,mouseleave:t.onDelegateMouseLeave,delegate:t.delegate,scope:t})}}afterSetStayOnHover(e,t){if(e){let e=this;e.addDomListeners([{mouseenter:e.onMouseEnter,scope:e},{mouseleave:e.onMouseLeave,scope:e}])}}afterSetText(e,a){if(e){let a=this,i=(a.items||[])[0];"label"===i?.ntype?i.text=e:a.add({module:t,text:e})}}clearTimeout(e){Array.isArray(e)||(e=[e]);let t,a=this;e.forEach((e=>{t=e+"DelayTaskId",a[t]&&(clearTimeout(a[t]),a[t]=null)}))}static createSingleton(e){return a[e.name]||(a[e.name]=Neo.create("Neo.tooltip.Base",{appName:e.name,componentId:e.mainView.id,delegate:this.delegateFilter,isShared:!0,resetCfg:{},windowId:e.mainView.windowId,listeners:{targetOver({target:e,data:t}){let a,i,s=this;for(i in s.setSilent(s.resetCfg),s.resetCfg={},a=e?._tooltip||{text:t.target.data.neoTooltip},a)s.resetCfg[i]=s[i];s.set(a)}}})),a[e.name]}static delegateFilter(e){for(let t=0,{length:a}=e;t<a;t++)if(e[t].cls.includes("neo-uses-shared-tooltip")||e[t].data.neoTooltip)return t}hide(){let e=this;e.clearTimeout(["dismiss","hide","show"]),e.mounted&&e.unmount()}hideDelayed(e){let t=this;t.hideDelay?t.addTimeout("hide",t.hide.bind(t),t.hideDelay):t.hide(e)}onDelegateMouseEnter(e){let t=this,{currentTarget:a}=e;a!==t.activeTarget?.id&&(t.activeTarget=Neo.get(a),t.fire("targetOver",{target:t.activeTarget,data:e}),t.align.target=a,t.align.targetMargin=10,t.mounted?(t.show(),t.alignTo()):t.showDelayed(e))}onDelegateMouseLeave(e){let t=this;e.currentTarget===t.activeTarget?.id&&(t.fire("targetOut",{target:t.activeTarget,data:e}),t.activeTarget=null,t.hideDelayed(e))}onMouseEnter(e){let t=e.path[0].id;this.id===t&&this.clearTimeout(["dismiss","hide"])}onMouseLeave(e){let t=e.path[0].id;this.id===t&&this.hideDelayed(null)}show(e){let t=this;t.showDelayTaskId=null,t.clearTimeout(["hide","dismiss"]),t.dismissDelay&&t.addTimeout("dismiss",t.hide.bind(t),t.dismissDelay,e),!t.mounted&&t.render(!0)}showDelayed(e){let t=this;t.showDelay?t.addTimeout("show",t.show.bind(t),t.showDelay):t.show(e)}});