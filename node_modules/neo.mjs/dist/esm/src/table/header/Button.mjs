import e from"../../button/Base.mjs";import t from"../../util/Array.mjs";import l from"../../form/field/Text.mjs";import{resolveCallback as r}from"../../util/Function.mjs";export default Neo.setupClass(class extends e{static cellAlignValues=["left","center","right"];static config={className:"Neo.table.header.Button",ntype:"table-header-button",baseCls:["neo-table-header-button"],cellAlign_:"left",dataField:null,defaultSortDirection:"ASC",draggable_:!0,editorConfig:null,filterConfig:null,filterField:null,iconCls:"fa fa-arrow-circle-up",iconPosition:"right",isSorted_:null,renderer_:"cellRenderer",rendererScope:null,showHeaderFilter_:!1,sortable_:!0,_vdom:{tag:"th",cn:[{tag:"button",cn:[{tag:"span",cls:["neo-button-glyph"]},{tag:"span",cls:["neo-button-text"]},{tag:"span",cls:["neo-button-badge"]},{tag:"span",cls:["neo-button-ripple-wrapper"],cn:[{tag:"span",cls:["neo-button-ripple"]}]}]}]}};afterSetIsSorted(e,l){let r=this,{cls:o}=r,i=r.up("table-container");switch(e){case null:t.add(o,"neo-sort-hidden");break;case"ASC":t.remove(o,"neo-sort-desc"),t.remove(o,"neo-sort-hidden"),t.add(o,"neo-sort-asc");break;case"DESC":t.remove(o,"neo-sort-asc"),t.remove(o,"neo-sort-hidden"),t.add(o,"neo-sort-desc")}r.cls=o,i&&i.store&&r.mounted&&r.fire("sort",{direction:e,property:r.dataField})}afterSetShowHeaderFilter(e,t){let r=this;e?r.filterField?delete r.filterField.vdom.removeDom:(r.filterField=Neo.create({module:l,appName:r.appName,flag:"filter-field",hideLabel:!0,parentId:r.id,style:{marginLeft:".5em",marginRight:".5em"},windowId:r.windowId,listeners:{change:r.changeFilterValue,operatorChange:r.changeFilterOperator,scope:r},...r.editorConfig}),r.vdom.cn.push(r.filterField.createVdomReference())):r.filterField&&(r.filterField.vdom.removeDom=!0),r.updateDepth=2,r.update()}afterSetSortable(e,l){let r=this,{cls:o}=r;t.toggle(o,"neo-sort-hidden",!e),r.cls=o,r.update()}beforeSetCellAlign(e,t){return this.beforeSetEnumValue(e,t,"cellAlign","cellAlignValues")}beforeSetRenderer(e,t){return r(e,this).fn}cellRenderer(e){return e.value}changeFilterOperator(e){let t,l,r=this,o=r.up("table-container"),i=o?.store,a=e.value;i&&(t=i.getFilter(r.dataField),t?t.operator=a:(l=i.filters,l.push({property:r.dataField,operator:a,value:null,...r.filterConfig}),i.filters=l))}changeFilterValue(e){let t,l,r,o,i=this,a=i.up("table-container"),n=a?.store,{value:d}=e;n&&(l=n.getFilter(i.dataField),o=n.model,t=o&&o.getField(i.dataField),d&&"date"===t.type.toLowerCase()&&(d=new Date(d)),Neo.isRecord(d)&&(d=d[i.filterField.displayField]),l?l.value=d:(r=n.filters,r.push({property:i.dataField,operator:"like",value:d,...i.filterConfig}),n.filters=r))}destroy(...e){this.filterField?.destroy(),super.destroy(...e)}getVdomRoot(){return this.vdom.cn[0]}getVnodeRoot(){return this.vnode.childNodes[0]}onClick(e){let t,l=this;t="DESC"===l.defaultSortDirection?{ASC:null,DESC:"ASC",null:"DESC"}:{ASC:"DESC",DESC:null,null:"ASC"},l.isSorted=t[l.isSorted+""],super.onClick(e)}removeSortingCss(){let e=this,{cls:l}=e;t.add(l,"neo-sort-hidden"),e.cls=l,e._isSorted=null}});