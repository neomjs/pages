import e from"../core/Base.mjs";import s from"../util/Array.mjs";export default Neo.setupClass(class extends e{static config={className:"Neo.util.KeyNavigation",ntype:"keynav",component_:null,keyDownEventBubble:!1,keys_:null};add(e){this._keys.push(...this.parseKeys(e))}beforeGetComponent(){return Neo.getComponent(this._component)}beforeSetComponent(e){return e?.id}destroy(){this.unregister(),super.destroy()}onKeyDown(e){if(e.key){let s,o=this,r=e.key.toUpperCase();r=o.parseUpperCaseKey(r),o.keys.forEach(t=>{s=Neo.isString(t.scope)?Neo.get(t.scope):t.scope,t.key.toUpperCase()===r&&(Neo.isFunction(t.fn)?t.fn.apply(s,[e,o.component]):s[t.fn]?.apply(s,[e,o.component]))})}}parseKeys(e){if(!Array.isArray(e)){let s=this._component,o=[];s&&(Object.entries(e).forEach(([r,t])=>{"scope"!==r&&o.push({fn:t,key:r,scope:e.scope||s})}),e=o)}return e}parseUpperCaseKey(e){switch(e){case" ":e="SPACE";break;case"ARROWDOWN":e="DOWN";break;case"ARROWLEFT":e="LEFT";break;case"ARROWRIGHT":e="RIGHT";break;case"ARROWUP":e="UP"}return e}register(e){let s=this;s.component=e,s.keys=s.parseKeys(s.keys),e.addDomListeners({keydown:{bubble:s.keyDownEventBubble,fn:s.onKeyDown,scope:s}})}removeKey(e){let o,r=this._keys,t=0,n=r.length;for(;t<n;t++)if(o=r[t],Neo.isEqual(o,e)){s.remove(r,o);break}}removeKeys(e){Array.isArray(e)&&e.forEach(e=>this.removeKey(e))}unregister(){}});