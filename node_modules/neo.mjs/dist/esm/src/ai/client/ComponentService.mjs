import o from"./Service.mjs";import e from"../../util/vdom/TreeBuilder.mjs";import t from"../../util/VDom.mjs";export default Neo.setupClass(class extends o{static config={className:"Neo.ai.client.ComponentService"};async getComputedStyles({componentId:o,variables:e}){const t=Neo.getComponent(o);if(!t)throw new Error(`Component not found: ${o}`);return{styles:await Neo.main.DomAccess.getComputedStyle({id:t.id,style:e})}}async getDomRect({componentIds:o}){if(!Array.isArray(o)||0===o.length)throw new Error("componentIds must be a non-empty array");const e=Neo.getComponent(o[0]);if(!e)throw new Error(`Component not found: ${o[0]}`);const t=await e.getDomRect(o);return{rects:Array.isArray(t)?t:[t]}}highlightComponent({componentId:o,options:e}){let t,n=Neo.getComponent(o);if(!n)throw new Error(`Component not found: ${o}`);const r=(e=e||{}).color||"red",m=e.duration||2e3,s=e.style||"outline";t=n.style||{};let i={};return"outline"===s?(i.outline=`2px solid ${r}`,i.outlineOffset="-2px"):i.boxShadow=`0 0 10px ${r}, inset 0 0 10px ${r}`,n.style={...t,...i},this.timeout(m).then(()=>{n.style=t}),{success:!0}}getComponentTree({depth:o,lean:e=!0,rootId:t}){return{tree:this.serializeComponent({component:this.getComponentRoot(t),lean:e,maxDepth:o||-1})}}getVdomTree({depth:o,rootId:t}){const n=this.getComponentRoot(t);if(!n)throw new Error("Root component not found");return{vdom:e.getVdomTree(n.vdom,o)}}getVnodeTree({depth:o,rootId:t}){const n=this.getComponentRoot(t);if(!n)throw new Error("Root component not found");return{vnode:e.getVnodeTree(n.vnode,o)}}getVdomVnode({depth:o,rootId:t}){const n=this.getComponentRoot(t);if(!n)throw new Error("Root component not found");return{vdom:e.getVdomTree(n.vdom,o),vnode:e.getVnodeTree(n.vnode,o)}}queryComponent({rootId:o,selector:e,returnProperties:t}){let n;if(o){const t=Neo.getComponent(o);if(!t)throw new Error(`Root component not found: ${o}`);n=t.down(e,!1)}else n=Neo.manager.Component.find(e);return{components:n.map(o=>{if(Array.isArray(t)&&t.length>0){const e={};return t.forEach(t=>{e[t]=this.safeSerialize(o[t])}),{className:o.className,id:o.id,properties:e}}return o.toJSON()})}}queryVdom({rootId:o,selector:e}){const n=this.getComponentRoot(o);if(!n)throw new Error("Root component not found");const r=t.find(n.vdom,e);return{vdom:r?.vdom||null,index:r?.index,parentId:r?.parentNode?.id}}getComponentRoot(o){if(o)return Neo.getComponent(o);const e=Object.values(Neo.apps||{});return e.length>0?e[0].mainView:null}serializeComponent({component:o,currentDepth:e=1,lean:t=!0,maxDepth:n=-1}){if(!o)return null;let r;if(r=t?{className:o.className,id:o.id}:o.toJSON(),-1===n||e<n){const m=Neo.manager.Component.getChildComponents(o);m&&m.length>0&&(r.items=m.map(o=>this.serializeComponent({component:o,currentDepth:e+1,lean:t,maxDepth:n})))}return r}});