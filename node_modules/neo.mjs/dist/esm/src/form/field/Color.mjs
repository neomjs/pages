import e from"../../list/Color.mjs";import o from"./ComboBox.mjs";import t from"../../util/VDom.mjs";export default Neo.setupClass(class extends o{static config={className:"Neo.form.field.Color",ntype:"colorfield",baseCls:["neo-colorfield","neo-combobox","neo-pickerfield","neo-textfield"],colorField:"name",colorFormatter:(e,o)=>o[e.colorField],listConfig:{module:e,colorField:"@config:colorField",colorFormatter:"@config:colorFormatter",silentSelectUpdate:!0}};construct(e){super.construct(e);let o=this;t.find(o.vdom,o.getInputWrapperId()).vdom.cn.unshift({cls:"neo-color",id:o.getColorIndicatorId(),style:{backgroundColor:o.getColor()}}),o.update()}afterSetValue(e,o,r=!1){let l=this,s=t.find(l.vdom,l.getColorIndicatorId())?.vdom,{list:c,record:i}=l,n=l.list?.selectionModel;s&&(s.style.backgroundColor=l.getColor()),i?n?.select(c.getItemId(i[l.store.keyProperty])):n?.deselectAll(!0),super.afterSetValue(e,o,r)}getColor(){let e=this,{inputValue:o,value:t}=e;return t?e.colorFormatter(e,t):e.forceSelection?null:o}getColorIndicatorId(){return`${this.id}__color-indicator`}onSelectPostLastItem(){let{list:e}=this,o=e.store.getCount()-1;e.vdom.cn[o]=e.createItem(e.store.getAt(o),o),super.onSelectPostLastItem()}onSelectPreFirstItem(){let{list:e}=this;e.vdom.cn[0]=e.createItem(e.store.getAt(0),0),super.onSelectPreFirstItem()}});