import e from"../coronaGallery/ViewportController.mjs";export default Neo.setupClass(class extends e{static config={className:"Neo.examples.component.multiWindowCoronaGallery.ViewportController"};connectedApps=[];async createPopupWindow(){let e=this,{windowId:o}=e,{config:n,windowConfigs:t}=Neo,{environment:i}=n,a=Object.keys(t)[0],{basePath:p}=t[a],c=e.getReference("controls-panel"),l=await Neo.Main.getWindowData({windowId:o}),r=await e.component.getDomRect(c.id),{height:s,left:d,top:w,width:m}=r;"development"!==i&&(p=`${p+i}/`),s+=1,d+=m+l.screenLeft,w+=l.outerHeight-l.innerHeight+l.screenTop-63,e.component.up("live-preview")&&(s-=63,w+=63),await Neo.Main.windowOpen({url:p+"examples/component/multiWindowCoronaGallery/childapp/",windowFeatures:`height=${s},left=${d},top=${w},width=${m}`,windowId:a,windowName:"GalleryControls"})}async onAppConnect(e){let o=this,{appName:n}=e;if("GalleryControls"===n){let{mainView:t}=Neo.apps[e.windowId];o.connectedApps.push(n),this.getReference("header-toolbar").hidden=!0,t.add(o.getReference("controls-panel"))}}async onAppDisconnect(e){let o=this,{appName:n,windowId:t}=e;"GalleryControls"===n?(o.getReference("header-toolbar").hidden=!1,o.component.add(o.getReference("controls-panel"))):"Neo.examples.component.multiWindowCoronaGallery"===n&&Neo.Main.windowClose({names:o.connectedApps,windowId:t})}onConstructed(){super.onConstructed();let e=this;Neo.currentWorker.on({connect:e.onAppConnect,disconnect:e.onAppDisconnect,scope:e})}async onMaximiseButtonClick(e){await this.createPopupWindow()}});