import e from"../helix/ViewportController.mjs";export default Neo.setupClass(class extends e{static config={className:"Neo.examples.component.multiWindowHelix.ViewportController"};connectedApps=[];async createPopupWindow(){let e=this,{windowId:n}=e,{config:o,windowConfigs:t}=Neo,{environment:i}=o,p=Object.keys(t)[0],{basePath:c}=t[p],a=e.getReference("controls-panel"),s=await Neo.Main.getWindowData({windowId:n}),d=await e.component.getDomRect(a.id),{height:l,left:r,top:w,width:m}=d;"development"!==i&&(c=`${c+i}/`),l+=1,r+=m+s.screenLeft,w+=s.outerHeight-s.innerHeight+s.screenTop-63,e.component.up("live-preview")&&(l-=63,w+=63),await Neo.Main.windowOpen({url:c+"examples/component/multiWindowHelix/childapp/",windowFeatures:`height=${l},left=${r},top=${w},width=${m}`,windowId:p,windowName:"HelixControls"})}async onAppConnect(e){let n=this,{appName:o}=e;if("HelixControls"===o){let t=n.getReference("controls-panel"),{mainView:i}=Neo.apps[e.windowId];n.connectedApps.push(o),this.getReference("header-toolbar").hidden=!0,i.add(t)}}async onAppDisconnect(e){let n=this,{appName:o,windowId:t}=e;"HelixControls"===o?(n.getReference("header-toolbar").hidden=!1,n.component.add(n.getReference("controls-panel"))):"Neo.examples.component.multiWindowHelix"===o&&Neo.Main.windowClose({names:n.connectedApps,windowId:t})}onConstructed(){super.onConstructed();let e=this;Neo.currentWorker.on({connect:e.onAppConnect,disconnect:e.onAppDisconnect,scope:e})}async onMaximiseButtonClick(e){await this.createPopupWindow()}});