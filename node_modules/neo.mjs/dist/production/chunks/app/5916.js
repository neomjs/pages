"use strict";(self.webpackChunkneo_mjs=self.webpackChunkneo_mjs||[]).push([[5916],{2930:(e,t,o)=>{o.d(t,{A:()=>r});var s=o(3079);class i extends s.A{static config={className:"Neo.container.Viewport",ntype:"viewport",applyBodyCls:!0,autoMount:!0,baseCls:["neo-viewport"],monitorSize_:!1};afterSetMounted(e,t){super.afterSetMounted(e,t);let o=this;e&&o.monitorSize&&o.addDomListeners([{resize:o.onDomResize,scope:o}])}onConstructed(){super.onConstructed();let{appName:e,windowId:t}=this;this.applyBodyCls&&Neo.main.DomAccess.applyBodyCls({appName:e,cls:["neo-body-viewport"],windowId:t})}onDomResize(e){this.fire("resize",e)}}const r=Neo.setupClass(i)},2393:(e,t,o)=>{o.d(t,{A:()=>f});var s=o(3079),i=o(2778),r=o(1315),l=o(3303),n=o(5608),d=o(825);class c extends n.A{static config={className:"Neo.grid.View",ntype:"grid-view",baseCls:["neo-grid-view"]};construct(e){super.construct(e);let t=this;t.addDomListeners([{click:t.onCellClick,dblclick:t.onCellDoubleClick,delegate:".neo-grid-cell",scope:t},{click:t.onRowClick,dblclick:t.onRowDoubleClick,delegate:".neo-grid-row",scope:t}])}createViewData(e){let t,o,s,i,r,l,n,d,c,a,h,u,g,p,m=this,w=e.length,C=m.parent,f=C.items[0].items,v=f.length,S=[],y=0,{vdom:A}=m;for(m.recordVnodeMap={},"selection-grid-rowmodel"===C.selectionModel?.ntype&&(g=C.selectionModel.items||[]);y<w;y++){for(h=e[y],n=m.getRowId(h,y),m.recordVnodeMap[n]=y,p=m.getTrClass(h,y),g?.includes(n)&&(p.push("neo-selected"),Neo.getComponent(m.containerId).fire("select",{record:h})),S.push({id:n,cls:p,cn:[],tabIndex:"-1"}),r=0,l=0,c=0;c<v;c++)i=f[c],u=Neo.ns(i.field,!1,h),null==u&&(u=""),a=i.renderer.call(i.rendererScope||C,{column:i,field:i.field,index:y,record:h,value:u}),t=a?.cls||["neo-grid-cell"],"left"!==i.align&&t.push("neo-"+i.align),Neo.isObject(a)||(a={cls:t,html:a?.toString()}),o=a.style||{},i.width&&(o.minWidth=`${i.width}px`),s={id:m.getCellId(h,i.field),cls:t,innerHTML:a.html||"",style:o,tabIndex:"-1"},i.dock&&(s.cls=["neo-locked",...s.cls||[]],"left"===i.dock&&(s.style.left=r+"px",r+=i.width)),i.flex&&(s.style.width="100%"),S[y].cn.push(s);for(c=0;c<v;c++)d=v-c-1,i=f[d],"right"===i.dock&&(S[y].cn[d].style.right=l+"px",l+=i.width+1)}A.cn=S,C.dockLeftMargin=r,C.dockRightMargin=l,m.promiseUpdate().then((()=>{g?.length>0&&Neo.main.DomAccess.scrollToTableRow({appName:m.appName,id:g[0]})}))}destroy(e,t){this.store=null,super.destroy(e,t)}fireCellEvent(e,t){let o=this,{id:s}=e.target,i=o.getCellDataField(s),r=o.getRecord(s);o.parent.fire(t,{id:o,data:e,dataField:i,record:r})}fireRowEvent(e,t){let o=this,{id:s}=e.target,i=o.getRecord(s);o.parent.fire(t,{id:o,data:e,record:i})}getCellDataField(e){return e.split("__")[2]}getCellId(e,t){return this.id+"__"+e[this.store.keyProperty]+"__"+t}getRecord(e){let t,o,s=this,i=s.getRecordByRowId(e);if(i)return i;for(t of(o=d.A.getParentNodes(s.vdom,e),o))if(i=s.getRecordByRowId(t.id),i)return i;return null}getRecordByRowId(e){return this.store.getAt(this.recordVnodeMap[e])}getRowId(e,t){return`${this.id}__tr__${e[this.store.keyProperty]}`}getTrClass(e,t){return["neo-grid-row"]}onCellClick(e){this.fireCellEvent(e,"cellClick")}onCellDoubleClick(e){this.fireCellEvent(e,"cellDoubleClick")}onRowClick(e){this.fireRowEvent(e,"rowClick")}onRowDoubleClick(e){this.fireRowEvent(e,"rowDoubleClick")}onStoreRecordChange(e){let t,o,s=this,i=[];e.fields.forEach((r=>{t=s.getCellId(e.record,r.name),o=s.getVdomChild(t),o.innerHTML=r.value,i.push({id:t,innerHTML:r.value})})),i.length>0&&Neo.applyDeltas(s.appName,i)}}const a=Neo.setupClass(c);var h=o(4912),u=o(6270);class g extends h.A{static cellAlignValues=["left","center","right"];static config={className:"Neo.grid.header.Button",ntype:"grid-header-button",baseCls:["neo-grid-header-button"],cellAlign_:"left",iconCls:"fa fa-arrow-circle-up",iconPosition:"right",isSorted_:null};defaultSortDirection="ASC";field=null;construct(e){super.construct(e);let t=this;t.addDomListeners({click:t.onButtonClick,scope:t})}afterSetIsSorted(e,t){let o=this,{cls:s}=o;switch(e){case null:u.A.add(s,"neo-sort-hidden");break;case"ASC":u.A.remove(s,"neo-sort-desc"),u.A.remove(s,"neo-sort-hidden"),u.A.add(s,"neo-sort-asc");break;case"DESC":u.A.remove(s,"neo-sort-asc"),u.A.remove(s,"neo-sort-hidden"),u.A.add(s,"neo-sort-desc")}o.cls=s,o.mounted&&o.fire("sort",{direction:e,property:o.field})}beforeSetCellAlign(e,t){return this.beforeSetEnumValue(e,t,"cellAlign","cellAlignValues")}onButtonClick(){let e,t=this;e="DESC"===t.defaultSortDirection?{ASC:null,DESC:"ASC",null:"DESC"}:{ASC:"DESC",DESC:null,null:"ASC"},t.isSorted=e[t.isSorted+""]}removeSortingCss(){let e=this,{cls:t}=e;u.A.add(t,"neo-sort-hidden"),e.cls=t,e._isSorted=null}renderer(e){return e.value}}Neo.setupClass(g);var p=o(3627);class m extends p.A{static config={className:"Neo.grid.header.Toolbar",ntype:"grid-header-toolbar",baseCls:["neo-grid-header-toolbar","neo-toolbar"],itemDefaults:{ntype:"grid-header-button"}};createItems(){let e=this;e.itemDefaults.showHeaderFilter=e.showHeaderFilters,super.createItems();let t,o=0,s=0,i=e.items,r=i.length;i.forEach(((e,l)=>{t=e.wrapperStyle,e.maxWidth&&(t.maxWidth=e.maxWidth+"px"),e.minWidth&&(t.minWidth=e.minWidth+"px"),e.width&&(t.width=e.width+"px"),e.dock&&(e.vdom.cls.push("neo-locked"),"left"===e.dock&&(t.left=o+"px"),o+=e.width+1),e.wrapperStyle=t,"right"===(e=i[r-l-1]).dock&&(t=e.wrapperStyle,t.right=s+"px",e.wrapperStyle=t,s+=e.width+1)})),e.update()}}const w=Neo.setupClass(m);class C extends s.A{static config={className:"Neo.grid.Container",ntype:"grid-container",baseCls:["neo-grid-container"],columns_:[],keys:{},layout:"base",selectionModel_:null,store_:null,_vdom:{cls:["neo-grid-wrapper"],cn:[{cn:[]}]}};headerToolbarConfig=null;headerToolbarId=null;viewConfig=null;viewId=null;construct(e){super.construct(e);let t=this;t.headerToolbarId=Neo.getId("grid-header-toolbar"),t.viewId=Neo.getId("grid-view"),t.items=[{module:w,id:t.headerToolbarId,showHeaderFilters:t.showHeaderFilters,...t.headerToolbarConfig},{module:a,containerId:t.id,id:t.viewId,store:t.store,...t.viewConfig}],t.vdom.id=t.id+"wrapper",t.createColumns(t.columns)}afterSetSelectionModel(e,t){this.rendered&&e.register(this)}beforeSetColumns(e,t){return this.configsApplied?this.createColumns(e):e}beforeSetSelectionModel(e,t){return t?.destroy(),i.A.beforeSetInstance(e,r.A)}beforeSetStore(e,t){if(t?.destroy(),e){let t=this,o={filter:t.onStoreFilter,load:t.onStoreLoad,recordChange:t.onStoreRecordChange,scope:t};e instanceof l.A?(e.on(o),e.getCount()>0&&t.onStoreLoad(e.items)):e=i.A.beforeSetInstance(e,l.A,{listeners:o}),t.view&&(t.view.store=e)}return e}createColumns(e){let t,o=this,{columnDefaults:s}=o,i=o.store?.sorters;return e&&e.length||Neo.logError("Attempting to create a grid.Container without defined columns",o.id),e.forEach((e=>{t=e.renderer,s&&Neo.assignDefaults(e,s),e.dock&&!e.width&&Neo.logError("Attempting to create a docked column without a defined width",e,o.id),t&&Neo.isString(t)&&o[t]&&(e.renderer=o[t]),i?.[0]&&e.field===i[0].property&&(e.isSorted=i[0].direction),e.listeners={sort:o.onSortColumn,scope:o}})),o.items[0].items=e,e}createViewData(e){this.getView().createViewData(e)}getVdomRoot(){return this.vdom.cn[0]}getVdomItemsRoot(){return this.vdom.cn[0]}getView(){return Neo.getComponent(this.viewId)||Neo.get(this.viewId)}getVnodeRoot(){return this.vnode.childNodes[0]}onConstructed(){super.onConstructed(),this.selectionModel?.register(this)}onSortColumn(e){let t=this;t.store.sort(e),t.removeSortingCss(e.property),t.onStoreLoad(t.store.items)}onStoreFilter(){this.onStoreLoad(this.store.items)}onStoreLoad(e){let t,o=this;o.rendered?(o.createViewData(e),o.store.sorters.length<1&&o.removeSortingCss()):t=o.on("rendered",(()=>{o.un("rendered",t),o.timeout(50).then((()=>{o.createViewData(e)}))}))}onStoreRecordChange(e){this.getView().onStoreRecordChange(e)}removeSortingCss(e){this.items[0].items.forEach((t=>{t.field!==e&&t.removeSortingCss()}))}}const f=Neo.setupClass(C)},6556:(e,t,o)=>{o.d(t,{A:()=>l});var s=o(2583),i=o(6270);o(5691);class r extends s.A{static observable=!0;static config={className:"Neo.selection.Model",ntype:"selection-model",cls:null,items_:null,selectedCls:"neo-selected",singleSelect:!0,view_:null};beforeGetItems(e){return e||(this._items=e=[]),e}beforeGetView(e){return Neo.getComponent(this._view)}beforeSetView(e){return e&&e.id}addDomListener(){}deselect(e,t,o=this.items,s){if(e=e.isRecord?view.getItemId(e):Neo.isObject(e)?e.id:e,o.includes(e)){let r=this,{view:l}=r,n=l.getVdomChild(e);n&&(n.cls=i.A.remove(n.cls||[],s||r.selectedCls),n["aria-selected"]=!1),i.A.remove(o,e),t||(l.update(),r.fire("selectionChange",{selection:o}))}else t||this.fire("noChange")}deselectAll(e){let t=this,o=[...t.items],{view:s}=t;o.length?(o.forEach((e=>{t.deselect(e,!0)})),!e&&o.length>0&&s.update(),t.fire("selectionChange",{selection:this.items})):e||t.fire("noChange")}destroy(...e){this.unregister(),super.destroy(...e)}getSelection(){return this.items}hasSelection(){return this.items.length>0}isSelected(e){return this.items.includes(e)}register(e){let t=this,o=e.cls||[];t.cls&&!o.includes(t.cls)&&(o.push(t.cls),e.cls=o),t.view=e,t.addDomListener()}removeDomListeners(){let e=this,t=e.view,o=[...t.domListeners];t.domListeners.forEach((t=>{t.scope===e&&i.A.remove(o,t)})),t.domListeners=o}select(e,t=this.items,o){let s=this,{view:r}=s;e=(e=Array.isArray(e)?e:[e]).map((e=>e.isRecord?r.getItemId(e):Neo.isObject(e)?e.id:e)),Neo.isEqual(t,e)?s.fire("noChange"):(s.singleSelect&&s.deselectAll(!0),e.forEach((e=>{(e=r.getVdomChild(e))&&(e.cls=i.A.add(e.cls||[],o||s.selectedCls),e["aria-selected"]=!0)})),i.A.add(t,e),!r.silentSelect&&r.update(),r.onSelect?.(e),s.fire("selectionChange",{selection:t}))}toggleSelection(e){let t=this;t.isSelected(e)?t.deselect(e):t.select(e)}unregister(){let e=this,t=e.view.cls||[];e.cls&&t.includes(e.cls)&&(i.A.remove(t,e.cls),e.view.cls=t),e.deselectAll(),e.removeDomListeners()}}const l=Neo.setupClass(r)},950:(e,t,o)=>{o.d(t,{A:()=>r});var s=o(6556);class i extends s.A{static config={className:"Neo.selection.grid.BaseModel"};deselect(e,t,o=this.items,s){let{view:i}=this;t||(i.updateDepth=2),super.deselect(e,t,o,s)}deselectAll(e){let{view:t}=this;e||(t.updateDepth=2),super.deselectAll(e)}select(...e){let{view:t}=this;t.silentSelect||(t.updateDepth=2),super.select(...e)}}const r=Neo.setupClass(i)},1315:(e,t,o)=>{o.d(t,{A:()=>l});var s=o(950),i=o(825);class r extends s.A{static config={className:"Neo.selection.grid.RowModel",ntype:"selection-grid-rowmodel",cls:"neo-selection-rowmodel"};addDomListener(){let e=this;e.view.on("rowClick",e.onRowClick,e)}destroy(...e){let t=this;t.view.un("rowClick",t.onRowClick,t),super.destroy(...e)}getRowId(e){return e<0||this.view.store.getCount()<e?null:this.view.vdom.cn[0].cn[1].cn[e].id}static getRowNode(e){let t=0,o=e.length,s=null;for(;t<o;t++)e[t].cls.includes("neo-grid-row")&&(s=e[t]);return s}onKeyDownDown(e){this.onNavKeyRow(e,1)}onKeyDownUp(e){this.onNavKeyRow(e,-1)}onNavKeyRow(e,t){let o,s=r.getRowNode(e.path),{view:l}=this,{store:n}=l,d=i.A.find(l.vdom,s.id),c=(d.index+t)%n.getCount(),{parentNode:a}=d;for(;c<0;)c+=n.getCount();o=a.cn[c].id,o&&(this.select(o),l.focus(o),l.fire("select",{record:n.getAt(c)}))}onRowClick(e){let t,o,s=this,r=e.data.currentTarget,{view:l}=s;r&&(s.toggleSelection(r),t=s.isSelected(r),o=l.store.getAt(i.A.find(l.vdom,r).index),!t&&l.onDeselect?.(o),l.fire(t?"select":"deselect",{record:o}))}register(e){super.register(e);let{id:t,view:o}=this;o.keys?._keys.push({fn:"onKeyDownDown",key:"Down",scope:t},{fn:"onKeyDownUp",key:"Up",scope:t})}unregister(){let{id:e,view:t}=this;t.keys?.removeKeys([{fn:"onKeyDownDown",key:"Down",scope:e},{fn:"onKeyDownUp",key:"Up",scope:e}]),super.unregister()}}const l=Neo.setupClass(r)}}]);