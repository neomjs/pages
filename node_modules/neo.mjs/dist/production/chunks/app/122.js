export const __webpack_esm_id__=122;export const __webpack_esm_ids__=[122];export const __webpack_esm_modules__={122(e,t,n){n.r(t),n.d(t,{default:()=>s});var o=n(1741),a=n(1692),r=n(1031),l=n(950);const d=new Date;d.getDate(),d.getMonth(),d.getFullYear();class c extends o.A{static config={className:"Neo.calendar.view.month.Component",baseCls:["neo-calendar-monthcomponent"],bind:{calendarStore:"stores.calendars",currentDate:e=>e.currentDate,eventBorder:e=>e.events.border,eventStore:"stores.events",locale:e=>e.locale,showWeekends:e=>e.showWeekends,weekStartDay:e=>e.weekStartDay},calendarStore_:null,currentDate_:null,dayNameFormat_:"short",eventBorder_:null,eventStore_:null,headerHeight:null,intlFormat_day:null,intlFormat_month:null,intlFormat_time:null,isScrolling:!1,locale_:Neo.config.locale,monthNameFormat_:"short",needsEventUpdate:!1,owner:null,scrollTaskId:null,showWeekends_:!0,timeFormat_:{hour:"2-digit",minute:"2-digit"},useScrollBoxShadows_:!0,vdom:{cn:[{cls:["neo-days-header"],cn:[{cls:["neo-static-header"],style:{},cn:[{tag:"span",cls:["neo-month-name"],flag:"month-name"},{vtype:"text"}]}]},{cls:["neo-c-m-scrollcontainer"]}]},weekStartDay_:0};construct(e){super.construct(e);let t=this;t.addDomListeners([{dblclick:t.onEventDoubleClick,delegate:"neo-event",scope:t},{wheel:t.onWheel,scope:t}]),t.calendarStore.getCount()>0&&t.eventStore.getCount()>0&&(t.needsEventUpdate=!0),t.needsEventUpdate&&t.createContent(!0),t.updateHeader(!0)}afterSetCalendarStore(e,t){let n=this,o={load:n.onCalendarStoreLoad,recordChange:n.onCalendarStoreRecordChange,scope:n};t?.un(o),e?.on(o)}afterSetCurrentDate(e,t){let n=this;n.isConstructed&&(n.createContent(!0),n.updateHeader(),n.afterSetMounted(!0,!1))}afterSetDayNameFormat(e,t){let n=this;n.intlFormat_day=new Intl.DateTimeFormat(n.locale,{weekday:e}),void 0!==t&&n.updateHeader()}afterSetEventBorder(e,t){let n=this.cls;t&&r.A.remove(n,`neo-event-border-${t}`),e&&r.A.add(n,`neo-event-border-${e}`),this.cls=n}afterSetEventStore(e,t){let n=this,o={load:n.onEventStoreLoad,recordChange:n.onEventStoreRecordChange,scope:n};t?.un(o),e?.on(o)}afterSetLocale(e,t){if(t){let t=this;t.intlFormat_day=new Intl.DateTimeFormat(e,{weekday:t.dayNameFormat}),t.intlFormat_month=new Intl.DateTimeFormat(e,{month:t.monthNameFormat}),t.intlFormat_time=new Intl.DateTimeFormat(e,t.timeFormat),t.updateMonthNames(!0),t.updateHeader()}}afterSetMonthNameFormat(e,t){let n=this;n.intlFormat_month=new Intl.DateTimeFormat(n.locale,{month:e}),void 0!==t&&n.updateMonthNames()}afterSetMounted(e,t){let n=this;e&&(n.needsEventUpdate&&(n.createContent(),n.needsEventUpdate=!1),n.timeout(100).then(()=>{n.getDomRect([n.vdom.cn[1].id,n.vdom.cn[0].id]).then(e=>{n.headerHeight=e[1].height,Neo.main.DomAccess.scrollTo({direction:"top",id:n.vdom.cn[1].id,value:e[0].height-e[1].height,windowId:n.windowId})})}))}afterSetShowWeekends(e,t){if(void 0!==t){let t,n,o=this,{vdom:a}=o;a.cn[1].cn.forEach(o=>{if(o.flag)for(t=0;t<7;t++)n=o.cn[t],n.cls.includes("neo-weekend")&&(e?delete n.removeDom:n.removeDom=!0)}),o.updateHeader()}}afterSetTimeFormat(e,t){this.intlFormat_time=new Intl.DateTimeFormat(this.locale,e)}afterSetUseScrollBoxShadows(e,t){r.A[e?"add":"remove"](this.vdom.cn[1].cls,"neo-scroll-shadows"),this.update()}afterSetWeekStartDay(e,t){void 0!==t&&(this.createContent(!0),this.updateHeader())}beforeSetDayNameFormat(e,t){return this.beforeSetEnumValue(e,t,"dayNameFormat",a.A.prototype.dayNameFormats)}beforeSetMonthNameFormat(e,t){return this.beforeSetEnumValue(e,t,"monthNameFormat",a.A.prototype.monthNameFormats)}createContent(e=!1){let t=this;if(t.mounted){let e,n,o=t.currentDate,{vdom:r}=t,l=0;for(r.cn[1].cn=[],e=a.A.getFirstDayOffset(o,t.weekStartDay),o.setDate(1-e),o.setDate(o.getDate()-42);l<18;l++)n=t.createWeek(a.A.clone(o)),n.header&&r.cn[1].cn.push(n.header),r.cn[1].cn.push(n.row),o.setDate(o.getDate()+7);t.update()}else t.needsEventUpdate=!0}createWeek(e){let t,n,o,r,l,d,c,s=this,i=0,{calendarStore:m,eventStore:h}=s,u=null,g=a.A.convertToyyyymmdd(e);for(d={flag:g,cls:["neo-week"],cn:[],id:`${s.id}__week__${g}`};i<7;i++)n=e.getDate(),g=a.A.convertToyyyymmdd(e),1===n&&(d.flag=g,u={cls:["neo-month-header"],cn:[{cls:["neo-month-header-content"],cn:[{tag:"span",cls:["neo-month-name"],flag:"month-name",text:s.intlFormat_month.format(e)},{vtype:"text",text:` ${e.getFullYear()}`}]}]}),o={cls:["neo-day"],id:`${s.id}__day__${g}`,cn:[{cls:["neo-day-number"],id:`${s.id}__day_number__${g}`,text:n}]},c=e.getDay(),0!==c&&6!==c||(o.cls.push("neo-weekend"),s.showWeekends||(o.removeDom=!0)),o.removeDom||(r=h.getDayRecords(e),r.forEach(e=>{l=e[h.keyProperty],t=m.get(e.calendarId),t.active&&o.cn.push({cls:["neo-event",`neo-${t.color}`],flag:l,id:s.id+"__"+l,tabIndex:-1,cn:[{cls:["neo-event-title"],id:s.id+"__title__"+l,text:e.title},{cls:["neo-event-time"],id:s.id+"__time__"+l,text:s.intlFormat_time.format(e.startDate)}]})})),d.cn.push(o),e.setDate(e.getDate()+1);return{header:u,row:d}}onCalendarStoreLoad(e){this.eventStore.getCount()>0&&this.createContent()}onCalendarStoreRecordChange(e){this.createContent()}onEventDoubleClick(e){if(this.data.events.enableEdit){let t=this,{editEventContainer:n}=t.owner,{path:o}=e,a=o[0],r=o[2],d=o[3],c=l.A.find(t.vdom,a.id).vdom,s=t.eventStore.get(c.flag),i=n.style;Object.assign(i,{left:a.rect.right-r.rect.left+15+"px",top:a.rect.top-d.rect.top+d.scrollTop-12+"px"}),n.setSilent({parentId:o[1].id,record:s,style:i}),n.initVnode(!0)}}onEventStoreLoad(e){this.calendarStore.getCount()>0&&this.createContent()}onEventStoreRecordChange(e){this.createContent()}onFocusChange(e){let{windowId:t}=this,{oldPath:n,path:o}=e;n?.[0]?.cls.includes("neo-event")&&Neo.applyDeltas(t,{id:n[0].id,cls:{remove:["neo-focus"]}}),o?.[0]?.cls.includes("neo-event")&&Neo.applyDeltas(t,{id:o[0].id,cls:{add:["neo-focus"]}})}onWheel(e){if(Math.abs(e.deltaY)>Math.abs(e.deltaX)){let t,n,o,l=this,d=l.vdom.cn[1],c=0;if(e.deltaY>0&&Math.round(e.scrollTop/(e.clientHeight-l.headerHeight)*6)>11){for(t=new Date(d.cn[d.cn.length-1].flag),t.setDate(t.getDate()-(t.getDay()-l.weekStartDay));c<6;c++)d.cn[1].cls.includes("neo-month-header")&&d.cn.splice(1,1),d.cn.shift(),t.setDate(t.getDate()+7),o=l.createWeek(a.A.clone(t)),o.header&&d.cn.push(o.header),d.cn.push(o.row);l.update()}else if(e.deltaY<0&&Math.round(e.scrollTop/(e.clientHeight-l.headerHeight)*6)<1){for(t=d.cn[0].flag?new Date(d.cn[0].flag):new Date(d.cn[1].flag),t.setDate(t.getDate()-(t.getDay()-l.weekStartDay));c<6;c++)n=d.cn.length,d.cn[n-2].cls.includes("neo-month-header")&&d.cn.splice(n-2,1),d.cn.pop(),t.setDate(t.getDate()-7),o=l.createWeek(a.A.clone(t)),d.cn.unshift(o.row),o.header&&d.cn.unshift(o.header);l.promiseUpdate().then(()=>{Neo.main.DomAccess.scrollTo({direction:"top",id:l.vdom.cn[1].id,value:e.clientHeight-l.headerHeight,windowId:l.windowId})})}l.isScrolling||(l.isScrolling=!0,r.A.add(l.vdom.cn[1].cls,"neo-is-scrolling"),l.vdom.cn[0].cn[0].style.opacity=0,l.update()),l.scrollTaskId&&clearTimeout(l.scrollTaskId),l.scrollTaskId=setTimeout(l.onWheelEnd.bind(l),300)}}onWheelEnd(){let e,t,n=this,{vdom:o}=n,a=o.cn[0].cn[0],l=6;for(n.isScrolling=!1;l<12;l++)if(t=o.cn[1].cn[l].flag,t){e=new Date(t),e.setMonth(e.getMonth()+1),a.cn[0].text=n.intlFormat_month.format(e),a.cn[1].text=` ${e.getFullYear()}`;break}r.A.remove(o.cn[1].cls,"neo-is-scrolling"),a.style.opacity=1,n.update()}updateHeader(e=!1){let t,n,o=this,a=o.currentDate,{vdom:r}=o,l=r.cn[0].cn[0],d=1;for(l.cn[0].text=o.intlFormat_month.format(a),l.cn[1].text=` ${a.getFullYear()}`,a.setDate(o.currentDate.getDate()-o.currentDate.getDay()+o.weekStartDay);d<8;d++)t=a.getDay(),e?(n={cls:["neo-day-name"],text:o.intlFormat_day.format(a)},o.showWeekends||0!==t&&6!==t||(n.removeDom=!0),r.cn[0].cn.push(n)):(n=r.cn[0].cn[d],n&&(n.text=o.intlFormat_day.format(a),o.showWeekends||0!==t&&6!==t?delete n.removeDom:n.removeDom=!0)),a.setDate(a.getDate()+1);o.update()}updateMonthNames(e=!1){let t=this,n=t.currentDate;l.A.getFlags(t.vdom,"month-name").forEach(e=>{e.text=t.intlFormat_month.format(n),n.setMonth(n.getMonth()+1)}),t.update()}}const s=Neo.setupClass(c)}};