"use strict";(self.webpackChunkneo_mjs=self.webpackChunkneo_mjs||[]).push([[47966],{47966:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});var i=n(94367),s=n(61564);class o extends i.A{static transitionEasings=["ease","ease-in","ease-out","ease-in-out","linear"];static config={className:"Neo.list.plugin.Animate",ntype:"plugin-list-animate",columns:null,itemMargin:10,ownerRect:null,rows:null,transitionDuration_:500,transitionEasing_:"ease-in-out",transitionTimeoutId:null};construct(e){super.construct(e);let t=this,{owner:n}=t;n.itemHeight&&n.itemWidth||console.error("list.plugin.Animate requires fixed itemHeight and itemWidth values",n),t.adjustCreateItem(),n.onStoreFilter=t.onStoreFilter.bind(t),n.onStoreSort=t.onStoreSort.bind(t),this.updateTransitionDetails()}adjustCreateItem(){let e=this,{owner:t}=e;e.ownerCreateItem=t.createItem.bind(t),t.createItem=e.createItem.bind(t,e)}afterSetTransitionDuration(e,t){this.isConstructed&&this.updateTransitionDetails(Neo.isNumber(t))}afterSetTransitionEasing(e,t){this.isConstructed&&this.updateTransitionDetails(!!t)}beforeSetTransitionEasing(e,t){return this.beforeSetEnumValue(e,t,"transitionEasing")}createItem(e,t,n){let i=e.ownerCreateItem(t,n),{owner:s}=e,o=e.getItemPosition(t,n),r=i.style||{};return e.ownerRect?(Object.assign(r,{height:`${s.itemHeight}px`,position:"absolute",transform:`translate(${o.x}px, ${o.y}px)`,width:`${s.itemWidth}px`}),i.style=r,i):null}destroy(...e){s.A.deleteRules(this.windowId,`#${this.owner.id} .neo-list-item`),super.destroy(...e)}getItemPosition(e,t){let n=this,i=t%n.columns,s=n.itemMargin,o=n.owner,r=Math.floor(t/n.columns);return{x:i*(s+o.itemWidth)+s,y:r*(s+o.itemHeight)+s}}getItemIndex(e,t,n){if(!n)return e.index;let i=this.owner,s=i.getKeyProperty();return t.indexOf(i.getItemId(e.record[s]))}onOwnerMounted(){let e=this,t=e.owner;t.getDomRect().then(n=>{Object.assign(e,{columns:Math.floor(n.width/t.itemWidth),ownerRect:n,rows:Math.floor(n.height/t.itemHeight)}),t.store.getCount()>0&&t.createItems()})}onStoreFilter(e){let t,n,i,s,o=this,r=o.owner,a=r.getKeyProperty(),d=!1,l=[],u=[],m=[],c=o.transitionTimeoutId,h=!!c,p=r.vdom;c&&(clearTimeout(c),o.transitionTimeoutId=null),i=h?p.cn.map(e=>e.id):[],e.items.forEach((t,s)=>{n={index:s,record:t},e.oldItems.includes(t)?u.push(n):(h&&i.includes(r.getItemId(t[a]))&&(n.reAdded=!0),l.push(n))}),e.oldItems.forEach((t,n)=>{e.items.includes(t)||m.push({index:n,record:t})}),l.forEach(e=>{e.reAdded||(t=o.getItemIndex(e,i,h),t>-1&&(d=!0,p.cn.splice(t,0,o.createItem(o,e.record,e.index)),e.item=p.cn[t],e.item.style.opacity=0))}),d&&r.update(),o.timeout(50).then(()=>{i=p.cn.map(e=>e.id),l.forEach(e=>{t=o.getItemIndex(e,i,h),t>-1&&(p.cn[t].style.opacity=1)}),u.forEach(e=>{t=o.getItemIndex(e,i,!0),t>-1&&(s=o.getItemPosition(e.record,e.index),Object.assign(p.cn[t].style,{opacity:1,transform:`translate(${s.x}px, ${s.y}px)`}))}),m.forEach(e=>{t=o.getItemIndex(e,i,h),t>-1&&(e.item=p.cn[t],e.item.style.opacity=0)}),r.update(),o.triggerTransitionCallback()})}onStoreSort(e){let t=this;Neo.list.Component&&t.owner instanceof Neo.list.Component?t.sortComponentList(e):t.sortBaseList(e)}sortBaseList(e){let t,n=!1,i=this.owner,s=i.getKeyProperty(),o=[],r=e.previousItems.map(e=>e[s]),a=i.vdom;a.cn.length>0&&(e.items.forEach((e,i)=>{t=r.indexOf(e[s]),o.push(a.cn[t]),t!==i&&(n=!0)}),n&&(a.cn=o,i.update(),this.timeout(50).then(()=>{i.createItems()})))}sortComponentList(e){let t,n,i,s=this,o=s.owner,r=o.getKeyProperty(),a=e.previousItems.map(e=>e[r]),d=o.vdom;o.sortItems(e),a=o.items.map(e=>o.getItemRecordId(e[r])),d.cn.length>0&&(e.items.forEach((e,o)=>{t=a.indexOf(e[r]),n=d.cn[t],i=s.getItemPosition(e,o),n.style.transform=`translate(${i.x}px, ${i.y}px)`}),o.update())}triggerTransitionCallback(){let e=this;e.transitionTimeoutId=setTimeout(()=>{e.transitionTimeoutId=null,e.owner.createItems()},e.transitionDuration)}async updateTransitionDetails(e=!1){let t=this,n=t.transitionDuration,i=t.transitionEasing,{id:o}=t.owner;e&&await s.A.deleteRules(t.windowId,`#${o} .neo-list-item`),s.A.insertRules(t.windowId,[`#${o} .neo-list-item {`,`transition: opacity ${n}ms ${i}, transform ${n}ms ${i}`,"}"].join(""))}}const r=Neo.setupClass(o)},61564:(e,t,n)=>{n.d(t,{A:()=>o});var i=n(82583);class s extends i.A{static config={className:"Neo.util.Css"};static deleteRules(e,t){Array.isArray(t)||(t=[t]),Neo.main.addon.Stylesheet.deleteCssRules({rules:t,windowId:e})}static insertRules(e,t){Array.isArray(t)||(t=[t]),Neo.main.addon.Stylesheet.insertCssRules({rules:t,windowId:e})}}const o=Neo.setupClass(s)},94367:(e,t,n)=>{n.d(t,{A:()=>o});var i=n(82583);class s extends i.A{static config={className:"Neo.plugin.Base",ntype:"plugin",owner:null,windowId_:null};construct(e){super.construct(e);let t=this,{owner:n}=t;n.isConstructed?t.onOwnerConstructed():n.on("constructed",()=>{t.onOwnerConstructed()},t,{once:!0}),n.mounted?t.onOwnerMounted():n.on("mounted",t.onOwnerMounted,t)}afterSetWindowId(e,t){e&&Neo.currentWorker.insertThemeFiles(e,this.__proto__)}onOwnerConstructed(){let{owner:e}=this;e.windowId&&(this.windowId=e.windowId)}onOwnerMounted(){}}const o=Neo.setupClass(s)}}]);