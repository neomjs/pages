"use strict";(self.webpackChunkneo_mjs=self.webpackChunkneo_mjs||[]).push([[8334],{8334:(e,t,a)=>{a.r(t),a.d(t,{default:()=>_});var l=a(4350),r=a(9119),i=a(7613),o=a(2281);class n extends o.Z{static config={className:"Covid.model.HistoricalData",fields:[{name:"active",type:"int"},{name:"cases",type:"int"},{name:"date",type:"string"},{name:"dailyActive",type:"int"},{name:"dailyCases",type:"int"},{name:"dailyDeaths",type:"int"},{name:"dailyRecovered",type:"int"},{name:"deaths",type:"int"},{name:"recovered",type:"int"}]}}Neo.applyClassConfig(n);const s=n;var d=a(5959);class c extends d.Z{static config={className:"Covid.store.HistoricalData",keyProperty:"date",model:s,sorters:[{property:"date",direction:"DESC"}]}}Neo.applyClassConfig(c);const h=c;var u=a(1940);class m extends i.Z{static config={className:"Covid.view.country.HistoricalDataTable",baseCls:["covid-historical-data-table","neo-table-container"],columnDefaults:{cellAlign:"right",defaultSortDirection:"DESC",renderer:u.Z.formatNumber},columns:[{cellAlign:"left",dataField:"date",dock:"left",text:"Date",width:100,renderer:function(e){return{cls:["neo-date-column","neo-table-cell"],html:new Intl.DateTimeFormat("default",{day:"numeric",month:"numeric",year:"numeric"}).format(new Date(e.value))}}},{dataField:"cases",text:"Cases",renderer:e=>u.Z.formatNumber(e)},{dataField:"active",text:"Active",renderer:e=>u.Z.formatNumber(e,"#64B5F6")},{dataField:"recovered",text:"Recovered",renderer:e=>u.Z.formatNumber(e,"#28ca68")},{dataField:"deaths",text:"Deaths",renderer:e=>u.Z.formatNumber(e,"#fb6767")},{dataField:"dailyCases",text:"Daily C",renderer:e=>u.Z.formatNumber(e)},{dataField:"dailyActive",text:"Daily A",renderer:e=>u.Z.formatNumber(e,"#64B5F6")},{dataField:"dailyRecovered",text:"Daily R",renderer:e=>u.Z.formatNumber(e,"#28ca68")},{dataField:"dailyDeaths",text:"Daily D",renderer:e=>u.Z.formatNumber(e,"#fb6767")}],store:h}}Neo.applyClassConfig(m);const f=m;var p=a(7918);class b extends p.Z{static config={className:"Covid.view.country.LineChartComponent",baseCls:["covid-line-chart"],chartConfig:{cursor:{maxTooltipDistance:-1},legend:{labels:{template:{fill:"#bbb"}}},xAxes:[{type:"DateAxis",renderer:{minGridDistance:60,labels:{template:{fill:"#bbb"}}}}],yAxes:[{type:"ValueAxis",logarithmic:!0,numberFormatter:{numberFormat:"#.0a",bigNumberPrefixes:[{number:1e3,suffix:"K"},{number:1e6,suffix:"M"},{number:1e9,suffix:"B"}]},renderer:{minGridDistance:60,labels:{template:{fill:"#bbb"}}}}],series:[{type:"LineSeries",dataFields:{dateX:"date",valueY:"active"},fill:"#64b5f6",name:"Active",stroke:"#64b5f6",strokeWidth:3,tooltip:{background:{fill:"#fff"},getFillFromObject:!1,label:{fill:"#000"}}},{type:"LineSeries",dataFields:{dateX:"date",valueY:"cases"},fill:"#bbb",name:"Cases",stroke:"#bbb",strokeWidth:3,tooltip:{background:{fill:"#fff"},getFillFromObject:!1,label:{fill:"#000"}}},{type:"LineSeries",dataFields:{dateX:"date",valueY:"deaths"},fill:"#fb6767",name:"Deaths",stroke:"#fb6767",strokeWidth:3,tooltip:{background:{fill:"#fff"},getFillFromObject:!1,label:{fill:"#000"}}},{type:"LineSeries",dataFields:{dateX:"date",valueY:"recovered"},fill:"#28ca68",name:"Recovered",stroke:"#28ca68",strokeWidth:3,tooltip:{background:{fill:"#fff"},getFillFromObject:!1,label:{fill:"#000"}}}]},combineSeriesTooltip:!0,fitParentHeight:!0}}Neo.applyClassConfig(b);const g=b;var y=a(3921),v=a(1722),C=a(5542),x=a(4041);class D extends i.Z{static config={className:"Covid.view.country.Table",baseCls:["covid-country-table","neo-table-container"],bind:{country:{twoWay:!0,value:e=>e.country}},columnDefaults:{cellAlign:"right",defaultSortDirection:"DESC",renderer:u.Z.formatNumber},columns:[{cls:["neo-index-column","neo-table-header-button"],dataField:"index",dock:"left",minWidth:40,text:"#",renderer:u.Z.indexRenderer,width:40},{cellAlign:"left",dataField:"country",defaultSortDirection:"ASC",dock:"left",text:"Country",width:200,renderer:e=>({cls:["neo-country-column","neo-table-cell"],html:['<div style="display: flex; align-items: center">','<img style="height:20px; margin-right:10px; width:20px;" src="'+u.Z.getCountryFlagUrl(e.value)+'">'+e.value,"</div>"].join("")})},{dataField:"cases",text:"Cases"},{dataField:"casesPerOneMillion",text:"Cases / 1M"},{dataField:"infected",text:"Infected",renderer:e=>u.Z.formatInfected(e)},{dataField:"active",text:"Active",renderer:e=>u.Z.formatNumber(e,"#64B5F6")},{dataField:"recovered",text:"Recovered",renderer:e=>u.Z.formatNumber(e,"#28ca68")},{dataField:"critical",text:"Critical",renderer:e=>u.Z.formatNumber(e,"orange")},{dataField:"deaths",text:"Deaths",renderer:e=>u.Z.formatNumber(e,"#fb6767")},{dataField:"todayCases",text:"Cases today"},{dataField:"todayDeaths",text:"Deaths today",renderer:e=>u.Z.formatNumber(e,"#fb6767")},{dataField:"tests",text:"Tests"},{dataField:"testsPerOneMillion",text:"Tests / 1M"}],country_:null,store:x.Z};afterSetCountry(e,t){if(void 0!==t){let t,a=this,l=a.selectionModel,r=a.view;r&&(e?(t=`${r.id}__tr__${e}`,l.isSelected(t)||(l.select(t),a.mounted&&Neo.main.DomAccess.scrollToTableRow({id:t}))):l.deselectAll())}}onDeselect(e){this.country=null}onSelect(e){let t=this,a=e[0]||null;t.store.getCount()>0&&(a&&(a=t.view.getRecordByRowId(a)?.country),a&&(t.country=a))}}Neo.applyClassConfig(D);const k=D;var N=a(3846),S=a(5328);class F extends N.Z{static config={className:"Covid.view.TableContainerController",apiBaseUrl:"https://disease.sh/",apiHistoricalDataEndpoint:"v3/covid-19/historical/",apiHistoricalDataTimeRange:"all",removeEmptyRecords:!0,selectedRecord:null,table_:null};addStoreItems(e){let t,a=this,l=[],r={},i=e?.timeline;e&&!e.timeline&&(i=e),i&&(Object.entries(i.cases||{}).forEach((([e,t])=>{"undefined"!==e&&(r[e]={date:new Date(e).toISOString(),cases:t})})),Object.entries(i.deaths||{}).forEach((([e,t])=>{"undefined"!==e&&(r.hasOwnProperty(e)?r[e].deaths=t:r[e]={date:new Date(e).toISOString(),deaths:t})})),Object.entries(i.recovered||{}).forEach((([e,t])=>{"undefined"!==e&&(r.hasOwnProperty(e)?r[e].recovered=t:r[e]={date:new Date(e).toISOString(),recovered:t})})),Object.entries(r).forEach((([e,t])=>{t.active=t.cases-t.deaths-t.recovered,l.push(t)})),a.removeEmptyRecords&&[...l].forEach((e=>{0===e.cases&&S.Z.remove(l,e)})),Object.assign(l[0],{dailyActive:l[0].active,dailyCases:l[0].cases,dailyDeaths:l[0].deaths,dailyRecovered:l[0].recovered}),l.forEach(((e,a)=>{t=l[a+1],t&&Object.assign(t,{dailyActive:t.active-e.active,dailyCases:t.cases-e.cases,dailyDeaths:t.deaths-e.deaths,dailyRecovered:t.recovered-e.recovered})})),a.getReference("historical-data-table").store.data=l,a.updateLineChart(l))}static assignFieldsOrNull(e){return{active:e.active||null,cases:e.cases||null,deaths:e.deaths||null,dailyActive:e.dailyActive||null,dailyCases:e.dailyCases||null,dailyDeaths:e.dailyDeaths||null,dailyRecovered:e.dailyRecovered||null,recovered:e.recovered>0?e.recovered:null}}beforeGetTable(e){return e||(this._table=e=this.getReference("table")),e}loadHistoricalData(e){let t=this,a=t.apiBaseUrl+t.apiHistoricalDataEndpoint+e+"?lastdays="+t.apiHistoricalDataTimeRange;fetch(a).then((e=>e.json())).catch((e=>console.log("Can’t access "+a,e))).then((e=>t.addStoreItems(e)))}on520pxButtonClick(e){this.getReference("controls-panel").width=520}on800pxButtonClick(e){this.getReference("controls-panel").width=800}onCollapseButtonClick(e){let t=this.getReference("controls-panel"),a=40===t.width;t.width=a?this.component.historyPanelWidth:40,e.component.text=a?"X":"+"}onCountryChange(e){let t=this;t.selectedRecord=e?{...e}:null,t.loadHistoricalData(e?.countryInfo?.iso2||"all"),t.getReference("historical-data-label").html="Historical Data ("+(e?.country||"World")+")"}onDailyValuesChange(e){let t=this.getReference("line-chart").id,a=this.getReference("logarithmic-scale-checkbox"),l=e.value;l?a.set({checked:!1,disabled:e.value}):a.disabled=!1,Neo.main.addon.AmCharts.setProperties({id:t,properties:{"series.values.0.dataFields.valueY":l?"dailyActive":"active","series.values.1.dataFields.valueY":l?"dailyCases":"cases","series.values.2.dataFields.valueY":l?"dailyDeaths":"deaths","series.values.3.dataFields.valueY":l?"dailyRecovered":"recovered"}}),Neo.main.addon.AmCharts.callMethod({id:t,path:"invalidateData"})}onLogarithmicScaleChange(e){Neo.main.addon.AmCharts.setProperty({id:this.getReference("line-chart").id,path:"yAxes.values.0.logarithmic",value:e.value})}updateLineChart(e){let t=this,a=t.selectedRecord,l=t.getReference("line-chart");e.forEach((e=>Object.assign(e,F.assignFieldsOrNull(e)))),a||(a=t.getParent().summaryData),a&&e.push({date:(new Date).toISOString(),...F.assignFieldsOrNull(a)}),l.chartData=e}}Neo.applyClassConfig(F);const R=F;class Z extends r.Z{static config={className:"Covid.view.TableContainer",bind:{countryRecord:e=>e.countryRecord},controller:R,countryRecord_:null,historyPanelWidth:520,table:null,tableConfig:null,layout:{ntype:"hbox",align:"stretch"},items:[{ntype:"container",flex:1,layout:"fit",items:[]},{module:v.Z},{module:y.Z,cls:["neo-configuration-panel","neo-panel","neo-container"],layout:{ntype:"vbox",align:"stretch"},reference:"controls-panel",style:{backgroundColor:"#2b2b2b"},width:"@config:historyPanelWidth",containerConfig:{flex:null,style:{overflowY:"scroll"}},headers:[{dock:"top",items:[{ntype:"button",handler:"onCollapseButtonClick",text:"X"},{ntype:"label",reference:"historical-data-label",text:"Historical Data"},"->",{ntype:"button",handler:"on520pxButtonClick",text:"520px"},{ntype:"button",handler:"on800pxButtonClick",text:"800px"}]}],items:[{module:C.Z,style:{marginTop:"10px"},items:[{ntype:"container",layout:{ntype:"vbox",align:"stretch"},items:[{ntype:"toolbar",flex:"0 1 auto",items:[{module:l.Z,checked:!0,labelText:"Logarithmic Scale",labelWidth:135,reference:"logarithmic-scale-checkbox",listeners:{change:"onLogarithmicScaleChange"}},{module:l.Z,labelText:"Daily Values",style:{marginLeft:"30px"},labelWidth:95,listeners:{change:"onDailyValuesChange"}}]},{module:g,flex:1,reference:"line-chart"}],tabButtonConfig:{iconCls:"fa fa-chart-line",text:"Chart"}}]}]}]};construct(e){super.construct(e);let t=this;t.historicalDataTable=Neo.create({module:f,appName:t.appName,parentId:t.id,reference:"historical-data-table",tabButtonConfig:{iconCls:"fa fa-table",text:"Table"},...t.historicalDataTableConfig}),t.items[2].items[0].items.push(t.historicalDataTable),t.table=Neo.create({module:k,appName:t.appName,parentId:t.id,reference:"table",...t.tableConfig}),t.items[0].items.push(t.table)}afterSetCountryRecord(e,t){setTimeout((()=>{this.controller.onCountryChange(e)}),this.isConstructed?0:50)}}Neo.applyClassConfig(Z);const _=Z},7918:(e,t,a)=>{a.d(t,{Z:()=>i});var l=a(4022);a(8041);class r extends l.Z{static config={className:"Neo.component.wrapper.AmChart",ntype:"am-chart",chartConfig_:null,chartData_:null,chartType:"XYChart",combineSeriesTooltip:!1,dataPath:"",package:"am4charts",_vdom:{style:{position:"relative",height:"100%",width:"100%"},cn:[{style:{position:"absolute",height:"100%",width:"100%"},cn:[{style:{color:"red",height:"100%"}}]}]}};afterSetChartData(e,t){let a=this;e&&Neo.main.addon.AmCharts.updateData({appName:a.appName,data:e,dataPath:a.dataPath,id:a.id})}afterSetMounted(e,t){let a=this;if(!1===e&&void 0!==t&&Neo.main.addon.AmCharts.destroy({appName:a.appName,id:a.id}),super.afterSetMounted(e,t),e){let e={appName:a.appName,combineSeriesTooltip:a.combineSeriesTooltip,config:a.chartConfig,id:a.id,package:a.package,type:a.chartType};a.chartData&&(e.data=a.chartData,e.dataPath=a.dataPath),setTimeout((()=>{Neo.main.addon.AmCharts.create(e).then(a.onChartMounted)}),50)}}beforeSetChartConfig(e,t){return e||console.error("wrapper.AmChart defined without a chartConfig",this.id),this.parseItemConfigs(e),e}getVdomRoot(){return this.vdom.cn[0].cn[0]}getVnodeRoot(){return this.vnode.childNodes[0].childNodes[0]}onChartMounted(){}}Neo.applyClassConfig(r);const i=r},3921:(e,t,a)=>{a.d(t,{Z:()=>i});var l=a(9119);a(5031);class r extends l.Z{static config={className:"Neo.container.Panel",ntype:"panel",baseCls:["neo-panel","neo-container"],containerConfig:null,headerDefaults:null,headers:null,_layout:{ntype:"vbox",align:"stretch"},verticalHeadersFirst:!1};construct(e){super.construct(e);let t=this;t.hasHeaders()&&!0===t.verticalHeadersFirst&&(t.layout={ntype:"hbox",align:"stretch"})}static createHeaderConfig(e){if("NeoInstance"===Neo.typeOf(e))return e;let t={flex:"0 1 auto"};return e.module||e.ntype||(t.cls=["neo-panel-header-toolbar","neo-toolbar"],t.ntype="toolbar"),e.text&&(t.items=[{ntype:"label",cls:["neo-panel-header-text","neo-label"],text:e.text}],delete e.text),Array.isArray(e.items)&&e.items.forEach((e=>{"label"===e.ntype&&(e.cls=["neo-panel-header-text","neo-label"])})),{...t,...e}}createItems(){let e=this,t=e.containerConfig;if(e.hasHeaders()){let a,l=!1===e.verticalHeadersFirst,i=e.headers||[],o=i.filter((e=>e.dock===(l?"bottom":"right"))),n=i.filter((e=>e.dock===(l?"left":"top"))),s=i.filter((e=>e.dock===(l?"right":"bottom"))),d=i.filter((e=>e.dock===(l?"top":"left"))),c=o.length>0||d.length>0,h=n.length>0||s.length>0,u=e.items,m=[],f=[];d.forEach((e=>{f.push(r.createHeaderConfig(e))})),h&&(l&&c||!l&&c)?(n.forEach((e=>{m.push(r.createHeaderConfig(e))})),a={ntype:"container",flex:1,items:u,itemDefaults:e.itemDefaults,...t},m.push({...e.headerDefaults,...a}),s.forEach((e=>{m.push(r.createHeaderConfig(e))})),f.push({ntype:"container",items:m,layout:{ntype:l?"hbox":"vbox",align:"stretch"}})):(a={ntype:"container",flex:1,items:u,itemDefaults:e.itemDefaults,...t},f.push({...e.headerDefaults,...a})),o.forEach((e=>{f.push(r.createHeaderConfig(e))})),e.items=f,e.itemDefaults=null,super.createItems()}else t&&e.set(t),super.createItems()}hasHeaders(){return Array.isArray(this.headers)&&this.headers.length>0}}Neo.applyClassConfig(r);const i=r},4350:(e,t,a)=>{a.d(t,{Z:()=>n});var l=a(3980),r=a(6717),i=a(5328);class o extends l.Z{static labelPositions=["left","top"];static config={className:"Neo.form.field.CheckBox",ntype:"checkboxfield",baseCls:["neo-checkboxfield"],checked_:!1,error_:null,errorPositionAbsolute_:!1,errorTextGroupRequired:e=>`Please check at least one item of the group: ${e.name}`,errorTextRequired:"Required",groupRequired_:!1,hideLabel_:!1,iconCls:["far","fa-square"],iconClsChecked:["fas","fa-check"],inputType_:"checkbox",labelBaseCls:["neo-checkbox-label"],labelCls_:[],labelId_:null,labelIdCls_:[],labelIdSeparator_:" · ",labelPosition_:"left",labelText_:"LabelText",labelWidth_:150,required_:!1,showErrorTexts_:!0,uncheckedValue:!1,useAlertState_:!1,value:!0,valueLabelText_:null,_vdom:{cn:[{tag:"label",cls:["neo-checkbox-label"],cn:[{tag:"span",cls:[]},{tag:"input",cls:["neo-checkbox-input"]},{tag:"i",cls:["neo-checkbox-icon"]},{tag:"span",cls:["neo-checkbox-value-label"]}]},{cls:["neo-error-wrapper"],removeDom:!0,cn:[{cls:["neo-error"]}]}]}};clean=!0;construct(e){super.construct(e);let t=this;t.addDomListeners({change:t.onInputValueChange,scope:t})}afterSetChecked(e,t){let a=this,l=a.vdom.cn[0],r=l.cn[2].cls,o=e?a.iconClsChecked:a.iconCls,n=e?a.iconCls:a.iconClsChecked;t&&(a.clean=!1),a.validate(),l.cn[1].checked=e,i.Z.removeAdd(r,n,o),a.update(),void 0!==t&&a.fireChangeEvent(a.getValue(),a.getOldValue())}afterSetError(e,t){this.updateError(e)}afterSetErrorPositionAbsolute(e,t){let a=this.vdom.cn[1].cn[0].cls;i.Z[e?"add":"remove"](a,"neo-absolute"),this.update()}afterSetGroupRequired(e,t){void 0!==t&&this.validate(!1)}afterSetHideLabel(e,t){this.vdom.cn[0].cn[0].removeDom=e,this.update()}afterSetId(e,t){let a=this,l=a.vdom.cn[0];l.cn[0].id=a.getLabelId(),l.cn[1].id=a.getInputElId(),l.cn[2].id=a.getIconElId(),l.cn[3].id=a.getValueLabelId(),super.afterSetId(e,t)}afterSetInputType(e,t){this.changeInputElKey("type",e)}afterSetLabelCls(e,t){let a=this.vdom.cn[0].cn[0].cls;i.Z.remove(a,t),i.Z.add(a,e),this.update()}afterSetLabelPosition(e,t){let a=this.cls;i.Z.remove(a,"neo-label-"+t),i.Z.add(a,"neo-label-"+e),this.cls=a}afterSetLabelText(e,t){let a=this;a.labelId&&(e=`<span class="${a.labelIdCls.join(",")}">${a.labelId}</span>${a.labelIdSeparator+e}`),a.vdom.cn[0].cn[0].innerHTML=e,a.update()}afterSetLabelWidth(e,t){let a=this;a.hideLabel||(a.vdom.cn[0].cn[0].width=e,a.update())}afterSetRequired(e,t){void 0!==t&&this.validate(!1)}afterSetShowErrorTexts(e,t){void 0!==t&&this.validate(!1)}afterSetUseAlertState(e,t){let a=this.cls;i.Z.toggle(a,"neo-use-alert-state",e),this.cls=a}afterSetValue(e,t){this.changeInputElKey("value",e)}afterSetValueLabelText(e,t){let a=this.vdom.cn[0].cn[3],l=!!e;l&&(a.innerHTML=e),a.removeDom=!l,this.update()}beforeSetGroupRequired(e,t){return e&&this.required?(console.warn("Do not use groupRequired & required at the same time. Switching to required.",this),!1):e}beforeSetLabelCls(e,t){return i.Z.union(e||[],this.labelBaseCls)}beforeSetLabelPosition(e,t){return this.beforeSetEnumValue(e,t,"labelPosition")}beforeSetRenderName(e,t){return!0}getGroupValue(){let e=this.getClosestForm(),t=r.Z.find({path:this.getPath()}),a=[];return t.forEach((t=>{t.checked&&t.getClosestForm()===e&&i.Z.add(a,t.value)})),a}getIconElId(){return`${this.id}__icon`}getInputEl(){return this.vdom.cn[0].cn[1]}getInputElId(){return`${this.id}__input`}getLabelId(){return`${this.id}__label`}getOldValue(){let e=this;return e.checked?e.uncheckedValue:e.value}getValue(){let e=this;return e.checked?e.value:e.uncheckedValue}getValueLabelId(){return`${this.id}__value-label`}isEmptyAndRequired(){return!this.validate(!1)}isValid(){return this.validate(!0),!this.error&&super.isValid()}onInputValueChange(e){let t=this,a=e.target.checked;t.vnode.childNodes[0].childNodes[t.hideLabel?0:1].attributes.checked=`${a}`,t.checked=a,t.fireUserChangeEvent(t.getValue(),t.getOldValue())}updateError(e,t=!1){let a,l,r=this,o=r.cls,n=e&&r.showErrorTexts;r.clean&&!r.mounted||(r._error=e,i.Z[e?"add":"remove"](o,"neo-invalid"),r.cls=o,l=r.vdom.cn[1],a=l.cn[0],n?a.html=e:delete a.html,l.removeDom=!n,!t&&r.update())}validate(e=!0){let t,a,l=this,i=l.name,o=!0;if(e||(l.clean=!1),l.groupRequired){for(t of(o=!1,a=r.Z.find({ntype:l.ntype,name:l.name}),a))if(t.checked){o=!0;break}for(t of a)t.id!==l.id&&(l.clean||(t.clean=!1),t[l.clean?"_error":"error"]=o?null:t.errorTextGroupRequired({name:i}));o||(l._error=l.errorTextGroupRequired({name:i}))}else l.required&&!l.checked&&(l._error=l.errorTextRequired,o=!1);return o&&(l._error=null),!l.clean&&l.updateError(l._error,e),!!o&&super.validate(e)}}Neo.applyClassConfig(o);const n=o}}]);