export const __webpack_esm_id__=9361;export const __webpack_esm_ids__=[9361];export const __webpack_esm_modules__={9361(e,t,n){n.d(t,{default:()=>s});var o=n(1184),i=n(1107),a=n(9051);const d=Symbol.for("configSymbol");class r extends o.A{static activeViews=["preview","source"];static languages=["markdown","neomjs"];static config={className:"Neo.code.LivePreview",ntype:"live-preview",activeView_:"source",baseCls:["neo-code-live-preview"],disableRunSource:!1,enableFullscreen:!0,language_:"neomjs",layout:"fit",items:[{module:a.A,cls:["live-preview-container"],reference:"tab-container",removeInactiveCards:!1,items:[{module:i.A,header:{text:"Source"},hideLabel:!0,listeners:{editorChange:"up.onEditorChange"},style:{height:"100%"},reference:"editor"},{module:o.A,header:{text:"Preview"},reference:"preview"}]}],value_:null,windowUrl_:"./childapps/preview/index.html"};connectedWindowId=null;markdownComponent=null;markdownComponentClass=null;neoExecutor=null;previewContainer=null;get tabContainer(){return this.getItem("tab-container")}afterSetActiveView(e,t){this.tabContainer.activeIndex="source"===e?0:1}afterSetLanguage(e,t){let n=this;"markdown"!==e&&(n.markdownComponent=null),n.getItem("editor").language="neomjs"===e?"javascript":e,t&&!Object.hasOwn(n[d],"value")&&n.doRunSource()}afterSetValue(e,t){e&&(this.getItem("editor").value=e?.trim())}beforeSetActiveView(e,t){return this.beforeSetEnumValue(e,t,"activeView")}beforeSetLanguage(e,t){return this.beforeSetEnumValue(e,t,"language")}beforeSetWindowUrl(e,t){if(e.startsWith("./")){let t=Neo.config.appPath.split("/");return t.pop(),new URL(Neo.config.basePath+t.join("/")+e.substring(1),location.href).href}return e}async collapseExpand(e){let t,n=this,o=e.component,i="fas fa-compress"===o.iconCls,{vdom:a}=n;i?(o.iconCls="fas fa-expand",t=n.collapseRect,delete n.collapseRect,Object.assign(a.style,{height:t.height+"px",left:t.x+"px",top:t.y+"px",width:t.width+"px"}),n.update(),await n.timeout(300),Object.assign(a.style,{position:null,zIndex:null})):(o.iconCls="fas fa-compress",t=await n.getDomRect(),n.collapseRect=t,a.style=a.style||{},Object.assign(a.style,{height:t.height+"px",left:t.x+"px",position:"fixed",top:t.y+"px",width:t.width+"px",zIndex:103}),n.update(),await n.timeout(50),Object.assign(a.style,{height:"100%",left:0,top:0,width:"100%"})),n.update()}async createPopupWindow(){let e=this,{windowId:t}=e,n=await Neo.Main.getWindowData({windowId:t}),o=await e.getDomRect(e.getReference("preview").id),{height:i,left:a,top:d,width:r}=o;a+=n.screenLeft,d+=n.outerHeight-n.innerHeight+n.screenTop,Neo.Main.windowOpen({url:`${e.windowUrl}?id=${e.id}`,windowFeatures:`height=${i},left=${a},top=${d},width=${r}`,windowId:t,windowName:e.id})}destroy(...e){this.connectedWindowId&&Neo.Main.windowClose({names:[this.id],windowId:this.windowId}),super.destroy(...e)}async doRunSource(){if(this.disableRunSource)return;let e=this,t=e.getPreviewContainer(),o=e.editorValue||e.value;if(o)if("markdown"===e.language){if(!e.markdownComponentClass){const t=await n.e(5656).then(n.bind(n,5656));e.markdownComponentClass=t.default}e.markdownComponent&&!e.markdownComponent.isDestroyed?e.markdownComponent.value=o:(t.removeAll(!0,!0),e.markdownComponent=t.add({module:e.markdownComponentClass,style:{height:"100%",overflow:"auto"},value:o,windowUrl:e.windowUrl}))}else{if(!e.neoExecutor){const t=await n.e(3317).then(n.bind(n,3317));e.neoExecutor=Neo.create(t.default)}await e.neoExecutor.execute({code:o,container:t})}}getPreviewContainer(){let e=this;return e.previewContainer?e.previewContainer:e.getReference("preview")}onActiveIndexChange(e){let t=this,n=1===e.value;"preview"===e.item.reference?t.doRunSource():n||t.previewContainer||t.getReference("preview").removeAll(),t.getReference("popout-window-button").hidden=!n,t.disableRunSource=!1}onConstructed(){super.onConstructed();let e=this,t=[],{tabContainer:n}=e;e.editor,e.enableFullscreen&&t.push({handler:e.collapseExpand.bind(e),iconCls:"fas fa-expand",ui:"ghost"}),Neo.config.useSharedWorkers&&(t.push({handler:e.popoutPreview.bind(e),hidden:1!==n.activeIndex,iconCls:"far fa-window-maximize",reference:"popout-window-button",ui:"ghost"}),Neo.currentWorker.on({connect:e.onWindowConnect,disconnect:e.onWindowDisconnect,scope:e})),t.unshift("->"),n.getTabBar().add(t),n.getTabBar().update(),n.on("activeIndexChange",e.onActiveIndexChange,e),"preview"===e.activeView&&e.doRunSource()}onEditorChange({value:e}){let t=this;t._value=e,t.editorValue=e,t.fire("editorChange",{value:e}),t.doRunSource()}async onWindowConnect(e){let t=this,n=await Neo.Main.getByPath({path:"location.search",windowId:e.windowId});if(new URLSearchParams(n).get("id")===t.id){t.connectedWindowId=e.windowId;let n=Neo.apps[e.windowId].mainView,o=t.getReference("preview"),{tabContainer:i}=t,a=o.removeAt(0,!1);t.previewContainer=n,n.add(a),i.activeIndex=0,i.getTabAtIndex(1).disabled=!0}}async onWindowDisconnect(e){let t=this;if(e.windowId===t.connectedWindowId){let n=Neo.apps[e.windowId].mainView,o=t.getReference("preview"),{tabContainer:i}=t,a=n.removeAt(0,!1);t.previewContainer=null,o.add(a),t.disableRunSource=!0,i.activeIndex=1,t.getReference("popout-window-button").disabled=!1,i.getTabAtIndex(1).disabled=!1,t.connectedWindowId=null}}async popoutPreview(e){e.component.disabled=!0,await this.createPopupWindow()}}const s=Neo.setupClass(r)},1107(e,t,n){n.d(t,{A:()=>a});var o=n(1741);class i extends o.A{static cursorBlinkings=["blink","expand","phase","smooth","solid"];static delayable={layoutEditor:{type:"buffer",timer:50}};static editorThemes=["hc-black","hc-light","vs","vs-dark"];static languages=["javascript","markdown"];static config={className:"Neo.component.wrapper.MonacoEditor",ntype:"monaco-editor",baseCls:["neo-monaco-editor"],contextmenu_:!1,cursorBlinking_:"blink",domReadOnly_:!1,editorTheme_:"vs",fontSize_:14,language_:"javascript",minimap_:{enabled:!1},options_:{},readOnly_:!1,scrollBeyondLastLine_:!1,showLineNumbers_:!0,value_:"",useThemeAwareness_:!0};construct(e){super.construct(e);let t=this;t.addDomListeners({editorChange:t.onContentChange,resize:t.layoutEditor,scope:t})}afterSetContextmenu(e,t){this.updateOptions({contextmenu:e})}afterSetCursorBlinking(e,t){this.updateOptions({cursorBlinking:e})}afterSetDomReadOnly(e,t){this.updateOptions({domReadOnly:e})}afterSetMounted(e,t){super.afterSetMounted(e,t);let n=this;e&&n.timeout(150).then(()=>{Neo.main.addon.MonacoEditor.createInstance(n.getInitialOptions()).then(()=>{n.onEditorMounted?.()})})}afterSetEditorTheme(e,t){let n=this;n.mounted&&Neo.main.addon.MonacoEditor.setTheme({id:n.id,value:e,windowId:n.windowId})}afterSetFontSize(e,t){this.updateOptions({fontSize:e})}afterSetLanguage(e,t){let n=this;n.mounted&&Neo.main.addon.MonacoEditor.setLanguage({id:n.id,value:e,windowId:n.windowId})}afterSetMinimap(e,t){this.updateOptions({minimap:e})}afterSetOptions(e,t){this.updateOptions(e)}afterSetReadOnly(e,t){this.updateOptions({readOnly:e})}afterSetScrollBeyondLastLine(e,t){this.updateOptions({scrollBeyondLastLine:e})}afterSetShowLineNumbers(e,t){this.updateOptions({lineNumbers:e?"on":"off"})}afterSetUseThemeAwareness(e,t){e&&this.afterSetTheme(this.theme,null)}afterSetValue(e,t){let n=this;n.mounted&&Neo.main.addon.MonacoEditor.setValue({id:n.id,value:n.stringifyValue(n.value),windowId:n.windowId})}afterSetTheme(e,t){this.useThemeAwareness&&e&&(this.editorTheme=e.includes("dark")?"vs-dark":"vs")}afterSetWindowId(e,t){super.afterSetWindowId(e,t),t&&Neo.main.addon.MonacoEditor.destroyInstance({id:this.id,windowId:t})}beforeSetCursorBlinking(e,t){return this.beforeSetEnumValue(e,t,"cursorBlinking")}beforeSetEditorTheme(e,t){return this.beforeSetEnumValue(e,t,"editorTheme")}beforeSetLanguage(e,t){return this.beforeSetEnumValue(e,t,"language")}destroy(...e){let t=this;t.mounted&&Neo.main.addon.ResizeObserver.unregister({id:t.id,windowId:t.windowId}),Neo.main.addon.MonacoEditor.destroyInstance({id:t.id,windowId:t.windowId}),super.destroy(...e)}async getEditorValue(){return Neo.main.addon.MonacoEditor.getValue({id:this.id,windowId:this.windowId})}getInitialOptions(){let e=this;return{appName:e.appName,contextmenu:e.contextmenu,cursorBlinking:e.cursorBlinking,domReadOnly:e.domReadOnly,id:e.id,fontSize:e.fontSize,language:e.language,lineNumbers:e.showLineNumbers?"on":"off",minimap:e.minimap,readOnly:e.readOnly,scrollBeyondLastLine:e.scrollBeyondLastLine,theme:e.editorTheme,value:e.stringifyValue(e.value),windowId:e.windowId,scrollbar:{alwaysConsumeMouseWheel:!1},...e.options}}layoutEditor(){let e=this;e.mounted&&Neo.main.addon.MonacoEditor.layoutEditor({id:e.id,windowId:e.windowId})}onContentChange(e){this.fire("editorChange",e)}stringifyValue(e){return Array.isArray(e)&&(e=e.join("\n")),e}updateOptions(e){let t=this;t.mounted&&Neo.main.addon.MonacoEditor.updateOptions({id:t.id,windowId:t.windowId,options:e})}toJSON(){let e=this;return{...super.toJSON(),contextmenu:e.contextmenu,cursorBlinking:e.cursorBlinking,domReadOnly:e.domReadOnly,editorTheme:e.editorTheme,fontSize:e.fontSize,language:e.language,minimap:e.serializeConfig(e.minimap),options:e.serializeConfig(e.options),readOnly:e.readOnly,scrollBeyondLastLine:e.scrollBeyondLastLine,showLineNumbers:e.showLineNumbers,value:e.stringifyValue(e.value)}}}const a=Neo.setupClass(i)}};