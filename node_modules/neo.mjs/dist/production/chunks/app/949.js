export const __webpack_esm_id__=949;export const __webpack_esm_ids__=[949,3325];export const __webpack_esm_modules__={949(e,t,o){o.d(t,{default:()=>S}),o.r(t);var n=o(3572),s=o(5023);class r extends n.A{static config={className:"Neo.ai.client.Service",client:null};safeSerialize(e){const t=Neo.typeOf(e);if("NeoInstance"===t)return e.toJSON();if("Object"===t){const t={};return Object.entries(e).forEach(([e,o])=>{t[e]=this.safeSerialize(o)}),t}return"Array"===t?e.map(e=>this.safeSerialize(e)):e}}const c=Neo.setupClass(r);var i=o(7150),a=o(950);const d=Neo.setupClass(class extends c{static config={className:"Neo.ai.client.ComponentService"};async getComputedStyles({componentId:e,variables:t}){const o=Neo.getComponent(e);if(!o)throw new Error(`Component not found: ${e}`);return{styles:await Neo.main.DomAccess.getComputedStyle({id:o.id,style:t})}}async getDomRect({componentIds:e}){if(!Array.isArray(e)||0===e.length)throw new Error("componentIds must be a non-empty array");const t=Neo.getComponent(e[0]);if(!t)throw new Error(`Component not found: ${e[0]}`);const o=await t.getDomRect(e);return{rects:Array.isArray(o)?o:[o]}}highlightComponent({componentId:e,options:t}){let o,n=Neo.getComponent(e);if(!n)throw new Error(`Component not found: ${e}`);const s=(t=t||{}).color||"red",r=t.duration||2e3,c=t.style||"outline";o=n.style||{};let i={};return"outline"===c?(i.outline=`2px solid ${s}`,i.outlineOffset="-2px"):i.boxShadow=`0 0 10px ${s}, inset 0 0 10px ${s}`,n.style={...o,...i},this.timeout(r).then(()=>{n.style=o}),{success:!0}}getComponentTree({depth:e,rootId:t}){return{tree:this.serializeComponent(this.getComponentRoot(t),e||-1)}}getVdomTree({depth:e,rootId:t}){const o=this.getComponentRoot(t);if(!o)throw new Error("Root component not found");return{vdom:i.A.getVdomTree(o.vdom,e)}}getVnodeTree({depth:e,rootId:t}){const o=this.getComponentRoot(t);if(!o)throw new Error("Root component not found");return{vnode:i.A.getVnodeTree(o.vnode,e)}}getVdomVnode({depth:e,rootId:t}){const o=this.getComponentRoot(t);if(!o)throw new Error("Root component not found");return{vdom:i.A.getVdomTree(o.vdom,e),vnode:i.A.getVnodeTree(o.vnode,e)}}queryComponent({rootId:e,selector:t,returnProperties:o}){let n;if(e){const o=Neo.getComponent(e);if(!o)throw new Error(`Root component not found: ${e}`);n=o.down(t,!1)}else n=Neo.manager.Component.find(t);return{components:n.map(e=>{if(Array.isArray(o)&&o.length>0){const t={};return o.forEach(o=>{t[o]=this.safeSerialize(e[o])}),{className:e.className,id:e.id,properties:t}}return e.toJSON()})}}queryVdom({rootId:e,selector:t}){const o=this.getComponentRoot(e);if(!o)throw new Error("Root component not found");const n=a.A.find(o.vdom,t);return{vdom:n?.vdom||null,index:n?.index,parentId:n?.parentNode?.id}}getComponentRoot(e){if(e)return Neo.getComponent(e);const t=Object.values(Neo.apps||{});return t.length>0?t[0].mainView:null}serializeComponent(e,t,o=1){if(!e)return null;const n=e.toJSON();if(-1===t||o<t){const s=Neo.manager.Component.getChildComponents(e);s&&s.length>0&&(n.items=s.map(e=>this.serializeComponent(e,t,o+1)))}return n}});var l=o(1296);const p=Neo.setupClass(class extends c{static config={className:"Neo.ai.client.DataService"};getRecord({recordId:e,storeId:t}){let o;if(t){const n=Neo.get(t);if(!n)throw new Error(`Store not found: ${t}`);o=n.get(e)}else{const t=[];if(l.A.items.forEach(o=>{const n=o.get(e);n&&t.push(n)}),t.length>1)throw new Error(`Multiple records found with ID ${e}. Please specify storeId.`);1===t.length&&(o=t[0])}if(!o)throw new Error(`Record not found: ${e}`);return o.toJSON()}inspectStateProvider({providerId:e}){const t=Neo.get(e);if(!t)throw new Error(`StateProvider not found: ${e}`);return t.toJSON()}inspectStore({limit:e=50,offset:t=0,storeId:o}){const n=Neo.get(o);if(!n)throw new Error(`Store not found: ${o}`);return{...n.toJSON(),items:n.getRange(t,t+e).map(e=>e.toJSON())}}listStores(e){return{stores:l.A.items.map(e=>({id:e.id,model:e.model?.className||"N/A",count:e.count,isLoaded:e.isLoaded}))}}modifyStateProvider({data:e,providerId:t}){const o=Neo.get(t);if(!o)throw new Error(`StateProvider not found: ${t}`);return o.setData(e),{success:!0}}}),m=Neo.setupClass(class extends c{static config={className:"Neo.ai.client.InstanceService"};getInstanceProperties({id:e,properties:t}){const o=Neo.get(e),n={};if(!o)throw new Error(`Instance not found: ${e}`);return t.forEach(e=>{n[e]=this.safeSerialize(o[e])}),{properties:n}}findInstances({selector:e,returnProperties:t}){return{instances:Neo.manager.Instance.find(e).map(e=>{if(Array.isArray(t)&&t.length>0){const o={};return t.forEach(t=>{o[t]=this.safeSerialize(e[t])}),{className:e.className,id:e.id,properties:o}}return e.toJSON()})}}setInstanceProperties({id:e,properties:t}){const o=Neo.get(e);if(!o)throw new Error(`Instance not found: ${e}`);return o.set(t),{success:!0}}}),u=Neo.setupClass(class extends c{static config={className:"Neo.ai.client.InteractionService"};async simulateEvent({events:e}){let t=this;if(!Array.isArray(e))throw new Error("InteractionService: events must be an array");for(const o of e)o.delay&&await t.timeout(o.delay),await t.dispatch({id:o.targetId,options:o.options,type:o.type,windowId:o.windowId});return!0}async dispatch({id:e,options:t,type:o,windowId:n}){return await Neo.Main.importAddon({name:"EventSimulator",windowId:n}),await Neo.main.addon.EventSimulator.dispatch({id:e,options:t,type:o,windowId:n})}});var h=o(6069),g=o(6436);const f=Neo.setupClass(class extends c{static config={className:"Neo.ai.client.RuntimeService"};checkNamespace({namespace:e}){return{exists:!!Neo.ns(e)}}getDomEventListeners({componentId:e}){const t=[],o=h.A.items?.[e];return o&&Object.entries(o).forEach(([e,o])=>{o.forEach(o=>{t.push({delegate:o.delegate,event:e,handler:"function"==typeof o.fn?o.fn.name||"anonymous":o.fn,priority:o.priority,scope:o.scope?.id||"unknown"})})}),{listeners:t}}getDomEventSummary(e){const t={byComponent:{},byEvent:{},totalEvents:0};return Object.entries(h.A.items).forEach(([e,o])=>{let n=0;Object.entries(o).forEach(([e,o])=>{const s=o.length;t.totalEvents+=s,n+=s,t.byEvent[e]=(t.byEvent[e]||0)+s}),n>0&&(t.byComponent[e]=n)}),t}getDragState(e){const t=Neo.manager?.DragCoordinator;return t?t.toJSON():{}}getMethodSource({className:e,methodName:t}){const o=Neo.ns(e);if(!o)return{success:!1,error:`Class '${e}' not found`};const n=Neo.typeOf(o);let s;if("NeoClass"===n)s=o.prototype;else{if("NeoInstance"!==n)return{success:!1,error:`Target '${e}' is not a Neo class or instance`};s=o.constructor.prototype}return"function"!=typeof s[t]?{success:!1,error:`Method '${t}' not found on '${e}'`}:{success:!0,source:s[t].toString()}}getNamespaceTree({root:e="Neo"}){const t=Neo.ns(e),o={};return t?(this.#e(t,e,o),{root:e,tree:o}):{tree:{},error:`Namespace '${e}' not found`}}getNeoConfig({windowId:e}){return e?Neo.windowConfigs?.[e]||null:Neo.config}getRouteHistory({windowId:e}){const t=g.A.getStack(e);return{count:t.length,history:t,windowId:e||null}}getWindowInfo(e){const t=Neo.manager?.Window;return t?t.toJSON():{windows:[]}}inspectClass({className:e,detail:t="standard"}){const o=Neo.ns(e);if(!o)throw new Error(`Class not found: ${e}`);const n=o.isClass?o:o.constructor,s=n.prototype,r=e=>{const t=[];return Neo.isObject(e)&&Object.values(e).forEach(e=>{e&&e.isClass?t.push(e.prototype.className):t.push(...r(e))}),t},c={},i=new Set,a=new Set(Object.keys(n.config)),d=n.configDescriptors||{},l=["constructor","construct","init","onConstructed","onAfterConstructed"],p=/^(before|after)(Get|Set)([A-Z])/,m=this.serializeConfig(n.config),u=n.__proto__,h=u?.config||{};Object.keys(m).forEach(e=>{if("compact"===t&&Object.hasOwn(h,e)&&h[e]===n.config[e])return;c[e]={value:m[e]},d[e]&&(c[e].meta=this.serializeConfig(d[e]));const o=[];["beforeGet","beforeSet","afterSet"].forEach(n=>{const r=((e,t)=>e+t[0].toUpperCase()+t.slice(1))(n,e);"compact"===t?Object.hasOwn(s,r)&&o.push(n):"function"==typeof s[r]&&o.push(n)}),o.length>0&&(c[e].hooks=o)});let g=s;for(;g&&"Object"!==g.constructor.className&&(Object.getOwnPropertyNames(g).forEach(e=>{a.has(e)||l.includes(e)||e.startsWith("_")||e.startsWith("#")||e.match(p)||"function"==typeof Object.getOwnPropertyDescriptor(g,e).value&&i.add(e)}),"compact"!==t);)g=g.__proto__;return{className:s.className,ntype:s.ntype,ntypeChain:n.ntypeChain,superClass:s.__proto__?.constructor?.config?.className||null,mixins:s.mixins?r(s.mixins):[],configs:c,methods:Array.from(i).sort()}}patchCode({className:e,methodName:t,source:o}){if(!0!==Neo.config.enableHotPatching)return{success:!1,error:"Hot patching is disabled. Set Neo.config.enableHotPatching = true to enable."};const n=Neo.ns(e);if(!n)return{success:!1,error:`Class '${e}' not found`};if(!n.prototype)return{success:!1,error:`Class '${e}' has no prototype (is it a singleton?)`};try{const s=new Function("return "+o)();return"function"!=typeof s?{success:!1,error:"Source did not evaluate to a function"}:(console.warn(`[Neo.ai.client.RuntimeService] Hot-patching ${e}.prototype.${t}`),n.prototype[t]=s,s.$isPatched=!0,s.$originalSource=o,{success:!0})}catch(e){return console.error("[Neo.ai.client.RuntimeService] Hot patch failed:",e),{success:!1,error:e.message}}}reloadPage(e){return Neo.Main.reloadWindow(),{status:"reloading"}}setNeoConfig({config:e}){return Neo.setGlobalConfig(e),{status:"ok"}}setRoute({hash:e,windowId:t}){return Neo.Main.setRoute({value:e,windowId:t}),{status:"ok",hash:e}}#e(e,t,o){Object.keys(e).forEach(n=>{const s=e[n],r=Neo.typeOf(s),c=t?`${t}.${n}`:n;"NeoClass"===r?o[n]={type:"class",className:s.prototype.className}:"NeoInstance"===r?o[n]={type:"singleton",className:s.className}:"Object"===r&&(o[n]={},this.#e(s,c,o[n]),0===Object.keys(o[n]).length&&delete o[n])})}});var N=o(9932);o(4556);class w extends n.A{static observable=!0;static config={className:"Neo.data.connection.WebSocket",ntype:"socket-connection",backoffStrategy:e=>Math.min(1e3*Math.pow(2,e-1),3e4),socket_:null};channel=null;maxReconnectAttempts=5;messageCallbacks={};messageId=1;reconnectAttempts=0;serverAddress=null;construct(e){super.construct(e),this.createSocket()}async attemptReconnect(e,t){let o=this;if(o.reconnectAttempts++,o.reconnectAttempts<o.maxReconnectAttempts){const n=o.backoffStrategy(o.reconnectAttempts);o.fire("reconnecting",{attempt:o.reconnectAttempts,maxAttempts:o.maxReconnectAttempts,delay:n}),console.log(`WebSocket reconnect attempt ${o.reconnectAttempts}/${o.maxReconnectAttempts} in ${n}ms`),await o.timeout(n),o.isDestroyed||(o.createSocket(),e&&o.on("open",{callback:e,scope:t||o,single:!0}))}else console.error("Max reconnection attempts reached"),o.fire("reconnect_failed")}beforeSend(e){let{channel:t}=this;return JSON.stringify(t?{channel:t,data:e}:e)}beforeSetSocket(e,t){if(e){let t=this;Object.assign(e,{onclose:t.onClose.bind(t),onerror:t.onError.bind(t),onmessage:t.onMessage.bind(t),onopen:t.onOpen.bind(t)}),(0,N.iI)(e,"send",t.beforeSend,t)}return e}close(e,t){this.socket.close(e,t)}createSocket(){this.socket=new WebSocket(this.serverAddress)}destroy(...e){this.close(),super.destroy(...e)}onClose(e,t,o){this.fire("close",{event:e,reason:t,wasClean:o}),o&&1e3===e.code||(console.warn("WebSocket closed abnormally, attempting reconnect..."),this.attemptReconnect())}onError(e){this.fire("error",{error:e})}onMessage(e){let t=this,o=JSON.parse(e.data);t.fire("message",{data:o}),o.mId&&(t.messageCallbacks[o.mId].resolve(o.data),delete t.messageCallbacks[o.mId])}onOpen(){this.reconnectAttempts=0,this.fire("open",{scope:this})}promiseMessage(e){let t=this;return new Promise((o,n)=>{t.messageCallbacks[t.messageId]={reject:n,resolve:o},t.sendMessage({data:e,mId:t.messageId}),t.messageId++})}sendMessage(e){let t=this,{socket:o}=t,n=e;switch(o.readyState){case WebSocket.CLOSED:case WebSocket.CLOSING:t.attemptReconnect(function(){t.sendMessage(n)});break;case WebSocket.CONNECTING:t.on("open",function(){t.sendMessage(n)},t,{once:!0});break;case WebSocket.OPEN:o.send(e)}}}const y=Neo.setupClass(w);var C=o(3325);class v extends n.A{static config={className:"Neo.ai.Client",singleton:!0,socketConfig:null,url:"ws://127.0.0.1:8081"};isConnected=!1;logs=[];serviceMap=null;services=null;socket=null;construct(e){super.construct(e);let t=this;t.services={component:Neo.create(d,{client:t}),data:Neo.create(p,{client:t}),instance:Neo.create(m,{client:t}),interaction:Neo.create(u,{client:t}),runtime:Neo.create(f,{client:t})};const{component:o,data:n,instance:s,interaction:r,runtime:c}=t.services;t.serviceMap={get_component:o,get_computed_styles:o,get_dom_rect:o,get_vdom:o,get_vdom_vnode:o,get_vnode:o,highlight_component:o,query_component:o,query_vdom:o,set_component:o,find_instances:s,get_instance_properties:s,set_instance_properties:s,get_record:n,inspect_state_provider:n,inspect_store:n,list_stores:n,modify_state_provider:n,get_dom_event:c,get_drag:c,get_method_source:c,get_route:c,get_window:c,inspect_class:c,patch_code:c,reload_page:c,set_route:c,simulate_event:r},Neo.currentWorker.on({connect:t.onAppWorkerWindowConnect,disconnect:t.onAppWorkerWindowDisconnect,scope:t}),t.connect()}connect(){let e=this;try{let t=new URL(Neo.config.neuralLinkUrl||e.url),o="Unknown App";if(Neo.config.appPath){const e=Neo.config.appPath.match(/apps\/([^\/]+)\//);e&&(o=e[1])}t.searchParams.set("appWorkerId",Neo.worker.App.id),t.searchParams.set("appName",o),e.socket=s.A.beforeSetInstance(e.socketConfig,y,{serverAddress:t.toString(),listeners:{close:e.onSocketClose,error:e.onSocketError,message:e.onSocketMessage,open:e.onSocketOpen,scope:e}})}catch(e){console.error("Neo.ai.Client: Failed to create WebSocket connection",e)}}async handleRequest(e,t){let o,n=this,s=null;for(o in n.serviceMap)if(e.startsWith(o)){s=n.serviceMap[o];break}const r=Neo.snakeToCamel(e);if(s){const e=s[r];if(Neo.isFunction(e))return e.call(s,t);if(Neo.isPromise(e))return await e.call(s,t)}if(s&&"function"==typeof s[r])return s[r](t);throw new Error(`Unknown method: ${e}`)}onAppWorkerWindowConnect(e){if(this.isConnected){const t=C.default.get(e.windowId),{appName:o,windowId:n}=e;this.sendNotification("window_connected",{appName:o,chrome:t?.chrome,innerRect:t?.innerRect,outerRect:t?.outerRect,windowId:n})}}onAppWorkerWindowDisconnect({windowId:e}){this.isConnected&&this.sendNotification("window_disconnected",{windowId:e})}async onSocketMessage({data:e}){if(e.method)try{const t=await this.handleRequest(e.method,e.params);this.sendResponse(e.id,t)}catch(t){console.error("Neo.ai.Client: Failed to handle message",t),this.sendError(e.id,t.message,t.stack)}}onSocketOpen(e){console.log("Neo.ai.Client: Connected to MCP Server"),this.isConnected=!0,this.logs.length>0&&(this.logs.forEach(e=>{this.sendNotification("console_log",e)}),this.logs.length=0);const t=Neo.worker.App;this.socket.sendMessage({jsonrpc:"2.0",method:"register",params:{appWorkerId:t.id,environment:Neo.config.environment,isSharedWorker:t.isSharedWorker,userAgent:navigator.userAgent}}),C.default.items.forEach(e=>{this.sendNotification("window_connected",{appName:e.appName,chrome:e.chrome,innerRect:e.innerRect,outerRect:e.outerRect,windowId:e.id})});const o=Neo.manager?.DragCoordinator;o?.activeTargetZone&&this.sendNotification("drag_active",{sortGroup:o.activeTargetZone.sortGroup,sourceZone:o.activeTargetZone.id})}onSocketClose(e){console.log("Neo.ai.Client: Disconnected"),this.isConnected=!1}onSocketError(e){console.error("Neo.ai.Client: WebSocket Error",e)}sendError(e,t,o){this.isConnected&&this.socket.sendMessage({jsonrpc:"2.0",id:e,error:{code:-32603,message:t,data:{stack:o}}})}sendNotification(e,t){this.isConnected&&this.socket.sendMessage({jsonrpc:"2.0",method:e,params:t})}sendResponse(e,t){this.isConnected&&this.socket.sendMessage({jsonrpc:"2.0",id:e,result:t})}}const S=Neo.setupClass(v)},1296(e,t,o){o.d(t,{A:()=>r});var n=o(7402);class s extends n.A{static config={className:"Neo.manager.Store",singleton:!0};construct(e){super.construct(e)}}const r=Neo.setupClass(s)},3325(e,t,o){o.r(t),o.d(t,{default:()=>c});var n=o(7402),s=o(6743);class r extends n.A{static config={className:"Neo.manager.Window",isSafari:/^((?!chrome|android).)*safari/i.test(navigator.userAgent),singleton:!0};construct(e){super.construct(e);let t=this;Neo.currentWorker.on({connect:t.onWindowConnect,disconnect:t.onWindowDisconnect,scope:t})}getWindowAt(e,t){let o=this.items.find(o=>o.outerRect?.intersects({bottom:t,right:e,x:e,y:t}));return o?o.id:null}calculateGeometry(e){const{innerHeight:t,innerWidth:o,mozInnerScreenX:n,mozInnerScreenY:r,outerHeight:c,outerWidth:i,screenLeft:a,screenTop:d}=e,l=(i-o)/2,p=c-t-l,m={bottom:l,left:l,right:l,top:p};let u,h;return"number"==typeof n?(u=n,h=r):this.isSafari?(u=a+l,h=d+p):(u=a,h=d),{chrome:m,innerRect:new s.A(u,h,o,t),outerRect:new s.A(u-l,h-p,i,c)}}onWindowConnect({appName:e,windowData:t,windowId:o}){let n=null,s=null,r=null;t&&({chrome:n,innerRect:s,outerRect:r}=this.calculateGeometry(t)),console.log("Window.onWindowConnect",{windowId:o,appName:e,chrome:n,innerRect:s,outerRect:r}),this.register({appName:e,chrome:n,id:o,innerRect:s,outerRect:r})}onWindowDisconnect({windowId:e}){this.unregister(e)}onWindowPositionChange(e){const t=this,o=t.get(e.windowId),{chrome:n,innerRect:s,outerRect:r}=t.calculateGeometry(e);o?(o.chrome=n,o.innerRect=s,o.outerRect=r):t.register({chrome:n,id:e.windowId,innerRect:s,outerRect:r})}toJSON(){return{className:this.className,windows:this.items.map(e=>({id:e.id,appName:e.appName,chrome:e.chrome,innerRect:e.innerRect,outerRect:e.outerRect}))}}}const c=Neo.setupClass(r)},7150(e,t,o){o.d(t,{A:()=>c});var n=o(3572),s=o(7466);class r extends n.A{static config={className:"Neo.util.vdom.TreeBuilder",singleton:!0};#t(e,t,o,n){if("object"!=typeof e||null===e)return e;let r={...e};return e[n]&&(r[n]=[],e[n].forEach(e=>{let c,i=e;if(i.componentId){const e=s.A.get(i.componentId);if(-1!==t&&e?.vnode){const e=o?.has(i.componentId);if(1===t&&!e||o&&!e)return void r[n].push({...i,neoIgnore:!0})}if(t>1||-1===t||o?.has(i.componentId)||!e?.vnode){const t="cn"===n?e?.vdom:e?.vnode;t&&(i=t)}}c=e.componentId?-1===t?-1:Math.max(0,t-1):t,r[n].push(this.#t(i,c,o,n))})),r}getVdomTree(e,t=-1,o=null){return this.#t(e,t,o,"cn")}getVnodeTree(e,t=-1,o=null){return this.#t(e,t,o,"childNodes")}}const c=Neo.setupClass(r)}};