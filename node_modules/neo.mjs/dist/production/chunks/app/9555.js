export const __webpack_esm_id__=9555;export const __webpack_esm_ids__=[3325,9555];export const __webpack_esm_modules__={9555(e,t,o){o.d(t,{default:()=>m}),o.r(t);var r=o(1741),n=o(7402),i=o(6743),a=o(3325);class s extends n.A{static config={className:"Neo.manager.DragCoordinator",singleton:!0,sortZones:new Map};activeTargetZone=null;handleVoid(e,t,o){let r=this;r.activeTargetZone&&(r.activeTargetZone.onRemoteDragLeave(),r.activeTargetZone=null,e.resumeWindowDrag(t.reference||t.id,o))}onDragMove(e){let t,o=this,{draggedItem:r,offsetX:n,offsetY:s,proxyRect:c,screenX:d,screenY:l,sourceSortZone:g}=e,{sortGroup:h}=g,p=a.default.getWindowAt(d,l);if(p&&p!==g.windowId&&(t=o.sortZones.get(h)?.get(p),t)){let e=a.default.get(p),h=d-e.innerRect.x,m=l-e.innerRect.y,w=new i.A(h-n,m-s,c.width,c.height);if(t.acceptsRemoteDrag(h,m))return o.activeTargetZone!==t&&(o.activeTargetZone?.onRemoteDragLeave(),o.activeTargetZone||g.suspendWindowDrag(r.reference||r.id),o.activeTargetZone=t),void t.onRemoteDragMove({draggedItem:r,localX:h,localY:m,offsetX:n,offsetY:s,proxyRect:w})}o.handleVoid(g,r,c)}onDragEnd(e){let t=this;t.activeTargetZone&&(t.activeTargetZone.onRemoteDrop(e.draggedItem),e.sourceSortZone.onRemoteDropOut(e.draggedItem),t.activeTargetZone=null)}register(e){let t=this,{sortGroup:o,windowId:r}=e;o&&(t.sortZones.has(o)||t.sortZones.set(o,new Map),t.sortZones.get(o).set(r,e))}unregister(e){let t=this,{sortGroup:o,windowId:r}=e;if(o&&t.sortZones.has(o)){let e=t.sortZones.get(o);e.delete(r),0===e.size&&t.sortZones.delete(o)}}toJSON(){let e=this;return{className:e.className,activeTargetZone:e.activeTargetZone?{id:e.activeTargetZone.id,sortGroup:e.activeTargetZone.sortGroup,windowId:e.activeTargetZone.windowId}:null,sortZones:Array.from(e.sortZones.entries()).map(([e,t])=>({group:e,windows:Array.from(t.keys())}))}}}const c=Neo.setupClass(s);var d=o(2450),l=o(1031),g=o(9380),h=o(950);class p extends g.default{static config={className:"Neo.draggable.dashboard.SortZone",ntype:"dashboard-sortzone",dragHandleSelector:".neo-draggable",dragProxyExtraCls:[],sortGroup:null};isRemoteDragging=!1;construct(e){super.construct(e),c.register(this)}acceptsRemoteDrag(e,t){let o=this;return o.ownerRect?e>=o.ownerRect.x&&e<=o.ownerRect.x+o.ownerRect.width&&t>=o.ownerRect.y&&t<=o.ownerRect.y+o.ownerRect.height:(o.isFetchingRect||(o.isFetchingRect=!0,o.owner.getDomRect([o.owner.id]).then(e=>{o.ownerRect=e[0],o.isFetchingRect=!1})),!1)}applyAbsolutePositioning(){let e,t=this;t.sortableItems.forEach((o,r)=>{let n=t.itemRects[r];e=o.wrapperStyle||{},t.adjustProxyRectToParent?.(n,t.ownerRect),console.log("applyAbsolutePositioning",{height:`${n.height}px`,left:`${n.left}px`,top:`${n.top}px`,width:`${n.width}px`}),o.wrapperStyle=Object.assign(e,{flex:"none",height:`${n.height}px`,left:`${n.left}px`,margin:"0px",position:"absolute",top:`${n.top}px`,width:`${n.width}px`})})}calculateExpandedLayout(){let e=this,t=e.ownerRect,o="horizontal"===e.sortDirection,r=o?t.width:t.height,n=[],i=0,a=0,s=[],c=0,d=0,l=0,g=0,h=0,p=0,m=0,w=e.adjustItemRectsToParent?0:t.x,u=e.adjustItemRectsToParent?0:t.y;if(e.itemRects.length>0){let n=e.itemRects[0],i=e.itemRects[e.itemRects.length-1];if(o){if(c=e.adjustItemRectsToParent?n.x:n.x-t.x,d=r-(e.adjustItemRectsToParent?i.x+i.width:i.x-t.x+i.width),g=e.adjustItemRectsToParent?n.y:n.y-t.y,h=t.height-(e.adjustItemRectsToParent?n.y+n.height:n.y-t.y+n.height),e.itemRects.length>1){let t=e.itemRects[1];l=t.x-(n.x+n.width)}}else if(c=e.adjustItemRectsToParent?n.y:n.y-t.y,d=r-(e.adjustItemRectsToParent?i.y+i.height:i.y-t.y+i.height),p=e.adjustItemRectsToParent?n.x:n.x-t.x,m=t.width-(e.adjustItemRectsToParent?n.x+n.width:n.x-t.x+n.width),e.itemRects.length>1){let t=e.itemRects[1];l=t.y-(n.y+n.height)}}for(let t=0;t<e.itemRects.length;t++){let r=e.indexMap[t];if(-1===r)continue;let s=e.owner.items[r];if(s===e.dragPlaceholder||s===e.dragComponent)continue;let c=e.itemRects[t];n.push({item:s,rect:c}),s.flex?i+=s.flex:a+=o?c.width:c.height}let R=Math.max(0,n.length-1),f=Math.max(0,r-c-d-R*l-a),x=c;return n.forEach(({item:e,rect:r},n)=>{let a,c={};a=e.flex?e.flex/i*f:o?r.width:r.height,c=o?{left:`${w+x}px`,top:`${u+g}px`,height:t.height-g-h+"px",width:`${a}px`}:{left:`${w+p}px`,top:`${u+x}px`,height:`${a}px`,width:t.width-p-m+"px"},s.push({item:e,style:c}),x+=a+l}),s}destroy(){c.unregister(this),super.destroy()}getDragProxyConfig(){const e=super.getDragProxyConfig();return e.cls=e.cls.filter(e=>!e.includes("neo-viewport")),l.A.add(e.cls,this.dragProxyExtraCls),e}async onDragEnd(e){let t=this;t.isRemoteDragging||c.onDragEnd({draggedItem:t.dragComponent,sourceSortZone:t}),super.onDragEnd(e)}async onDragMove(e){let t=this;t.itemRects&&t.boundaryContainerRect&&!t.isScrolling&&await super.onDragMove(e)}async onRemoteDragLeave(e){let t=this;t.isRemoteDragging&&(t.isRemoteDragging=!1,await t.onDragEnd({}))}async onRemoteDragMove(e){let t=this;t.isRemoteDragging||await t.startRemoteDrag(e),t.onDragMove({clientX:e.localX,clientY:e.localY,proxyRect:e.proxyRect}),t.dragMove({clientX:e.localX,clientY:e.localY},!0)}async onRemoteDrop(e){let t=this,o=t.currentIndex;if(t.isRemoteDragging){await t.onDragEnd({});const r=e.parentId;r&&"document.body"!==r&&Neo.getComponent(r)?.remove(e,!1),t.owner.insert(o,e),t.isRemoteDragging=!1}}onRemoteDropOut(e){let t=this;if(t.owner.detachedItems)for(const[o,r]of t.owner.detachedItems.entries())if(r.widget===e){t.owner.detachedItems.delete(o);break}}onWindowDragContinue(e,t){let o=this;c.onDragMove({draggedItem:o.dragComponent,offsetX:o.offsetX,offsetY:o.offsetY,proxyRect:t.proxyRect,screenX:t.screenX,screenY:t.screenY,sourceSortZone:o})}resumeWindowDrag(e,t){this.owner.resumeWindowDrag(e,t)}async setupDragState(e){let t,o,r,n,i=this,{adjustItemRectsToParent:a,owner:s}=i,c=i.itemStyles=[],{layout:d}=s,l=s.style||{};n=s.items.filter(e=>!e.isDestroyed),t=n.indexOf(e),o={},Object.assign(i,{currentIndex:t,dragElement:h.A.find(s.vdom,e.id).vdom,dragProxyConfig:i.getDragProxyConfig(),indexMap:o,ownerStyle:{height:l.height,minWidth:l.minWidth,width:l.width},reversedLayoutDirection:"column-reverse"===d.direction||"row-reverse"===d.direction,sortableItems:n,sortDirection:d.direction?.includes("column")?"vertical":"horizontal",startIndex:t}),i.dragComponent=e,n.forEach((e,t)=>{o[t]=s.items.indexOf(e),c.push({height:e.height?`${e.height}px`:e.style?.height,width:e.width?`${e.width}px`:e.style?.width})}),r=await s.getDomRect([s.id].concat(n.map(e=>e.id))),r.forEach(e=>{console.log("itemRect",{height:`${e.height}px`,left:`${e.left}px`,top:`${e.top}px`,width:`${e.width}px`})}),i.ownerRect=r.shift(),i.boundaryContainerRect=i.ownerRect,s.style={...l,height:`${i.ownerRect.height}px`,minWidth:`${i.ownerRect.width}px`,width:`${i.ownerRect.width}px`},console.log("adjustItemRectsToParent",a),a&&r.forEach(e=>{e.x-=i.ownerRect.x,e.y-=i.ownerRect.y}),i.itemRects=r}async startRemoteDrag(e){let t,o=this,{owner:n}=o,{proxyRect:i}=e,a=e.draggedItem;o.isRemoteDragging=!0,o.dragElementRect={height:i.height,width:i.width,x:e.localX,y:e.localY,left:e.localX,top:e.localY},a.appName=o.appName,console.log("startRemoteDrag",a.id,a.windowId,a.parentId,a.parentComponent),a.parentId=null,a.parentComponent=null,a.mounted=!1,a.vnode=null,a.vnodeInitialized=!1,console.log("parent cleared:",a.parentId,a.parentComponent);let s=await n.getDomRect([n.id]);o.ownerRect=s[0],console.log("ownerRect",o.ownerRect),o.offsetX=e.offsetX,o.offsetY=e.offsetY,console.log("startRemoteDrag: ownerRect",o.ownerRect),console.log("startRemoteDrag: local coords",e.localX,e.localY),console.log("startRemoteDrag: calculated coords",e.localX-o.offsetX,e.localY-o.offsetY),t={module:d.A,appName:o.appName,cls:["neo-dragproxy",...o.owner.cls],items:[a],moveInMainThread:!1,windowId:o.windowId,style:{left:e.localX-o.offsetX+"px",top:e.localY-o.offsetY+"px"}},console.log("Creating local drag proxy",t),o.dragProxy=Neo.create(t),console.log("Created local drag proxy",o.dragProxy),o.dragPlaceholder=Neo.create({module:r.A,flex:"none",style:{height:`${i.height}px`,visibility:"hidden"}}),n.add(o.dragPlaceholder),await o.timeout(50),await o.setupDragState(o.dragPlaceholder);let c=o.sortableItems.indexOf(o.dragPlaceholder);if(c>-1){let e=o.itemRects[c];o.dragProxy.width=e.width,o.dragProxy.height=e.height}await o.timeout(50),o.applyAbsolutePositioning()}startWindowDrag(e){let t=this,{popupHeight:o,popupWidth:r,windowName:n}=e;t.dragProxy.style={opacity:0},t.isWindowDragging=!0,t.dragPlaceholder&&(t.dragPlaceholder.wrapperStyle={...t.dragPlaceholder.wrapperStyle,visibility:"hidden"}),t.calculateExpandedLayout().forEach(({item:e,style:t})=>{e.wrapperStyle={...e.wrapperStyle,...t}}),Neo.main.addon.DragDrop.startWindowDrag({popupHeight:o,popupName:n,popupWidth:r,windowId:t.windowId})}suspendWindowDrag(e){this.owner.suspendWindowDrag(e)}}const m=Neo.setupClass(p)},3325(e,t,o){o.r(t),o.d(t,{default:()=>a});var r=o(7402),n=o(6743);class i extends r.A{static config={className:"Neo.manager.Window",isSafari:/^((?!chrome|android).)*safari/i.test(navigator.userAgent),singleton:!0};construct(e){super.construct(e);let t=this;Neo.currentWorker.on({connect:t.onWindowConnect,disconnect:t.onWindowDisconnect,scope:t})}getWindowAt(e,t){let o=this.items.find(o=>o.outerRect?.intersects({bottom:t,right:e,x:e,y:t}));return o?o.id:null}calculateGeometry(e){const{innerHeight:t,innerWidth:o,mozInnerScreenX:r,mozInnerScreenY:i,outerHeight:a,outerWidth:s,screenLeft:c,screenTop:d}=e,l=(s-o)/2,g=a-t-l,h={bottom:l,left:l,right:l,top:g};let p,m;return"number"==typeof r?(p=r,m=i):this.isSafari?(p=c+l,m=d+g):(p=c,m=d),{chrome:h,innerRect:new n.A(p,m,o,t),outerRect:new n.A(p-l,m-g,s,a)}}onWindowConnect({appName:e,windowData:t,windowId:o}){let r=null,n=null,i=null;t&&({chrome:r,innerRect:n,outerRect:i}=this.calculateGeometry(t)),console.log("Window.onWindowConnect",{windowId:o,appName:e,chrome:r,innerRect:n,outerRect:i}),this.register({appName:e,chrome:r,id:o,innerRect:n,outerRect:i})}onWindowDisconnect({windowId:e}){this.unregister(e)}onWindowPositionChange(e){const t=this,o=t.get(e.windowId),{chrome:r,innerRect:n,outerRect:i}=t.calculateGeometry(e);o?(o.chrome=r,o.innerRect=n,o.outerRect=i):t.register({chrome:r,id:e.windowId,innerRect:n,outerRect:i})}toJSON(){return{className:this.className,windows:this.items.map(e=>({id:e.id,appName:e.appName,chrome:e.chrome,innerRect:e.innerRect,outerRect:e.outerRect}))}}}const a=Neo.setupClass(i)}};