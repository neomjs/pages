"use strict";(self.webpackChunkneo_mjs=self.webpackChunkneo_mjs||[]).push([[5457],{1842:(e,t,o)=>{o.d(t,{A:()=>a});var n=o(2583);class d extends n.A{static config={className:"Neo.util.Style"};static compareStyles(e,t){let o={};return Neo.isString(e)&&(e=Neo.createStyleObject(e)),Neo.isString(t)&&(t=Neo.createStyleObject(t)),e||t?t?e?(Object.keys(e).forEach((n=>{t.hasOwnProperty(n)&&t[n]===e[n]||(o[n]=e[n])})),Object.keys(t).forEach((t=>{e.hasOwnProperty(t)||(o[t]=null)})),Object.keys(o).length>0?o:null):void Object.keys(t).forEach((function(e){o[e]=null})):Neo.clone(e):null}}const a=Neo.setupClass(d)},5457:(e,t,o)=>{o.r(t),o.d(t,{default:()=>c});var n=o(2583),d=o(6270),a=o(8596),r=o(1842);class s{constructor(e){Object.assign(this,{attributes:e.attributes||[],childNodes:e.childNodes||[],className:e.className||[],id:e.id||Neo.getId("vnode"),innerHTML:e.innerHTML,nodeName:e.nodeName,style:e.style,vtype:e.vtype||"vnode"}),e.static&&(this.static=!0)}}Neo.ns("Neo.vdom",!0).VNode=s;const i=s;class l extends n.A{static config={className:"Neo.vdom.Helper",remote:{app:["create","update"]},singleton:!0};rawDimensionTags=new Set(["circle","clipPath","ellipse","filter","foreignObject","image","marker","mask","pattern","rect","svg","use"]);returnChildNodeOuterHtml=!1;voidAttributes=new Set(["checked","defer","disabled","ismap","multiple","nohref","noresize","noshade","nowrap","open","readonly","required","reversed","selected"]);voidElements=new Set(["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"]);create(e){let t,o=!0===e.autoMount,{appName:n,parentId:d,parentIndex:a,windowId:r}=e;return delete e.appName,delete e.autoMount,delete e.parentId,delete e.parentIndex,delete e.windowId,t=this.createVnode(e),t.outerHTML=this.createStringFromVnode(t),o&&Object.assign(t,{appName:n,autoMount:!0,parentId:d,parentIndex:a,windowId:r}),Neo.config.useVdomWorker?t:Promise.resolve(t)}createCloseTag(e){return this.voidElements.has(e.nodeName)?"":"</"+e.nodeName+">"}compareAttributes(e){let t,o,n,a,s,i,l,{deltas:c,oldVnode:p,vnode:m,vnodeMap:u}=e;return!p.componentId||p.id!==m.id&&p.componentId!==m.id?("text"===m.vtype&&m.innerHTML!==p.innerHTML?c.default.push({action:"updateVtext",id:m.id,parentId:u.get(m.id).parentNode.id,value:m.innerHTML}):(a=Object.keys(m),Object.keys(p).forEach((e=>{m.hasOwnProperty(e)?"attributes"===e&&Object.keys(p[e]).forEach((t=>{m[e].hasOwnProperty(t)||(m[e][t]=null)})):a.push(e)})),a.forEach((e=>{switch(o={},n=m[e],e){case"attributes":t={},Object.entries(n).forEach((([e,o])=>{p.attributes.hasOwnProperty(e)&&p.attributes[e]===o||null!==o&&!Neo.isString(o)&&Neo.isEmpty(o)||(t[e]=o)})),Object.keys(t).length>0&&(o.attributes=t,Object.entries(t).forEach((([e,t])=>{null!==t&&""!==t||delete m.attributes[e]})));break;case"nodeName":case"innerHTML":n!==p[e]&&(o[e]=n);break;case"style":s=r.A.compareStyles(n,p.style),s&&(o.style=s);break;case"className":p.className?(i=d.A.difference(n,p.className),l=d.A.difference(p.className,n)):(i=n,l=[]),(i.length>0||l.length>0)&&(o.cls={},i.length>0&&(o.cls.add=i),l.length>0&&(o.cls.remove=l))}Object.keys(o).length>0&&(o.id=m.id,c.default.push(o))}))),c):c}createDeltas(e){let{deltas:t={default:[],remove:[]},oldVnode:o,vnode:n}=e,d=o?.id||o?.componentId,a=n?.id;if(!n&&d)return t.remove.push({action:"removeNode",id:d}),t;if(n.static)return t;if(a!==d&&n.componentId!==o.componentId)throw new Error(`createDeltas() must get called for the same node. ${a}, ${d}`);let r,s,i,l,c=this,p=e.oldVnodeMap||c.createVnodeMap({vnode:o}),m=e.vnodeMap||c.createVnodeMap({vnode:n}),u=n.childNodes||[],h=o.childNodes||[],v=0,N=0,g=0,f=Math.max(u.length,h.length);if(c.compareAttributes({deltas:t,oldVnode:o,vnode:n,vnodeMap:m}),0===u.length&&h.length>1)return t.remove.push({action:"removeAll",parentId:a}),t;for(;v<f&&(r=u[v],i=h[v+N],r||i);v++)if(r&&i&&(r.id===i.id||r.componentId&&r.componentId===i.componentId))c.createDeltas({deltas:t,oldVnode:i,oldVnodeMap:p,vnode:r,vnodeMap:m});else{if(i){if(l=i.id||i.componentId,s=m.get(l),!s){c.removeNode({deltas:t,oldVnode:i,oldVnodeMap:p}),v--,g++;continue}if(r&&a!==s.parentNode.id){v--,N++;continue}}r&&(c.isMovedNode(r,p)?c.moveNode({deltas:t,insertDelta:g,oldVnodeMap:p,vnode:r,vnodeMap:m}):c.insertNode({deltas:t,index:v+g,oldVnodeMap:p,vnode:r,vnodeMap:m}),i&&a===m.get(l)?.parentNode.id&&f++)}return t}createOpenTag(e){let t,o="<"+e.nodeName,{attributes:n}=e,d=e.className;return e.style&&(t=Neo.createStyles(e.style),""!==t&&(o+=` style="${t}"`)),d&&(Array.isArray(d)&&(d=d.join(" ")),""!==d&&(o+=` class="${d}"`)),e.id&&(Neo.config.useDomIds?o+=` id="${e.id}"`:o+=` data-neo-id="${e.id}"`),Object.entries(n).forEach((([e,t])=>{this.voidAttributes.has(e)?"true"===t&&(o+=` ${e}`):"removeDom"!==e&&("value"===e&&(t=a.A.escapeHtml(t)),o+=` ${e}="${t?.replaceAll?.('"',"&quot;")??t}"`)})),o+">"}createStringFromVnode(e,t){let o=this,n=e?.id;if(n&&t?.get(n))return"";switch(e.vtype){case"root":return o.createStringFromVnode(e.childNodes[0],t);case"text":return void 0===e.innerHTML?"":String(e.innerHTML);case"vnode":return o.createOpenTag(e)+o.createTagContent(e,t)+o.createCloseTag(e);default:return""}}createTagContent(e,t){if(e.innerHTML)return e.innerHTML;let o,n,d="",a=e.childNodes?e.childNodes.length:0,r=0;for(;r<a;r++)o=e.childNodes[r],n=this.createStringFromVnode(o,t),o.innerHTML!==n&&this.returnChildNodeOuterHtml&&(o.outerHTML=n),d+=n;return d}createVnode(e){if(e.componentId)return e.id||(e.id=e.componentId),e;if(!0===e.removeDom)return null;if("text"===e.vtype)return e.id||(e.id=Neo.getId("vtext")),e.innerHTML=`\x3c!-- ${e.id} --\x3e${e.html||""}\x3c!-- /neo-vtext --\x3e`,delete e.html,e;let t,o=this,n={attributes:{},childNodes:[],style:{}};return e.tag||(e.tag="div"),Object.entries(e).forEach((([e,d])=>{let a,r,s;if(null!=d&&"flag"!==e)switch(e){case"tag":case"nodeName":n.nodeName=d;break;case"html":case"innerHTML":n.innerHTML=d.toString();break;case"children":case"childNodes":case"cn":Array.isArray(d)||(d=[d]),r=[],d.forEach((e=>{!0!==e.removeDom&&(delete e.removeDom,t=o.createVnode(e),t&&r.push(t))})),n.childNodes=r;break;case"cls":d&&!Array.isArray(d)?n.className=[d]:Array.isArray(d)&&d.length<1||(n.className=d);break;case"data":d&&"Object"===Neo.typeOf(d)&&Object.entries(d).forEach((([e,t])=>{n.attributes[`data-${Neo.decamel(e)}`]=t}));break;case"height":case"maxHeight":case"maxWidth":case"minHeight":case"minWidth":case"width":o.rawDimensionTags.has(n.nodeName)?n.attributes[e]=d+"":(a=d!=parseInt(d),n.style[e]=d+(a?"":"px"));break;case"componentId":case"id":case"static":n[e]=d;break;case"style":s=n.style,Neo.isString(d)?n.style=Object.assign(s,Neo.core.Util.createStyleObject(d)):n.style=Object.assign(s,d);break;default:"removeDom"!==e&&(n.attributes[e]=d+"")}})),new i(n)}createVnodeMap(e){let t,{vnode:o,parentNode:n=null,index:d=0,map:a=new Map}=e;return o&&(t=o.id||o.componentId,a.set(t,{id:t,index:d,parentNode:n,vnode:o}),o.childNodes?.forEach(((e,t)=>{this.createVnodeMap({vnode:e,parentNode:o,index:t,map:a})}))),a}findMovedNodes(e){let{movedNodes:t=new Map,oldVnodeMap:o,vnode:n,vnodeMap:d}=e,a=n?.id;return a&&(this.isMovedNode(n,o)?t.set(a,d.get(a)):n.childNodes?.forEach((e=>{"text"!==e.vtype&&this.findMovedNodes({movedNodes:t,oldVnodeMap:o,vnode:e,vnodeMap:d})}))),t}insertNode(e){let{deltas:t,index:o,oldVnodeMap:n,vnode:d,vnodeMap:a}=e,r=a.get(d.id).parentNode.id,s=this,i=s.findMovedNodes({oldVnodeMap:n,vnode:d,vnodeMap:a}),l=s.createStringFromVnode(d,i);t.default.push({action:"insertNode",index:o,outerHTML:l,parentId:r}),n.get(r).vnode.childNodes.splice(o,0,d),i.forEach((e=>{let{id:o}=e,d=e.parentNode.id;t.default.push({action:"moveNode",id:o,index:e.index,parentId:d}),s.createDeltas({deltas:t,oldVnode:n.get(o).vnode,oldVnodeMap:n,vnode:e.vnode,vnodeMap:a})}))}isMovedNode(e,t){let o=t.get(e.id);return o&&(!o.vnode.componentId||e.componentId===o.vnode.componentId)}moveNode(e){let{deltas:t,insertDelta:o,oldVnodeMap:n,vnode:a,vnodeMap:r}=e,s=r.get(a.id),{index:i,parentNode:l}=s,c=l.id,p=n.get(a.id),m=p.parentNode,{childNodes:u}=m;if(c!==m.id){d.A.remove(u,p.vnode);let e=n.get(c);e&&(p.parentNode=e.vnode,u=p.parentNode.childNodes)}t.default.push({action:"moveNode",id:a.id,index:i+o,parentId:c}),d.A.insert(u,i,p.vnode),this.createDeltas({deltas:t,oldVnode:p.vnode,oldVnodeMap:n,vnode:a,vnodeMap:r})}removeNode({deltas:e,oldVnode:t,oldVnodeMap:o}){t.componentId&&!t.id&&(t.id=t.componentId);let n={action:"removeNode",id:t.id},{parentNode:a}=o.get(t.id);"text"===t.vtype&&(n.parentId=a.id),e.remove.push(n),d.A.remove(a.childNodes,t)}update(e){let t=this.createVnode(e.vdom),o=this.createDeltas({oldVnode:e.vnode,vnode:t});o=o.default.concat(o.remove);let n={deltas:o,updateVdom:!0,vnode:t};return Neo.config.useVdomWorker?n:Promise.resolve(n)}}const c=Neo.setupClass(l)},8596:(e,t,o)=>{o.d(t,{A:()=>a});var n=o(2583);class d extends n.A{static charEntityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;",$:"&dollar;","\\":"&bsol;","/":"&sol;"};static charPattern=/[&<>"'$\\]/g;static entityPattern=/(&amp;)|(&lt;)|(&gt;)|(&quot;)|(&apos;)|(&dollar;)|(&bsol;)|(&sol;)/g;static config={className:"Neo.util.String"};static escapeHtml(e){let t=this;return Neo.isString(e)?e.replace(t.charPattern,t.getEntityFromChar.bind(t)):e}static getCharFromEntity(e){return Object.keys(this.charEntityMap).find((t=>this.charEntityMap[t]===e))||e}static getEntityFromChar(e){return this.charEntityMap[e]||e}static unescapeHtml(e){let t=this;return Neo.isString(e)?e.replace(t.entityPattern,t.getCharFromEntity.bind(t)):e}static uncapitalize(e){return e&&e[0].toLowerCase()+e.substring(1)}}const a=Neo.setupClass(d)}}]);