"use strict";(self.webpackChunkneo_mjs=self.webpackChunkneo_mjs||[]).push([[5457],{1842:(e,t,o)=>{o.d(t,{A:()=>a});var n=o(2583);class d extends n.A{static config={className:"Neo.util.Style"};static compareStyles(e,t){let o={};return Neo.isString(e)&&(e=Neo.createStyleObject(e)),Neo.isString(t)&&(t=Neo.createStyleObject(t)),e||t?t?(e&&Object.keys(e).forEach(n=>{t.hasOwnProperty(n)&&t[n]===e[n]||(o[n]=e[n])}),Object.keys(t).forEach(t=>{e&&e.hasOwnProperty(t)||(o[t]=null)}),Object.keys(o).length>0?o:null):Neo.clone(e):null}}const a=Neo.setupClass(d)},3994:(e,t,o)=>{o.d(t,{IY:()=>n,qd:()=>a,yL:()=>d});const n=new Set(["circle","clipPath","ellipse","filter","foreignObject","image","marker","mask","pattern","rect","svg","use"]),d=new Set(["checked","defer","disabled","ismap","multiple","nohref","noresize","noshade","nowrap","open","readonly","required","reversed","selected"]),a=new Set(["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"])},5457:(e,t,o)=>{o.r(t),o.d(t,{default:()=>m});var n=o(2583),d=o(6270),a=o(1842),r=o(3994),s=o(8596);function i(e){let t=[];return Neo.isString(e)?t=e.split(" ").filter(Boolean):Array.isArray(e)&&e.forEach(e=>{Neo.isString(e)&&(e.includes(" ")?t.push(...e.split(" ").filter(Boolean)):""!==e&&t.push(e))}),[...new Set(t)]}const c=Neo.gatekeep(class{constructor(e){let t=this,{textContent:o}=e,n=Object.hasOwn(e,"innerHTML"),d="text"===e.vtype;Object.assign(t,{childNodes:e.childNodes||[],id:e.id||Neo.getId(d?"vtext":"vnode"),vtype:e.vtype||"vnode"}),d?t.textContent=Neo.config.useDomApiRenderer?o:s.A.escapeHtml(o):(Object.assign(t,{attributes:e.attributes||{},className:i(e.className),nodeName:e.nodeName||"div",style:e.style||{}}),n?t.innerHTML=e.innerHTML:Object.hasOwn(e,"textContent")&&(t.textContent=Neo.config.useDomApiRenderer?o:s.A.escapeHtml(o))),e.static&&(t.static=!0)}},"Neo.vdom.VNode"),l=Neo.config;class p extends n.A{static config={className:"Neo.vdom.Helper",remote:{app:["create","update"]},singleton:!0};compareAttributes({deltas:e,oldVnode:t,vnode:o,vnodeMap:n}){if(o.componentId||t.componentId)return e;let r,s,i,c,l,p,m={};return"text"===o.vtype&&o.textContent!==t.textContent?e.default.push({action:"updateVtext",id:o.id,parentId:n.get(o.id).parentNode.id,value:o.textContent}):(i=Object.keys(o),Object.keys(t).forEach(e=>{Object.hasOwn(o,e)?"attributes"===e&&Object.keys(t[e]).forEach(t=>{Object.hasOwn(o[e],t)||(o[e][t]=null)}):i.push(e)}),i.forEach(e=>{switch(s=o[e],e){case"attributes":r={},Object.entries(s).forEach(([e,o])=>{const n=t.attributes[e];Object.hasOwn(t.attributes,e)&&n===o||null!==o&&!Neo.isString(o)&&Neo.isEmpty(o)||(r[e]=o)}),Object.keys(r).length>0&&(m.attributes=r,Object.entries(r).forEach(([e,t])=>{null!==t&&""!==t||delete o.attributes[e]}));break;case"nodeName":case"innerHTML":case"textContent":s!==t[e]&&(m[e]=s);break;case"style":c=a.A.compareStyles(s,t.style),c&&(m.style=c);break;case"className":t.className?(l=d.A.difference(s,t.className),p=d.A.difference(t.className,s)):(l=s,p=[]),(l.length>0||p.length>0)&&(m.cls={},l.length>0&&(m.cls.add=l),p.length>0&&(m.cls.remove=p))}}),Object.keys(m).length>0&&(m.id=o.id,e.default.push(m))),e}create(e){let t,o,{util:n}=Neo.vdom;if(o=this.createVnode(e.vdom),t={...e,vnode:o},delete t.vdom,!l.useDomApiRenderer){if(!n.StringFromVnode)throw new Error("VDom Helper render utilities are not loaded yet!");t.outerHTML=n.StringFromVnode.create(o)}return t}createDeltas(e){let{deltas:t={default:[],remove:[]},oldVnode:o,vnode:n}=e,d=n?.id;if(!n&&(o?.id||o?.componentId))return t.remove.push({action:"removeNode",id:o.id||o.componentId}),t;if(n.static)return t;if(n.id!==o.id||n.componentId!==o.componentId)throw new Error(`createDeltas() must be called for the same node. new: {id: ${n.id}, cId: ${n.componentId}}, old: {id: ${o.id}, cId: ${o.componentId}}`);let a,r,s,i,c=this,l=e.oldVnodeMap||c.createVnodeMap({vnode:o}),p=e.vnodeMap||c.createVnodeMap({vnode:n}),m=n.childNodes||[],h=o.childNodes||[],u=0,v=0,N=0,g=Math.max(m.length,h.length);if(c.compareAttributes({deltas:t,oldVnode:o,vnode:n,vnodeMap:p}),0===m.length&&h.length>1)return t.remove.push({action:"removeAll",parentId:d}),t;for(;u<g&&(a=m[u],s=h[u+v],a||s);u++)if(a&&s&&(!a.componentId&&!s.componentId&&a.id===s.id||a.componentId&&a.componentId===s.componentId)){if(a.neoIgnore){delete a.neoIgnore;continue}c.createDeltas({deltas:t,oldVnode:s,oldVnodeMap:l,vnode:a,vnodeMap:p})}else{if(s){if(i=s.id||s.componentId,r=p.get(i),!r){c.removeNode({deltas:t,oldVnode:s,oldVnodeMap:l}),u--,N++;continue}if(a&&d!==r.parentNode.id){u--,v++;continue}}a&&(c.isMovedNode(a,l)?c.moveNode({deltas:t,insertDelta:N,oldVnodeMap:l,vnode:a,vnodeMap:p}):c.insertNode({deltas:t,index:u+N,oldVnodeMap:l,vnode:a,vnodeMap:p}),s&&d===p.get(i)?.parentNode.id&&g++)}return t}createVnode(e){if(e.componentId)return e.childNodes??=[],e.id??=e.componentId,e;if(!0===e.removeDom)return null;let t,o=this,n={attributes:{},style:{}};return Object.entries(e).forEach(([e,d])=>{if(null!=d&&"flag"!==e&&"removeDom"!==e){let a,s,i;switch(e){case"tag":n.nodeName=d;break;case"cls":n.className=d;break;case"html":n.innerHTML=d.toString();break;case"text":n.textContent=d;break;case"cn":Array.isArray(d)||(d=[d]),s=[],d.filter(Boolean).forEach(e=>{!0!==e.removeDom&&(delete e.removeDom,t=o.createVnode(e),t&&s.push(t))}),n.childNodes=s;break;case"data":d&&"Object"===Neo.typeOf(d)&&Object.entries(d).forEach(([e,t])=>{n.attributes[`data-${Neo.decamel(e)}`]=t});break;case"height":case"maxHeight":case"maxWidth":case"minHeight":case"minWidth":case"width":r.IY.has(n.nodeName)?n.attributes[e]=d+"":(a=d!=parseInt(d),n.style[e]=d+(a?"":"px"));break;case"componentId":case"id":case"static":case"vtype":n[e]=d;break;case"style":i=n.style,Neo.isString(d)?n.style=Object.assign(i,Neo.core.Util.createStyleObject(d)):n.style=Object.assign(i,d);break;default:n.attributes[e]=d+""}}}),Object.keys(n.attributes).length<1&&delete n.attributes,Object.keys(n.style).length<1&&delete n.style,new c(n)}createVnodeMap({index:e=0,map:t=new Map,parentNode:o=null,vnode:n}){if(n){let d=n.id||n.componentId;t.set(d,{id:d,index:e,parentNode:o,vnode:n}),n.childNodes?.forEach((e,o)=>{this.createVnodeMap({index:o,map:t,parentNode:n,vnode:e})})}return t}findMovedNodes({movedNodes:e=new Map,oldVnodeMap:t,vnode:o,vnodeMap:n}){let d=o?.id;return d&&(this.isMovedNode(o,t)?e.set(d,n.get(d)):o.childNodes?.forEach(o=>{"text"!==o.vtype&&this.findMovedNodes({movedNodes:e,oldVnodeMap:t,vnode:o,vnodeMap:n})})),e}getPhysicalIndex(e,t){let o=t,n=0;for(;n<t;n++)"text"===e.childNodes[n]?.vtype&&(o+=2);return o}async importUtil(){const{util:e}=Neo.vdom;l.useDomApiRenderer?e?.DomApiVnodeCreator||await o.e(8910).then(o.bind(o,8910)):e?.StringFromVnode||await o.e(6839).then(o.bind(o,6839))}async initAsync(){super.initAsync();let e=this;l.unitTestMode||Neo.currentWorker.on({neoConfigChange:e.onNeoConfigChange,scope:e}),await e.importUtil()}insertNode({deltas:e,index:t,oldVnodeMap:o,vnode:n,vnodeMap:d}){let a=d.get(n.id),{parentNode:r}=a,s=r.id,i=this,c=i.findMovedNodes({oldVnodeMap:o,vnode:n,vnodeMap:d}),p={action:"insertNode",parentId:s};p.index=i.getPhysicalIndex(r,t),l.useDomApiRenderer?p.vnode=Neo.vdom.util.DomApiVnodeCreator.create(n,c):p.outerHTML=Neo.vdom.util.StringFromVnode.create(n,c),e.default.push(p),o.get(s).vnode.childNodes.splice(t,0,n),c.forEach(t=>{let{id:n}=t,a=t.parentNode.id;e.default.push({action:"moveNode",id:n,index:t.index,parentId:a}),i.createDeltas({deltas:e,oldVnode:o.get(n).vnode,oldVnodeMap:o,vnode:t.vnode,vnodeMap:d})})}isMovedNode(e,t){let o=t.get(e.id);return o&&(!o.vnode.componentId||e.componentId===o.vnode.componentId)}moveNode({deltas:e,insertDelta:t,oldVnodeMap:o,vnode:n,vnodeMap:a}){let r=a.get(n.id),{index:s,parentNode:i}=r,c=i.id,l=o.get(n.id),p=l.parentNode,{childNodes:m}=p,h={action:"moveNode",id:n.id,parentId:c},u=this.getPhysicalIndex(i,s);if(Object.assign(h,{index:u+t}),e.default.push(h),c!==p.id){d.A.remove(m,l.vnode);let e=o.get(c);e&&(l.parentNode=e.vnode,m=l.parentNode.childNodes)}d.A.insert(m,s,l.vnode),this.createDeltas({deltas:e,oldVnode:l.vnode,oldVnodeMap:o,vnode:n,vnodeMap:a})}async onNeoConfigChange(e){Object.hasOwn(e,"useDomApiRenderer")&&await this.importUtil()}removeNode({deltas:e,oldVnode:t,oldVnodeMap:o}){t.componentId&&(t.id??=t.componentId);let n={action:"removeNode",id:t.id},{parentNode:a}=o.get(t.id);"text"===t.vtype&&(n.parentId=a.id),e.remove.push(n),d.A.remove(a.childNodes,t)}update(e){let t,o,{util:n}=Neo.vdom;if(l.useDomApiRenderer){if(!n.DomApiVnodeCreator)throw new Error("Neo.vdom.Helper: DomApiVnodeCreator is not loaded yet for updates!")}else if(!n.StringFromVnode)throw new Error("Neo.vdom.Helper: StringFromVnode is not loaded yet for updates!");return o=this.createVnode(e.vdom),t=this.createDeltas({oldVnode:e.vnode,vnode:o}),t=t.default.concat(t.remove),{deltas:t,updateVdom:!0,vnode:o}}}const m=Neo.setupClass(p)},8596:(e,t,o)=>{o.d(t,{A:()=>a});var n=o(2583);class d extends n.A{static charEntityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;",$:"&dollar;","\\":"&bsol;","/":"&sol;"};static charPattern=/[&<>"'$\\]/g;static entityPattern=/(&amp;)|(&lt;)|(&gt;)|(&quot;)|(&apos;)|(&dollar;)|(&bsol;)|(&sol;)/g;static config={className:"Neo.util.String"};static escapeHtml(e){let t=this;return Neo.isString(e)?e.replace(t.charPattern,t.getEntityFromChar.bind(t)):e}static getCharFromEntity(e){return Object.keys(this.charEntityMap).find(t=>this.charEntityMap[t]===e)||e}static getEntityFromChar(e){return this.charEntityMap[e]||e}static unescapeHtml(e){let t=this;return Neo.isString(e)?e.replace(t.entityPattern,t.getCharFromEntity.bind(t)):e}static uncapitalize(e){return e&&e[0].toLowerCase()+e.substring(1)}}const a=Neo.setupClass(d)}}]);