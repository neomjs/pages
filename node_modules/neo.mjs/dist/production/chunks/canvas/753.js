"use strict";(self.webpackChunkneo_mjs=self.webpackChunkneo_mjs||[]).push([[753],{753(e,t,a){a.d(t,{default:()=>n});var l=a(247);const s="#3E63DD",o="#8BA6FF",r="#00BFFF",h=150;class i extends l.A{static config={className:"Portal.canvas.HomeCanvas",remote:{app:["clearGraph","initGraph","pause","resume","updateMouseState","updateSize"]},singleton:!0};agentBuffer=null;canvasId=null;canvasSize=null;context=null;gradients={};isPaused=!1;mouse={x:-1e3,y:-1e3};nodeBuffer=null;packetBuffer=null;shockwaves=[];sparks=[];time=0;clearGraph(){let e=this;e.context=null,e.canvasId=null,e.canvasSize=null,e.nodeBuffer=null,e.agentBuffer=null,e.packetBuffer=null,e.shockwaves=[],e.sparks=[],e.isPaused=!1,e.gradients={}}drawAgents(e){let t=this;if(!t.agentBuffer)return;const a=t.agentBuffer;e.strokeStyle=r,e.fillStyle="#FFFFFF",e.lineCap="round";for(let l=0;l<20;l++){let s=6*l,o=a[s],r=a[s+1],h=a[s+2],i=a[s+3],n=a[s+5];Math.sqrt(h*h+i*i)>.1&&(e.beginPath(),e.lineWidth=2,e.globalAlpha=.6,e.moveTo(o,r),e.lineTo(o-4*h,r-4*i),e.stroke()),e.beginPath(),e.globalAlpha=1===n?1:.8;let f=1===n?3:2;e.arc(o,r,f,0,2*Math.PI),e.fill(),1===n&&(e.beginPath(),e.lineWidth=1,e.globalAlpha=.3,e.arc(o,r,8+2*Math.sin(10*t.time),0,2*Math.PI),e.stroke())}e.globalAlpha=1}drawNetwork(e,t,a){let l=this;if(!l.nodeBuffer)return;const i=l.nodeBuffer,n=h,f=l.mouse.x,d=l.mouse.y,u=t/2,c=a/2;e.lineWidth=1;for(let t=0;t<n;t++){let a=9*t,l=i[a+5],h=i[a+6],p=2===l?.05:1===l?.02:.01,g=(-1e3!==f?f-u:0)*p,M=(-1e3!==d?d-c:0)*p,m=i[a]+g,k=i[a+1]+M;for(let a=t+1;a<n;a++){let n=9*a,p=i[n+5],g=i[n+6];if(!(h===g&&-1!==h||h===a||g===t||-1===h&&-1===g))continue;let M=2===p?.05:1===p?.02:.01,w=(-1e3!==f?f-u:0)*M,y=(-1e3!==d?d-c:0)*M,b=i[n]+w,v=i[n+1]+y,B=m-b,x=k-v,F=B*B+x*x;if(F<4e4){let t=Math.sqrt(F),a=1-t/200;a*=.2+.1*l;let h=(m+b)/2-f,i=(k+v)/2-d;h*h+i*i<1e4?(a=Math.min(a+.5,1),e.strokeStyle=r,e.lineWidth=1.5):(e.strokeStyle=2===l?s:o,e.lineWidth=1-t/200+.5),e.beginPath(),e.globalAlpha=.5*a,e.moveTo(m,k),e.lineTo(b,v),e.stroke()}}}for(let t=0;t<n;t++){let a=9*t,h=i[a+4],n=i[a+5],p=i[a+6],g=i[a+7],M=i[a+8],m=2===n?.05:1===n?.02:.01,k=(-1e3!==f?f-u:0)*m,w=(-1e3!==d?d-c:0)*m,y=i[a]+k,b=i[a+1]+w,v=y-f,B=b-d,x=Math.sqrt(v*v+B*B)<50;l.shockwaves.length>0&&l.shockwaves.forEach(e=>{let t=Math.sqrt((y-e.x)**2+(b-e.y)**2),a=e.age*e.speed;Math.abs(t-a)<20&&(x=!0)}),e.beginPath();let F=-1===p?1.5*h:h;F*=1+.15*Math.sin(2*l.time+g)+M,x&&(F*=1.5),e.arc(y,b,F,0,2*Math.PI),M>.1?(e.fillStyle=r,e.globalAlpha=Math.min(1,.5+M)):2===n?(e.fillStyle=x?"#FFFFFF":s,e.globalAlpha=x?1:.8):-2===p?(e.fillStyle=r,e.globalAlpha=.6+.3*Math.sin(10*l.time+g)):1===n?(e.fillStyle=x?r:o,e.globalAlpha=.5):(e.fillStyle="#808080",e.globalAlpha=.2),e.fill()}e.globalAlpha=1}drawPackets(e){if(!this.packetBuffer)return;const t=this.packetBuffer;e.fillStyle="#FFFFFF",e.shadowBlur=5,e.shadowColor=r;for(let a=0;a<20;a++){let l=5*a,s=t[l+4];if(s>0){let a=t[l],o=t[l+1];e.beginPath(),e.globalAlpha=Math.min(2*s,1),e.arc(a,o,2,0,2*Math.PI),e.fill()}}e.shadowBlur=0,e.globalAlpha=1}drawShockwaves(e){let t=this;if(0!==t.shockwaves.length){e.lineCap="round";for(let a=t.shockwaves.length-1;a>=0;a--){let l=t.shockwaves[a];l.age++;let o=l.age/l.maxAge;if(o>=1){t.shockwaves.splice(a,1);continue}let h=(1-Math.pow(1-o,3))*l.maxRadius,i=1-o;e.beginPath(),e.strokeStyle=r,e.globalAlpha=.8*i,e.lineWidth=4*(1-o),e.shadowBlur=10,e.shadowColor=r,e.arc(l.x,l.y,.99*h,0,2*Math.PI),e.stroke(),e.beginPath(),e.strokeStyle=s,e.globalAlpha=.8*i,e.lineWidth=4*(1-o),e.shadowBlur=10,e.shadowColor=s,e.arc(l.x,l.y,1.01*h,0,2*Math.PI),e.stroke(),e.beginPath(),e.strokeStyle="#FFFFFF",e.globalAlpha=i,e.lineWidth=6*(1-o),e.shadowBlur=20,e.shadowColor="#FFFFFF",e.arc(l.x,l.y,h,0,2*Math.PI),e.stroke(),e.fillStyle=s,e.globalAlpha=.05*i,e.fill()}e.shadowBlur=0,e.globalAlpha=1}}drawSparks(e){let t=this;if(0!==t.sparks.length){e.strokeStyle="#4B0082",e.shadowBlur=0,e.lineWidth=2;for(let a of t.sparks)e.globalAlpha=a.life,e.beginPath(),e.moveTo(a.x,a.y),e.lineTo(a.x-2*a.vx,a.y-2*a.vy),e.stroke();e.globalAlpha=1}}initAgents(e,t){let a=this;a.agentBuffer||(a.agentBuffer=new Float32Array(120));const l=a.agentBuffer;for(let a=0;a<20;a++){let s=6*a;l[s]=Math.random()*e,l[s+1]=Math.random()*t,l[s+2]=4*(Math.random()-.5),l[s+3]=4*(Math.random()-.5),l[s+4]=-1,l[s+5]=0}}initGraph({canvasId:e,windowId:t}){let a=this,l=a.canvasId!==e;a.canvasId=e;const s=()=>{const o=Neo.currentWorker.canvasWindowMap[e]?.[t];o?(a.context=o.getContext("2d"),a.updateSize({width:o.width,height:o.height}),l&&a.renderLoop()):setTimeout(s,50)};s()}initNodes(e,t){let a=this;a.nodeBuffer||(a.nodeBuffer=new Float32Array(1350));const l=a.nodeBuffer,s=e/2,o=t/2,r=(1+Math.sqrt(5))/2,i=.8*Math.sqrt(e*t/h),n=Math.floor(15);let f=[];for(let a=0;a<h;a++){let h=9*a,d=a<n;d&&f.push(a);let u=2*a*Math.PI*r,c=Math.sqrt(a)*i,p=s+c*Math.cos(u),g=o+c*Math.sin(u);p=(p%e+e)%e,g=(g%t+t)%t,l[h]=p,l[h+1]=g,l[h+2]=.2*(Math.random()-.5),l[h+3]=.2*(Math.random()-.5);let M=Math.floor(3*Math.random());l[h+5]=M,l[h+4]=d?4+2*M:2+1.5*M,l[h+6]=d?-1:-2,l[h+7]=Math.random()*Math.PI*2,l[h+8]=0}for(let e=n;e<h;e++){let t=9*e,a=l[t],s=l[t+1],o=1/0,r=-1;for(let e of f){let t=9*e,h=a-l[t],i=s-l[t+1],n=h*h+i*i;n<o&&(o=n,r=e)}l[t+6]=r}}initPackets(){this.packetBuffer||(this.packetBuffer=new Float32Array(100))}pause(){this.isPaused=!0}resume(){let e=this;e.isPaused&&(e.isPaused=!1,e.renderLoop())}renderLoop=this.render.bind(this);render(){let e=this;if(!e.context||e.isPaused)return;const t=e.context,a=e.canvasSize?.width||100,l=e.canvasSize?.height||50;e.time+=.01,e.nodeBuffer||e.initNodes(a,l),e.agentBuffer||e.initAgents(a,l),e.packetBuffer||e.initPackets(),e.updatePhysics(a,l),e.updateAgents(a,l),e.updatePackets(),e.updateSparks(),t.clearRect(0,0,a,l),e.gradients.bgGradient&&(t.fillStyle=e.gradients.bgGradient,t.fillRect(0,0,a,l)),e.drawNetwork(t,a,l),e.drawPackets(t),e.drawAgents(t),e.drawShockwaves(t),e.drawSparks(t),setTimeout(e.renderLoop,1e3/60)}updateMouseState(e){let t=this;if(e.leave)t.mouse.x=-1e3,t.mouse.y=-1e3;else if(void 0!==e.x&&(t.mouse.x=e.x),void 0!==e.y&&(t.mouse.y=e.y),e.click){t.shockwaves.push({x:e.x,y:e.y,age:0,maxAge:40,maxRadius:300});for(let a=0;a<40;a++){let a=Math.random()*Math.PI*2,l=15*Math.random()+5;t.sparks.push({x:e.x,y:e.y,vx:Math.cos(a)*l,vy:Math.sin(a)*l,life:1,decay:.02+.03*Math.random()})}}}updatePackets(){let e=this;if(!e.packetBuffer||!e.nodeBuffer)return;const t=e.packetBuffer,a=e.nodeBuffer;for(let e=0;e<20;e++){let l=5*e;if(t[l+4]<=0){if(Math.random()<.02){let e=9*Math.floor(150*Math.random()),s=a[e+6];if(-1!==s){let o=9*s,r=a[e],h=a[e+1],i=a[o]-r,n=a[o+1]-h,f=Math.sqrt(i*i+n*n);if(f<200){t[l]=r,t[l+1]=h;let e=4;t[l+2]=i/f*e,t[l+3]=n/f*e,t[l+4]=f/e}}}}else t[l]+=t[l+2],t[l+1]+=t[l+3],t[l+4]--}}updateSparks(){let e=this;for(let t=e.sparks.length-1;t>=0;t--){let a=e.sparks[t];a.x+=a.vx,a.y+=a.vy,a.vx*=.9,a.vy*=.9,a.life-=a.decay,a.life<=0&&e.sparks.splice(t,1)}}updateAgents(e,t){let a=this;if(!a.agentBuffer||!a.nodeBuffer)return;const l=a.agentBuffer,s=a.nodeBuffer,o=a.mouse.x,r=a.mouse.y;for(let a=0;a<20;a++){let h=6*a,i=l[h+4],n=l[h+5];if(-1===i||Math.random()<.005){const e=Math.floor(15);l[h+4]=Math.floor(Math.random()*e),i=l[h+4],l[h+5]=0}if(-1!==i&&0===n){let e=9*i,t=s[e],a=s[e+1],o=t-l[h],r=a-l[h+1],n=Math.sqrt(o*o+r*r);if(n<10)l[h+5]=1,l[h+2]*=.1,l[h+3]*=.1,s[e+8]=1;else{let e=.05;l[h+2]+=o/n*e,l[h+3]+=r/n*e}}else 1===n&&Math.random()<.02&&(l[h+4]=-1,l[h+5]=0,l[h+2]+=4*(Math.random()-.5),l[h+3]+=4*(Math.random()-.5));if(-1e3!==o){let e=l[h]-o,t=l[h+1]-r,a=e*e+t*t;if(a<1e4){let s=Math.sqrt(a),o=(100-s)/100;l[h+2]+=e/s*o*1.5,l[h+3]+=t/s*o*1.5,l[h+5]=0}}let f=Math.sqrt(l[h+2]**2+l[h+3]**2);f>4&&(l[h+2]*=4/f,l[h+3]*=4/f),l[h]+=l[h+2],l[h+1]+=l[h+3],l[h]<0&&(l[h]=e),l[h]>e&&(l[h]=0),l[h+1]<0&&(l[h+1]=t),l[h+1]>t&&(l[h+1]=0)}}updatePhysics(e,t){let a=this;if(!a.nodeBuffer)return;const l=a.nodeBuffer,s=a.mouse.x,o=a.mouse.y,r=Math.floor(15);for(let i=0;i<h;i++){let h=9*i,n=l[h+6],f=-1===n;if(!f&&(-2!==n&&Math.random()<5e-4&&(l[h+6]=-2,l[h+2]+=2*(Math.random()-.5),l[h+3]+=2*(Math.random()-.5)),-2===n)){l[h+2]+=.1*(Math.random()-.5),l[h+3]+=.1*(Math.random()-.5);for(let e=0;e<r;e++){let t=9*e,a=l[t],s=l[t+1];if(Math.sqrt((a-l[h])**2+(s-l[h+1])**2)<60){l[h+6]=e;break}}}if(!f&&-2!==l[h+6]){let e=9*n,t=l[e],a=l[e+1],s=t-l[h],o=a-l[h+1],r=Math.sqrt(s*s+o*o);if(r>50){let e=5e-4*(r-50);l[h+2]+=s*e,l[h+3]+=o*e}}if(-1e3!==s){let e=l[h]-s,t=l[h+1]-o,a=e*e+t*t;if(a<22500){let s=Math.sqrt(a),o=(150-s)/150;l[h+2]+=e/s*o*.5,l[h+3]+=t/s*o*.5}}if(a.shockwaves.length>0&&a.shockwaves.forEach(e=>{let t=e.age/e.maxAge;if(t<1){let a=(1-Math.pow(1-t,3))*e.maxRadius,s=l[h]-e.x,o=l[h+1]-e.y,r=Math.sqrt(s*s+o*o);if(Math.abs(r-a)<20){let e=1-t;l[h+2]+=s/r*e*10,l[h+3]+=o/r*e*10}}}),l[h+2]*=.95,l[h+3]*=.95,l[h+8]*=.99,f){let s=(Math.cos(.002*l[h]+.5*a.time)+Math.sin(.002*l[h+1]+.5*a.time))*Math.PI;l[h+2]+=.05*Math.cos(s),l[h+3]+=.05*Math.sin(s);let o=t/2,r=e/2-l[h],i=o-l[h+1],n=Math.sqrt(r*r+i*i),f=.4*Math.min(e,t);if(n>f){let e=.001*(n-f);l[h+2]+=r/n*e,l[h+3]+=i/n*e}}else Math.abs(l[h+2])<.2&&(l[h+2]+=.02*(Math.random()-.5)),Math.abs(l[h+3])<.2&&(l[h+3]+=.02*(Math.random()-.5));l[h]+=l[h+2],l[h+1]+=l[h+3];const d=20;l[h]<d&&(l[h]=d,l[h+2]*=-1),l[h]>e-d&&(l[h]=e-d,l[h+2]*=-1),l[h+1]<d&&(l[h+1]=d,l[h+3]*=-1),l[h+1]>t-d&&(l[h+1]=t-d,l[h+3]*=-1)}}updateResources(e,t){let a=this.context;if(!a)return;const l=a.createLinearGradient(0,0,e,t);l.addColorStop(0,"rgba(62, 99, 221, 0.05)"),l.addColorStop(1,"rgba(139, 166, 255, 0.05)"),this.gradients.bgGradient=l}updateSize(e){let t=this;t.canvasSize=e,t.context&&(t.context.canvas.width=e.width,t.context.canvas.height=e.height,t.initNodes(e.width,e.height),t.initAgents(e.width,e.height),t.updateResources(e.width,e.height))}}const n=Neo.setupClass(i)}}]);