"use strict";(self.webpackChunkneo_mjs=self.webpackChunkneo_mjs||[]).push([[96,942],{96:(e,t,a)=>{a.r(t),a.d(t,{default:()=>n});var i=a(583);class o extends i.A{static config={className:"Neo.main.addon.Base",isMainThreadAddon:!0,isReady_:!1,preloadFilesDelay:5e3};cache=[];isLoading=!1;loadingTimeoutId=null;construct(e){super.construct(e);let t=this;t.loadFiles&&(0===t.preloadFilesDelay?t.loadFiles():Neo.isNumber(t.preloadFilesDelay)&&(t.loadingTimeoutId=setTimeout(()=>{t.loadFiles()},t.preloadFilesDelay)))}afterSetIsReady(e,t){if(e){let e,t=this;t.cache.forEach(a=>{e=t[a.fn](a.data),a.resolve(e)}),t.cache=[]}}cacheMethodCall(e){let t=this;return t.isLoading||(t.loadingTimeoutId&&clearTimeout(t.loadingTimeoutId),t.loadingTimeoutId=null,t.loadFiles()),new Promise((a,i)=>{t.cache.push({...e,resolve:a})})}}const n=Neo.setupClass(o)},942:(e,t,a)=>{a.r(t),a.d(t,{default:()=>l});var i=a(96),o=a(392),n=a(160),s=a(49);const c={A:1,BUTTON:1};class r extends i.default{static config={className:"Neo.main.addon.Navigator",remote:{app:["navigateTo","subscribe","unsubscribe"]}};clickItem(e){if("function"==typeof e.click)e.click();else{const t=e.getBoundingClientRect(),a=t.x+t.width/2,i=t.y+t.height/2;e.dispatchEvent(new MouseEvent("click",{bubbles:!0,altKey:Neo.altKeyDown,ctrlKey:Neo.controlKeyDown,metaKey:Neo.metaKeyDown,shiftKey:Neo.shiftKeyDown,clientX:a,clientY:i}))}}fixItemFocusability(e){if(!e.subject.contains(e.eventSource))return;const t=Array.from(e.subject.querySelectorAll(e.selector)).reduce((e,t)=>{const a=s.A.query(t,s.A.isFocusable);return a&&e.push(a),e},[]),a=t[0]||e.subject.querySelector(e.selector);t.forEach(e=>e!==a&&(e.tabIndex=-1)),a&&(a.tabIndex=0)}navigateClickHandler(e,t){let a=e.target.closest(t.selector);a&&!t.findFocusable(a)&&this.navigateTo(a,t)}navigateFocusInHandler(e,t){let a=e.target.closest(t.selector),{relatedTarget:i}=e,{subject:o}=t;a&&(this.setActiveItem(a,t),o.contains(i)&&(i.tabIndex=-1))}navigateFocusOutHandler(e,t){let{target:a}=e;a.closest(t.selector)?.classList.remove(t.activeCls),s.A.isTabbable(a)||(a.tabIndex=0)}navigateGetAdjacent(e=1,t){let{treeWalker:a}=t;if(a.currentNode=this.navigatorGetActiveItem(t)||t.subject,a[e<0?"previousNode":"nextNode"](),a.currentNode){if(a.currentNode!==t.activeItem)return a.currentNode}else if(!1!==t.wrap){const a=t.subject.querySelector(t.selector);return a[1===e?0:a.length-1]}}navigateKeyDownHandler(e,t){const a=this,{subject:i,wrap:o}=t,n=i.querySelector(t.selector);if(!t.nextKey&&n){const e=getComputedStyle(i),a=getComputedStyle(n);"flex"===e.display&&"row"===e.flexDirection||"inline"===a.display||"inline-block"===a.display?(t.previousKey="ArrowLeft",t.nextKey="ArrowRight"):(t.previousKey="ArrowUp",t.nextKey="ArrowDown")}let s,{key:r,target:l}=e;switch(r){case t.previousKey:s=a.navigateGetAdjacent(-1,t),!s&&o&&(s=i.querySelector(`${t.selector}:last-of-type`));break;case t.nextKey:s=a.navigateGetAdjacent(1,t),!s&&o&&(s=i.querySelector(t.selector));break;case"Home":s=i.querySelector(t.selector);break;case"End":s=i.querySelector(`${t.selector}:last-of-type`);break;case"Enter":t.activeItem&&!c[l.tagName]&&this.clickItem(t.activeItem)}s&&(e.preventDefault(),a.navigateTo(s,t))}navigateMouseDownHandler(e,t){const a=e.target.closest(t.selector);a&&!t.findFocusable(a)&&e.preventDefault()}navigateNodeFilter(e,t){return e.offsetParent&&e.matches?.(t.selector)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}navigateTargetChildListChange(e,t){if(this.fixItemFocusability(t),t.keepFocusIndex&&t.activeItem&&!t.subject.contains(t.activeItem)){const e=t.subject.querySelectorAll(t.selector);e.length&&this.navigateTo(e[Math.max(Math.min(t.activeIndex,e.length-1),0)],t)}}navigateTo(e,t){if(!t.subject&&!(t=o.A.getElement(t.id)?.$navigator))return;if("number"==typeof e?e=t.subject.querySelectorAll(t.selector)?.[e]:"string"==typeof e&&(e=o.A.getElement(e)),!e)return;e.scrollIntoView({behavior:"smooth",block:"nearest"});const a=s.A.query(e,s.A.isFocusable);a?a.focus({preventScroll:!0}):this.setActiveItem(e,t)}navigatorGetActiveItem(e){let t=e.activeItem&&o.A.getElement(e.activeItem.id)||null;if(!t&&"activeIndex"in e){const a=e.subject.querySelectorAll(e.selector);t=a[Math.max(Math.min(e.activeIndex,a.length-1),0)]}return t}setActiveItem(e,t){const a=Array.from(t.subject.querySelectorAll(t.selector));"number"==typeof e&&(e=a[Math.max(Math.min(e,a.length-1),0)]),t.previousActiveIndex=t.activeIndex,(t.previousActiveItem=t.activeItem)?.classList.remove(t.activeCls),(t.activeItem=e)?.classList.add(t.activeCls),t.activeIndex=e?a.indexOf(e):-1,e.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"}),(t.eventSource||t.subject).setAttribute("aria-activedescendant",t.activeItem.id),t.activeItem!==t.previousActiveItem&&n.A.sendMessageToApp({type:"neonavigate",target:t.id,path:[{id:t.id}],activeItem:t.activeItem.id,previousActiveItem:t.previousActiveItem?.id,activeIndex:t.activeIndex,previousActiveIndex:t.previousActiveIndex,altKey:Neo.altKeyDown,ctrlKey:Neo.controlKeyDown,metaKey:Neo.metaKeyDown,shiftKey:Neo.shiftKeyDown}),t.autoClick&&this.clickItem(e)}subscribe(e){const t=this,a=e.subject=o.A.getElement(e.id),i=e.eventSource=e.eventSource?o.A.getElement(e.eventSource):a;a&&(a.$navigator=e,e.activeCls||(e.activeCls="neo-navigator-active-item"),t.fixItemFocusability(e),e.findFocusable=t=>s.A.closest(t,t=>s.A.isFocusable(t)&&a.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY&&t.closest(e.selector)),e.treeWalker=document.createTreeWalker(a,NodeFilter.SHOW_ELEMENT,a=>t.navigateNodeFilter(a,e)),(e.targetMutationMonitor=new MutationObserver(a=>t.navigateTargetChildListChange(a,e))).observe(a,{childList:!0,subtree:!0}),i.addEventListener("keydown",e.l1=a=>t.navigateKeyDownHandler(a,e)),a.addEventListener("mousedown",e.l2=a=>t.navigateMouseDownHandler(a,e)),a.addEventListener("click",e.l3=a=>t.navigateClickHandler(a,e)),a.addEventListener("focusin",e.l4=a=>t.navigateFocusInHandler(a,e)),a.addEventListener("focusout",e.l5=a=>t.navigateFocusOutHandler(a,e)))}unsubscribe(e){const t=o.A.getElement(e.id);e=t?.$navigator,e&&(delete t.$navigator,e.targetMutationMonitor.disconnect(),e.eventSource.removeEventListener("keydown",e.l1),t.removeEventListener("mousedown",e.l2),t.removeEventListener("click",e.l3),t.removeEventListener("focusin",e.l4),t.removeEventListener("focusout",e.l5))}}const l=Neo.setupClass(r)}}]);