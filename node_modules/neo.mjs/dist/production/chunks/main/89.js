"use strict";(self.webpackChunkneo_mjs=self.webpackChunkneo_mjs||[]).push([[89,96],{89:(e,s,t)=>{t.r(s),t.d(s,{default:()=>i});var a=t(96);class l extends a.default{static config={className:"Neo.main.addon.PrefixField",accept_:null,pattern_:null,remote:{app:["initialize","destroy","updateAccept","updatePattern","updateSlots"]},slots_:null};elIds=new Map;prev;back=!1;destroy(){}initialize(e){const s=this;s.elId=e.elId,s.el=document.getElementById(e.elId);const t=s.pattern=e.pattern,a=s.slots=new Set(e.slots||"_");var l;s.accept=e.accept,s.prev=(l=0,Array.from(t,(e,s)=>a.has(e)?l=s+1:l)),s.first=[...t].findIndex(e=>a.has(e)),s.addListeners(),s.addCss()}addCss(){this.el.classList.add("tiny-prefix-field-input")}addListeners(){const e=this,s=e.el,t=e.format.bind(e);s.addEventListener("keypress",e.onKeyDown.bind(e)),s.addEventListener("input",t),s.addEventListener("focusin",t),s.addEventListener("focusout",e.onBlur.bind(e))}onBlur(){const e=this.pattern,s=this.el;return s.value===e&&(s.value="")}onKeyDown(e){this.back="Backspace"===e.key}clean(e){this.el;const s=new RegExp(this.accept||"\\d","g"),t=this.pattern,a=this.slots;return e=e.match(s)||[],Array.from(t,s=>(e[0]===s||a.has(s))&&e.shift()||s)}format(){const e=this,s=this.el,t=this.prev,a=this.clean.bind(this);console.log(s.selectionStart,s.selectionEnd);const[l,i]=[s.selectionStart,s.selectionEnd].map(l=>(l=a(s.value.slice(0,l)).findIndex(s=>e.slots.has(s)))<0?t[t.length-1]:e.back?t[l-1]||e.first:l);s.value=a(s.value).join``,s.setSelectionRange(l,i),this.back=!1}}const i=Neo.setupClass(l)},96:(e,s,t)=>{t.r(s),t.d(s,{default:()=>i});var a=t(110);class l extends a.A{static config={className:"Neo.main.addon.Base",isMainThreadAddon:!0,preloadFilesDelay:5e3};cache=[];get isLoading(){return!!this.#e&&!!this.#s}#e=null;#s=null;construct(e){super.construct(e);let s=this;if(s.#e=new Promise(e=>{s.#s=e}),!1===s.preloadFilesDelay)s.#s(),s.#s=null;else{const e=Neo.isNumber(s.preloadFilesDelay)?s.preloadFilesDelay:0;0===e?s.#t():s.timeout(e).then(()=>{s.#s&&s.#t()})}}async#t(){let e=this;if(e.#s){const s=e.#s;e.#s=null,await e.loadFiles(),s()}}async initAsync(){await super.initAsync(),await this.#e}afterSetIsReady(e,s){e&&this.#a()}cacheMethodCall(e){let s=this;return s.#s&&s.#t(),new Promise((t,a)=>{s.cache.push({...e,reject:a,resolve:t})})}async loadFiles(){}onInterceptRemotes(e){return this.cacheMethodCall({fn:e.remoteMethod,data:e.data})}async#a(){let e=this;for(const s of e.cache){let t;try{t=e[s.fn](s.data),Neo.isPromise(t)&&(t=await t),s.resolve(t)}catch(e){s.reject(e);break}}e.cache=[]}}const i=Neo.setupClass(l)}}]);