"use strict";(self.webpackChunkneo_mjs=self.webpackChunkneo_mjs||[]).push([[96,803],{803(e,a,o){o.r(a),o.d(a,{default:()=>i});var s=o(1096),t=o(4392),l=o(9160);o(5691);class r extends s.default{static observable=!0;static config={className:"Neo.main.addon.GoogleMaps",remote:{app:["addMarker","create","destroyMarkers","geocode","hideMarker","panTo","removeMap","removeMarker","setCenter","setZoom","showMarker"]}};geoCoder=null;maps={};markers={};addMarker(e){let a,o,s=this,{mapId:t}=e;s.maps[t]?(Neo.ns(`${t}`,!0,s.markers),s.markers[t][e.id]=o=new google.maps.Marker({icon:e.icon,label:e.label,map:s.maps[t],neoId:e.id,neoMapId:t,position:e.position,title:e.title}),o.addListener("click",s.onMarkerClick.bind(s,o))):a=s.on("mapCreated",o=>{t===o&&(s.un(a),s.addMarker(e))})}create(e){let a,o=this,{id:s}=e;o.maps[s]=a=new google.maps.Map(t.A.getElement(s),{center:e.center,fullscreenControl:e.fullscreenControl,maxZoom:e.maxZoom,minZoom:e.minZoom,zoom:e.zoom,zoomControl:e.zoomControl,...e.mapOptions}),a.addListener("zoom_changed",o.onMapZoomChange.bind(o,a,s)),o.fire("mapCreated",s)}destroyMarkers(e){let a=this.markers[e.mapId]||{};Object.values(a).forEach(e=>e.setMap(null)),delete this.markers[e.mapId]}async geocode(e){let a,o=this;return o.geoCoder||(o.geoCoder=new google.maps.Geocoder),a=await o.geoCoder.geocode(e),JSON.parse(JSON.stringify(a))}hideMarker(e){this.markers[e.mapId][e.id].setMap(null)}async loadFiles(){let e=Neo.config.googleMapsApiKey;await t.A.loadScript(` https://maps.googleapis.com/maps/api/js?key=${e}&v=weekly&callback=Neo.emptyFn`)}onMapZoomChange(e,a){l.A.sendMessageToApp({id:a,path:[{cls:[],id:a}],type:"googleMapZoomChange",value:e.zoom})}onMarkerClick(e,a){let o=l.A.getMouseEventData(a.domEvent);l.A.sendMessageToApp({id:e.neoId,path:[{cls:[],id:e.neoMapId}],type:"googleMarkerClick",domEvent:o})}panTo(e){this.maps[e.mapId].panTo(e.position)}removeMap(e){delete this.maps[e.mapId],delete this.markers[e.mapId]}removeMarker(e){let a=this.markers[e.mapId];a[e.id].setMap(null),delete a[e.id]}setCenter(e){this.maps[e.id].setCenter(e.value)}setZoom(e){this.maps[e.id].setZoom(e.value)}showMarker(e){this.markers[e.mapId][e.id].setMap(this.maps[e.mapId])}}const i=Neo.setupClass(r)},1096(e,a,o){o.r(a),o.d(a,{default:()=>l});var s=o(8247);class t extends s.A{static config={className:"Neo.main.addon.Base",isMainThreadAddon:!0,preloadFilesDelay:5e3,remote:{app:["loadFiles"]},useLazyLoading:!1};cache=[];get isLoading(){return!!this.#e&&!!this.#a}#e=null;#a=null;construct(e){super.construct(e);let a=this;if(a.#e=new Promise(e=>{a.#a=e}),a.useLazyLoading);else if(!1===a.preloadFilesDelay)a.#a(),a.#a=null;else{const e=Neo.isNumber(a.preloadFilesDelay)?a.preloadFilesDelay:0;0===e?a.#o():a.timeout(e).then(()=>{a.#a&&a.#o()})}}async#o(){let e=this;if(e.#a){const a=e.#a;e.#a=null,await e.loadFiles(),a()}}async initAsync(){await super.initAsync(),await this.#e}afterSetIsReady(e,a){super.afterSetIsReady(e,a),e&&this.#s()}cacheMethodCall(e){let a=this;return a.#a&&a.#o(),new Promise((o,s)=>{a.cache.push({...e,reject:s,resolve:o})})}async loadFiles(){}onInterceptRemotes(e){return this.cacheMethodCall({fn:e.remoteMethod,data:e.data})}async#s(){let e=this;for(const a of e.cache){let o;try{o=e[a.fn](a.data),Neo.isPromise(o)&&(o=await o),a.resolve(o)}catch(e){a.reject(e);break}}e.cache=[]}}const l=Neo.setupClass(t)}}]);