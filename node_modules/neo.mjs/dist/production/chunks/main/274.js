"use strict";(self.webpackChunkneo_mjs=self.webpackChunkneo_mjs||[]).push([[96,274],{96:(e,a,s)=>{s.r(a),s.d(a,{default:()=>r});var o=s(583);class i extends o.A{static config={className:"Neo.main.addon.Base",isMainThreadAddon:!0,isReady_:!1,preloadFilesDelay:5e3};cache=[];isLoading=!1;loadingTimeoutId=null;construct(e){super.construct(e);let a=this;a.loadFiles&&(0===a.preloadFilesDelay?a.loadFiles():Neo.isNumber(a.preloadFilesDelay)&&(a.loadingTimeoutId=setTimeout((()=>{a.loadFiles()}),a.preloadFilesDelay)))}afterSetIsReady(e,a){if(e){let e,a=this;a.cache.forEach((s=>{e=a[s.fn](s.data),s.resolve(e)})),a.cache=[]}}cacheMethodCall(e){let a=this;return a.isLoading||(a.loadingTimeoutId&&clearTimeout(a.loadingTimeoutId),a.loadingTimeoutId=null,a.loadFiles()),new Promise(((s,o)=>{a.cache.push({...e,resolve:s})}))}}const r=Neo.setupClass(i)},274:(e,a,s)=>{s.r(a),s.d(a,{default:()=>t});var o=s(96),i=s(126);class r extends o.default{static config={className:"Neo.main.addon.ServiceWorker"};construct(e){super.construct(e),this.registerServiceWorker()}async registerServiceWorker(){if("serviceWorker"in navigator){let e=this,{config:a}=Neo,s="development"===a.environment,o=s?"ServiceWorker.mjs":"serviceworker.js",r=window.location.pathname.includes("/examples/")?"examples/":"apps/",t=s?{type:"module"}:{},n=(s?a.basePath:a.workerBasePath)+(s?r:"")+o,{serviceWorker:d}=navigator,l=await d.register(n,t);window.addEventListener("beforeunload",e.onBeforeUnload.bind(e)),l.addEventListener("updatefound",(()=>{window.location.reload()})),await d.ready,d.onmessage=i.A.onWorkerMessage.bind(i.A),i.A.getWorker("service")||(i.A.serviceWorker=l.active),i.A.sendMessage("service",{action:"registerNeoConfig",data:a})}}onBeforeUnload(){i.A.sendMessage("service",{action:"unregisterPort"})}}const t=Neo.setupClass(r)}}]);