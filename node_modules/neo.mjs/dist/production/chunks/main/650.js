"use strict";(self.webpackChunkneo_mjs=self.webpackChunkneo_mjs||[]).push([[96,650],{1096(e,t,o){o.r(t),o.d(t,{default:()=>l});var n=o(8247);class r extends n.A{static config={className:"Neo.main.addon.Base",isMainThreadAddon:!0,preloadFilesDelay:5e3};cache=[];get isLoading(){return!!this.#e&&!!this.#t}#e=null;#t=null;construct(e){super.construct(e);let t=this;if(t.#e=new Promise(e=>{t.#t=e}),!1===t.preloadFilesDelay)t.#t(),t.#t=null;else{const e=Neo.isNumber(t.preloadFilesDelay)?t.preloadFilesDelay:0;0===e?t.#o():t.timeout(e).then(()=>{t.#t&&t.#o()})}}async#o(){let e=this;if(e.#t){const t=e.#t;e.#t=null,await e.loadFiles(),t()}}async initAsync(){await super.initAsync(),await this.#e}afterSetIsReady(e,t){super.afterSetIsReady(e,t),e&&this.#n()}cacheMethodCall(e){let t=this;return t.#t&&t.#o(),new Promise((o,n)=>{t.cache.push({...e,reject:n,resolve:o})})}async loadFiles(){}onInterceptRemotes(e){return this.cacheMethodCall({fn:e.remoteMethod,data:e.data})}async#n(){let e=this;for(const t of e.cache){let o;try{o=e[t.fn](t.data),Neo.isPromise(o)&&(o=await o),t.resolve(o)}catch(e){t.reject(e);break}}e.cache=[]}}const l=Neo.setupClass(r)},1650(e,t,o){o.r(t),o.d(t,{default:()=>i});var n=o(1096),r=o(4392),l=o(9160),s=o(1406);class a extends n.default{static config={className:"Neo.main.addon.DragDrop",allowOverdrag:!1,alwaysFireDragMove:!1,bodyCursorStyle:null,boundaryContainerRect:null,clientX:0,clientY:0,dragElementRootId:null,dragProxyCls:"neo-dragproxy",dragProxyElement:null,dragProxyRect:null,dragZoneId:null,dropZoneIdentifier:null,initialScrollLeft:0,initialScrollTop:0,isWindowDragging:!1,moveHorizontal:!0,moveVertical:!0,offsetX:0,offsetY:0,popupName:null,remote:{app:["requestWindowManagementPermission","setConfigs","setDragProxyElement","startWindowDrag"]},scrollContainerElement:null,scrollContainerRect:null,scrollFactorLeft:1,scrollFactorTop:1};construct(e){super.construct(e);let t=this,n=[];l.A.on({mouseEnter:t.onMouseEnter,mouseLeave:t.onMouseLeave,scope:t}),t.addGlobalEventListeners(),Neo.config.hasMouseEvents&&n.push(o.e(588).then(o.bind(o,5588))),Neo.config.hasTouchEvents&&n.push(o.e(176).then(o.bind(o,2176))),Promise.all(n).then(e=>{e.forEach(e=>{Neo.create({module:e.default})})})}addGlobalEventListeners(){let e=this;document.addEventListener("drag:end",e.onDragEnd.bind(e),!0),document.addEventListener("drag:move",e.onDragMove.bind(e),!0),document.addEventListener("drag:start",e.onDragStart.bind(e),!0)}getEventData(e){let t=e.path||e.composedPath(),o=e.detail,n={...l.A.getEventData(e.detail.originalEvent),clientX:o.clientX,clientY:o.clientY};return o.eventPath?n.targetPath=o.eventPath.map(e=>l.A.getTargetData(e)):n.targetPath=n.path,n.path=t.map(e=>l.A.getTargetData(e)),n}onDragEnd(e){let t=this,o=t.getEventData(e),n=t.pathIncludesDropZone(o.targetPath);t.bodyCursorStyle&&r.A.setStyle({id:"document.body",style:{cursor:null}}),l.A.sendMessageToApp({...o,dragZoneId:t.dragZoneId,isDrop:n,offsetX:t.offsetX,offsetY:t.offsetY,type:"drag:end"}),n&&l.A.sendMessageToApp({...l.A.getMouseEventData(e.detail.originalEvent),dragZoneId:t.dragZoneId,type:"drop"}),Object.assign(t,{alwaysFireDragMove:!1,bodyCursorStyle:null,boundaryContainerRect:null,dragElementRootId:null,dragElementRootRect:null,dragProxyCls:"neo-dragproxy",dragProxyElement:null,dragZoneId:null,dropZoneIdentifier:null,initialScrollLeft:0,initialScrollTop:0,isWindowDragging:!1,moveHorizontal:!0,moveVertical:!0,popupHeight:null,popupName:null,popupWidth:null,scrollContainerElement:null,scrollContainerRect:null,setScrollFactorLeft:1,scrollFactorTop:1,windowName:null})}onDragMove(e){let t,o,n,r=this,{originalEvent:s}=e.detail,a=r.dragProxyRect,i=r.boundaryContainerRect;if(r.isWindowDragging){const t=s.screenX-(r.offsetX||0),o=s.screenY-(r.offsetY||0);return Neo.Main.windowMoveTo({windowName:r.popupName,x:t,y:o}),void l.A.sendMessageToApp({...r.getEventData(e),dragZoneId:r.dragZoneId,offsetX:r.offsetX,offsetY:r.offsetY,proxyRect:new DOMRect(t-window.screenX,o-window.screenY,r.popupWidth,r.popupHeight),screenX:s.screenX,screenY:s.screenY,type:"drag:move"})}if(r.scrollContainerElement&&(t=r.scrollContainer({clientX:e.detail.clientX,clientY:e.detail.clientY}),e.detail.clientX=t.clientX,e.detail.clientY=t.clientY),r.dragProxyElement&&(o=e.detail.clientX-r.offsetX,n=e.detail.clientY-r.offsetY,i&&!r.allowOverdrag&&(o<i.left?o=i.left:o>i.right-a.width&&(o=i.right-a.width),n<i.top?n=i.top:n>i.bottom-a.height&&(n=i.bottom-a.height)),r.moveHorizontal&&(r.dragProxyElement.style.left=`${o}px`),r.moveVertical&&(r.dragProxyElement.style.top=`${n}px`)),!r.dragProxyElement||r.alwaysFireDragMove){let t=e.detail.originalEvent;if(a=null,r.dragProxyElement){const{height:e,width:t}=r.dragProxyElement.getBoundingClientRect();a=new DOMRect(o,n,t,e)}l.A.sendMessageToApp({...r.getEventData(e),dragZoneId:r.dragZoneId,offsetX:r.offsetX,offsetY:r.offsetY,proxyRect:a,screenX:t.screenX,screenY:t.screenY,type:"drag:move"})}}onDragStart(e){let t=e.target.getBoundingClientRect();Object.assign(this,{dragProxyRect:t,offsetX:e.detail.clientX-t.left,offsetY:e.detail.clientY-t.top}),l.A.sendMessageToApp({...this.getEventData(e),type:"drag:start"})}onMouseEnter(e){this.pathIncludesDropZone(e.path)&&l.A.sendMessageToApp({...e,dragZoneId:this.dragZoneId,type:"drop:enter"})}onMouseLeave(e){this.pathIncludesDropZone(e.path)&&l.A.sendMessageToApp({...e,dragZoneId:this.dragZoneId,type:"drop:leave"})}pathIncludesDropZone(e){let t,o,n=!0,r=this.dropZoneIdentifier;if(r){t=r.cls,o=r.ids;for(const r of e){if(t){n=!1;for(const e of r.cls)if(t.includes(e)){n=!0;break}}if(n&&o&&!o.includes(r.id)&&(n=!1),n)return!0}}return!1}async requestWindowManagementPermission(){if(!window.isSecureContext||!("getScreenDetails"in window))return{success:!1,error:"The Window Management API requires a secure context (HTTPS or localhost) and is not supported by this browser."};try{return await window.getScreenDetails(),{success:!0}}catch(e){return"PermissionDeniedError"===e.name?{success:!1,error:"Permission to manage windows was denied."}:{success:!1,error:`An unknown error occurred: ${e.message}`}}}scrollContainer(e){let t=this,o=e.clientX-t.clientX,n=e.clientY-t.clientY,r=t.scrollContainerElement,l=250,s=t.scrollContainerRect;return t.clientX=e.clientX,t.clientY=e.clientY,(o<0&&e.clientX<s.left+l||o>0&&e.clientX>s.right-l)&&(r.scrollLeft+=o*t.scrollFactorLeft),(n<0&&e.clientY<s.top+l||n>0&&e.clientY>s.bottom-l)&&(r.scrollTop+=n*t.scrollFactorTop),{clientX:t.clientX+r.scrollLeft-t.initialScrollLeft,clientY:t.clientY+r.scrollTop-t.initialScrollTop}}setConfigs(e){let t,o,n=this,{boundaryContainerId:l}=e;return delete e.appName,delete e.windowId,l&&(o=r.A.getBoundingClientRect({id:l}),Array.isArray(l)?n.boundaryContainerRect=s.A.getIntersection(...o):n.boundaryContainerRect=o),delete e.boundaryContainerId,e.scrollContainerId&&(t=r.A.getElementOrBody(e.scrollContainerId),Object.assign(n,{scrollContainerElement:t,scrollContainerRect:t.getBoundingClientRect(),initialScrollLeft:t.scrollLeft,initialScrollTop:t.scrollTop})),delete e.scrollContainerId,Object.entries(e).forEach(([e,t])=>{n.hasOwnProperty(e)?n[e]=t:console.error("unknown key passed inside setConfigs()",e)}),n.bodyCursorStyle&&r.A.setStyle({id:"document.body",style:{cursor:n.bodyCursorStyle}}),{boundaryContainerRect:n.boundaryContainerRect||null}}setDragProxyElement(e){this.dragProxyElement=document.getElementById(e.id)}startWindowDrag({popupHeight:e,popupName:t,popupWidth:o}){Object.assign(this,{isWindowDragging:!0,popupHeight:e,popupName:t,popupWidth:o})}}const i=Neo.setupClass(a)}}]);