{"classData":[{"comment":"/**\n * @summary User Enrichment & Filtering Service.\n *\n * This service is the \"Worker Bee\" of the pipeline. It takes a batch of raw usernames (from the Tracker)\n * and turns them into rich, structured data profiles for the application.\n *\n * **Core Workflow:**\n * 1.  **Fetch:** Queries GitHub (GraphQL) for the user's profile and a multi-year contribution history matrix.\n * 2.  **Enrich:** Augments the profile with Organization memberships via the REST API.\n * 3.  **Filter:** Applies the \"Meritocracy Logic\". If a user falls below the `minTotalContributions` threshold\n *     (and is not allowlisted), they are marked for immediate deletion from the Tracker (\"Active Pruning\").\n *     **Dynamic Threshold:** Once the database hits the `maxUsers` cap (managed by `Storage`), this\n *     threshold dynamically rises to match the lowest performer in the database, ensuring only superior\n *     candidates displace existing ones.\n * 4.  **Persist:** Saves valid users to the Rich Data Store and updates their timestamp in the Tracker.\n * 5.  **Rescue:** Handles \"Not Found\" or \"Bot\" errors by setting a dummy timestamp to prevent infinite retry loops.\n *\n * @class DevIndex.services.Updater\n * @extends Neo.core.Base\n * @singleton\n */","meta":{"filename":"Updater.mjs","lineno":8,"columnno":0,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/apps/devindex/services","code":{}},"summary":"User Enrichment & Filtering Service.\n\nThis service is the \"Worker Bee\" of the pipeline. It takes a batch of raw usernames (from the Tracker)\nand turns them into rich, structured data profiles for the application.\n\n**Core Workflow:**\n1.  **Fetch:** Queries GitHub (GraphQL) for the user's profile and a multi-year contribution history matrix.\n2.  **Enrich:** Augments the profile with Organization memberships via the REST API.\n3.  **Filter:** Applies the \"Meritocracy Logic\". If a user falls below the `minTotalContributions` threshold\n    (and is not allowlisted), they are marked for immediate deletion from the Tracker (\"Active Pruning\").\n    **Dynamic Threshold:** Once the database hits the `maxUsers` cap (managed by `Storage`), this\n    threshold dynamically rises to match the lowest performer in the database, ensuring only superior\n    candidates displace existing ones.\n4.  **Persist:** Saves valid users to the Rich Data Store and updates their timestamp in the Tracker.\n5.  **Rescue:** Handles \"Not Found\" or \"Bot\" errors by setting a dummy timestamp to prevent infinite retry loops.","kind":"class","name":"Updater","augments":["Neo.core.Base"],"tags":[{"originalTitle":"singleton","title":"singleton","text":""}],"memberof":"DevIndex.services","longname":"DevIndex.services.Updater","scope":"static","$longname":"DevIndex.services.Updater","$kind":"class","id":8091,"neoClassName":"DevIndex.services.Updater"},{"comment":"/**\n         * @member {String} className='DevIndex.services.Updater'\n         * @protected\n         */","meta":{"filename":"Updater.mjs","lineno":35,"columnno":8,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/apps/devindex/services","code":{}},"kind":"member","name":"className","type":{"names":["String"]},"defaultvalue":"'DevIndex.services.Updater'","access":"protected","longname":"className","scope":"global","$longname":"className","$kind":"property","id":8092,"neoClassName":"DevIndex.services.Updater"},{"comment":"/**\n         * @member {Boolean} singleton=true\n         * @protected\n         */","meta":{"filename":"Updater.mjs","lineno":40,"columnno":8,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/apps/devindex/services","code":{}},"kind":"member","name":"singleton","type":{"names":["Boolean"]},"defaultvalue":true,"access":"protected","longname":"singleton","scope":"global","$longname":"singleton","$kind":"property","id":8093,"neoClassName":"DevIndex.services.Updater"},{"comment":"/**\n     * Orchestrates the update process for a specific batch of users.\n     *\n     * Iterates through the provided list of logins, fetching their latest data from GitHub.\n     * Enforces the \"Meritocracy Logic\" by checking the contribution threshold and allowlist status.\n     *\n     * **Safe Purge Protocol (Self-Healing):**\n     * This method implements a defensive strategy for handling API errors:\n     * 1.  **Transient Errors (5xx, Rate Limits):** Users are moved to the \"Penalty Box\" (`failed.json`) to be retried later.\n     * 2.  **Fatal Errors (404, Not a User):**\n     *     -   **If User Has History:** If the user exists in `users.jsonl`, we assume the 404 is a glitch or temporary suspension. They are **Protected** and moved to the Penalty Box.\n     *     -   **If User Is New:** If the user has *never* been successfully indexed, they are classified as a \"Bad Seed\" (e.g., leaked Organization, Typo). They are **Pruned** (deleted) from the tracker immediately.\n     * 3.  **Rename Recovery:** If a user returns a 404 but exists in our Rich Data Store with a valid GitHub Database ID,\n     *     we query the API for their current login. If found, the old record is pruned and the new login is immediately\n     *     fetched and indexed, preserving history.\n     *\n     * @param {String[]} logins             Array of usernames to process in this batch.\n     * @param {Number}   [initialBacklog=0] The total size of the backlog *before* this batch started, used for reporting.\n     * @returns {Promise<void>}\n     */","meta":{"range":[3368,10953],"filename":"Updater.mjs","lineno":63,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/apps/devindex/services","code":{"id":"astnode100012376","name":"Updater#processBatch","type":"MethodDefinition","paramnames":["logins","initialBacklog"]},"vars":{"":null}},"description":"<p>Orchestrates the update process for a specific batch of users.</p>\n<p>Iterates through the provided list of logins, fetching their latest data from GitHub.\nEnforces the &quot;Meritocracy Logic&quot; by checking the contribution threshold and allowlist status.</p>\n<p><strong>Safe Purge Protocol (Self-Healing):</strong>\nThis method implements a defensive strategy for handling API errors:</p>\n<ol>\n<li><strong>Transient Errors (5xx, Rate Limits):</strong> Users are moved to the &quot;Penalty Box&quot; (<code>failed.json</code>) to be retried later.</li>\n<li><strong>Fatal Errors (404, Not a User):</strong><ul>\n<li><strong>If User Has History:</strong> If the user exists in <code>users.jsonl</code>, we assume the 404 is a glitch or temporary suspension. They are <strong>Protected</strong> and moved to the Penalty Box.</li>\n<li><strong>If User Is New:</strong> If the user has <em>never</em> been successfully indexed, they are classified as a &quot;Bad Seed&quot; (e.g., leaked Organization, Typo). They are <strong>Pruned</strong> (deleted) from the tracker immediately.</li>\n</ul>\n</li>\n<li><strong>Rename Recovery:</strong> If a user returns a 404 but exists in our Rich Data Store with a valid GitHub Database ID,\nwe query the API for their current login. If found, the old record is pruned and the new login is immediately\nfetched and indexed, preserving history.</li>\n</ol>\n","params":[{"type":{"names":["Array.<String>"]},"description":"<p>Array of usernames to process in this batch.</p>\n","name":"logins"},{"type":{"names":["Number"]},"optional":true,"defaultvalue":0,"description":"<p>The total size of the backlog <em>before</em> this batch started, used for reporting.</p>\n","name":"initialBacklog"}],"returns":[{"type":{"names":["Promise.<void>"]}}],"name":"processBatch","longname":"Updater#processBatch","kind":"function","memberof":"Updater","scope":"instance","async":true,"$longname":"Updater#processBatch","$kind":"method","id":8094,"neoClassName":"DevIndex.services.Updater"},{"comment":"/**\n     * Helper to save partial results.\n     * @param {Array} results\n     * @param {Array} indexUpdates\n     * @param {Array} failedLogins\n     * @param {Array} recoveredLogins\n     * @param {Array} prunedLogins\n     */","meta":{"range":[11187,11941],"filename":"Updater.mjs","lineno":220,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/apps/devindex/services","code":{"id":"astnode100013163","name":"Updater#saveCheckpoint","type":"MethodDefinition","paramnames":["results","indexUpdates","failedLogins","recoveredLogins","prunedLogins"]},"vars":{"":null}},"description":"<p>Helper to save partial results.</p>\n","params":[{"type":{"names":["Array"]},"name":"results"},{"type":{"names":["Array"]},"name":"indexUpdates"},{"type":{"names":["Array"]},"name":"failedLogins"},{"type":{"names":["Array"]},"name":"recoveredLogins"},{"type":{"names":["Array"]},"name":"prunedLogins"}],"name":"saveCheckpoint","longname":"Updater#saveCheckpoint","kind":"function","memberof":"Updater","scope":"instance","async":true,"$longname":"Updater#saveCheckpoint","$kind":"method","id":8095,"neoClassName":"DevIndex.services.Updater"},{"comment":"/**\n     * Fetches and aggregates comprehensive profile data for a single user.\n     *\n     * This method combines data from multiple sources:\n     * 1.  **GraphQL User Query:** Fetches profile info (bio, company, location) and social accounts.\n     * 2.  **GraphQL Contribution Graph:** Fetches the *entire* contribution history (total contributions) for every year since account creation.\n     * 3.  **REST API Organizations:** Fetches public organization memberships (bypassing GraphQL scope limitations).\n     *\n     * Returns `null` if the user is not found (404) or flagged as a bot, allowing the caller to handle the error gracefull.\n     *\n     * @param {String} username The GitHub login to fetch.\n     * @returns {Promise<Object|null>} The enriched user object matching the `users.json` schema, or null.\n     * @private\n     */","meta":{"range":[12789,23274],"filename":"Updater.mjs","lineno":246,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/apps/devindex/services","code":{"id":"astnode100013276","name":"Updater#fetchUserData","type":"MethodDefinition","paramnames":["username"]},"vars":{"":null}},"description":"<p>Fetches and aggregates comprehensive profile data for a single user.</p>\n<p>This method combines data from multiple sources:</p>\n<ol>\n<li><strong>GraphQL User Query:</strong> Fetches profile info (bio, company, location) and social accounts.</li>\n<li><strong>GraphQL Contribution Graph:</strong> Fetches the <em>entire</em> contribution history (total contributions) for every year since account creation.</li>\n<li><strong>REST API Organizations:</strong> Fetches public organization memberships (bypassing GraphQL scope limitations).</li>\n</ol>\n<p>Returns <code>null</code> if the user is not found (404) or flagged as a bot, allowing the caller to handle the error gracefull.</p>\n","params":[{"type":{"names":["String"]},"description":"<p>The GitHub login to fetch.</p>\n","name":"username"}],"returns":[{"type":{"names":["Promise.<(Object|null)>"]},"description":"The enriched user object matching the `users.json` schema, or null."}],"access":"private","name":"fetchUserData","longname":"Updater#fetchUserData","kind":"function","memberof":"Updater","scope":"instance","async":true,"$longname":"Updater#fetchUserData","$kind":"method","id":8096,"neoClassName":"DevIndex.services.Updater"}]}