{"classData":[{"comment":"/**\n * Manages the assembly of the LLM context window.\n * Combines System Prompt, Short-Term Memory (Session History), and Long-Term Memory (RAG).\n * Uses the \"Thick Client\" pattern to access Memory Services directly.\n *\n * @class Neo.ai.context.Assembler\n * @extends Neo.core.Base\n */","meta":{"filename":"Assembler.mjs","lineno":9,"columnno":0,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/context","code":{}},"description":"<p>Manages the assembly of the LLM context window.\nCombines System Prompt, Short-Term Memory (Session History), and Long-Term Memory (RAG).\nUses the &quot;Thick Client&quot; pattern to access Memory Services directly.</p>\n","kind":"class","name":"Assembler","augments":["Neo.core.Base"],"memberof":"Neo.ai.context","longname":"Neo.ai.context.Assembler","scope":"static","$longname":"Neo.ai.context.Assembler","$kind":"class","id":6334,"neoClassName":"Neo.ai.context.Assembler"},{"comment":"/**\n         * @member {String} className='Neo.ai.context.Assembler'\n         * @protected\n         */","meta":{"filename":"Assembler.mjs","lineno":23,"columnno":8,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/context","code":{}},"kind":"member","name":"className","type":{"names":["String"]},"defaultvalue":"'Neo.ai.context.Assembler'","access":"protected","longname":"className","scope":"global","$longname":"className","$kind":"property","id":6335,"neoClassName":"Neo.ai.context.Assembler"},{"comment":"/**\n         * Number of messages to keep before compressing.\n         * @member {Number} compressionThreshold=20\n         */","meta":{"filename":"Assembler.mjs","lineno":28,"columnno":8,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/context","code":{}},"description":"<p>Number of messages to keep before compressing.</p>\n","kind":"member","name":"compressionThreshold","type":{"names":["Number"]},"defaultvalue":20,"longname":"compressionThreshold","scope":"global","$longname":"compressionThreshold","$kind":"property","id":6336,"neoClassName":"Neo.ai.context.Assembler"},{"comment":"/**\n         * Number of initial messages to keep as context when compressing.\n         * @member {Number} contextCount=5\n         */","meta":{"filename":"Assembler.mjs","lineno":33,"columnno":8,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/context","code":{}},"description":"<p>Number of initial messages to keep as context when compressing.</p>\n","kind":"member","name":"contextCount","type":{"names":["Number"]},"defaultvalue":5,"longname":"contextCount","scope":"global","$longname":"contextCount","$kind":"property","id":6337,"neoClassName":"Neo.ai.context.Assembler"},{"comment":"/**\n         * Maximum tokens allowed in the context window.\n         * Used for pruning history.\n         * @member {Number} maxTokens=1000000\n         */","meta":{"filename":"Assembler.mjs","lineno":39,"columnno":8,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/context","code":{}},"description":"<p>Maximum tokens allowed in the context window.\nUsed for pruning history.</p>\n","kind":"member","name":"maxTokens","type":{"names":["Number"]},"defaultvalue":1000000,"longname":"maxTokens","scope":"global","$longname":"maxTokens","$kind":"property","id":6338,"neoClassName":"Neo.ai.context.Assembler"},{"comment":"/**\n         * Number of most recent messages to keep when compressing.\n         * @member {Number} recentCount=10\n         */","meta":{"filename":"Assembler.mjs","lineno":44,"columnno":8,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/context","code":{}},"description":"<p>Number of most recent messages to keep when compressing.</p>\n","kind":"member","name":"recentCount","type":{"names":["Number"]},"defaultvalue":10,"longname":"recentCount","scope":"global","$longname":"recentCount","$kind":"property","id":6339,"neoClassName":"Neo.ai.context.Assembler"},{"comment":"/**\n     * Ensure services are ready before use.\n     */","meta":{"range":[1436,1870],"filename":"Assembler.mjs","lineno":50,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/context","code":{"id":"astnode100052632","name":"ContextAssembler#initAsync","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Ensure services are ready before use.</p>\n","name":"initAsync","longname":"ContextAssembler#initAsync","kind":"function","memberof":"ContextAssembler","scope":"instance","params":[],"async":true,"$longname":"ContextAssembler#initAsync","$kind":"method","id":6340,"neoClassName":"Neo.ai.context.Assembler"},{"comment":"/**\n     * Assembles the full context payload for the LLM.\n     *\n     * @param {Object} options\n     * @param {String} options.systemPrompt The base system prompt (identity, rules).\n     * @param {String} options.userQuery    The current user input or event trigger.\n     * @param {String} [options.ragQuery]   Optional query to fetch long-term memories.\n     * @param {String} [options.sessionId]  The session ID to fetch context for.\n     * @returns {Promise<{system: String, messages: Array}>}\n     */","meta":{"range":[2386,4543],"filename":"Assembler.mjs","lineno":72,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/context","code":{"id":"astnode100052664","name":"ContextAssembler#assemble","type":"MethodDefinition","paramnames":[""]},"vars":{"":null}},"description":"<p>Assembles the full context payload for the LLM.</p>\n","params":[{"type":{"names":["Object"]},"name":"options"},{"type":{"names":["String"]},"description":"<p>The base system prompt (identity, rules).</p>\n","name":"options.systemPrompt"},{"type":{"names":["String"]},"description":"<p>The current user input or event trigger.</p>\n","name":"options.userQuery"},{"type":{"names":["String"]},"optional":true,"description":"<p>Optional query to fetch long-term memories.</p>\n","name":"options.ragQuery"},{"type":{"names":["String"]},"optional":true,"description":"<p>The session ID to fetch context for.</p>\n","name":"options.sessionId"}],"returns":[{"type":{"names":["Promise.<{system: String, messages: Array}>"]}}],"name":"assemble","longname":"ContextAssembler#assemble","kind":"function","memberof":"ContextAssembler","scope":"instance","async":true,"$longname":"ContextAssembler#assemble","$kind":"method","id":6341,"neoClassName":"Neo.ai.context.Assembler"},{"comment":"/**\n     * Formats Session Summary results.\n     * @param {Array} results\n     * @returns {String}\n     */","meta":{"range":[4660,4922],"filename":"Assembler.mjs","lineno":142,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/context","code":{"id":"astnode100052831","name":"ContextAssembler#formatSummaryContext","type":"MethodDefinition","paramnames":["results"]},"vars":{"":null}},"description":"<p>Formats Session Summary results.</p>\n","params":[{"type":{"names":["Array"]},"name":"results"}],"returns":[{"type":{"names":["String"]}}],"name":"formatSummaryContext","longname":"ContextAssembler#formatSummaryContext","kind":"function","memberof":"ContextAssembler","scope":"instance","$longname":"ContextAssembler#formatSummaryContext","$kind":"method","id":6342,"neoClassName":"Neo.ai.context.Assembler"},{"comment":"/**\n     * Formats KB results.\n     * @param {Array} results\n     * @returns {String}\n     */","meta":{"range":[5026,5378],"filename":"Assembler.mjs","lineno":153,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/context","code":{"id":"astnode100052875","name":"ContextAssembler#formatKbContext","type":"MethodDefinition","paramnames":["results"]},"vars":{"":null}},"description":"<p>Formats KB results.</p>\n","params":[{"type":{"names":["Array"]},"name":"results"}],"returns":[{"type":{"names":["String"]}}],"name":"formatKbContext","longname":"ContextAssembler#formatKbContext","kind":"function","memberof":"ContextAssembler","scope":"instance","$longname":"ContextAssembler#formatKbContext","$kind":"method","id":6343,"neoClassName":"Neo.ai.context.Assembler"},{"comment":"/**\n     * Formats raw memory entries into message objects.\n     * @param {Array} memories\n     * @returns {Array}\n     */","meta":{"range":[5511,5802],"filename":"Assembler.mjs","lineno":167,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/context","code":{"id":"astnode100052936","name":"ContextAssembler#formatMessages","type":"MethodDefinition","paramnames":["memories"]},"vars":{"":null}},"description":"<p>Formats raw memory entries into message objects.</p>\n","params":[{"type":{"names":["Array"]},"name":"memories"}],"returns":[{"type":{"names":["Array"]}}],"name":"formatMessages","longname":"ContextAssembler#formatMessages","kind":"function","memberof":"ContextAssembler","scope":"instance","$longname":"ContextAssembler#formatMessages","$kind":"method","id":6344,"neoClassName":"Neo.ai.context.Assembler"},{"comment":"/**\n     * Formats raw memory entries into message history with compression.\n     * @param {Array} memories\n     * @returns {Array}\n     */","meta":{"range":[5952,7045],"filename":"Assembler.mjs","lineno":181,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/context","code":{"id":"astnode100052986","name":"ContextAssembler#formatHistory","type":"MethodDefinition","paramnames":["memories"]},"vars":{"":null}},"description":"<p>Formats raw memory entries into message history with compression.</p>\n","params":[{"type":{"names":["Array"]},"name":"memories"}],"returns":[{"type":{"names":["Array"]}}],"name":"formatHistory","longname":"ContextAssembler#formatHistory","kind":"function","memberof":"ContextAssembler","scope":"instance","$longname":"ContextAssembler#formatHistory","$kind":"method","id":6345,"neoClassName":"Neo.ai.context.Assembler"},{"comment":"/**\n     * Appends RAG context to the system prompt.\n     * @param {String} basePrompt\n     * @param {String} ragContext\n     * @returns {String}\n     */","meta":{"range":[7209,7305],"filename":"Assembler.mjs","lineno":214,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/context","code":{"id":"astnode100053085","name":"ContextAssembler#augmentSystemPrompt","type":"MethodDefinition","paramnames":["basePrompt","ragContext"]},"vars":{"":null}},"description":"<p>Appends RAG context to the system prompt.</p>\n","params":[{"type":{"names":["String"]},"name":"basePrompt"},{"type":{"names":["String"]},"name":"ragContext"}],"returns":[{"type":{"names":["String"]}}],"name":"augmentSystemPrompt","longname":"ContextAssembler#augmentSystemPrompt","kind":"function","memberof":"ContextAssembler","scope":"instance","$longname":"ContextAssembler#augmentSystemPrompt","$kind":"method","id":6346,"neoClassName":"Neo.ai.context.Assembler"}]}