"use strict";
(self["webpackChunkneo_mjs"] = self["webpackChunkneo_mjs"] || []).push([["examples_component_multiWindowHelix_app_mjs"],{

/***/ "./examples/component/multiWindowHelix/Viewport.mjs":
/*!**********************************************************!*\
  !*** ./examples/component/multiWindowHelix/Viewport.mjs ***!
  \**********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _helix_Viewport_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../helix/Viewport.mjs */ "./examples/component/helix/Viewport.mjs");
/* harmony import */ var _ViewportController_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ViewportController.mjs */ "./examples/component/multiWindowHelix/ViewportController.mjs");



/**
 * @class Neo.examples.component.multiWindowHelix.Viewport
 * @extends Neo.examples.component.helix.Viewport
 */
class Viewport extends _helix_Viewport_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.examples.component.multiWindowHelix.Viewport'
         * @protected
         */
        className: 'Neo.examples.component.multiWindowHelix.Viewport',
        /**
         * @member {String[]} cls=['multi-window-helix-viewport']
         */
        cls: ['multi-window-helix-viewport'],
        /**
         * @member {Neo.controller.Component} controller=ViewportController
         */
        controller: _ViewportController_mjs__WEBPACK_IMPORTED_MODULE_1__["default"]
    }

    /**
     * @param {Object} config
     */
    construct(config) {
        super.construct(config);

        this.getItem('controls-panel').headers = [{
            dock     : 'top',
            reference: 'header-toolbar',

            items: [{
                ntype: 'label',
                cls  : ['neo-panel-header-text', 'neo-label'],
                text : 'Helix Controls'
            }, '->', {
                handler: 'onMaximiseButtonClick',
                iconCls: 'far fa-window-maximize'
            }]
        }]
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(Viewport));


/***/ }),

/***/ "./examples/component/multiWindowHelix/ViewportController.mjs":
/*!********************************************************************!*\
  !*** ./examples/component/multiWindowHelix/ViewportController.mjs ***!
  \********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _helix_ViewportController_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../helix/ViewportController.mjs */ "./examples/component/helix/ViewportController.mjs");


/**
 * @class Neo.examples.component.multiWindowHelix.ViewportController
 * @extends Neo.examples.component.helix.ViewportController
 */
class ViewportController extends _helix_ViewportController_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.examples.component.multiWindowHelix.ViewportController'
         * @protected
         */
        className: 'Neo.examples.component.multiWindowHelix.ViewportController'
    }

    /**
     * @member {String[]} connectedApps=[]
     */
    connectedApps = []

    /**
     *
     */
    async createPopupWindow() {
        let me                         = this,
            {windowId}                 = me,
            {config, windowConfigs}    = Neo,
            {environment}              = config,
            firstWindowId              = parseInt(Object.keys(windowConfigs)[0]),
            {basePath}                 = windowConfigs[firstWindowId],
            widget                     = me.getReference('controls-panel'),
            winData                    = await Neo.Main.getWindowData({windowId}),
            rect                       = await me.component.getDomRect(widget.id),
            {height, left, top, width} = rect;

        if (environment !== 'development') {
            basePath = `${basePath + environment}/`
        }

        height += 1; // popup header in Chrome => height + 1, top -63
        left   += (width + winData.screenLeft);
        top    += (winData.outerHeight - winData.innerHeight + winData.screenTop - 63);

        // Mounted inside a code.LivePreview, the popup header should be within the content (height-wise)
        // See: https://github.com/neomjs/neo/issues/5991
        if (me.component.up('live-preview')) {
            height -= 63;
            top    += 63;
        }

        /*
         * For this demo, the url './childapp/' would be sufficient.
         * However, we also want to open it from within apps/portal.
         *
         * We match the basePath to the firstWindowId,
         * assuming the first connected window is the (main) one which we want to be in charge.
         */
        await Neo.Main.windowOpen({
            url           : basePath + 'examples/component/multiWindowHelix/childapp/',
            windowFeatures: `height=${height},left=${left},top=${top},width=${width}`,
            windowId      : firstWindowId,
            windowName    : 'HelixControls'
        })
    }

    /**
     * @param {Object} data
     * @param {String} data.appName
     * @param {Number} data.windowId
     */
    async onAppConnect(data) {
        let me        = this,
            {appName} = data;

        if (appName === 'HelixControls') {
            let controlsPanel = me.getReference('controls-panel'),
                {mainView}    = Neo.apps[appName];

            me.connectedApps.push(appName);

            this.getReference('header-toolbar').hidden = true;

            mainView.add(controlsPanel)
        }
    }

    /**
     * @param {Object} data
     * @param {String} data.appName
     * @param {Number} data.windowId
     */
    async onAppDisconnect(data) {
        let me                  = this,
            {appName, windowId} = data;

        if (appName === 'HelixControls') {
            me.getReference('header-toolbar').hidden = false;

            me.component.add(me.getReference('controls-panel'))
        }
        // Close popup windows when closing or reloading the main window
        else if (appName === 'Neo.examples.component.multiWindowHelix') {
            Neo.Main.windowClose({names: me.connectedApps, windowId})
        }
    }
    /**
     *
     */
    onConstructed() {
        super.onConstructed();

        let me = this;

        Neo.currentWorker.on({
            connect   : me.onAppConnect,
            disconnect: me.onAppDisconnect,
            scope     : me
        })
    }

    /**
     * @param {Object} data
     */
    async onMaximiseButtonClick(data) {
        await this.createPopupWindow()
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(ViewportController));


/***/ }),

/***/ "./examples/component/multiWindowHelix/app.mjs":
/*!*****************************************************!*\
  !*** ./examples/component/multiWindowHelix/app.mjs ***!
  \*****************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   onStart: () => (/* binding */ onStart)
/* harmony export */ });
/* harmony import */ var _Viewport_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Viewport.mjs */ "./examples/component/multiWindowHelix/Viewport.mjs");


const onStart = () => Neo.app({
    mainView: _Viewport_mjs__WEBPACK_IMPORTED_MODULE_0__["default"],
    name    : 'Neo.examples.component.multiWindowHelix'
});


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2h1bmtzL2FwcC9leGFtcGxlc19jb21wb25lbnRfbXVsdGlXaW5kb3dIZWxpeF9hcHBfbWpzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUF1RDtBQUNHOztBQUUxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QiwyREFBWTtBQUNuQztBQUNBO0FBQ0Esb0JBQW9CLFFBQVE7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsVUFBVTtBQUM5QjtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsMEJBQTBCO0FBQzlDO0FBQ0Esb0JBQW9CLCtEQUFrQjtBQUN0Qzs7QUFFQTtBQUNBLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7O0FBRUEsaUVBQWUsd0JBQXdCLEVBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7QUM5Q2lCOztBQUV6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxxRUFBVTtBQUMzQztBQUNBO0FBQ0Esb0JBQW9CLFFBQVE7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxnQkFBZ0IsVUFBVTtBQUMxQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLDBCQUEwQjtBQUN2QyxhQUFhLDBCQUEwQjtBQUN2QyxhQUFhLDBCQUEwQjtBQUN2QztBQUNBLGFBQWEsMEJBQTBCO0FBQ3ZDO0FBQ0EsdUVBQXVFLFNBQVM7QUFDaEY7QUFDQSxhQUFhLDBCQUEwQjs7QUFFdkM7QUFDQSwwQkFBMEIsdUJBQXVCO0FBQ2pEOztBQUVBLHFCQUFxQjtBQUNyQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MsT0FBTyxRQUFRLEtBQUssT0FBTyxJQUFJLFNBQVMsTUFBTTtBQUNwRjtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0EsYUFBYSxTQUFTOztBQUV0QjtBQUNBO0FBQ0EsaUJBQWlCLGFBQWE7O0FBRTlCOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBLGFBQWEsbUJBQW1COztBQUVoQztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLGtDQUFrQztBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGlFQUFlLGtDQUFrQyxFQUFDOzs7Ozs7Ozs7Ozs7Ozs7O0FDaElaOztBQUUvQjtBQUNQLGNBQWMscURBQVE7QUFDdEI7QUFDQSxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmVvLm1qcy8uL2V4YW1wbGVzL2NvbXBvbmVudC9tdWx0aVdpbmRvd0hlbGl4L1ZpZXdwb3J0Lm1qcyIsIndlYnBhY2s6Ly9uZW8ubWpzLy4vZXhhbXBsZXMvY29tcG9uZW50L211bHRpV2luZG93SGVsaXgvVmlld3BvcnRDb250cm9sbGVyLm1qcyIsIndlYnBhY2s6Ly9uZW8ubWpzLy4vZXhhbXBsZXMvY29tcG9uZW50L211bHRpV2luZG93SGVsaXgvYXBwLm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQmFzZVZpZXdwb3J0ICAgICAgIGZyb20gJy4uL2hlbGl4L1ZpZXdwb3J0Lm1qcyc7XG5pbXBvcnQgVmlld3BvcnRDb250cm9sbGVyIGZyb20gJy4vVmlld3BvcnRDb250cm9sbGVyLm1qcyc7XG5cbi8qKlxuICogQGNsYXNzIE5lby5leGFtcGxlcy5jb21wb25lbnQubXVsdGlXaW5kb3dIZWxpeC5WaWV3cG9ydFxuICogQGV4dGVuZHMgTmVvLmV4YW1wbGVzLmNvbXBvbmVudC5oZWxpeC5WaWV3cG9ydFxuICovXG5jbGFzcyBWaWV3cG9ydCBleHRlbmRzIEJhc2VWaWV3cG9ydCB7XG4gICAgc3RhdGljIGNvbmZpZyA9IHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gY2xhc3NOYW1lPSdOZW8uZXhhbXBsZXMuY29tcG9uZW50Lm11bHRpV2luZG93SGVsaXguVmlld3BvcnQnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ05lby5leGFtcGxlcy5jb21wb25lbnQubXVsdGlXaW5kb3dIZWxpeC5WaWV3cG9ydCcsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmdbXX0gY2xzPVsnbXVsdGktd2luZG93LWhlbGl4LXZpZXdwb3J0J11cbiAgICAgICAgICovXG4gICAgICAgIGNsczogWydtdWx0aS13aW5kb3ctaGVsaXgtdmlld3BvcnQnXSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge05lby5jb250cm9sbGVyLkNvbXBvbmVudH0gY29udHJvbGxlcj1WaWV3cG9ydENvbnRyb2xsZXJcbiAgICAgICAgICovXG4gICAgICAgIGNvbnRyb2xsZXI6IFZpZXdwb3J0Q29udHJvbGxlclxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3QoY29uZmlnKSB7XG4gICAgICAgIHN1cGVyLmNvbnN0cnVjdChjb25maWcpO1xuXG4gICAgICAgIHRoaXMuZ2V0SXRlbSgnY29udHJvbHMtcGFuZWwnKS5oZWFkZXJzID0gW3tcbiAgICAgICAgICAgIGRvY2sgICAgIDogJ3RvcCcsXG4gICAgICAgICAgICByZWZlcmVuY2U6ICdoZWFkZXItdG9vbGJhcicsXG5cbiAgICAgICAgICAgIGl0ZW1zOiBbe1xuICAgICAgICAgICAgICAgIG50eXBlOiAnbGFiZWwnLFxuICAgICAgICAgICAgICAgIGNscyAgOiBbJ25lby1wYW5lbC1oZWFkZXItdGV4dCcsICduZW8tbGFiZWwnXSxcbiAgICAgICAgICAgICAgICB0ZXh0IDogJ0hlbGl4IENvbnRyb2xzJ1xuICAgICAgICAgICAgfSwgJy0+Jywge1xuICAgICAgICAgICAgICAgIGhhbmRsZXI6ICdvbk1heGltaXNlQnV0dG9uQ2xpY2snLFxuICAgICAgICAgICAgICAgIGljb25DbHM6ICdmYXIgZmEtd2luZG93LW1heGltaXplJ1xuICAgICAgICAgICAgfV1cbiAgICAgICAgfV1cbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IE5lby5zZXR1cENsYXNzKFZpZXdwb3J0KTtcbiIsImltcG9ydCBDb250cm9sbGVyIGZyb20gJy4uL2hlbGl4L1ZpZXdwb3J0Q29udHJvbGxlci5tanMnO1xuXG4vKipcbiAqIEBjbGFzcyBOZW8uZXhhbXBsZXMuY29tcG9uZW50Lm11bHRpV2luZG93SGVsaXguVmlld3BvcnRDb250cm9sbGVyXG4gKiBAZXh0ZW5kcyBOZW8uZXhhbXBsZXMuY29tcG9uZW50LmhlbGl4LlZpZXdwb3J0Q29udHJvbGxlclxuICovXG5jbGFzcyBWaWV3cG9ydENvbnRyb2xsZXIgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J05lby5leGFtcGxlcy5jb21wb25lbnQubXVsdGlXaW5kb3dIZWxpeC5WaWV3cG9ydENvbnRyb2xsZXInXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ05lby5leGFtcGxlcy5jb21wb25lbnQubXVsdGlXaW5kb3dIZWxpeC5WaWV3cG9ydENvbnRyb2xsZXInXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQG1lbWJlciB7U3RyaW5nW119IGNvbm5lY3RlZEFwcHM9W11cbiAgICAgKi9cbiAgICBjb25uZWN0ZWRBcHBzID0gW11cblxuICAgIC8qKlxuICAgICAqXG4gICAgICovXG4gICAgYXN5bmMgY3JlYXRlUG9wdXBXaW5kb3coKSB7XG4gICAgICAgIGxldCBtZSAgICAgICAgICAgICAgICAgICAgICAgICA9IHRoaXMsXG4gICAgICAgICAgICB7d2luZG93SWR9ICAgICAgICAgICAgICAgICA9IG1lLFxuICAgICAgICAgICAge2NvbmZpZywgd2luZG93Q29uZmlnc30gICAgPSBOZW8sXG4gICAgICAgICAgICB7ZW52aXJvbm1lbnR9ICAgICAgICAgICAgICA9IGNvbmZpZyxcbiAgICAgICAgICAgIGZpcnN0V2luZG93SWQgICAgICAgICAgICAgID0gcGFyc2VJbnQoT2JqZWN0LmtleXMod2luZG93Q29uZmlncylbMF0pLFxuICAgICAgICAgICAge2Jhc2VQYXRofSAgICAgICAgICAgICAgICAgPSB3aW5kb3dDb25maWdzW2ZpcnN0V2luZG93SWRdLFxuICAgICAgICAgICAgd2lkZ2V0ICAgICAgICAgICAgICAgICAgICAgPSBtZS5nZXRSZWZlcmVuY2UoJ2NvbnRyb2xzLXBhbmVsJyksXG4gICAgICAgICAgICB3aW5EYXRhICAgICAgICAgICAgICAgICAgICA9IGF3YWl0IE5lby5NYWluLmdldFdpbmRvd0RhdGEoe3dpbmRvd0lkfSksXG4gICAgICAgICAgICByZWN0ICAgICAgICAgICAgICAgICAgICAgICA9IGF3YWl0IG1lLmNvbXBvbmVudC5nZXREb21SZWN0KHdpZGdldC5pZCksXG4gICAgICAgICAgICB7aGVpZ2h0LCBsZWZ0LCB0b3AsIHdpZHRofSA9IHJlY3Q7XG5cbiAgICAgICAgaWYgKGVudmlyb25tZW50ICE9PSAnZGV2ZWxvcG1lbnQnKSB7XG4gICAgICAgICAgICBiYXNlUGF0aCA9IGAke2Jhc2VQYXRoICsgZW52aXJvbm1lbnR9L2BcbiAgICAgICAgfVxuXG4gICAgICAgIGhlaWdodCArPSAxOyAvLyBwb3B1cCBoZWFkZXIgaW4gQ2hyb21lID0+IGhlaWdodCArIDEsIHRvcCAtNjNcbiAgICAgICAgbGVmdCAgICs9ICh3aWR0aCArIHdpbkRhdGEuc2NyZWVuTGVmdCk7XG4gICAgICAgIHRvcCAgICArPSAod2luRGF0YS5vdXRlckhlaWdodCAtIHdpbkRhdGEuaW5uZXJIZWlnaHQgKyB3aW5EYXRhLnNjcmVlblRvcCAtIDYzKTtcblxuICAgICAgICAvLyBNb3VudGVkIGluc2lkZSBhIGNvZGUuTGl2ZVByZXZpZXcsIHRoZSBwb3B1cCBoZWFkZXIgc2hvdWxkIGJlIHdpdGhpbiB0aGUgY29udGVudCAoaGVpZ2h0LXdpc2UpXG4gICAgICAgIC8vIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL25lb21qcy9uZW8vaXNzdWVzLzU5OTFcbiAgICAgICAgaWYgKG1lLmNvbXBvbmVudC51cCgnbGl2ZS1wcmV2aWV3JykpIHtcbiAgICAgICAgICAgIGhlaWdodCAtPSA2MztcbiAgICAgICAgICAgIHRvcCAgICArPSA2MztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qXG4gICAgICAgICAqIEZvciB0aGlzIGRlbW8sIHRoZSB1cmwgJy4vY2hpbGRhcHAvJyB3b3VsZCBiZSBzdWZmaWNpZW50LlxuICAgICAgICAgKiBIb3dldmVyLCB3ZSBhbHNvIHdhbnQgdG8gb3BlbiBpdCBmcm9tIHdpdGhpbiBhcHBzL3BvcnRhbC5cbiAgICAgICAgICpcbiAgICAgICAgICogV2UgbWF0Y2ggdGhlIGJhc2VQYXRoIHRvIHRoZSBmaXJzdFdpbmRvd0lkLFxuICAgICAgICAgKiBhc3N1bWluZyB0aGUgZmlyc3QgY29ubmVjdGVkIHdpbmRvdyBpcyB0aGUgKG1haW4pIG9uZSB3aGljaCB3ZSB3YW50IHRvIGJlIGluIGNoYXJnZS5cbiAgICAgICAgICovXG4gICAgICAgIGF3YWl0IE5lby5NYWluLndpbmRvd09wZW4oe1xuICAgICAgICAgICAgdXJsICAgICAgICAgICA6IGJhc2VQYXRoICsgJ2V4YW1wbGVzL2NvbXBvbmVudC9tdWx0aVdpbmRvd0hlbGl4L2NoaWxkYXBwLycsXG4gICAgICAgICAgICB3aW5kb3dGZWF0dXJlczogYGhlaWdodD0ke2hlaWdodH0sbGVmdD0ke2xlZnR9LHRvcD0ke3RvcH0sd2lkdGg9JHt3aWR0aH1gLFxuICAgICAgICAgICAgd2luZG93SWQgICAgICA6IGZpcnN0V2luZG93SWQsXG4gICAgICAgICAgICB3aW5kb3dOYW1lICAgIDogJ0hlbGl4Q29udHJvbHMnXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGFcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZGF0YS5hcHBOYW1lXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGRhdGEud2luZG93SWRcbiAgICAgKi9cbiAgICBhc3luYyBvbkFwcENvbm5lY3QoZGF0YSkge1xuICAgICAgICBsZXQgbWUgICAgICAgID0gdGhpcyxcbiAgICAgICAgICAgIHthcHBOYW1lfSA9IGRhdGE7XG5cbiAgICAgICAgaWYgKGFwcE5hbWUgPT09ICdIZWxpeENvbnRyb2xzJykge1xuICAgICAgICAgICAgbGV0IGNvbnRyb2xzUGFuZWwgPSBtZS5nZXRSZWZlcmVuY2UoJ2NvbnRyb2xzLXBhbmVsJyksXG4gICAgICAgICAgICAgICAge21haW5WaWV3fSAgICA9IE5lby5hcHBzW2FwcE5hbWVdO1xuXG4gICAgICAgICAgICBtZS5jb25uZWN0ZWRBcHBzLnB1c2goYXBwTmFtZSk7XG5cbiAgICAgICAgICAgIHRoaXMuZ2V0UmVmZXJlbmNlKCdoZWFkZXItdG9vbGJhcicpLmhpZGRlbiA9IHRydWU7XG5cbiAgICAgICAgICAgIG1haW5WaWV3LmFkZChjb250cm9sc1BhbmVsKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGFcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZGF0YS5hcHBOYW1lXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGRhdGEud2luZG93SWRcbiAgICAgKi9cbiAgICBhc3luYyBvbkFwcERpc2Nvbm5lY3QoZGF0YSkge1xuICAgICAgICBsZXQgbWUgICAgICAgICAgICAgICAgICA9IHRoaXMsXG4gICAgICAgICAgICB7YXBwTmFtZSwgd2luZG93SWR9ID0gZGF0YTtcblxuICAgICAgICBpZiAoYXBwTmFtZSA9PT0gJ0hlbGl4Q29udHJvbHMnKSB7XG4gICAgICAgICAgICBtZS5nZXRSZWZlcmVuY2UoJ2hlYWRlci10b29sYmFyJykuaGlkZGVuID0gZmFsc2U7XG5cbiAgICAgICAgICAgIG1lLmNvbXBvbmVudC5hZGQobWUuZ2V0UmVmZXJlbmNlKCdjb250cm9scy1wYW5lbCcpKVxuICAgICAgICB9XG4gICAgICAgIC8vIENsb3NlIHBvcHVwIHdpbmRvd3Mgd2hlbiBjbG9zaW5nIG9yIHJlbG9hZGluZyB0aGUgbWFpbiB3aW5kb3dcbiAgICAgICAgZWxzZSBpZiAoYXBwTmFtZSA9PT0gJ05lby5leGFtcGxlcy5jb21wb25lbnQubXVsdGlXaW5kb3dIZWxpeCcpIHtcbiAgICAgICAgICAgIE5lby5NYWluLndpbmRvd0Nsb3NlKHtuYW1lczogbWUuY29ubmVjdGVkQXBwcywgd2luZG93SWR9KVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqXG4gICAgICovXG4gICAgb25Db25zdHJ1Y3RlZCgpIHtcbiAgICAgICAgc3VwZXIub25Db25zdHJ1Y3RlZCgpO1xuXG4gICAgICAgIGxldCBtZSA9IHRoaXM7XG5cbiAgICAgICAgTmVvLmN1cnJlbnRXb3JrZXIub24oe1xuICAgICAgICAgICAgY29ubmVjdCAgIDogbWUub25BcHBDb25uZWN0LFxuICAgICAgICAgICAgZGlzY29ubmVjdDogbWUub25BcHBEaXNjb25uZWN0LFxuICAgICAgICAgICAgc2NvcGUgICAgIDogbWVcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqL1xuICAgIGFzeW5jIG9uTWF4aW1pc2VCdXR0b25DbGljayhkYXRhKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuY3JlYXRlUG9wdXBXaW5kb3coKVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgTmVvLnNldHVwQ2xhc3MoVmlld3BvcnRDb250cm9sbGVyKTtcbiIsImltcG9ydCBWaWV3cG9ydCBmcm9tICcuL1ZpZXdwb3J0Lm1qcyc7XG5cbmV4cG9ydCBjb25zdCBvblN0YXJ0ID0gKCkgPT4gTmVvLmFwcCh7XG4gICAgbWFpblZpZXc6IFZpZXdwb3J0LFxuICAgIG5hbWUgICAgOiAnTmVvLmV4YW1wbGVzLmNvbXBvbmVudC5tdWx0aVdpbmRvd0hlbGl4J1xufSk7XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9