"use strict";
(self["webpackChunkneo_mjs"] = self["webpackChunkneo_mjs"] || []).push([["vendors-examples_grid_container_app_mjs"],{

/***/ "./examples/grid/container/MainContainer.mjs":
/*!***************************************************!*\
  !*** ./examples/grid/container/MainContainer.mjs ***!
  \***************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _src_selection_grid_CellColumnModel_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../src/selection/grid/CellColumnModel.mjs */ "./src/selection/grid/CellColumnModel.mjs");
/* harmony import */ var _src_selection_grid_CellColumnRowModel_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../src/selection/grid/CellColumnRowModel.mjs */ "./src/selection/grid/CellColumnRowModel.mjs");
/* harmony import */ var _src_selection_grid_CellModel_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../src/selection/grid/CellModel.mjs */ "./src/selection/grid/CellModel.mjs");
/* harmony import */ var _src_selection_grid_CellRowModel_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../src/selection/grid/CellRowModel.mjs */ "./src/selection/grid/CellRowModel.mjs");
/* harmony import */ var _ConfigurationViewport_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../ConfigurationViewport.mjs */ "./examples/ConfigurationViewport.mjs");
/* harmony import */ var _src_selection_grid_ColumnModel_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../src/selection/grid/ColumnModel.mjs */ "./src/selection/grid/ColumnModel.mjs");
/* harmony import */ var _src_grid_Container_mjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../src/grid/Container.mjs */ "./src/grid/Container.mjs");
/* harmony import */ var _MainStore_mjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./MainStore.mjs */ "./examples/grid/container/MainStore.mjs");
/* harmony import */ var _src_form_field_Number_mjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../src/form/field/Number.mjs */ "./src/form/field/Number.mjs");
/* harmony import */ var _src_form_field_Radio_mjs__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../src/form/field/Radio.mjs */ "./src/form/field/Radio.mjs");
/* harmony import */ var _src_selection_grid_RowModel_mjs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../src/selection/grid/RowModel.mjs */ "./src/selection/grid/RowModel.mjs");












/**
 * @class Neo.examples.grid.container.MainContainer
 * @extends Neo.examples.ConfigurationViewport
 */
class MainContainer extends _ConfigurationViewport_mjs__WEBPACK_IMPORTED_MODULE_4__["default"] {
    static config = {
        className           : 'Neo.examples.grid.container.MainContainer',
        autoMount           : true,
        configItemLabelWidth: 130,
        configPanelFlex     : 1.5,
        exampleComponentFlex: 3,
        layout              : {ntype: 'hbox', align: 'stretch'}
    }

    createConfigurationComponents() {
        let me = this;

        const selectionModelRadioDefaults = {
            module        : _src_form_field_Radio_mjs__WEBPACK_IMPORTED_MODULE_9__["default"],
            hideValueLabel: false,
            labelText     : '',
            name          : 'selectionModel',
            width         : 350
        };

        return [{
            module   : _src_form_field_Number_mjs__WEBPACK_IMPORTED_MODULE_8__["default"],
            labelText: 'height',
            listeners: {change: me.onConfigChange.bind(me, 'height')},
            maxValue : 800,
            minValue : 225,
            stepSize : 5,
            value    : me.exampleComponent.height
        }, {
            ...selectionModelRadioDefaults,
            checked       : me.exampleComponent.selectionModel.ntype === 'selection-grid-cellmodel',
            labelText     : 'selectionModel',
            listeners     : {change: me.onRadioChange.bind(me, 'selectionModel', _src_selection_grid_CellModel_mjs__WEBPACK_IMPORTED_MODULE_2__["default"])},
            style         : {marginTop: '10px'},
            valueLabelText: 'Cell'
        }, {
            ...selectionModelRadioDefaults,
            checked       : me.exampleComponent.selectionModel.ntype === 'selection-grid-columnmodel',
            listeners     : {change: me.onRadioChange.bind(me, 'selectionModel', _src_selection_grid_ColumnModel_mjs__WEBPACK_IMPORTED_MODULE_5__["default"])},
            valueLabelText: 'Column'
        }, {
            ...selectionModelRadioDefaults,
            checked       : me.exampleComponent.selectionModel.ntype === 'selection-grid-rowmodel',
            listeners     : {change: me.onRadioChange.bind(me, 'selectionModel', _src_selection_grid_RowModel_mjs__WEBPACK_IMPORTED_MODULE_10__["default"])},
            valueLabelText: 'Row'
        }, {
            ...selectionModelRadioDefaults,
            checked       : me.exampleComponent.selectionModel.ntype === 'selection-grid-cellcolumnmodel',
            listeners     : {change: me.onRadioChange.bind(me, 'selectionModel', _src_selection_grid_CellColumnModel_mjs__WEBPACK_IMPORTED_MODULE_0__["default"])},
            valueLabelText: 'Cell & Column'
        }, {
            ...selectionModelRadioDefaults,
            checked       : me.exampleComponent.selectionModel.ntype === 'selection-grid-cellrowmodel',
            listeners     : {change: me.onRadioChange.bind(me, 'selectionModel', _src_selection_grid_CellRowModel_mjs__WEBPACK_IMPORTED_MODULE_3__["default"])},
            valueLabelText: 'Cell & Row'
        }, {
            ...selectionModelRadioDefaults,
            checked       : me.exampleComponent.selectionModel.ntype === 'selection-grid-cellcolumnrowmodel',
            listeners     : {change: me.onRadioChange.bind(me, 'selectionModel', _src_selection_grid_CellColumnRowModel_mjs__WEBPACK_IMPORTED_MODULE_1__["default"])},
            valueLabelText: 'Cell & Column & Row'
        }]
    }

    createExampleComponent() {
        return Neo.create(_src_grid_Container_mjs__WEBPACK_IMPORTED_MODULE_6__["default"], {
            selectionModel: _src_selection_grid_CellModel_mjs__WEBPACK_IMPORTED_MODULE_2__["default"],
            store         : _MainStore_mjs__WEBPACK_IMPORTED_MODULE_7__["default"],

            columnDefaults: {
                width: 200
            },

            columns: [
                {field: 'firstname', text: 'Firstname'},
                {field: 'lastname',  text: 'Lastname'},
                {field: 'githubId',  text: 'Github Id'},
                {field: 'country',   text: 'Country'}
            ]
        })
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(MainContainer));


/***/ }),

/***/ "./examples/grid/container/MainModel.mjs":
/*!***********************************************!*\
  !*** ./examples/grid/container/MainModel.mjs ***!
  \***********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _src_data_Model_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../src/data/Model.mjs */ "./src/data/Model.mjs");


/**
 * @class Neo.examples.grid.container.MainModel
 * @extends Neo.data.Model
 */
class MainModel extends _src_data_Model_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        className: 'Neo.examples.grid.container.MainModel',

        fields: [{
            name: 'country',
            type: 'String'
        }, {
            name: 'firstname',
            type: 'String'
        }, {
            name: 'githubId',
            type: 'String'
        }, {
            name: 'lastname',
            type: 'String'
        }]
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(MainModel));


/***/ }),

/***/ "./examples/grid/container/MainStore.mjs":
/*!***********************************************!*\
  !*** ./examples/grid/container/MainStore.mjs ***!
  \***********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _MainModel_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MainModel.mjs */ "./examples/grid/container/MainModel.mjs");
/* harmony import */ var _src_data_Store_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../src/data/Store.mjs */ "./src/data/Store.mjs");



/**
 * @class Neo.examples.grid.container.MainStore
 * @extends Neo.data.Store
 */
class MainStore extends _src_data_Store_mjs__WEBPACK_IMPORTED_MODULE_1__["default"] {
    static config = {
        className  : 'Neo.examples.grid.container.MainStore',
        keyProperty: 'githubId',
        model      : _MainModel_mjs__WEBPACK_IMPORTED_MODULE_0__["default"],

        data: [{
            country  : 'Germany',
            firstname: 'Tobias',
            githubId : 'tobiu',
            lastname : 'Uhlig'
        }, {
            country  : 'USA',
            firstname: 'Rich',
            githubId : 'rwaters',
            lastname : 'Waters'
        }, {
            country  : 'Germany',
            firstname: 'Nils',
            githubId : 'mrsunshine',
            lastname : 'Dehl'
        }, {
            country  : 'USA',
            firstname: 'Gerard',
            githubId : 'camtnbikerrwc',
            lastname : 'Horan'
        }, {
            country  : 'Slovakia',
            firstname: 'Jozef',
            githubId : 'jsakalos',
            lastname : 'Sakalos'
        }, {
            country  : 'Germany',
            firstname: 'Bastian',
            githubId : 'bhaustein',
            lastname : 'Haustein'
        }]
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(MainStore));


/***/ }),

/***/ "./examples/grid/container/app.mjs":
/*!*****************************************!*\
  !*** ./examples/grid/container/app.mjs ***!
  \*****************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   onStart: () => (/* binding */ onStart)
/* harmony export */ });
/* harmony import */ var _MainContainer_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MainContainer.mjs */ "./examples/grid/container/MainContainer.mjs");


const onStart = () => Neo.app({
    mainView: _MainContainer_mjs__WEBPACK_IMPORTED_MODULE_0__["default"],
    name    : 'Neo.examples.grid.container'
});


/***/ }),

/***/ "./src/form/field/Radio.mjs":
/*!**********************************!*\
  !*** ./src/form/field/Radio.mjs ***!
  \**********************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _CheckBox_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CheckBox.mjs */ "./src/form/field/CheckBox.mjs");
/* harmony import */ var _manager_Component_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../manager/Component.mjs */ "./src/manager/Component.mjs");



/**
 * @class Neo.form.field.Radio
 * @extends Neo.form.field.CheckBox
 */
class Radio extends _CheckBox_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.form.field.Radio'
         * @protected
         */
        className: 'Neo.form.field.Radio',
        /**
         * @member {String} ntype='radiofield'
         * @protected
         */
        ntype: 'radiofield',
        /**
         * @member {String[]} baseCls=['neo-radiofield','neo-checkboxfield']
         */
        baseCls: ['neo-radiofield', 'neo-checkboxfield'],
        /**
         * @member {String[]} iconCls=['far','fa-circle']
         */
        iconCls: ['far', 'fa-circle'],
        /**
         * @member {String} inputType='radio'
         */
        inputType: 'radio'
    }

    /**
     * Triggered after the checked config got changed
     * @param {Boolean} value
     * @param {Boolean} oldValue
     * @protected
     */
    afterSetChecked(value, oldValue) {
        super.afterSetChecked(value, oldValue);

        // update radios with the same name to be unchecked
        value && this.uncheckGroupItems()
    }

    /**
     * Radios should only fire change & fieldChange events if checked.
     * If there was just 1 radio, you can not uncheck it.
     * @param {*} value
     * @param {*} oldValue
     */
    fireChangeEvent(value, oldValue) {
        this.checked && super.fireChangeEvent(value, oldValue)
    }

    /**
     * @returns {String[]}
     */
    getGroupValue() {
        let value = super.getGroupValue();

        return value.length > 0 ? value[0] : []
    }

    /**
     * Radios do not fire a change event for "uncheck", so we need to iterate over other radios with the same name.
     */
    uncheckGroupItems() {
        let me = this,
            radios;

        // discuss: we could limit this to radios inside the same form, IF a top level form is used
        radios = _manager_Component_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].find({
            ntype: 'radiofield',
            name : me.name
        });

        radios.forEach(item => {
            if (item.id !== me.id && item._checked) {
                item.checked = false
            }
        })
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(Radio));


/***/ }),

/***/ "./src/selection/grid/CellColumnModel.mjs":
/*!************************************************!*\
  !*** ./src/selection/grid/CellColumnModel.mjs ***!
  \************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _CellModel_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CellModel.mjs */ "./src/selection/grid/CellModel.mjs");
/* harmony import */ var _ColumnModel_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ColumnModel.mjs */ "./src/selection/grid/ColumnModel.mjs");
/* harmony import */ var _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../util/VDom.mjs */ "./src/util/VDom.mjs");




/**
 * @class Neo.selection.grid.CellColumnModel
 * @extends Neo.selection.grid.CellModel
 */
class CellColumnModel extends _CellModel_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.selection.grid.CellColumnModel'
         * @protected
         */
        className: 'Neo.selection.grid.CellColumnModel',
        /**
         * @member {String} ntype='selection-grid-cellcolumnmodel'
         * @protected
         */
        ntype: 'selection-grid-cellcolumnmodel',
        /**
         * @member {String} cls='neo-selection-cellcolumnmodel'
         * @protected
         */
        cls: 'neo-selection-cellcolumnmodel',
        /**
         * @member {String} selectedColumnCellCls='selected-column-cell'
         * @protected
         */
        selectedColumnCellCls: 'selected-column-cell',
        /**
         * @member {Array|null} selectedColumnCellIds=null
         * @protected
         */
        selectedColumnCellIds: null
    }

    /**
     * @param {Object} config
     */
    construct(config) {
        super.construct(config);

        this.selectedColumnCellIds = []
    }

    /**
     * @param {Boolean} [silent] true to prevent a vdom update
     */
    deselectAllCells(silent) {
        let me      = this,
            cellIds = [...me.selectedColumnCellIds],
            {view}  = me

        cellIds.forEach(cellId => {
            me.deselect(cellId, true, me.selectedColumnCellIds, me.selectedColumnCellCls)
        });

        !silent && view.update()
    }

    /**
     * @param {Object} data
     */
    onCellClick(data) {
        let me = this,
            id = data.data.currentTarget,
            columnNodeIds, index, tbodyNode;

        if (id) {
            index         = _ColumnModel_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].getColumnIndex(id, me.view.items[0].items);
            tbodyNode     = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].find(me.view.vdom, {cls: 'neo-grid-view'}).vdom;
            columnNodeIds = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].getColumnNodesIds(tbodyNode, index);

            me.deselectAllCells(true);
            me.select(columnNodeIds, me.selectedColumnCellIds, me.selectedColumnCellCls)
        }

        super.onCellClick(data)
    }

    /**
     * @param {Object} data
     * @param {Number} step
     */
    onNavKeyColumn(data, step) {
        let me            = this,
            idArray       = _ColumnModel_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].getCellId(data.path).split('__'),
            currentColumn = idArray[2],
            {view}        = me,
            fields        = view.columns.map(c => c.field),
            newIndex      = (fields.indexOf(currentColumn) + step) % fields.length,
            columnNodeIds, tbodyNode;

        while (newIndex < 0) {
            newIndex += fields.length
        }

        tbodyNode     = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].find(me.view.vdom, {cls: 'neo-grid-view'}).vdom;
        columnNodeIds = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].getColumnNodesIds(tbodyNode, newIndex);

        me.deselectAllCells(true);
        me.select(columnNodeIds, me.selectedColumnCellIds, me.selectedColumnCellCls);

        super.onNavKeyColumn(data, step)
    }

    /**
     *
     */
    unregister() {
        this.deselectAllCells();
        super.unregister()
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(CellColumnModel));


/***/ }),

/***/ "./src/selection/grid/CellColumnRowModel.mjs":
/*!***************************************************!*\
  !*** ./src/selection/grid/CellColumnRowModel.mjs ***!
  \***************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _CellRowModel_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CellRowModel.mjs */ "./src/selection/grid/CellRowModel.mjs");
/* harmony import */ var _ColumnModel_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ColumnModel.mjs */ "./src/selection/grid/ColumnModel.mjs");
/* harmony import */ var _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../util/VDom.mjs */ "./src/util/VDom.mjs");




/**
 * @class Neo.selection.grid.CellColumnRowModel
 * @extends Neo.selection.grid.CellRowModel
 */
class CellColumnRowModel extends _CellRowModel_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.selection.grid.CellColumnRowModel'
         * @protected
         */
        className: 'Neo.selection.grid.CellColumnRowModel',
        /**
         * @member {String} ntype='selection-grid-cellcolumnrowmodel'
         * @protected
         */
        ntype: 'selection-grid-cellcolumnrowmodel',
        /**
         * @member {String} cls='neo-selection-cellcolumnrowmodel'
         * @protected
         */
        cls: 'neo-selection-cellcolumnrowmodel',
        /**
         * @member {String} selectedColumnCellCls='selected-column-cell'
         * @protected
         */
        selectedColumnCellCls: 'selected-column-cell',
        /**
         * @member {Array|null} selectedColumnCellIds=null
         * @protected
         */
        selectedColumnCellIds: null
    }

    /**
     * @param {Object} config
     */
    construct(config) {
        super.construct(config);

        this.selectedColumnCellIds = []
    }

    /**
     * @param {Boolean} [silent] true to prevent a vdom update
     */
    deselectAllCells(silent) {
        let me      = this,
            cellIds = [...me.selectedColumnCellIds],
            {view}  = me;

        cellIds.forEach(cellId => {
            me.deselect(cellId, true, me.selectedColumnCellIds, me.selectedColumnCellCls)
        });

        !silent && view.update()
    }

    /**
     * @param {Object} data
     */
    onCellClick(data) {
        let me = this,
            id = _ColumnModel_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].getCellId(data.data.path),
            columnNodeIds, index, tbodyNode;

        if (id) {
            index         = _ColumnModel_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].getColumnIndex(id, me.view.items[0].items);
            tbodyNode     = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].find(me.view.vdom, {cls: 'neo-grid-view'}).vdom;
            columnNodeIds = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].getColumnNodesIds(tbodyNode, index);

            me.deselectAllCells(true);
            me.select(columnNodeIds, me.selectedColumnCellIds, me.selectedColumnCellCls)
        }

        super.onCellClick(data)
    }

    /**
     * @param {Object} data
     * @param {Number} step
     */
    onNavKeyColumn(data, step) {
        let me            = this,
            idArray       = _ColumnModel_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].getCellId(data.path).split('__'),
            currentColumn = idArray[2],
            {view}        = me,
            fields        = view.columns.map(c => c.field),
            newIndex      = (fields.indexOf(currentColumn) + step) % fields.length,
            columnNodeIds, tbodyNode;

        while (newIndex < 0) {
            newIndex += fields.length
        }

        tbodyNode     = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].find(me.view.vdom, {cls: 'neo-grid-view'}).vdom;
        columnNodeIds = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].getColumnNodesIds(tbodyNode, newIndex);

        me.deselectAllCells(true);
        me.select(columnNodeIds, me.selectedColumnCellIds, me.selectedColumnCellCls);

        super.onNavKeyColumn(data, step)
    }

    /**
     *
     */
    unregister() {
        this.deselectAllCells();
        super.unregister()
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(CellColumnRowModel));


/***/ }),

/***/ "./src/selection/grid/CellModel.mjs":
/*!******************************************!*\
  !*** ./src/selection/grid/CellModel.mjs ***!
  \******************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _BaseModel_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BaseModel.mjs */ "./src/selection/grid/BaseModel.mjs");


/**
 * @class Neo.selection.grid.CellModel
 * @extends Neo.selection.grid.BaseModel
 */
class CellModel extends _BaseModel_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.selection.grid.CellModel'
         * @protected
         */
        className: 'Neo.selection.grid.CellModel',
        /**
         * @member {String} ntype='selection-grid-cellmodel'
         * @protected
         */
        ntype: 'selection-grid-cellmodel',
        /**
         * @member {String} cls='neo-selection-cellmodel'
         * @protected
         */
        cls: 'neo-selection-cellmodel'
    }

    /**
     *
     */
    addDomListener() {
        let me = this;

        me.view.on('cellClick', me.onCellClick, me)
    }

    /**
     * @param args
     */
    destroy(...args) {
        let me = this;

        me.view.un('cellClick', me.onCellClick, me);

        super.destroy(...args)
    }

    /**
     * @param {Object} data
     */
    onCellClick(data) {
        this.toggleSelection(data.data.currentTarget)
    }

    /**
     * @param {Object} data
     */
    onKeyDownDown(data) {
        this.onNavKeyRow(data, 1)
    }

    /**
     * @param {Object} data
     */
    onKeyDownLeft(data) {
        this.onNavKeyColumn(data, -1)
    }

    /**
     * @param {Object} data
     */
    onKeyDownRight(data) {
        this.onNavKeyColumn(data, 1)
    }

    /**
     * @param {Object} data
     */
    onKeyDownUp(data) {
        this.onNavKeyRow(data, -1)
    }

    /**
     * @param {Object} data
     * @param {Number} step
     */
    onNavKeyColumn(data, step) {
        let me            = this,
            {view}        = me,
            idArray       = data.path[0].id.split('__'),
            currentColumn = idArray[2],
            dataFields    = view.columns.map(c => c.field),
            newIndex      = (dataFields.indexOf(currentColumn) + step) % dataFields.length,
            id;

        while (newIndex < 0) {
            newIndex += dataFields.length
        }

        idArray[2] = dataFields[newIndex];
        id = idArray.join('__');

        me.select(id);
        view.focus(id)
    }

    /**
     * @param {Object} data
     * @param {Number} step
     */
    onNavKeyRow(data, step) {
        let me       = this,
            {view}   = me,
            {store}  = view,
            idArray  = data.path[0].id.split('__'),
            recordId = idArray[1],
            newIndex = (store.indexOf(recordId) + step) % store.getCount(),
            id;

        while (newIndex < 0) {
            newIndex += store.getCount()
        }

        idArray[1] = store.getKeyAt(newIndex);
        id = idArray.join('__');

        me.select(id);
        view.focus(id)
    }

    /**
     * @param {Neo.component.Base} component
     */
    register(component) {
        super.register(component);

        let me         = this,
            {id, view} = me;

        view.keys?._keys.push(
            {fn: 'onKeyDownDown'  ,key: 'Down'  ,scope: id},
            {fn: 'onKeyDownLeft'  ,key: 'Left'  ,scope: id},
            {fn: 'onKeyDownRight' ,key: 'Right' ,scope: id},
            {fn: 'onKeyDownUp'    ,key: 'Up'    ,scope: id}
        )
    }

    /**
     *
     */
    unregister() {
        let me         = this,
            {id, view} = me;

        view.keys?.removeKeys([
            {fn: 'onKeyDownDown'  ,key: 'Down'  ,scope: id},
            {fn: 'onKeyDownLeft'  ,key: 'Left'  ,scope: id},
            {fn: 'onKeyDownRight' ,key: 'Right' ,scope: id},
            {fn: 'onKeyDownUp'    ,key: 'Up'    ,scope: id}
        ]);

        super.unregister()
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(CellModel));


/***/ }),

/***/ "./src/selection/grid/CellRowModel.mjs":
/*!*********************************************!*\
  !*** ./src/selection/grid/CellRowModel.mjs ***!
  \*********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _CellModel_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CellModel.mjs */ "./src/selection/grid/CellModel.mjs");
/* harmony import */ var _util_Array_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../util/Array.mjs */ "./src/util/Array.mjs");
/* harmony import */ var _RowModel_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./RowModel.mjs */ "./src/selection/grid/RowModel.mjs");
/* harmony import */ var _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/VDom.mjs */ "./src/util/VDom.mjs");





/**
 * @class Neo.selection.grid.CellRowModel
 * @extends Neo.selection.grid.CellModel
 */
class CellRowModel extends _CellModel_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.selection.grid.CellRowModel'
         * @protected
         */
        className: 'Neo.selection.grid.CellRowModel',
        /**
         * @member {String} ntype='selection-grid-cellrowmodel'
         * @protected
         */
        ntype: 'selection-grid-cellrowmodel',
        /**
         * @member {String} cls='neo-selection-cellrowmodel'
         * @protected
         */
        cls: 'neo-selection-cellrowmodel',
        /**
         * @member {Array|null} selectedRowIds=null
         * @protected
         */
        selectedRowIds: null
    }

    /**
     * @param {Object} config
     */
    construct(config) {
        super.construct(config);

        this.selectedRowIds = []
    }

    /**
     * @param {Boolean} [silent] true to prevent a vdom update
     */
    deselectAllRows(silent) {
        let me     = this,
            rowIds = [...me.selectedRowIds],
            {view} = me;

        rowIds.forEach(rowId => {
            me.deselectRow(rowId, true)
        });

        !silent && view.update()
    }

    /**
     * @param {String} rowId
     * @param {Boolean} [silent] true to prevent a vdom update
     */
    deselectRow(rowId, silent) {
        let me     = this,
            {view} = me,
            node   = view.getVdomChild(rowId),
            cls;

        if (node) {
            cls = node.cls || [];
            _util_Array_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].remove(cls, me.selectedCls);
            node.cls = cls
        }

        _util_Array_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].remove(me.selectedRowIds, rowId);

        if (!silent) {
            view.updateDepth = 2;
            view.update()
        }
    }

    /**
     * @param {Object} data
     */
    onCellClick(data) {
        let me   = this,
            node = _RowModel_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].getRowNode(data.data.path), // we could add a separate export for this method
            id   = node?.id;

        if (id) {
            me.deselectAllRows(true);
            me.selectRow(id)
        }

        super.onCellClick(data)
    }

    /**
     * @param {Object} data
     * @param {Number} step
     */
    onNavKeyRow(data, step) {
        super.onNavKeyRow(data, step);

        let me           = this,
            node         = _RowModel_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].getRowNode(data.path),
            {view}       = me,
            {store}      = view,
            vdomNode     = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_3__["default"].find(view.vdom, node.id),
            newIndex     = (vdomNode.index + step) % store.getCount(),
            {parentNode} = vdomNode,
            id;

        while (newIndex < 0) {
            newIndex += store.getCount()
        }

        id = parentNode.cn[newIndex].id;

        if (id) {
            me.deselectAllRows(true);
            me.selectRow(id)
        }
    }

    /**
     * @param {String} id
     * @param {Boolean} [silent]
     */
    selectRow(id, silent) {
        let me       = this,
            {view}   = me,
            vdomNode = id && view.getVdomChild(id),
            cls;

        if (vdomNode) {
            cls = vdomNode.cls || [];
            _util_Array_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].add(cls, me.selectedCls);
            vdomNode.cls = cls;

            me.selectedRowIds.push(id)
        }

        if (!silent) {
            view.updateDepth = 2;
            view.update()
        }
    }

    /**
     *
     */
    unregister() {
        this.deselectAllRows();
        super.unregister()
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(CellRowModel));


/***/ }),

/***/ "./src/selection/grid/ColumnModel.mjs":
/*!********************************************!*\
  !*** ./src/selection/grid/ColumnModel.mjs ***!
  \********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _BaseModel_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BaseModel.mjs */ "./src/selection/grid/BaseModel.mjs");
/* harmony import */ var _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../util/VDom.mjs */ "./src/util/VDom.mjs");



/**
 * @class Neo.selection.grid.ColumnModel
 * @extends Neo.selection.grid.BaseModel
 */
class ColumnModel extends _BaseModel_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.selection.grid.ColumnModel'
         * @protected
         */
        className: 'Neo.selection.grid.ColumnModel',
        /**
         * @member {String} ntype='selection-grid-columnmodel'
         * @protected
         */
        ntype: 'selection-grid-columnmodel',
        /**
         * @member {String} cls='selection-columnmodel'
         * @protected
         */
        cls: 'neo-selection-columnmodel'
    }

    /**
     *
     */
    addDomListener() {
        let me = this;

        me.view.on('cellClick', me.onCellClick, me)
    }

    /**
     * @param args
     */
    destroy(...args) {
        let me = this;

        me.view.un('cellClick', me.onCellClick, me);

        super.destroy(...args)
    }

    /**
     * @param {Object} eventPath
     * @returns {String|null} cellId
     */
    static getCellId(eventPath) {
        let id   = null,
            i    = 0,
            len  = eventPath.length;

        for (; i < len; i++) {
            if (eventPath[i].cls.includes('neo-grid-cell')) {
                id = eventPath[i].id;
                break
            }
        }

        return id
    }

    /**
     * todo: move to grid.Container or view
     * @param {String} cellId
     * @param {Object[]} columns
     * @returns {Number} index
     */
    static getColumnIndex(cellId, columns) {
        let idArray       = cellId.split('__'),
            currentColumn = idArray[2],
            dataFields    = columns.map(c => c.field);

        return dataFields.indexOf(currentColumn)
    }

    /**
     * @param {Object} data
     */
    onCellClick(data) {
        let me = this,
            id = data.data.currentTarget,
            columnNodeIds, index, tbodyNode;

        if (id) {
            index         = ColumnModel.getColumnIndex(id, me.view.items[0].items);
            tbodyNode     = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].find(me.view.vdom, {cls: 'neo-grid-view'}).vdom;
            columnNodeIds = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].getColumnNodesIds(tbodyNode, index);

            me.select(columnNodeIds)
        }
    }

    /**
     * @param {Object} data
     */
    onKeyDownLeft(data) {
        this.onNavKeyColumn(data, -1)
    }

    /**
     * @param {Object} data
     */
    onKeyDownRight(data) {
        this.onNavKeyColumn(data, 1)
    }

    /**
     * @param {Object} data
     * @param {Number} step
     */
    onNavKeyColumn(data, step) {
        let me            = this,
            idArray       = ColumnModel.getCellId(data.path).split('__'),
            currentColumn = idArray[2],
            {view}        = me,
            fields        = view.columns.map(c => c.field),
            newIndex      = (fields.indexOf(currentColumn) + step) % fields.length,
            columnNodeIds, id, tbodyNode;

        while (newIndex < 0) {
            newIndex += fields.length
        }

        idArray[2] = fields[newIndex];
        id = idArray.join('__');

        tbodyNode     = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].find(me.view.vdom, {cls: 'neo-grid-view'}).vdom;
        columnNodeIds = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].getColumnNodesIds(tbodyNode, newIndex);

        me.select(columnNodeIds);
        view.focus(id) // we have to focus one cell to ensure the keynav keeps working
    }

    /**
     * @param {Neo.component.Base} component
     */
    register(component) {
        super.register(component);

        let {id, view} = this;

        view.keys?._keys.push(
            {fn: 'onKeyDownLeft',  key: 'Left',  scope: id},
            {fn: 'onKeyDownRight', key: 'Right', scope: id}
        )
    }

    /**
     *
     */
    unregister() {
        let {id, view} = this;

        view.keys?.removeKeys([
            {fn: 'onKeyDownLeft',  key: 'Left',  scope: id},
            {fn: 'onKeyDownRight', key: 'Right', scope: id}
        ]);

        super.unregister()
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(ColumnModel));


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2h1bmtzL2FwcC92ZW5kb3JzLWV4YW1wbGVzX2dyaWRfY29udGFpbmVyX2FwcF9tanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQW9GO0FBQ0c7QUFDVDtBQUNHO0FBQ2I7QUFDWTtBQUNaO0FBQ2hCO0FBQ21CO0FBQ0Q7QUFDTzs7QUFFN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsa0VBQXFCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQjtBQUMvQjs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsNEJBQTRCLGlFQUFLO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx1QkFBdUIsa0VBQVc7QUFDbEM7QUFDQSx3QkFBd0IsNkNBQTZDO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixvREFBb0QseUVBQVMsRUFBRTtBQUM1Riw2QkFBNkIsa0JBQWtCO0FBQy9DO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSw2QkFBNkIsb0RBQW9ELDJFQUFXLEVBQUU7QUFDOUY7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLDZCQUE2QixvREFBb0QseUVBQVEsRUFBRTtBQUMzRjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsNkJBQTZCLG9EQUFvRCwrRUFBZSxFQUFFO0FBQ2xHO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSw2QkFBNkIsb0RBQW9ELDRFQUFZLEVBQUU7QUFDL0Y7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLDZCQUE2QixvREFBb0Qsa0ZBQWtCLEVBQUU7QUFDckc7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQSwwQkFBMEIsK0RBQWE7QUFDdkMsNEJBQTRCLHlFQUFTO0FBQ3JDLDRCQUE0QixzREFBUzs7QUFFckM7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQSxpQkFBaUIsc0NBQXNDO0FBQ3ZELGlCQUFpQixxQ0FBcUM7QUFD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QUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QixlQUFlLFVBQVU7QUFDekIsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDRCQUE0QixzREFBUSxxQkFBcUIscUJBQXFCO0FBQzlFLDRCQUE0QixzREFBUTs7QUFFcEM7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxhQUFhO0FBQzFCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSx3QkFBd0Isc0RBQVEscUJBQXFCLHFCQUFxQjtBQUMxRSx3QkFBd0Isc0RBQVE7O0FBRWhDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGVBQWUsb0JBQW9CO0FBQ25DO0FBQ0E7QUFDQTs7QUFFQSxhQUFhLFVBQVU7O0FBRXZCO0FBQ0EsYUFBYSw4Q0FBOEM7QUFDM0QsYUFBYTtBQUNiO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLFVBQVU7O0FBRXZCO0FBQ0EsYUFBYSw4Q0FBOEM7QUFDM0QsYUFBYTtBQUNiOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxpRUFBZSwyQkFBMkIsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL25lby5tanMvLi9leGFtcGxlcy9ncmlkL2NvbnRhaW5lci9NYWluQ29udGFpbmVyLm1qcyIsIndlYnBhY2s6Ly9uZW8ubWpzLy4vZXhhbXBsZXMvZ3JpZC9jb250YWluZXIvTWFpbk1vZGVsLm1qcyIsIndlYnBhY2s6Ly9uZW8ubWpzLy4vZXhhbXBsZXMvZ3JpZC9jb250YWluZXIvTWFpblN0b3JlLm1qcyIsIndlYnBhY2s6Ly9uZW8ubWpzLy4vZXhhbXBsZXMvZ3JpZC9jb250YWluZXIvYXBwLm1qcyIsIndlYnBhY2s6Ly9uZW8ubWpzLy4vc3JjL2Zvcm0vZmllbGQvUmFkaW8ubWpzIiwid2VicGFjazovL25lby5tanMvLi9zcmMvc2VsZWN0aW9uL2dyaWQvQ2VsbENvbHVtbk1vZGVsLm1qcyIsIndlYnBhY2s6Ly9uZW8ubWpzLy4vc3JjL3NlbGVjdGlvbi9ncmlkL0NlbGxDb2x1bW5Sb3dNb2RlbC5tanMiLCJ3ZWJwYWNrOi8vbmVvLm1qcy8uL3NyYy9zZWxlY3Rpb24vZ3JpZC9DZWxsTW9kZWwubWpzIiwid2VicGFjazovL25lby5tanMvLi9zcmMvc2VsZWN0aW9uL2dyaWQvQ2VsbFJvd01vZGVsLm1qcyIsIndlYnBhY2s6Ly9uZW8ubWpzLy4vc3JjL3NlbGVjdGlvbi9ncmlkL0NvbHVtbk1vZGVsLm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ2VsbENvbHVtbk1vZGVsICAgICAgIGZyb20gJy4uLy4uLy4uL3NyYy9zZWxlY3Rpb24vZ3JpZC9DZWxsQ29sdW1uTW9kZWwubWpzJztcbmltcG9ydCBDZWxsQ29sdW1uUm93TW9kZWwgICAgZnJvbSAnLi4vLi4vLi4vc3JjL3NlbGVjdGlvbi9ncmlkL0NlbGxDb2x1bW5Sb3dNb2RlbC5tanMnO1xuaW1wb3J0IENlbGxNb2RlbCAgICAgICAgICAgICBmcm9tICcuLi8uLi8uLi9zcmMvc2VsZWN0aW9uL2dyaWQvQ2VsbE1vZGVsLm1qcyc7XG5pbXBvcnQgQ2VsbFJvd01vZGVsICAgICAgICAgIGZyb20gJy4uLy4uLy4uL3NyYy9zZWxlY3Rpb24vZ3JpZC9DZWxsUm93TW9kZWwubWpzJztcbmltcG9ydCBDb25maWd1cmF0aW9uVmlld3BvcnQgZnJvbSAnLi4vLi4vQ29uZmlndXJhdGlvblZpZXdwb3J0Lm1qcyc7XG5pbXBvcnQgQ29sdW1uTW9kZWwgICAgICAgICAgIGZyb20gJy4uLy4uLy4uL3NyYy9zZWxlY3Rpb24vZ3JpZC9Db2x1bW5Nb2RlbC5tanMnO1xuaW1wb3J0IEdyaWRDb250YWluZXIgICAgICAgICBmcm9tICcuLi8uLi8uLi9zcmMvZ3JpZC9Db250YWluZXIubWpzJztcbmltcG9ydCBNYWluU3RvcmUgICAgICAgICAgICAgZnJvbSAnLi9NYWluU3RvcmUubWpzJztcbmltcG9ydCBOdW1iZXJGaWVsZCAgICAgICAgICAgZnJvbSAnLi4vLi4vLi4vc3JjL2Zvcm0vZmllbGQvTnVtYmVyLm1qcyc7XG5pbXBvcnQgUmFkaW8gICAgICAgICAgICAgICAgIGZyb20gJy4uLy4uLy4uL3NyYy9mb3JtL2ZpZWxkL1JhZGlvLm1qcyc7XG5pbXBvcnQgUm93TW9kZWwgICAgICAgICAgICAgIGZyb20gJy4uLy4uLy4uL3NyYy9zZWxlY3Rpb24vZ3JpZC9Sb3dNb2RlbC5tanMnO1xuXG4vKipcbiAqIEBjbGFzcyBOZW8uZXhhbXBsZXMuZ3JpZC5jb250YWluZXIuTWFpbkNvbnRhaW5lclxuICogQGV4dGVuZHMgTmVvLmV4YW1wbGVzLkNvbmZpZ3VyYXRpb25WaWV3cG9ydFxuICovXG5jbGFzcyBNYWluQ29udGFpbmVyIGV4dGVuZHMgQ29uZmlndXJhdGlvblZpZXdwb3J0IHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICBjbGFzc05hbWUgICAgICAgICAgIDogJ05lby5leGFtcGxlcy5ncmlkLmNvbnRhaW5lci5NYWluQ29udGFpbmVyJyxcbiAgICAgICAgYXV0b01vdW50ICAgICAgICAgICA6IHRydWUsXG4gICAgICAgIGNvbmZpZ0l0ZW1MYWJlbFdpZHRoOiAxMzAsXG4gICAgICAgIGNvbmZpZ1BhbmVsRmxleCAgICAgOiAxLjUsXG4gICAgICAgIGV4YW1wbGVDb21wb25lbnRGbGV4OiAzLFxuICAgICAgICBsYXlvdXQgICAgICAgICAgICAgIDoge250eXBlOiAnaGJveCcsIGFsaWduOiAnc3RyZXRjaCd9XG4gICAgfVxuXG4gICAgY3JlYXRlQ29uZmlndXJhdGlvbkNvbXBvbmVudHMoKSB7XG4gICAgICAgIGxldCBtZSA9IHRoaXM7XG5cbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uTW9kZWxSYWRpb0RlZmF1bHRzID0ge1xuICAgICAgICAgICAgbW9kdWxlICAgICAgICA6IFJhZGlvLFxuICAgICAgICAgICAgaGlkZVZhbHVlTGFiZWw6IGZhbHNlLFxuICAgICAgICAgICAgbGFiZWxUZXh0ICAgICA6ICcnLFxuICAgICAgICAgICAgbmFtZSAgICAgICAgICA6ICdzZWxlY3Rpb25Nb2RlbCcsXG4gICAgICAgICAgICB3aWR0aCAgICAgICAgIDogMzUwXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIFt7XG4gICAgICAgICAgICBtb2R1bGUgICA6IE51bWJlckZpZWxkLFxuICAgICAgICAgICAgbGFiZWxUZXh0OiAnaGVpZ2h0JyxcbiAgICAgICAgICAgIGxpc3RlbmVyczoge2NoYW5nZTogbWUub25Db25maWdDaGFuZ2UuYmluZChtZSwgJ2hlaWdodCcpfSxcbiAgICAgICAgICAgIG1heFZhbHVlIDogODAwLFxuICAgICAgICAgICAgbWluVmFsdWUgOiAyMjUsXG4gICAgICAgICAgICBzdGVwU2l6ZSA6IDUsXG4gICAgICAgICAgICB2YWx1ZSAgICA6IG1lLmV4YW1wbGVDb21wb25lbnQuaGVpZ2h0XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIC4uLnNlbGVjdGlvbk1vZGVsUmFkaW9EZWZhdWx0cyxcbiAgICAgICAgICAgIGNoZWNrZWQgICAgICAgOiBtZS5leGFtcGxlQ29tcG9uZW50LnNlbGVjdGlvbk1vZGVsLm50eXBlID09PSAnc2VsZWN0aW9uLWdyaWQtY2VsbG1vZGVsJyxcbiAgICAgICAgICAgIGxhYmVsVGV4dCAgICAgOiAnc2VsZWN0aW9uTW9kZWwnLFxuICAgICAgICAgICAgbGlzdGVuZXJzICAgICA6IHtjaGFuZ2U6IG1lLm9uUmFkaW9DaGFuZ2UuYmluZChtZSwgJ3NlbGVjdGlvbk1vZGVsJywgQ2VsbE1vZGVsKX0sXG4gICAgICAgICAgICBzdHlsZSAgICAgICAgIDoge21hcmdpblRvcDogJzEwcHgnfSxcbiAgICAgICAgICAgIHZhbHVlTGFiZWxUZXh0OiAnQ2VsbCdcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgLi4uc2VsZWN0aW9uTW9kZWxSYWRpb0RlZmF1bHRzLFxuICAgICAgICAgICAgY2hlY2tlZCAgICAgICA6IG1lLmV4YW1wbGVDb21wb25lbnQuc2VsZWN0aW9uTW9kZWwubnR5cGUgPT09ICdzZWxlY3Rpb24tZ3JpZC1jb2x1bW5tb2RlbCcsXG4gICAgICAgICAgICBsaXN0ZW5lcnMgICAgIDoge2NoYW5nZTogbWUub25SYWRpb0NoYW5nZS5iaW5kKG1lLCAnc2VsZWN0aW9uTW9kZWwnLCBDb2x1bW5Nb2RlbCl9LFxuICAgICAgICAgICAgdmFsdWVMYWJlbFRleHQ6ICdDb2x1bW4nXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIC4uLnNlbGVjdGlvbk1vZGVsUmFkaW9EZWZhdWx0cyxcbiAgICAgICAgICAgIGNoZWNrZWQgICAgICAgOiBtZS5leGFtcGxlQ29tcG9uZW50LnNlbGVjdGlvbk1vZGVsLm50eXBlID09PSAnc2VsZWN0aW9uLWdyaWQtcm93bW9kZWwnLFxuICAgICAgICAgICAgbGlzdGVuZXJzICAgICA6IHtjaGFuZ2U6IG1lLm9uUmFkaW9DaGFuZ2UuYmluZChtZSwgJ3NlbGVjdGlvbk1vZGVsJywgUm93TW9kZWwpfSxcbiAgICAgICAgICAgIHZhbHVlTGFiZWxUZXh0OiAnUm93J1xuICAgICAgICB9LCB7XG4gICAgICAgICAgICAuLi5zZWxlY3Rpb25Nb2RlbFJhZGlvRGVmYXVsdHMsXG4gICAgICAgICAgICBjaGVja2VkICAgICAgIDogbWUuZXhhbXBsZUNvbXBvbmVudC5zZWxlY3Rpb25Nb2RlbC5udHlwZSA9PT0gJ3NlbGVjdGlvbi1ncmlkLWNlbGxjb2x1bW5tb2RlbCcsXG4gICAgICAgICAgICBsaXN0ZW5lcnMgICAgIDoge2NoYW5nZTogbWUub25SYWRpb0NoYW5nZS5iaW5kKG1lLCAnc2VsZWN0aW9uTW9kZWwnLCBDZWxsQ29sdW1uTW9kZWwpfSxcbiAgICAgICAgICAgIHZhbHVlTGFiZWxUZXh0OiAnQ2VsbCAmIENvbHVtbidcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgLi4uc2VsZWN0aW9uTW9kZWxSYWRpb0RlZmF1bHRzLFxuICAgICAgICAgICAgY2hlY2tlZCAgICAgICA6IG1lLmV4YW1wbGVDb21wb25lbnQuc2VsZWN0aW9uTW9kZWwubnR5cGUgPT09ICdzZWxlY3Rpb24tZ3JpZC1jZWxscm93bW9kZWwnLFxuICAgICAgICAgICAgbGlzdGVuZXJzICAgICA6IHtjaGFuZ2U6IG1lLm9uUmFkaW9DaGFuZ2UuYmluZChtZSwgJ3NlbGVjdGlvbk1vZGVsJywgQ2VsbFJvd01vZGVsKX0sXG4gICAgICAgICAgICB2YWx1ZUxhYmVsVGV4dDogJ0NlbGwgJiBSb3cnXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIC4uLnNlbGVjdGlvbk1vZGVsUmFkaW9EZWZhdWx0cyxcbiAgICAgICAgICAgIGNoZWNrZWQgICAgICAgOiBtZS5leGFtcGxlQ29tcG9uZW50LnNlbGVjdGlvbk1vZGVsLm50eXBlID09PSAnc2VsZWN0aW9uLWdyaWQtY2VsbGNvbHVtbnJvd21vZGVsJyxcbiAgICAgICAgICAgIGxpc3RlbmVycyAgICAgOiB7Y2hhbmdlOiBtZS5vblJhZGlvQ2hhbmdlLmJpbmQobWUsICdzZWxlY3Rpb25Nb2RlbCcsIENlbGxDb2x1bW5Sb3dNb2RlbCl9LFxuICAgICAgICAgICAgdmFsdWVMYWJlbFRleHQ6ICdDZWxsICYgQ29sdW1uICYgUm93J1xuICAgICAgICB9XVxuICAgIH1cblxuICAgIGNyZWF0ZUV4YW1wbGVDb21wb25lbnQoKSB7XG4gICAgICAgIHJldHVybiBOZW8uY3JlYXRlKEdyaWRDb250YWluZXIsIHtcbiAgICAgICAgICAgIHNlbGVjdGlvbk1vZGVsOiBDZWxsTW9kZWwsXG4gICAgICAgICAgICBzdG9yZSAgICAgICAgIDogTWFpblN0b3JlLFxuXG4gICAgICAgICAgICBjb2x1bW5EZWZhdWx0czoge1xuICAgICAgICAgICAgICAgIHdpZHRoOiAyMDBcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGNvbHVtbnM6IFtcbiAgICAgICAgICAgICAgICB7ZmllbGQ6ICdmaXJzdG5hbWUnLCB0ZXh0OiAnRmlyc3RuYW1lJ30sXG4gICAgICAgICAgICAgICAge2ZpZWxkOiAnbGFzdG5hbWUnLCAgdGV4dDogJ0xhc3RuYW1lJ30sXG4gICAgICAgICAgICAgICAge2ZpZWxkOiAnZ2l0aHViSWQnLCAgdGV4dDogJ0dpdGh1YiBJZCd9LFxuICAgICAgICAgICAgICAgIHtmaWVsZDogJ2NvdW50cnknLCAgIHRleHQ6ICdDb3VudHJ5J31cbiAgICAgICAgICAgIF1cbiAgICAgICAgfSlcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IE5lby5zZXR1cENsYXNzKE1haW5Db250YWluZXIpO1xuIiwiaW1wb3J0IE1vZGVsIGZyb20gJy4uLy4uLy4uL3NyYy9kYXRhL01vZGVsLm1qcyc7XG5cbi8qKlxuICogQGNsYXNzIE5lby5leGFtcGxlcy5ncmlkLmNvbnRhaW5lci5NYWluTW9kZWxcbiAqIEBleHRlbmRzIE5lby5kYXRhLk1vZGVsXG4gKi9cbmNsYXNzIE1haW5Nb2RlbCBleHRlbmRzIE1vZGVsIHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICBjbGFzc05hbWU6ICdOZW8uZXhhbXBsZXMuZ3JpZC5jb250YWluZXIuTWFpbk1vZGVsJyxcblxuICAgICAgICBmaWVsZHM6IFt7XG4gICAgICAgICAgICBuYW1lOiAnY291bnRyeScsXG4gICAgICAgICAgICB0eXBlOiAnU3RyaW5nJ1xuICAgICAgICB9LCB7XG4gICAgICAgICAgICBuYW1lOiAnZmlyc3RuYW1lJyxcbiAgICAgICAgICAgIHR5cGU6ICdTdHJpbmcnXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIG5hbWU6ICdnaXRodWJJZCcsXG4gICAgICAgICAgICB0eXBlOiAnU3RyaW5nJ1xuICAgICAgICB9LCB7XG4gICAgICAgICAgICBuYW1lOiAnbGFzdG5hbWUnLFxuICAgICAgICAgICAgdHlwZTogJ1N0cmluZydcbiAgICAgICAgfV1cbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IE5lby5zZXR1cENsYXNzKE1haW5Nb2RlbCk7XG4iLCJpbXBvcnQgTW9kZWwgZnJvbSAnLi9NYWluTW9kZWwubWpzJztcbmltcG9ydCBTdG9yZSBmcm9tICcuLi8uLi8uLi9zcmMvZGF0YS9TdG9yZS5tanMnO1xuXG4vKipcbiAqIEBjbGFzcyBOZW8uZXhhbXBsZXMuZ3JpZC5jb250YWluZXIuTWFpblN0b3JlXG4gKiBAZXh0ZW5kcyBOZW8uZGF0YS5TdG9yZVxuICovXG5jbGFzcyBNYWluU3RvcmUgZXh0ZW5kcyBTdG9yZSB7XG4gICAgc3RhdGljIGNvbmZpZyA9IHtcbiAgICAgICAgY2xhc3NOYW1lICA6ICdOZW8uZXhhbXBsZXMuZ3JpZC5jb250YWluZXIuTWFpblN0b3JlJyxcbiAgICAgICAga2V5UHJvcGVydHk6ICdnaXRodWJJZCcsXG4gICAgICAgIG1vZGVsICAgICAgOiBNb2RlbCxcblxuICAgICAgICBkYXRhOiBbe1xuICAgICAgICAgICAgY291bnRyeSAgOiAnR2VybWFueScsXG4gICAgICAgICAgICBmaXJzdG5hbWU6ICdUb2JpYXMnLFxuICAgICAgICAgICAgZ2l0aHViSWQgOiAndG9iaXUnLFxuICAgICAgICAgICAgbGFzdG5hbWUgOiAnVWhsaWcnXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGNvdW50cnkgIDogJ1VTQScsXG4gICAgICAgICAgICBmaXJzdG5hbWU6ICdSaWNoJyxcbiAgICAgICAgICAgIGdpdGh1YklkIDogJ3J3YXRlcnMnLFxuICAgICAgICAgICAgbGFzdG5hbWUgOiAnV2F0ZXJzJ1xuICAgICAgICB9LCB7XG4gICAgICAgICAgICBjb3VudHJ5ICA6ICdHZXJtYW55JyxcbiAgICAgICAgICAgIGZpcnN0bmFtZTogJ05pbHMnLFxuICAgICAgICAgICAgZ2l0aHViSWQgOiAnbXJzdW5zaGluZScsXG4gICAgICAgICAgICBsYXN0bmFtZSA6ICdEZWhsJ1xuICAgICAgICB9LCB7XG4gICAgICAgICAgICBjb3VudHJ5ICA6ICdVU0EnLFxuICAgICAgICAgICAgZmlyc3RuYW1lOiAnR2VyYXJkJyxcbiAgICAgICAgICAgIGdpdGh1YklkIDogJ2NhbXRuYmlrZXJyd2MnLFxuICAgICAgICAgICAgbGFzdG5hbWUgOiAnSG9yYW4nXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGNvdW50cnkgIDogJ1Nsb3Zha2lhJyxcbiAgICAgICAgICAgIGZpcnN0bmFtZTogJ0pvemVmJyxcbiAgICAgICAgICAgIGdpdGh1YklkIDogJ2pzYWthbG9zJyxcbiAgICAgICAgICAgIGxhc3RuYW1lIDogJ1Nha2Fsb3MnXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGNvdW50cnkgIDogJ0dlcm1hbnknLFxuICAgICAgICAgICAgZmlyc3RuYW1lOiAnQmFzdGlhbicsXG4gICAgICAgICAgICBnaXRodWJJZCA6ICdiaGF1c3RlaW4nLFxuICAgICAgICAgICAgbGFzdG5hbWUgOiAnSGF1c3RlaW4nXG4gICAgICAgIH1dXG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBOZW8uc2V0dXBDbGFzcyhNYWluU3RvcmUpO1xuIiwiaW1wb3J0IE1haW5Db250YWluZXIgZnJvbSAnLi9NYWluQ29udGFpbmVyLm1qcyc7XG5cbmV4cG9ydCBjb25zdCBvblN0YXJ0ID0gKCkgPT4gTmVvLmFwcCh7XG4gICAgbWFpblZpZXc6IE1haW5Db250YWluZXIsXG4gICAgbmFtZSAgICA6ICdOZW8uZXhhbXBsZXMuZ3JpZC5jb250YWluZXInXG59KTtcbiIsImltcG9ydCBDaGVja0JveCAgICAgICAgIGZyb20gJy4vQ2hlY2tCb3gubWpzJztcbmltcG9ydCBDb21wb25lbnRNYW5hZ2VyIGZyb20gJy4uLy4uL21hbmFnZXIvQ29tcG9uZW50Lm1qcyc7XG5cbi8qKlxuICogQGNsYXNzIE5lby5mb3JtLmZpZWxkLlJhZGlvXG4gKiBAZXh0ZW5kcyBOZW8uZm9ybS5maWVsZC5DaGVja0JveFxuICovXG5jbGFzcyBSYWRpbyBleHRlbmRzIENoZWNrQm94IHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J05lby5mb3JtLmZpZWxkLlJhZGlvJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBjbGFzc05hbWU6ICdOZW8uZm9ybS5maWVsZC5SYWRpbycsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IG50eXBlPSdyYWRpb2ZpZWxkJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBudHlwZTogJ3JhZGlvZmllbGQnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nW119IGJhc2VDbHM9WyduZW8tcmFkaW9maWVsZCcsJ25lby1jaGVja2JveGZpZWxkJ11cbiAgICAgICAgICovXG4gICAgICAgIGJhc2VDbHM6IFsnbmVvLXJhZGlvZmllbGQnLCAnbmVvLWNoZWNrYm94ZmllbGQnXSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ1tdfSBpY29uQ2xzPVsnZmFyJywnZmEtY2lyY2xlJ11cbiAgICAgICAgICovXG4gICAgICAgIGljb25DbHM6IFsnZmFyJywgJ2ZhLWNpcmNsZSddLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBpbnB1dFR5cGU9J3JhZGlvJ1xuICAgICAgICAgKi9cbiAgICAgICAgaW5wdXRUeXBlOiAncmFkaW8nXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJpZ2dlcmVkIGFmdGVyIHRoZSBjaGVja2VkIGNvbmZpZyBnb3QgY2hhbmdlZFxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gdmFsdWVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IG9sZFZhbHVlXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIGFmdGVyU2V0Q2hlY2tlZCh2YWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgc3VwZXIuYWZ0ZXJTZXRDaGVja2VkKHZhbHVlLCBvbGRWYWx1ZSk7XG5cbiAgICAgICAgLy8gdXBkYXRlIHJhZGlvcyB3aXRoIHRoZSBzYW1lIG5hbWUgdG8gYmUgdW5jaGVja2VkXG4gICAgICAgIHZhbHVlICYmIHRoaXMudW5jaGVja0dyb3VwSXRlbXMoKVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJhZGlvcyBzaG91bGQgb25seSBmaXJlIGNoYW5nZSAmIGZpZWxkQ2hhbmdlIGV2ZW50cyBpZiBjaGVja2VkLlxuICAgICAqIElmIHRoZXJlIHdhcyBqdXN0IDEgcmFkaW8sIHlvdSBjYW4gbm90IHVuY2hlY2sgaXQuXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZVxuICAgICAqIEBwYXJhbSB7Kn0gb2xkVmFsdWVcbiAgICAgKi9cbiAgICBmaXJlQ2hhbmdlRXZlbnQodmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgICAgIHRoaXMuY2hlY2tlZCAmJiBzdXBlci5maXJlQ2hhbmdlRXZlbnQodmFsdWUsIG9sZFZhbHVlKVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHtTdHJpbmdbXX1cbiAgICAgKi9cbiAgICBnZXRHcm91cFZhbHVlKCkge1xuICAgICAgICBsZXQgdmFsdWUgPSBzdXBlci5nZXRHcm91cFZhbHVlKCk7XG5cbiAgICAgICAgcmV0dXJuIHZhbHVlLmxlbmd0aCA+IDAgPyB2YWx1ZVswXSA6IFtdXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmFkaW9zIGRvIG5vdCBmaXJlIGEgY2hhbmdlIGV2ZW50IGZvciBcInVuY2hlY2tcIiwgc28gd2UgbmVlZCB0byBpdGVyYXRlIG92ZXIgb3RoZXIgcmFkaW9zIHdpdGggdGhlIHNhbWUgbmFtZS5cbiAgICAgKi9cbiAgICB1bmNoZWNrR3JvdXBJdGVtcygpIHtcbiAgICAgICAgbGV0IG1lID0gdGhpcyxcbiAgICAgICAgICAgIHJhZGlvcztcblxuICAgICAgICAvLyBkaXNjdXNzOiB3ZSBjb3VsZCBsaW1pdCB0aGlzIHRvIHJhZGlvcyBpbnNpZGUgdGhlIHNhbWUgZm9ybSwgSUYgYSB0b3AgbGV2ZWwgZm9ybSBpcyB1c2VkXG4gICAgICAgIHJhZGlvcyA9IENvbXBvbmVudE1hbmFnZXIuZmluZCh7XG4gICAgICAgICAgICBudHlwZTogJ3JhZGlvZmllbGQnLFxuICAgICAgICAgICAgbmFtZSA6IG1lLm5hbWVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmFkaW9zLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgICBpZiAoaXRlbS5pZCAhPT0gbWUuaWQgJiYgaXRlbS5fY2hlY2tlZCkge1xuICAgICAgICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBOZW8uc2V0dXBDbGFzcyhSYWRpbyk7XG4iLCJpbXBvcnQgQ2VsbE1vZGVsICAgZnJvbSAnLi9DZWxsTW9kZWwubWpzJztcbmltcG9ydCBDb2x1bW5Nb2RlbCBmcm9tICcuL0NvbHVtbk1vZGVsLm1qcyc7XG5pbXBvcnQgVkRvbVV0aWwgICAgZnJvbSAnLi4vLi4vdXRpbC9WRG9tLm1qcyc7XG5cbi8qKlxuICogQGNsYXNzIE5lby5zZWxlY3Rpb24uZ3JpZC5DZWxsQ29sdW1uTW9kZWxcbiAqIEBleHRlbmRzIE5lby5zZWxlY3Rpb24uZ3JpZC5DZWxsTW9kZWxcbiAqL1xuY2xhc3MgQ2VsbENvbHVtbk1vZGVsIGV4dGVuZHMgQ2VsbE1vZGVsIHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J05lby5zZWxlY3Rpb24uZ3JpZC5DZWxsQ29sdW1uTW9kZWwnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ05lby5zZWxlY3Rpb24uZ3JpZC5DZWxsQ29sdW1uTW9kZWwnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBudHlwZT0nc2VsZWN0aW9uLWdyaWQtY2VsbGNvbHVtbm1vZGVsJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBudHlwZTogJ3NlbGVjdGlvbi1ncmlkLWNlbGxjb2x1bW5tb2RlbCcsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IGNscz0nbmVvLXNlbGVjdGlvbi1jZWxsY29sdW1ubW9kZWwnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsczogJ25lby1zZWxlY3Rpb24tY2VsbGNvbHVtbm1vZGVsJyxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gc2VsZWN0ZWRDb2x1bW5DZWxsQ2xzPSdzZWxlY3RlZC1jb2x1bW4tY2VsbCdcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgc2VsZWN0ZWRDb2x1bW5DZWxsQ2xzOiAnc2VsZWN0ZWQtY29sdW1uLWNlbGwnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7QXJyYXl8bnVsbH0gc2VsZWN0ZWRDb2x1bW5DZWxsSWRzPW51bGxcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgc2VsZWN0ZWRDb2x1bW5DZWxsSWRzOiBudWxsXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZ1xuICAgICAqL1xuICAgIGNvbnN0cnVjdChjb25maWcpIHtcbiAgICAgICAgc3VwZXIuY29uc3RydWN0KGNvbmZpZyk7XG5cbiAgICAgICAgdGhpcy5zZWxlY3RlZENvbHVtbkNlbGxJZHMgPSBbXVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW3NpbGVudF0gdHJ1ZSB0byBwcmV2ZW50IGEgdmRvbSB1cGRhdGVcbiAgICAgKi9cbiAgICBkZXNlbGVjdEFsbENlbGxzKHNpbGVudCkge1xuICAgICAgICBsZXQgbWUgICAgICA9IHRoaXMsXG4gICAgICAgICAgICBjZWxsSWRzID0gWy4uLm1lLnNlbGVjdGVkQ29sdW1uQ2VsbElkc10sXG4gICAgICAgICAgICB7dmlld30gID0gbWVcblxuICAgICAgICBjZWxsSWRzLmZvckVhY2goY2VsbElkID0+IHtcbiAgICAgICAgICAgIG1lLmRlc2VsZWN0KGNlbGxJZCwgdHJ1ZSwgbWUuc2VsZWN0ZWRDb2x1bW5DZWxsSWRzLCBtZS5zZWxlY3RlZENvbHVtbkNlbGxDbHMpXG4gICAgICAgIH0pO1xuXG4gICAgICAgICFzaWxlbnQgJiYgdmlldy51cGRhdGUoKVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhXG4gICAgICovXG4gICAgb25DZWxsQ2xpY2soZGF0YSkge1xuICAgICAgICBsZXQgbWUgPSB0aGlzLFxuICAgICAgICAgICAgaWQgPSBkYXRhLmRhdGEuY3VycmVudFRhcmdldCxcbiAgICAgICAgICAgIGNvbHVtbk5vZGVJZHMsIGluZGV4LCB0Ym9keU5vZGU7XG5cbiAgICAgICAgaWYgKGlkKSB7XG4gICAgICAgICAgICBpbmRleCAgICAgICAgID0gQ29sdW1uTW9kZWwuZ2V0Q29sdW1uSW5kZXgoaWQsIG1lLnZpZXcuaXRlbXNbMF0uaXRlbXMpO1xuICAgICAgICAgICAgdGJvZHlOb2RlICAgICA9IFZEb21VdGlsLmZpbmQobWUudmlldy52ZG9tLCB7Y2xzOiAnbmVvLWdyaWQtdmlldyd9KS52ZG9tO1xuICAgICAgICAgICAgY29sdW1uTm9kZUlkcyA9IFZEb21VdGlsLmdldENvbHVtbk5vZGVzSWRzKHRib2R5Tm9kZSwgaW5kZXgpO1xuXG4gICAgICAgICAgICBtZS5kZXNlbGVjdEFsbENlbGxzKHRydWUpO1xuICAgICAgICAgICAgbWUuc2VsZWN0KGNvbHVtbk5vZGVJZHMsIG1lLnNlbGVjdGVkQ29sdW1uQ2VsbElkcywgbWUuc2VsZWN0ZWRDb2x1bW5DZWxsQ2xzKVxuICAgICAgICB9XG5cbiAgICAgICAgc3VwZXIub25DZWxsQ2xpY2soZGF0YSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBzdGVwXG4gICAgICovXG4gICAgb25OYXZLZXlDb2x1bW4oZGF0YSwgc3RlcCkge1xuICAgICAgICBsZXQgbWUgICAgICAgICAgICA9IHRoaXMsXG4gICAgICAgICAgICBpZEFycmF5ICAgICAgID0gQ29sdW1uTW9kZWwuZ2V0Q2VsbElkKGRhdGEucGF0aCkuc3BsaXQoJ19fJyksXG4gICAgICAgICAgICBjdXJyZW50Q29sdW1uID0gaWRBcnJheVsyXSxcbiAgICAgICAgICAgIHt2aWV3fSAgICAgICAgPSBtZSxcbiAgICAgICAgICAgIGZpZWxkcyAgICAgICAgPSB2aWV3LmNvbHVtbnMubWFwKGMgPT4gYy5maWVsZCksXG4gICAgICAgICAgICBuZXdJbmRleCAgICAgID0gKGZpZWxkcy5pbmRleE9mKGN1cnJlbnRDb2x1bW4pICsgc3RlcCkgJSBmaWVsZHMubGVuZ3RoLFxuICAgICAgICAgICAgY29sdW1uTm9kZUlkcywgdGJvZHlOb2RlO1xuXG4gICAgICAgIHdoaWxlIChuZXdJbmRleCA8IDApIHtcbiAgICAgICAgICAgIG5ld0luZGV4ICs9IGZpZWxkcy5sZW5ndGhcbiAgICAgICAgfVxuXG4gICAgICAgIHRib2R5Tm9kZSAgICAgPSBWRG9tVXRpbC5maW5kKG1lLnZpZXcudmRvbSwge2NsczogJ25lby1ncmlkLXZpZXcnfSkudmRvbTtcbiAgICAgICAgY29sdW1uTm9kZUlkcyA9IFZEb21VdGlsLmdldENvbHVtbk5vZGVzSWRzKHRib2R5Tm9kZSwgbmV3SW5kZXgpO1xuXG4gICAgICAgIG1lLmRlc2VsZWN0QWxsQ2VsbHModHJ1ZSk7XG4gICAgICAgIG1lLnNlbGVjdChjb2x1bW5Ob2RlSWRzLCBtZS5zZWxlY3RlZENvbHVtbkNlbGxJZHMsIG1lLnNlbGVjdGVkQ29sdW1uQ2VsbENscyk7XG5cbiAgICAgICAgc3VwZXIub25OYXZLZXlDb2x1bW4oZGF0YSwgc3RlcClcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqL1xuICAgIHVucmVnaXN0ZXIoKSB7XG4gICAgICAgIHRoaXMuZGVzZWxlY3RBbGxDZWxscygpO1xuICAgICAgICBzdXBlci51bnJlZ2lzdGVyKClcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IE5lby5zZXR1cENsYXNzKENlbGxDb2x1bW5Nb2RlbCk7XG4iLCJpbXBvcnQgQ2VsbFJvd01vZGVsIGZyb20gJy4vQ2VsbFJvd01vZGVsLm1qcyc7XG5pbXBvcnQgQ29sdW1uTW9kZWwgIGZyb20gJy4vQ29sdW1uTW9kZWwubWpzJztcbmltcG9ydCBWRG9tVXRpbCAgICAgZnJvbSAnLi4vLi4vdXRpbC9WRG9tLm1qcyc7XG5cbi8qKlxuICogQGNsYXNzIE5lby5zZWxlY3Rpb24uZ3JpZC5DZWxsQ29sdW1uUm93TW9kZWxcbiAqIEBleHRlbmRzIE5lby5zZWxlY3Rpb24uZ3JpZC5DZWxsUm93TW9kZWxcbiAqL1xuY2xhc3MgQ2VsbENvbHVtblJvd01vZGVsIGV4dGVuZHMgQ2VsbFJvd01vZGVsIHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J05lby5zZWxlY3Rpb24uZ3JpZC5DZWxsQ29sdW1uUm93TW9kZWwnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ05lby5zZWxlY3Rpb24uZ3JpZC5DZWxsQ29sdW1uUm93TW9kZWwnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBudHlwZT0nc2VsZWN0aW9uLWdyaWQtY2VsbGNvbHVtbnJvd21vZGVsJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBudHlwZTogJ3NlbGVjdGlvbi1ncmlkLWNlbGxjb2x1bW5yb3dtb2RlbCcsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IGNscz0nbmVvLXNlbGVjdGlvbi1jZWxsY29sdW1ucm93bW9kZWwnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsczogJ25lby1zZWxlY3Rpb24tY2VsbGNvbHVtbnJvd21vZGVsJyxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gc2VsZWN0ZWRDb2x1bW5DZWxsQ2xzPSdzZWxlY3RlZC1jb2x1bW4tY2VsbCdcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgc2VsZWN0ZWRDb2x1bW5DZWxsQ2xzOiAnc2VsZWN0ZWQtY29sdW1uLWNlbGwnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7QXJyYXl8bnVsbH0gc2VsZWN0ZWRDb2x1bW5DZWxsSWRzPW51bGxcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgc2VsZWN0ZWRDb2x1bW5DZWxsSWRzOiBudWxsXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZ1xuICAgICAqL1xuICAgIGNvbnN0cnVjdChjb25maWcpIHtcbiAgICAgICAgc3VwZXIuY29uc3RydWN0KGNvbmZpZyk7XG5cbiAgICAgICAgdGhpcy5zZWxlY3RlZENvbHVtbkNlbGxJZHMgPSBbXVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW3NpbGVudF0gdHJ1ZSB0byBwcmV2ZW50IGEgdmRvbSB1cGRhdGVcbiAgICAgKi9cbiAgICBkZXNlbGVjdEFsbENlbGxzKHNpbGVudCkge1xuICAgICAgICBsZXQgbWUgICAgICA9IHRoaXMsXG4gICAgICAgICAgICBjZWxsSWRzID0gWy4uLm1lLnNlbGVjdGVkQ29sdW1uQ2VsbElkc10sXG4gICAgICAgICAgICB7dmlld30gID0gbWU7XG5cbiAgICAgICAgY2VsbElkcy5mb3JFYWNoKGNlbGxJZCA9PiB7XG4gICAgICAgICAgICBtZS5kZXNlbGVjdChjZWxsSWQsIHRydWUsIG1lLnNlbGVjdGVkQ29sdW1uQ2VsbElkcywgbWUuc2VsZWN0ZWRDb2x1bW5DZWxsQ2xzKVxuICAgICAgICB9KTtcblxuICAgICAgICAhc2lsZW50ICYmIHZpZXcudXBkYXRlKClcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqL1xuICAgIG9uQ2VsbENsaWNrKGRhdGEpIHtcbiAgICAgICAgbGV0IG1lID0gdGhpcyxcbiAgICAgICAgICAgIGlkID0gQ29sdW1uTW9kZWwuZ2V0Q2VsbElkKGRhdGEuZGF0YS5wYXRoKSxcbiAgICAgICAgICAgIGNvbHVtbk5vZGVJZHMsIGluZGV4LCB0Ym9keU5vZGU7XG5cbiAgICAgICAgaWYgKGlkKSB7XG4gICAgICAgICAgICBpbmRleCAgICAgICAgID0gQ29sdW1uTW9kZWwuZ2V0Q29sdW1uSW5kZXgoaWQsIG1lLnZpZXcuaXRlbXNbMF0uaXRlbXMpO1xuICAgICAgICAgICAgdGJvZHlOb2RlICAgICA9IFZEb21VdGlsLmZpbmQobWUudmlldy52ZG9tLCB7Y2xzOiAnbmVvLWdyaWQtdmlldyd9KS52ZG9tO1xuICAgICAgICAgICAgY29sdW1uTm9kZUlkcyA9IFZEb21VdGlsLmdldENvbHVtbk5vZGVzSWRzKHRib2R5Tm9kZSwgaW5kZXgpO1xuXG4gICAgICAgICAgICBtZS5kZXNlbGVjdEFsbENlbGxzKHRydWUpO1xuICAgICAgICAgICAgbWUuc2VsZWN0KGNvbHVtbk5vZGVJZHMsIG1lLnNlbGVjdGVkQ29sdW1uQ2VsbElkcywgbWUuc2VsZWN0ZWRDb2x1bW5DZWxsQ2xzKVxuICAgICAgICB9XG5cbiAgICAgICAgc3VwZXIub25DZWxsQ2xpY2soZGF0YSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBzdGVwXG4gICAgICovXG4gICAgb25OYXZLZXlDb2x1bW4oZGF0YSwgc3RlcCkge1xuICAgICAgICBsZXQgbWUgICAgICAgICAgICA9IHRoaXMsXG4gICAgICAgICAgICBpZEFycmF5ICAgICAgID0gQ29sdW1uTW9kZWwuZ2V0Q2VsbElkKGRhdGEucGF0aCkuc3BsaXQoJ19fJyksXG4gICAgICAgICAgICBjdXJyZW50Q29sdW1uID0gaWRBcnJheVsyXSxcbiAgICAgICAgICAgIHt2aWV3fSAgICAgICAgPSBtZSxcbiAgICAgICAgICAgIGZpZWxkcyAgICAgICAgPSB2aWV3LmNvbHVtbnMubWFwKGMgPT4gYy5maWVsZCksXG4gICAgICAgICAgICBuZXdJbmRleCAgICAgID0gKGZpZWxkcy5pbmRleE9mKGN1cnJlbnRDb2x1bW4pICsgc3RlcCkgJSBmaWVsZHMubGVuZ3RoLFxuICAgICAgICAgICAgY29sdW1uTm9kZUlkcywgdGJvZHlOb2RlO1xuXG4gICAgICAgIHdoaWxlIChuZXdJbmRleCA8IDApIHtcbiAgICAgICAgICAgIG5ld0luZGV4ICs9IGZpZWxkcy5sZW5ndGhcbiAgICAgICAgfVxuXG4gICAgICAgIHRib2R5Tm9kZSAgICAgPSBWRG9tVXRpbC5maW5kKG1lLnZpZXcudmRvbSwge2NsczogJ25lby1ncmlkLXZpZXcnfSkudmRvbTtcbiAgICAgICAgY29sdW1uTm9kZUlkcyA9IFZEb21VdGlsLmdldENvbHVtbk5vZGVzSWRzKHRib2R5Tm9kZSwgbmV3SW5kZXgpO1xuXG4gICAgICAgIG1lLmRlc2VsZWN0QWxsQ2VsbHModHJ1ZSk7XG4gICAgICAgIG1lLnNlbGVjdChjb2x1bW5Ob2RlSWRzLCBtZS5zZWxlY3RlZENvbHVtbkNlbGxJZHMsIG1lLnNlbGVjdGVkQ29sdW1uQ2VsbENscyk7XG5cbiAgICAgICAgc3VwZXIub25OYXZLZXlDb2x1bW4oZGF0YSwgc3RlcClcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqL1xuICAgIHVucmVnaXN0ZXIoKSB7XG4gICAgICAgIHRoaXMuZGVzZWxlY3RBbGxDZWxscygpO1xuICAgICAgICBzdXBlci51bnJlZ2lzdGVyKClcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IE5lby5zZXR1cENsYXNzKENlbGxDb2x1bW5Sb3dNb2RlbCk7XG4iLCJpbXBvcnQgQmFzZU1vZGVsIGZyb20gJy4vQmFzZU1vZGVsLm1qcyc7XG5cbi8qKlxuICogQGNsYXNzIE5lby5zZWxlY3Rpb24uZ3JpZC5DZWxsTW9kZWxcbiAqIEBleHRlbmRzIE5lby5zZWxlY3Rpb24uZ3JpZC5CYXNlTW9kZWxcbiAqL1xuY2xhc3MgQ2VsbE1vZGVsIGV4dGVuZHMgQmFzZU1vZGVsIHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J05lby5zZWxlY3Rpb24uZ3JpZC5DZWxsTW9kZWwnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ05lby5zZWxlY3Rpb24uZ3JpZC5DZWxsTW9kZWwnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBudHlwZT0nc2VsZWN0aW9uLWdyaWQtY2VsbG1vZGVsJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBudHlwZTogJ3NlbGVjdGlvbi1ncmlkLWNlbGxtb2RlbCcsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IGNscz0nbmVvLXNlbGVjdGlvbi1jZWxsbW9kZWwnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsczogJ25lby1zZWxlY3Rpb24tY2VsbG1vZGVsJ1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqXG4gICAgICovXG4gICAgYWRkRG9tTGlzdGVuZXIoKSB7XG4gICAgICAgIGxldCBtZSA9IHRoaXM7XG5cbiAgICAgICAgbWUudmlldy5vbignY2VsbENsaWNrJywgbWUub25DZWxsQ2xpY2ssIG1lKVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSBhcmdzXG4gICAgICovXG4gICAgZGVzdHJveSguLi5hcmdzKSB7XG4gICAgICAgIGxldCBtZSA9IHRoaXM7XG5cbiAgICAgICAgbWUudmlldy51bignY2VsbENsaWNrJywgbWUub25DZWxsQ2xpY2ssIG1lKTtcblxuICAgICAgICBzdXBlci5kZXN0cm95KC4uLmFyZ3MpXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGFcbiAgICAgKi9cbiAgICBvbkNlbGxDbGljayhkYXRhKSB7XG4gICAgICAgIHRoaXMudG9nZ2xlU2VsZWN0aW9uKGRhdGEuZGF0YS5jdXJyZW50VGFyZ2V0KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhXG4gICAgICovXG4gICAgb25LZXlEb3duRG93bihkYXRhKSB7XG4gICAgICAgIHRoaXMub25OYXZLZXlSb3coZGF0YSwgMSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqL1xuICAgIG9uS2V5RG93bkxlZnQoZGF0YSkge1xuICAgICAgICB0aGlzLm9uTmF2S2V5Q29sdW1uKGRhdGEsIC0xKVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhXG4gICAgICovXG4gICAgb25LZXlEb3duUmlnaHQoZGF0YSkge1xuICAgICAgICB0aGlzLm9uTmF2S2V5Q29sdW1uKGRhdGEsIDEpXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGFcbiAgICAgKi9cbiAgICBvbktleURvd25VcChkYXRhKSB7XG4gICAgICAgIHRoaXMub25OYXZLZXlSb3coZGF0YSwgLTEpXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGFcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gc3RlcFxuICAgICAqL1xuICAgIG9uTmF2S2V5Q29sdW1uKGRhdGEsIHN0ZXApIHtcbiAgICAgICAgbGV0IG1lICAgICAgICAgICAgPSB0aGlzLFxuICAgICAgICAgICAge3ZpZXd9ICAgICAgICA9IG1lLFxuICAgICAgICAgICAgaWRBcnJheSAgICAgICA9IGRhdGEucGF0aFswXS5pZC5zcGxpdCgnX18nKSxcbiAgICAgICAgICAgIGN1cnJlbnRDb2x1bW4gPSBpZEFycmF5WzJdLFxuICAgICAgICAgICAgZGF0YUZpZWxkcyAgICA9IHZpZXcuY29sdW1ucy5tYXAoYyA9PiBjLmZpZWxkKSxcbiAgICAgICAgICAgIG5ld0luZGV4ICAgICAgPSAoZGF0YUZpZWxkcy5pbmRleE9mKGN1cnJlbnRDb2x1bW4pICsgc3RlcCkgJSBkYXRhRmllbGRzLmxlbmd0aCxcbiAgICAgICAgICAgIGlkO1xuXG4gICAgICAgIHdoaWxlIChuZXdJbmRleCA8IDApIHtcbiAgICAgICAgICAgIG5ld0luZGV4ICs9IGRhdGFGaWVsZHMubGVuZ3RoXG4gICAgICAgIH1cblxuICAgICAgICBpZEFycmF5WzJdID0gZGF0YUZpZWxkc1tuZXdJbmRleF07XG4gICAgICAgIGlkID0gaWRBcnJheS5qb2luKCdfXycpO1xuXG4gICAgICAgIG1lLnNlbGVjdChpZCk7XG4gICAgICAgIHZpZXcuZm9jdXMoaWQpXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGFcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gc3RlcFxuICAgICAqL1xuICAgIG9uTmF2S2V5Um93KGRhdGEsIHN0ZXApIHtcbiAgICAgICAgbGV0IG1lICAgICAgID0gdGhpcyxcbiAgICAgICAgICAgIHt2aWV3fSAgID0gbWUsXG4gICAgICAgICAgICB7c3RvcmV9ICA9IHZpZXcsXG4gICAgICAgICAgICBpZEFycmF5ICA9IGRhdGEucGF0aFswXS5pZC5zcGxpdCgnX18nKSxcbiAgICAgICAgICAgIHJlY29yZElkID0gaWRBcnJheVsxXSxcbiAgICAgICAgICAgIG5ld0luZGV4ID0gKHN0b3JlLmluZGV4T2YocmVjb3JkSWQpICsgc3RlcCkgJSBzdG9yZS5nZXRDb3VudCgpLFxuICAgICAgICAgICAgaWQ7XG5cbiAgICAgICAgd2hpbGUgKG5ld0luZGV4IDwgMCkge1xuICAgICAgICAgICAgbmV3SW5kZXggKz0gc3RvcmUuZ2V0Q291bnQoKVxuICAgICAgICB9XG5cbiAgICAgICAgaWRBcnJheVsxXSA9IHN0b3JlLmdldEtleUF0KG5ld0luZGV4KTtcbiAgICAgICAgaWQgPSBpZEFycmF5LmpvaW4oJ19fJyk7XG5cbiAgICAgICAgbWUuc2VsZWN0KGlkKTtcbiAgICAgICAgdmlldy5mb2N1cyhpZClcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge05lby5jb21wb25lbnQuQmFzZX0gY29tcG9uZW50XG4gICAgICovXG4gICAgcmVnaXN0ZXIoY29tcG9uZW50KSB7XG4gICAgICAgIHN1cGVyLnJlZ2lzdGVyKGNvbXBvbmVudCk7XG5cbiAgICAgICAgbGV0IG1lICAgICAgICAgPSB0aGlzLFxuICAgICAgICAgICAge2lkLCB2aWV3fSA9IG1lO1xuXG4gICAgICAgIHZpZXcua2V5cz8uX2tleXMucHVzaChcbiAgICAgICAgICAgIHtmbjogJ29uS2V5RG93bkRvd24nICAsa2V5OiAnRG93bicgICxzY29wZTogaWR9LFxuICAgICAgICAgICAge2ZuOiAnb25LZXlEb3duTGVmdCcgICxrZXk6ICdMZWZ0JyAgLHNjb3BlOiBpZH0sXG4gICAgICAgICAgICB7Zm46ICdvbktleURvd25SaWdodCcgLGtleTogJ1JpZ2h0JyAsc2NvcGU6IGlkfSxcbiAgICAgICAgICAgIHtmbjogJ29uS2V5RG93blVwJyAgICAsa2V5OiAnVXAnICAgICxzY29wZTogaWR9XG4gICAgICAgIClcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqL1xuICAgIHVucmVnaXN0ZXIoKSB7XG4gICAgICAgIGxldCBtZSAgICAgICAgID0gdGhpcyxcbiAgICAgICAgICAgIHtpZCwgdmlld30gPSBtZTtcblxuICAgICAgICB2aWV3LmtleXM/LnJlbW92ZUtleXMoW1xuICAgICAgICAgICAge2ZuOiAnb25LZXlEb3duRG93bicgICxrZXk6ICdEb3duJyAgLHNjb3BlOiBpZH0sXG4gICAgICAgICAgICB7Zm46ICdvbktleURvd25MZWZ0JyAgLGtleTogJ0xlZnQnICAsc2NvcGU6IGlkfSxcbiAgICAgICAgICAgIHtmbjogJ29uS2V5RG93blJpZ2h0JyAsa2V5OiAnUmlnaHQnICxzY29wZTogaWR9LFxuICAgICAgICAgICAge2ZuOiAnb25LZXlEb3duVXAnICAgICxrZXk6ICdVcCcgICAgLHNjb3BlOiBpZH1cbiAgICAgICAgXSk7XG5cbiAgICAgICAgc3VwZXIudW5yZWdpc3RlcigpXG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBOZW8uc2V0dXBDbGFzcyhDZWxsTW9kZWwpO1xuIiwiaW1wb3J0IENlbGxNb2RlbCBmcm9tICcuL0NlbGxNb2RlbC5tanMnO1xuaW1wb3J0IE5lb0FycmF5ICBmcm9tICcuLi8uLi91dGlsL0FycmF5Lm1qcyc7XG5pbXBvcnQgUm93TW9kZWwgIGZyb20gJy4vUm93TW9kZWwubWpzJztcbmltcG9ydCBWRG9tVXRpbCAgZnJvbSAnLi4vLi4vdXRpbC9WRG9tLm1qcyc7XG5cbi8qKlxuICogQGNsYXNzIE5lby5zZWxlY3Rpb24uZ3JpZC5DZWxsUm93TW9kZWxcbiAqIEBleHRlbmRzIE5lby5zZWxlY3Rpb24uZ3JpZC5DZWxsTW9kZWxcbiAqL1xuY2xhc3MgQ2VsbFJvd01vZGVsIGV4dGVuZHMgQ2VsbE1vZGVsIHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J05lby5zZWxlY3Rpb24uZ3JpZC5DZWxsUm93TW9kZWwnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ05lby5zZWxlY3Rpb24uZ3JpZC5DZWxsUm93TW9kZWwnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBudHlwZT0nc2VsZWN0aW9uLWdyaWQtY2VsbHJvd21vZGVsJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBudHlwZTogJ3NlbGVjdGlvbi1ncmlkLWNlbGxyb3dtb2RlbCcsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IGNscz0nbmVvLXNlbGVjdGlvbi1jZWxscm93bW9kZWwnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsczogJ25lby1zZWxlY3Rpb24tY2VsbHJvd21vZGVsJyxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge0FycmF5fG51bGx9IHNlbGVjdGVkUm93SWRzPW51bGxcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgc2VsZWN0ZWRSb3dJZHM6IG51bGxcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnXG4gICAgICovXG4gICAgY29uc3RydWN0KGNvbmZpZykge1xuICAgICAgICBzdXBlci5jb25zdHJ1Y3QoY29uZmlnKTtcblxuICAgICAgICB0aGlzLnNlbGVjdGVkUm93SWRzID0gW11cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtzaWxlbnRdIHRydWUgdG8gcHJldmVudCBhIHZkb20gdXBkYXRlXG4gICAgICovXG4gICAgZGVzZWxlY3RBbGxSb3dzKHNpbGVudCkge1xuICAgICAgICBsZXQgbWUgICAgID0gdGhpcyxcbiAgICAgICAgICAgIHJvd0lkcyA9IFsuLi5tZS5zZWxlY3RlZFJvd0lkc10sXG4gICAgICAgICAgICB7dmlld30gPSBtZTtcblxuICAgICAgICByb3dJZHMuZm9yRWFjaChyb3dJZCA9PiB7XG4gICAgICAgICAgICBtZS5kZXNlbGVjdFJvdyhyb3dJZCwgdHJ1ZSlcbiAgICAgICAgfSk7XG5cbiAgICAgICAgIXNpbGVudCAmJiB2aWV3LnVwZGF0ZSgpXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHJvd0lkXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbc2lsZW50XSB0cnVlIHRvIHByZXZlbnQgYSB2ZG9tIHVwZGF0ZVxuICAgICAqL1xuICAgIGRlc2VsZWN0Um93KHJvd0lkLCBzaWxlbnQpIHtcbiAgICAgICAgbGV0IG1lICAgICA9IHRoaXMsXG4gICAgICAgICAgICB7dmlld30gPSBtZSxcbiAgICAgICAgICAgIG5vZGUgICA9IHZpZXcuZ2V0VmRvbUNoaWxkKHJvd0lkKSxcbiAgICAgICAgICAgIGNscztcblxuICAgICAgICBpZiAobm9kZSkge1xuICAgICAgICAgICAgY2xzID0gbm9kZS5jbHMgfHwgW107XG4gICAgICAgICAgICBOZW9BcnJheS5yZW1vdmUoY2xzLCBtZS5zZWxlY3RlZENscyk7XG4gICAgICAgICAgICBub2RlLmNscyA9IGNsc1xuICAgICAgICB9XG5cbiAgICAgICAgTmVvQXJyYXkucmVtb3ZlKG1lLnNlbGVjdGVkUm93SWRzLCByb3dJZCk7XG5cbiAgICAgICAgaWYgKCFzaWxlbnQpIHtcbiAgICAgICAgICAgIHZpZXcudXBkYXRlRGVwdGggPSAyO1xuICAgICAgICAgICAgdmlldy51cGRhdGUoKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGFcbiAgICAgKi9cbiAgICBvbkNlbGxDbGljayhkYXRhKSB7XG4gICAgICAgIGxldCBtZSAgID0gdGhpcyxcbiAgICAgICAgICAgIG5vZGUgPSBSb3dNb2RlbC5nZXRSb3dOb2RlKGRhdGEuZGF0YS5wYXRoKSwgLy8gd2UgY291bGQgYWRkIGEgc2VwYXJhdGUgZXhwb3J0IGZvciB0aGlzIG1ldGhvZFxuICAgICAgICAgICAgaWQgICA9IG5vZGU/LmlkO1xuXG4gICAgICAgIGlmIChpZCkge1xuICAgICAgICAgICAgbWUuZGVzZWxlY3RBbGxSb3dzKHRydWUpO1xuICAgICAgICAgICAgbWUuc2VsZWN0Um93KGlkKVxuICAgICAgICB9XG5cbiAgICAgICAgc3VwZXIub25DZWxsQ2xpY2soZGF0YSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBzdGVwXG4gICAgICovXG4gICAgb25OYXZLZXlSb3coZGF0YSwgc3RlcCkge1xuICAgICAgICBzdXBlci5vbk5hdktleVJvdyhkYXRhLCBzdGVwKTtcblxuICAgICAgICBsZXQgbWUgICAgICAgICAgID0gdGhpcyxcbiAgICAgICAgICAgIG5vZGUgICAgICAgICA9IFJvd01vZGVsLmdldFJvd05vZGUoZGF0YS5wYXRoKSxcbiAgICAgICAgICAgIHt2aWV3fSAgICAgICA9IG1lLFxuICAgICAgICAgICAge3N0b3JlfSAgICAgID0gdmlldyxcbiAgICAgICAgICAgIHZkb21Ob2RlICAgICA9IFZEb21VdGlsLmZpbmQodmlldy52ZG9tLCBub2RlLmlkKSxcbiAgICAgICAgICAgIG5ld0luZGV4ICAgICA9ICh2ZG9tTm9kZS5pbmRleCArIHN0ZXApICUgc3RvcmUuZ2V0Q291bnQoKSxcbiAgICAgICAgICAgIHtwYXJlbnROb2RlfSA9IHZkb21Ob2RlLFxuICAgICAgICAgICAgaWQ7XG5cbiAgICAgICAgd2hpbGUgKG5ld0luZGV4IDwgMCkge1xuICAgICAgICAgICAgbmV3SW5kZXggKz0gc3RvcmUuZ2V0Q291bnQoKVxuICAgICAgICB9XG5cbiAgICAgICAgaWQgPSBwYXJlbnROb2RlLmNuW25ld0luZGV4XS5pZDtcblxuICAgICAgICBpZiAoaWQpIHtcbiAgICAgICAgICAgIG1lLmRlc2VsZWN0QWxsUm93cyh0cnVlKTtcbiAgICAgICAgICAgIG1lLnNlbGVjdFJvdyhpZClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZFxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW3NpbGVudF1cbiAgICAgKi9cbiAgICBzZWxlY3RSb3coaWQsIHNpbGVudCkge1xuICAgICAgICBsZXQgbWUgICAgICAgPSB0aGlzLFxuICAgICAgICAgICAge3ZpZXd9ICAgPSBtZSxcbiAgICAgICAgICAgIHZkb21Ob2RlID0gaWQgJiYgdmlldy5nZXRWZG9tQ2hpbGQoaWQpLFxuICAgICAgICAgICAgY2xzO1xuXG4gICAgICAgIGlmICh2ZG9tTm9kZSkge1xuICAgICAgICAgICAgY2xzID0gdmRvbU5vZGUuY2xzIHx8IFtdO1xuICAgICAgICAgICAgTmVvQXJyYXkuYWRkKGNscywgbWUuc2VsZWN0ZWRDbHMpO1xuICAgICAgICAgICAgdmRvbU5vZGUuY2xzID0gY2xzO1xuXG4gICAgICAgICAgICBtZS5zZWxlY3RlZFJvd0lkcy5wdXNoKGlkKVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFzaWxlbnQpIHtcbiAgICAgICAgICAgIHZpZXcudXBkYXRlRGVwdGggPSAyO1xuICAgICAgICAgICAgdmlldy51cGRhdGUoKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKi9cbiAgICB1bnJlZ2lzdGVyKCkge1xuICAgICAgICB0aGlzLmRlc2VsZWN0QWxsUm93cygpO1xuICAgICAgICBzdXBlci51bnJlZ2lzdGVyKClcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IE5lby5zZXR1cENsYXNzKENlbGxSb3dNb2RlbCk7XG4iLCJpbXBvcnQgQmFzZU1vZGVsIGZyb20gJy4vQmFzZU1vZGVsLm1qcyc7XG5pbXBvcnQgVkRvbVV0aWwgIGZyb20gJy4uLy4uL3V0aWwvVkRvbS5tanMnO1xuXG4vKipcbiAqIEBjbGFzcyBOZW8uc2VsZWN0aW9uLmdyaWQuQ29sdW1uTW9kZWxcbiAqIEBleHRlbmRzIE5lby5zZWxlY3Rpb24uZ3JpZC5CYXNlTW9kZWxcbiAqL1xuY2xhc3MgQ29sdW1uTW9kZWwgZXh0ZW5kcyBCYXNlTW9kZWwge1xuICAgIHN0YXRpYyBjb25maWcgPSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IGNsYXNzTmFtZT0nTmVvLnNlbGVjdGlvbi5ncmlkLkNvbHVtbk1vZGVsJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBjbGFzc05hbWU6ICdOZW8uc2VsZWN0aW9uLmdyaWQuQ29sdW1uTW9kZWwnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBudHlwZT0nc2VsZWN0aW9uLWdyaWQtY29sdW1ubW9kZWwnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIG50eXBlOiAnc2VsZWN0aW9uLWdyaWQtY29sdW1ubW9kZWwnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbHM9J3NlbGVjdGlvbi1jb2x1bW5tb2RlbCdcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgY2xzOiAnbmVvLXNlbGVjdGlvbi1jb2x1bW5tb2RlbCdcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqL1xuICAgIGFkZERvbUxpc3RlbmVyKCkge1xuICAgICAgICBsZXQgbWUgPSB0aGlzO1xuXG4gICAgICAgIG1lLnZpZXcub24oJ2NlbGxDbGljaycsIG1lLm9uQ2VsbENsaWNrLCBtZSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gYXJnc1xuICAgICAqL1xuICAgIGRlc3Ryb3koLi4uYXJncykge1xuICAgICAgICBsZXQgbWUgPSB0aGlzO1xuXG4gICAgICAgIG1lLnZpZXcudW4oJ2NlbGxDbGljaycsIG1lLm9uQ2VsbENsaWNrLCBtZSk7XG5cbiAgICAgICAgc3VwZXIuZGVzdHJveSguLi5hcmdzKVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBldmVudFBhdGhcbiAgICAgKiBAcmV0dXJucyB7U3RyaW5nfG51bGx9IGNlbGxJZFxuICAgICAqL1xuICAgIHN0YXRpYyBnZXRDZWxsSWQoZXZlbnRQYXRoKSB7XG4gICAgICAgIGxldCBpZCAgID0gbnVsbCxcbiAgICAgICAgICAgIGkgICAgPSAwLFxuICAgICAgICAgICAgbGVuICA9IGV2ZW50UGF0aC5sZW5ndGg7XG5cbiAgICAgICAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgaWYgKGV2ZW50UGF0aFtpXS5jbHMuaW5jbHVkZXMoJ25lby1ncmlkLWNlbGwnKSkge1xuICAgICAgICAgICAgICAgIGlkID0gZXZlbnRQYXRoW2ldLmlkO1xuICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gaWRcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiB0b2RvOiBtb3ZlIHRvIGdyaWQuQ29udGFpbmVyIG9yIHZpZXdcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gY2VsbElkXG4gICAgICogQHBhcmFtIHtPYmplY3RbXX0gY29sdW1uc1xuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9IGluZGV4XG4gICAgICovXG4gICAgc3RhdGljIGdldENvbHVtbkluZGV4KGNlbGxJZCwgY29sdW1ucykge1xuICAgICAgICBsZXQgaWRBcnJheSAgICAgICA9IGNlbGxJZC5zcGxpdCgnX18nKSxcbiAgICAgICAgICAgIGN1cnJlbnRDb2x1bW4gPSBpZEFycmF5WzJdLFxuICAgICAgICAgICAgZGF0YUZpZWxkcyAgICA9IGNvbHVtbnMubWFwKGMgPT4gYy5maWVsZCk7XG5cbiAgICAgICAgcmV0dXJuIGRhdGFGaWVsZHMuaW5kZXhPZihjdXJyZW50Q29sdW1uKVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhXG4gICAgICovXG4gICAgb25DZWxsQ2xpY2soZGF0YSkge1xuICAgICAgICBsZXQgbWUgPSB0aGlzLFxuICAgICAgICAgICAgaWQgPSBkYXRhLmRhdGEuY3VycmVudFRhcmdldCxcbiAgICAgICAgICAgIGNvbHVtbk5vZGVJZHMsIGluZGV4LCB0Ym9keU5vZGU7XG5cbiAgICAgICAgaWYgKGlkKSB7XG4gICAgICAgICAgICBpbmRleCAgICAgICAgID0gQ29sdW1uTW9kZWwuZ2V0Q29sdW1uSW5kZXgoaWQsIG1lLnZpZXcuaXRlbXNbMF0uaXRlbXMpO1xuICAgICAgICAgICAgdGJvZHlOb2RlICAgICA9IFZEb21VdGlsLmZpbmQobWUudmlldy52ZG9tLCB7Y2xzOiAnbmVvLWdyaWQtdmlldyd9KS52ZG9tO1xuICAgICAgICAgICAgY29sdW1uTm9kZUlkcyA9IFZEb21VdGlsLmdldENvbHVtbk5vZGVzSWRzKHRib2R5Tm9kZSwgaW5kZXgpO1xuXG4gICAgICAgICAgICBtZS5zZWxlY3QoY29sdW1uTm9kZUlkcylcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhXG4gICAgICovXG4gICAgb25LZXlEb3duTGVmdChkYXRhKSB7XG4gICAgICAgIHRoaXMub25OYXZLZXlDb2x1bW4oZGF0YSwgLTEpXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGFcbiAgICAgKi9cbiAgICBvbktleURvd25SaWdodChkYXRhKSB7XG4gICAgICAgIHRoaXMub25OYXZLZXlDb2x1bW4oZGF0YSwgMSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBzdGVwXG4gICAgICovXG4gICAgb25OYXZLZXlDb2x1bW4oZGF0YSwgc3RlcCkge1xuICAgICAgICBsZXQgbWUgICAgICAgICAgICA9IHRoaXMsXG4gICAgICAgICAgICBpZEFycmF5ICAgICAgID0gQ29sdW1uTW9kZWwuZ2V0Q2VsbElkKGRhdGEucGF0aCkuc3BsaXQoJ19fJyksXG4gICAgICAgICAgICBjdXJyZW50Q29sdW1uID0gaWRBcnJheVsyXSxcbiAgICAgICAgICAgIHt2aWV3fSAgICAgICAgPSBtZSxcbiAgICAgICAgICAgIGZpZWxkcyAgICAgICAgPSB2aWV3LmNvbHVtbnMubWFwKGMgPT4gYy5maWVsZCksXG4gICAgICAgICAgICBuZXdJbmRleCAgICAgID0gKGZpZWxkcy5pbmRleE9mKGN1cnJlbnRDb2x1bW4pICsgc3RlcCkgJSBmaWVsZHMubGVuZ3RoLFxuICAgICAgICAgICAgY29sdW1uTm9kZUlkcywgaWQsIHRib2R5Tm9kZTtcblxuICAgICAgICB3aGlsZSAobmV3SW5kZXggPCAwKSB7XG4gICAgICAgICAgICBuZXdJbmRleCArPSBmaWVsZHMubGVuZ3RoXG4gICAgICAgIH1cblxuICAgICAgICBpZEFycmF5WzJdID0gZmllbGRzW25ld0luZGV4XTtcbiAgICAgICAgaWQgPSBpZEFycmF5LmpvaW4oJ19fJyk7XG5cbiAgICAgICAgdGJvZHlOb2RlICAgICA9IFZEb21VdGlsLmZpbmQobWUudmlldy52ZG9tLCB7Y2xzOiAnbmVvLWdyaWQtdmlldyd9KS52ZG9tO1xuICAgICAgICBjb2x1bW5Ob2RlSWRzID0gVkRvbVV0aWwuZ2V0Q29sdW1uTm9kZXNJZHModGJvZHlOb2RlLCBuZXdJbmRleCk7XG5cbiAgICAgICAgbWUuc2VsZWN0KGNvbHVtbk5vZGVJZHMpO1xuICAgICAgICB2aWV3LmZvY3VzKGlkKSAvLyB3ZSBoYXZlIHRvIGZvY3VzIG9uZSBjZWxsIHRvIGVuc3VyZSB0aGUga2V5bmF2IGtlZXBzIHdvcmtpbmdcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge05lby5jb21wb25lbnQuQmFzZX0gY29tcG9uZW50XG4gICAgICovXG4gICAgcmVnaXN0ZXIoY29tcG9uZW50KSB7XG4gICAgICAgIHN1cGVyLnJlZ2lzdGVyKGNvbXBvbmVudCk7XG5cbiAgICAgICAgbGV0IHtpZCwgdmlld30gPSB0aGlzO1xuXG4gICAgICAgIHZpZXcua2V5cz8uX2tleXMucHVzaChcbiAgICAgICAgICAgIHtmbjogJ29uS2V5RG93bkxlZnQnLCAga2V5OiAnTGVmdCcsICBzY29wZTogaWR9LFxuICAgICAgICAgICAge2ZuOiAnb25LZXlEb3duUmlnaHQnLCBrZXk6ICdSaWdodCcsIHNjb3BlOiBpZH1cbiAgICAgICAgKVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqXG4gICAgICovXG4gICAgdW5yZWdpc3RlcigpIHtcbiAgICAgICAgbGV0IHtpZCwgdmlld30gPSB0aGlzO1xuXG4gICAgICAgIHZpZXcua2V5cz8ucmVtb3ZlS2V5cyhbXG4gICAgICAgICAgICB7Zm46ICdvbktleURvd25MZWZ0JywgIGtleTogJ0xlZnQnLCAgc2NvcGU6IGlkfSxcbiAgICAgICAgICAgIHtmbjogJ29uS2V5RG93blJpZ2h0Jywga2V5OiAnUmlnaHQnLCBzY29wZTogaWR9XG4gICAgICAgIF0pO1xuXG4gICAgICAgIHN1cGVyLnVucmVnaXN0ZXIoKVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgTmVvLnNldHVwQ2xhc3MoQ29sdW1uTW9kZWwpO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9