"use strict";
(self["webpackChunkneo_mjs"] = self["webpackChunkneo_mjs"] || []).push([["src_draggable_grid_header_toolbar_SortZone_mjs"],{

/***/ "./src/draggable/grid/header/toolbar/SortZone.mjs":
/*!********************************************************!*\
  !*** ./src/draggable/grid/header/toolbar/SortZone.mjs ***!
  \********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _toolbar_SortZone_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../toolbar/SortZone.mjs */ "./src/draggable/toolbar/SortZone.mjs");
/* harmony import */ var _util_Array_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../util/Array.mjs */ "./src/util/Array.mjs");
/* harmony import */ var _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../util/VDom.mjs */ "./src/util/VDom.mjs");




/**
 * @class Neo.draggable.grid.header.toolbar.SortZone
 * @extends Neo.draggable.toolbar.SortZone
 */
class SortZone extends _toolbar_SortZone_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.draggable.grid.header.toolbar.SortZone'
         * @protected
         */
        className: 'Neo.draggable.grid.header.toolbar.SortZone',
        /**
         * @member {String} ntype='grid-header-toolbar-sortzone'
         * @protected
         */
        ntype: 'grid-header-toolbar-sortzone',
        /**
         * @member {String|null} itemMargin=null
         * @protected
         */
        itemMargin: '1px',
        /**
         * @member {Boolean} moveColumnContent=true
         */
        moveColumnContent: true,
        /**
         * @member {Boolean} moveVertical=false
         */
        moveVertical: false
    }

    /**
     * @param {Neo.util.Rectangle} rect
     * @param {Neo.util.Rectangle} parentRect
     */
    adjustProxyRectToParent(rect, parentRect) {
        rect.x = rect.x - parentRect.x - 1;
        rect.y = rect.y - parentRect.y - 1
    }

    /**
     * @param {Object}  data
     * @param {Boolean} createComponent=true
     * @returns {Object|Neo.draggable.DragProxyComponent}
     */
    async createDragProxy(data, createComponent=true) {
        if (!this.moveColumnContent) {
            return await super.createDragProxy(data, createComponent)
        }

        let me          = this,
            grid        = me.owner.parent,
            {view}      = grid,
            gridRows    = view.getVdomRoot().cn,
            columnIndex = me.dragElement['aria-colindex'] - 1,
            {dataField} = view.columnPositions[columnIndex],
            cells       = view.getColumnCells(dataField),
            rows        = [],
            config      = await super.createDragProxy(data, false),
            rect        = await grid.getDomRect(),
            row;

        config.cls = ['neo-grid-wrapper', me.owner.getTheme()];

        config.style.height = rect.height + 'px';

        cells.forEach((cell, index) => {
            row = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].clone({cls: gridRows[index].cls, cn: [cell]}); // clone to remove ids

            row.style = {
                height: view.rowHeight + 'px'
            };

            delete row.cn[0].style.left;

            rows.push(row)
        });

        config.vdom =
        {cn: [
            {cls: ['neo-grid-container'], cn: [
                {...config.vdom, cls: ['neo-grid-header-toolbar', 'neo-toolbar']},
                {cls: ['neo-grid-view'], cn: rows}
            ]}
        ]};

        if (createComponent) {
            return me.dragProxy = Neo.create(config)
        }

        return config
    }

    /**
     * @param {Number} fromIndex
     * @param {Number} toIndex
     */
    moveTo(fromIndex, toIndex) {
        super.moveTo(fromIndex, toIndex);

        // It is crucial to use _columns to not get a shallow copy
        _util_Array_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].move(this.owner.parent._columns, fromIndex, toIndex);
    }

    /**
     * @param {Object} data
     */
    async onDragEnd(data) {
        await super.onDragEnd(data);

        let {owner} = this;

        owner.items.forEach((item, index) => {
            item.vdom['aria-colindex'] = index + 1; // 1 based
        });

        owner.updateDepth = 2;
        owner.update();

        await owner.passSizeToView();

        await this.timeout(20);

        owner.parent.view.createViewData()
    }

    /**
     * @param {Object} data
     */
    async onDragStart(data) {
        await super.onDragStart(data);

        if (this.moveColumnContent) {
            let me          = this,
                {view}      = me.owner.parent,
                columnIndex = me.dragElement['aria-colindex'] - 1,
                {dataField} = view.columnPositions[columnIndex],
                cells       = view.getColumnCells(dataField);

            cells.forEach(cell => {
                cell.style.display = 'none'
            });

            view.update()
        }
    }

    /**
     * @param {Number} index1
     * @param {Number} index2
     */
    switchItems(index1, index2) {
        if (this.moveColumnContent) {
            let {view}          = this.owner.parent,
                columnPositions = view._columnPositions, // no clone
                column1Cells    = view.getColumnCells(columnPositions[index1].dataField),
                column2Cells    = view.getColumnCells(columnPositions[index2].dataField),
                x;

            x = columnPositions[index1].x;
            columnPositions[index1].x = columnPositions[index2].x;
            columnPositions[index2].x = x;

            _util_Array_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].move(columnPositions, index1, index2);

            column1Cells.forEach(node => {
                node.style.left = columnPositions[index2].x + 'px'
            });

            column2Cells.forEach(node => {
                node.style.left = columnPositions[index1].x + 'px'
            });

            view.update()
        }

        super.switchItems(index1, index2);
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(SortZone));


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2h1bmtzL2FwcC9zcmNfZHJhZ2dhYmxlX2dyaWRfaGVhZGVyX3Rvb2xiYXJfU29ydFpvbmVfbWpzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBeUQ7QUFDRjtBQUNEOztBQUV0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1Qiw2REFBWTtBQUNuQztBQUNBO0FBQ0Esb0JBQW9CLFFBQVE7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsUUFBUTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixhQUFhO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLFNBQVM7QUFDN0I7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLFNBQVM7QUFDN0I7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZUFBZSxvQkFBb0I7QUFDbkMsZUFBZSxvQkFBb0I7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGVBQWUsU0FBUztBQUN4QixlQUFlLFNBQVM7QUFDeEIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWEsV0FBVztBQUN4QjtBQUNBO0FBQ0EsYUFBYSxXQUFXO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQSxrQkFBa0Isc0RBQVEsUUFBUSxxQ0FBcUMsR0FBRzs7QUFFMUU7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBLFNBQVM7QUFDVCxhQUFhO0FBQ2IsaUJBQWlCLGdFQUFnRTtBQUNqRixpQkFBaUI7QUFDakI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBOztBQUVBO0FBQ0EsUUFBUSx1REFBUTtBQUNoQjs7QUFFQTtBQUNBLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7O0FBRUEsYUFBYSxPQUFPOztBQUVwQjtBQUNBLG9EQUFvRDtBQUNwRCxTQUFTOztBQUVUO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGlCQUFpQixXQUFXO0FBQzVCO0FBQ0EsaUJBQWlCLFdBQVc7QUFDNUI7O0FBRUE7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsZUFBZTtBQUNoQztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsWUFBWSx1REFBUTs7QUFFcEI7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsaUVBQWUsd0JBQXdCLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZW8ubWpzLy4vc3JjL2RyYWdnYWJsZS9ncmlkL2hlYWRlci90b29sYmFyL1NvcnRab25lLm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQmFzZVNvcnRab25lIGZyb20gJy4uLy4uLy4uL3Rvb2xiYXIvU29ydFpvbmUubWpzJztcbmltcG9ydCBOZW9BcnJheSAgICAgZnJvbSAgJy4uLy4uLy4uLy4uL3V0aWwvQXJyYXkubWpzJztcbmltcG9ydCBWZG9tVXRpbCAgICAgZnJvbSAgJy4uLy4uLy4uLy4uL3V0aWwvVkRvbS5tanMnO1xuXG4vKipcbiAqIEBjbGFzcyBOZW8uZHJhZ2dhYmxlLmdyaWQuaGVhZGVyLnRvb2xiYXIuU29ydFpvbmVcbiAqIEBleHRlbmRzIE5lby5kcmFnZ2FibGUudG9vbGJhci5Tb3J0Wm9uZVxuICovXG5jbGFzcyBTb3J0Wm9uZSBleHRlbmRzIEJhc2VTb3J0Wm9uZSB7XG4gICAgc3RhdGljIGNvbmZpZyA9IHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gY2xhc3NOYW1lPSdOZW8uZHJhZ2dhYmxlLmdyaWQuaGVhZGVyLnRvb2xiYXIuU29ydFpvbmUnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ05lby5kcmFnZ2FibGUuZ3JpZC5oZWFkZXIudG9vbGJhci5Tb3J0Wm9uZScsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IG50eXBlPSdncmlkLWhlYWRlci10b29sYmFyLXNvcnR6b25lJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBudHlwZTogJ2dyaWQtaGVhZGVyLXRvb2xiYXItc29ydHpvbmUnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfG51bGx9IGl0ZW1NYXJnaW49bnVsbFxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBpdGVtTWFyZ2luOiAnMXB4JyxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge0Jvb2xlYW59IG1vdmVDb2x1bW5Db250ZW50PXRydWVcbiAgICAgICAgICovXG4gICAgICAgIG1vdmVDb2x1bW5Db250ZW50OiB0cnVlLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7Qm9vbGVhbn0gbW92ZVZlcnRpY2FsPWZhbHNlXG4gICAgICAgICAqL1xuICAgICAgICBtb3ZlVmVydGljYWw6IGZhbHNlXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtOZW8udXRpbC5SZWN0YW5nbGV9IHJlY3RcbiAgICAgKiBAcGFyYW0ge05lby51dGlsLlJlY3RhbmdsZX0gcGFyZW50UmVjdFxuICAgICAqL1xuICAgIGFkanVzdFByb3h5UmVjdFRvUGFyZW50KHJlY3QsIHBhcmVudFJlY3QpIHtcbiAgICAgICAgcmVjdC54ID0gcmVjdC54IC0gcGFyZW50UmVjdC54IC0gMTtcbiAgICAgICAgcmVjdC55ID0gcmVjdC55IC0gcGFyZW50UmVjdC55IC0gMVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSAgZGF0YVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gY3JlYXRlQ29tcG9uZW50PXRydWVcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fE5lby5kcmFnZ2FibGUuRHJhZ1Byb3h5Q29tcG9uZW50fVxuICAgICAqL1xuICAgIGFzeW5jIGNyZWF0ZURyYWdQcm94eShkYXRhLCBjcmVhdGVDb21wb25lbnQ9dHJ1ZSkge1xuICAgICAgICBpZiAoIXRoaXMubW92ZUNvbHVtbkNvbnRlbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBzdXBlci5jcmVhdGVEcmFnUHJveHkoZGF0YSwgY3JlYXRlQ29tcG9uZW50KVxuICAgICAgICB9XG5cbiAgICAgICAgbGV0IG1lICAgICAgICAgID0gdGhpcyxcbiAgICAgICAgICAgIGdyaWQgICAgICAgID0gbWUub3duZXIucGFyZW50LFxuICAgICAgICAgICAge3ZpZXd9ICAgICAgPSBncmlkLFxuICAgICAgICAgICAgZ3JpZFJvd3MgICAgPSB2aWV3LmdldFZkb21Sb290KCkuY24sXG4gICAgICAgICAgICBjb2x1bW5JbmRleCA9IG1lLmRyYWdFbGVtZW50WydhcmlhLWNvbGluZGV4J10gLSAxLFxuICAgICAgICAgICAge2RhdGFGaWVsZH0gPSB2aWV3LmNvbHVtblBvc2l0aW9uc1tjb2x1bW5JbmRleF0sXG4gICAgICAgICAgICBjZWxscyAgICAgICA9IHZpZXcuZ2V0Q29sdW1uQ2VsbHMoZGF0YUZpZWxkKSxcbiAgICAgICAgICAgIHJvd3MgICAgICAgID0gW10sXG4gICAgICAgICAgICBjb25maWcgICAgICA9IGF3YWl0IHN1cGVyLmNyZWF0ZURyYWdQcm94eShkYXRhLCBmYWxzZSksXG4gICAgICAgICAgICByZWN0ICAgICAgICA9IGF3YWl0IGdyaWQuZ2V0RG9tUmVjdCgpLFxuICAgICAgICAgICAgcm93O1xuXG4gICAgICAgIGNvbmZpZy5jbHMgPSBbJ25lby1ncmlkLXdyYXBwZXInLCBtZS5vd25lci5nZXRUaGVtZSgpXTtcblxuICAgICAgICBjb25maWcuc3R5bGUuaGVpZ2h0ID0gcmVjdC5oZWlnaHQgKyAncHgnO1xuXG4gICAgICAgIGNlbGxzLmZvckVhY2goKGNlbGwsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICByb3cgPSBWZG9tVXRpbC5jbG9uZSh7Y2xzOiBncmlkUm93c1tpbmRleF0uY2xzLCBjbjogW2NlbGxdfSk7IC8vIGNsb25lIHRvIHJlbW92ZSBpZHNcblxuICAgICAgICAgICAgcm93LnN0eWxlID0ge1xuICAgICAgICAgICAgICAgIGhlaWdodDogdmlldy5yb3dIZWlnaHQgKyAncHgnXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBkZWxldGUgcm93LmNuWzBdLnN0eWxlLmxlZnQ7XG5cbiAgICAgICAgICAgIHJvd3MucHVzaChyb3cpXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbmZpZy52ZG9tID1cbiAgICAgICAge2NuOiBbXG4gICAgICAgICAgICB7Y2xzOiBbJ25lby1ncmlkLWNvbnRhaW5lciddLCBjbjogW1xuICAgICAgICAgICAgICAgIHsuLi5jb25maWcudmRvbSwgY2xzOiBbJ25lby1ncmlkLWhlYWRlci10b29sYmFyJywgJ25lby10b29sYmFyJ119LFxuICAgICAgICAgICAgICAgIHtjbHM6IFsnbmVvLWdyaWQtdmlldyddLCBjbjogcm93c31cbiAgICAgICAgICAgIF19XG4gICAgICAgIF19O1xuXG4gICAgICAgIGlmIChjcmVhdGVDb21wb25lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBtZS5kcmFnUHJveHkgPSBOZW8uY3JlYXRlKGNvbmZpZylcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjb25maWdcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gZnJvbUluZGV4XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHRvSW5kZXhcbiAgICAgKi9cbiAgICBtb3ZlVG8oZnJvbUluZGV4LCB0b0luZGV4KSB7XG4gICAgICAgIHN1cGVyLm1vdmVUbyhmcm9tSW5kZXgsIHRvSW5kZXgpO1xuXG4gICAgICAgIC8vIEl0IGlzIGNydWNpYWwgdG8gdXNlIF9jb2x1bW5zIHRvIG5vdCBnZXQgYSBzaGFsbG93IGNvcHlcbiAgICAgICAgTmVvQXJyYXkubW92ZSh0aGlzLm93bmVyLnBhcmVudC5fY29sdW1ucywgZnJvbUluZGV4LCB0b0luZGV4KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqL1xuICAgIGFzeW5jIG9uRHJhZ0VuZChkYXRhKSB7XG4gICAgICAgIGF3YWl0IHN1cGVyLm9uRHJhZ0VuZChkYXRhKTtcblxuICAgICAgICBsZXQge293bmVyfSA9IHRoaXM7XG5cbiAgICAgICAgb3duZXIuaXRlbXMuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGl0ZW0udmRvbVsnYXJpYS1jb2xpbmRleCddID0gaW5kZXggKyAxOyAvLyAxIGJhc2VkXG4gICAgICAgIH0pO1xuXG4gICAgICAgIG93bmVyLnVwZGF0ZURlcHRoID0gMjtcbiAgICAgICAgb3duZXIudXBkYXRlKCk7XG5cbiAgICAgICAgYXdhaXQgb3duZXIucGFzc1NpemVUb1ZpZXcoKTtcblxuICAgICAgICBhd2FpdCB0aGlzLnRpbWVvdXQoMjApO1xuXG4gICAgICAgIG93bmVyLnBhcmVudC52aWV3LmNyZWF0ZVZpZXdEYXRhKClcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqL1xuICAgIGFzeW5jIG9uRHJhZ1N0YXJ0KGRhdGEpIHtcbiAgICAgICAgYXdhaXQgc3VwZXIub25EcmFnU3RhcnQoZGF0YSk7XG5cbiAgICAgICAgaWYgKHRoaXMubW92ZUNvbHVtbkNvbnRlbnQpIHtcbiAgICAgICAgICAgIGxldCBtZSAgICAgICAgICA9IHRoaXMsXG4gICAgICAgICAgICAgICAge3ZpZXd9ICAgICAgPSBtZS5vd25lci5wYXJlbnQsXG4gICAgICAgICAgICAgICAgY29sdW1uSW5kZXggPSBtZS5kcmFnRWxlbWVudFsnYXJpYS1jb2xpbmRleCddIC0gMSxcbiAgICAgICAgICAgICAgICB7ZGF0YUZpZWxkfSA9IHZpZXcuY29sdW1uUG9zaXRpb25zW2NvbHVtbkluZGV4XSxcbiAgICAgICAgICAgICAgICBjZWxscyAgICAgICA9IHZpZXcuZ2V0Q29sdW1uQ2VsbHMoZGF0YUZpZWxkKTtcblxuICAgICAgICAgICAgY2VsbHMuZm9yRWFjaChjZWxsID0+IHtcbiAgICAgICAgICAgICAgICBjZWxsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSdcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB2aWV3LnVwZGF0ZSgpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gaW5kZXgxXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGluZGV4MlxuICAgICAqL1xuICAgIHN3aXRjaEl0ZW1zKGluZGV4MSwgaW5kZXgyKSB7XG4gICAgICAgIGlmICh0aGlzLm1vdmVDb2x1bW5Db250ZW50KSB7XG4gICAgICAgICAgICBsZXQge3ZpZXd9ICAgICAgICAgID0gdGhpcy5vd25lci5wYXJlbnQsXG4gICAgICAgICAgICAgICAgY29sdW1uUG9zaXRpb25zID0gdmlldy5fY29sdW1uUG9zaXRpb25zLCAvLyBubyBjbG9uZVxuICAgICAgICAgICAgICAgIGNvbHVtbjFDZWxscyAgICA9IHZpZXcuZ2V0Q29sdW1uQ2VsbHMoY29sdW1uUG9zaXRpb25zW2luZGV4MV0uZGF0YUZpZWxkKSxcbiAgICAgICAgICAgICAgICBjb2x1bW4yQ2VsbHMgICAgPSB2aWV3LmdldENvbHVtbkNlbGxzKGNvbHVtblBvc2l0aW9uc1tpbmRleDJdLmRhdGFGaWVsZCksXG4gICAgICAgICAgICAgICAgeDtcblxuICAgICAgICAgICAgeCA9IGNvbHVtblBvc2l0aW9uc1tpbmRleDFdLng7XG4gICAgICAgICAgICBjb2x1bW5Qb3NpdGlvbnNbaW5kZXgxXS54ID0gY29sdW1uUG9zaXRpb25zW2luZGV4Ml0ueDtcbiAgICAgICAgICAgIGNvbHVtblBvc2l0aW9uc1tpbmRleDJdLnggPSB4O1xuXG4gICAgICAgICAgICBOZW9BcnJheS5tb3ZlKGNvbHVtblBvc2l0aW9ucywgaW5kZXgxLCBpbmRleDIpO1xuXG4gICAgICAgICAgICBjb2x1bW4xQ2VsbHMuZm9yRWFjaChub2RlID0+IHtcbiAgICAgICAgICAgICAgICBub2RlLnN0eWxlLmxlZnQgPSBjb2x1bW5Qb3NpdGlvbnNbaW5kZXgyXS54ICsgJ3B4J1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbHVtbjJDZWxscy5mb3JFYWNoKG5vZGUgPT4ge1xuICAgICAgICAgICAgICAgIG5vZGUuc3R5bGUubGVmdCA9IGNvbHVtblBvc2l0aW9uc1tpbmRleDFdLnggKyAncHgnXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdmlldy51cGRhdGUoKVxuICAgICAgICB9XG5cbiAgICAgICAgc3VwZXIuc3dpdGNoSXRlbXMoaW5kZXgxLCBpbmRleDIpO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgTmVvLnNldHVwQ2xhc3MoU29ydFpvbmUpO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9