"use strict";
(self["webpackChunkneo_mjs"] = self["webpackChunkneo_mjs"] || []).push([["examples_component_multiWindowCoronaGallery_app_mjs"],{

/***/ "./examples/component/multiWindowCoronaGallery/Viewport.mjs":
/*!******************************************************************!*\
  !*** ./examples/component/multiWindowCoronaGallery/Viewport.mjs ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _coronaGallery_Viewport_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../coronaGallery/Viewport.mjs */ "./examples/component/coronaGallery/Viewport.mjs");
/* harmony import */ var _ViewportController_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ViewportController.mjs */ "./examples/component/multiWindowCoronaGallery/ViewportController.mjs");



/**
 * @class Neo.examples.component.multiWindowCoronaGallery.Viewport
 * @extends Neo.examples.component.coronaGallery.Viewport
 */
class Viewport extends _coronaGallery_Viewport_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.examples.component.multiWindowCoronaGallery.Viewport'
         * @protected
         */
        className: 'Neo.examples.component.multiWindowCoronaGallery.Viewport',
        /**
         * @member {String[]} cls=['multi-window-helix-viewport']
         */
        cls: ['multi-window-helix-viewport'],
        /**
         * @member {Neo.controller.Component} controller=ViewportController
         */
        controller: _ViewportController_mjs__WEBPACK_IMPORTED_MODULE_1__["default"]
    }

    /**
     * @param {Object} config
     */
    construct(config) {
        super.construct(config);

        this.getItem('controls-panel').headers = [{
            dock     : 'top',
            reference: 'header-toolbar',

            items: [{
                ntype: 'label',
                cls  : ['neo-panel-header-text', 'neo-label'],
                text : 'Gallery Controls'
            }, '->', {
                handler: 'onMaximiseButtonClick',
                iconCls: 'far fa-window-maximize'
            }]
        }]
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(Viewport));


/***/ }),

/***/ "./examples/component/multiWindowCoronaGallery/ViewportController.mjs":
/*!****************************************************************************!*\
  !*** ./examples/component/multiWindowCoronaGallery/ViewportController.mjs ***!
  \****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _coronaGallery_ViewportController_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../coronaGallery/ViewportController.mjs */ "./examples/component/coronaGallery/ViewportController.mjs");


/**
 * @class Neo.examples.component.multiWindowCoronaGallery.ViewportController
 * @extends Neo.examples.component.coronaGallery.ViewportController
 */
class ViewportController extends _coronaGallery_ViewportController_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.examples.component.multiWindowCoronaGallery.ViewportController'
         * @protected
         */
        className: 'Neo.examples.component.multiWindowCoronaGallery.ViewportController'
    }

    /**
     * @member {String[]} connectedApps=[]
     */
    connectedApps = []

    /**
     *
     */
    async createPopupWindow() {
        let me                         = this,
            {windowId}                 = me,
            {config, windowConfigs}    = Neo,
            {environment}              = config,
            firstWindowId              = Object.keys(windowConfigs)[0],
            {basePath}                 = windowConfigs[firstWindowId],
            widget                     = me.getReference('controls-panel'),
            winData                    = await Neo.Main.getWindowData({windowId}),
            rect                       = await me.component.getDomRect(widget.id),
            {height, left, top, width} = rect;

        if (environment !== 'development') {
            basePath = `${basePath + environment}/`
        }

        height += 1; // popup header in Chrome => height + 1, top -63
        left   += (width + winData.screenLeft);
        top    += (winData.outerHeight - winData.innerHeight + winData.screenTop - 63);

        // Mounted inside a code.LivePreview, the popup header should be within the content (height-wise)
        // See: https://github.com/neomjs/neo/issues/5991
        if (me.component.up('live-preview')) {
            height -= 63;
            top    += 63;
        }

        /*
         * For this demo, the url './childapp/' would be sufficient.
         * However, we also want to open it from within apps/portal.
         *
         * We match the basePath to the firstWindowId,
         * assuming the first connected window is the (main) one which we want to be in charge.
         */
        await Neo.Main.windowOpen({
            url           : basePath + 'examples/component/multiWindowCoronaGallery/childapp/',
            windowFeatures: `height=${height},left=${left},top=${top},width=${width}`,
            windowId      : firstWindowId,
            windowName    : 'GalleryControls'
        })
    }

    /**
     * @param {Object} data
     * @param {String} data.appName
     * @param {Number} data.windowId
     */
    async onAppConnect(data) {
        let me        = this,
            {appName} = data;

        if (appName === 'GalleryControls') {
            let {mainView} = Neo.apps[data.windowId];

            me.connectedApps.push(appName);

            this.getReference('header-toolbar').hidden = true;

            mainView.add(me.getReference('controls-panel'))
        }
    }

    /**
     * @param {Object} data
     * @param {String} data.appName
     * @param {Number} data.windowId
     */
    async onAppDisconnect(data) {
        let me                  = this,
            {appName, windowId} = data;

        if (appName === 'GalleryControls') {
            me.getReference('header-toolbar').hidden = false;

            me.component.add(me.getReference('controls-panel'))
        }
        // Close popup windows when closing or reloading the main window
        else if (appName === 'Neo.examples.component.multiWindowCoronaGallery') {
            Neo.Main.windowClose({names: me.connectedApps, windowId})
        }
    }
    /**
     *
     */
    onConstructed() {
        super.onConstructed();

        let me = this;

        Neo.currentWorker.on({
            connect   : me.onAppConnect,
            disconnect: me.onAppDisconnect,
            scope     : me
        })
    }

    /**
     * @param {Object} data
     */
    async onMaximiseButtonClick(data) {
        await this.createPopupWindow()
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(ViewportController));


/***/ }),

/***/ "./examples/component/multiWindowCoronaGallery/app.mjs":
/*!*************************************************************!*\
  !*** ./examples/component/multiWindowCoronaGallery/app.mjs ***!
  \*************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   onStart: () => (/* binding */ onStart)
/* harmony export */ });
/* harmony import */ var _Viewport_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Viewport.mjs */ "./examples/component/multiWindowCoronaGallery/Viewport.mjs");


const onStart = () => Neo.app({
    mainView: _Viewport_mjs__WEBPACK_IMPORTED_MODULE_0__["default"],
    name    : 'Neo.examples.component.multiWindowCoronaGallery'
});


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2h1bmtzL2FwcC9leGFtcGxlc19jb21wb25lbnRfbXVsdGlXaW5kb3dDb3JvbmFHYWxsZXJ5X2FwcF9tanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQStEO0FBQ0w7O0FBRTFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLG1FQUFZO0FBQ25DO0FBQ0E7QUFDQSxvQkFBb0IsUUFBUTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixVQUFVO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwwQkFBMEI7QUFDOUM7QUFDQSxvQkFBb0IsK0RBQWtCO0FBQ3RDOztBQUVBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTs7QUFFQSxpRUFBZSx3QkFBd0IsRUFBQzs7Ozs7Ozs7Ozs7Ozs7OztBQzlDeUI7O0FBRWpFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLDZFQUFVO0FBQzNDO0FBQ0E7QUFDQSxvQkFBb0IsUUFBUTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGdCQUFnQixVQUFVO0FBQzFCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsMEJBQTBCO0FBQ3ZDLGFBQWEsMEJBQTBCO0FBQ3ZDLGFBQWEsMEJBQTBCO0FBQ3ZDO0FBQ0EsYUFBYSwwQkFBMEI7QUFDdkM7QUFDQSx1RUFBdUUsU0FBUztBQUNoRjtBQUNBLGFBQWEsMEJBQTBCOztBQUV2QztBQUNBLDBCQUEwQix1QkFBdUI7QUFDakQ7O0FBRUEscUJBQXFCO0FBQ3JCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyxPQUFPLFFBQVEsS0FBSyxPQUFPLElBQUksU0FBUyxNQUFNO0FBQ3BGO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQSxhQUFhLFNBQVM7O0FBRXRCO0FBQ0EsaUJBQWlCLFVBQVU7O0FBRTNCOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBLGFBQWEsbUJBQW1COztBQUVoQztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLGtDQUFrQztBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGlFQUFlLGtDQUFrQyxFQUFDOzs7Ozs7Ozs7Ozs7Ozs7O0FDL0haOztBQUUvQjtBQUNQLGNBQWMscURBQVE7QUFDdEI7QUFDQSxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmVvLm1qcy8uL2V4YW1wbGVzL2NvbXBvbmVudC9tdWx0aVdpbmRvd0Nvcm9uYUdhbGxlcnkvVmlld3BvcnQubWpzIiwid2VicGFjazovL25lby5tanMvLi9leGFtcGxlcy9jb21wb25lbnQvbXVsdGlXaW5kb3dDb3JvbmFHYWxsZXJ5L1ZpZXdwb3J0Q29udHJvbGxlci5tanMiLCJ3ZWJwYWNrOi8vbmVvLm1qcy8uL2V4YW1wbGVzL2NvbXBvbmVudC9tdWx0aVdpbmRvd0Nvcm9uYUdhbGxlcnkvYXBwLm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQmFzZVZpZXdwb3J0ICAgICAgIGZyb20gJy4uL2Nvcm9uYUdhbGxlcnkvVmlld3BvcnQubWpzJztcbmltcG9ydCBWaWV3cG9ydENvbnRyb2xsZXIgZnJvbSAnLi9WaWV3cG9ydENvbnRyb2xsZXIubWpzJztcblxuLyoqXG4gKiBAY2xhc3MgTmVvLmV4YW1wbGVzLmNvbXBvbmVudC5tdWx0aVdpbmRvd0Nvcm9uYUdhbGxlcnkuVmlld3BvcnRcbiAqIEBleHRlbmRzIE5lby5leGFtcGxlcy5jb21wb25lbnQuY29yb25hR2FsbGVyeS5WaWV3cG9ydFxuICovXG5jbGFzcyBWaWV3cG9ydCBleHRlbmRzIEJhc2VWaWV3cG9ydCB7XG4gICAgc3RhdGljIGNvbmZpZyA9IHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gY2xhc3NOYW1lPSdOZW8uZXhhbXBsZXMuY29tcG9uZW50Lm11bHRpV2luZG93Q29yb25hR2FsbGVyeS5WaWV3cG9ydCdcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgY2xhc3NOYW1lOiAnTmVvLmV4YW1wbGVzLmNvbXBvbmVudC5tdWx0aVdpbmRvd0Nvcm9uYUdhbGxlcnkuVmlld3BvcnQnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nW119IGNscz1bJ211bHRpLXdpbmRvdy1oZWxpeC12aWV3cG9ydCddXG4gICAgICAgICAqL1xuICAgICAgICBjbHM6IFsnbXVsdGktd2luZG93LWhlbGl4LXZpZXdwb3J0J10sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtOZW8uY29udHJvbGxlci5Db21wb25lbnR9IGNvbnRyb2xsZXI9Vmlld3BvcnRDb250cm9sbGVyXG4gICAgICAgICAqL1xuICAgICAgICBjb250cm9sbGVyOiBWaWV3cG9ydENvbnRyb2xsZXJcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnXG4gICAgICovXG4gICAgY29uc3RydWN0KGNvbmZpZykge1xuICAgICAgICBzdXBlci5jb25zdHJ1Y3QoY29uZmlnKTtcblxuICAgICAgICB0aGlzLmdldEl0ZW0oJ2NvbnRyb2xzLXBhbmVsJykuaGVhZGVycyA9IFt7XG4gICAgICAgICAgICBkb2NrICAgICA6ICd0b3AnLFxuICAgICAgICAgICAgcmVmZXJlbmNlOiAnaGVhZGVyLXRvb2xiYXInLFxuXG4gICAgICAgICAgICBpdGVtczogW3tcbiAgICAgICAgICAgICAgICBudHlwZTogJ2xhYmVsJyxcbiAgICAgICAgICAgICAgICBjbHMgIDogWyduZW8tcGFuZWwtaGVhZGVyLXRleHQnLCAnbmVvLWxhYmVsJ10sXG4gICAgICAgICAgICAgICAgdGV4dCA6ICdHYWxsZXJ5IENvbnRyb2xzJ1xuICAgICAgICAgICAgfSwgJy0+Jywge1xuICAgICAgICAgICAgICAgIGhhbmRsZXI6ICdvbk1heGltaXNlQnV0dG9uQ2xpY2snLFxuICAgICAgICAgICAgICAgIGljb25DbHM6ICdmYXIgZmEtd2luZG93LW1heGltaXplJ1xuICAgICAgICAgICAgfV1cbiAgICAgICAgfV1cbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IE5lby5zZXR1cENsYXNzKFZpZXdwb3J0KTtcbiIsImltcG9ydCBDb250cm9sbGVyIGZyb20gJy4uL2Nvcm9uYUdhbGxlcnkvVmlld3BvcnRDb250cm9sbGVyLm1qcyc7XG5cbi8qKlxuICogQGNsYXNzIE5lby5leGFtcGxlcy5jb21wb25lbnQubXVsdGlXaW5kb3dDb3JvbmFHYWxsZXJ5LlZpZXdwb3J0Q29udHJvbGxlclxuICogQGV4dGVuZHMgTmVvLmV4YW1wbGVzLmNvbXBvbmVudC5jb3JvbmFHYWxsZXJ5LlZpZXdwb3J0Q29udHJvbGxlclxuICovXG5jbGFzcyBWaWV3cG9ydENvbnRyb2xsZXIgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J05lby5leGFtcGxlcy5jb21wb25lbnQubXVsdGlXaW5kb3dDb3JvbmFHYWxsZXJ5LlZpZXdwb3J0Q29udHJvbGxlcidcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgY2xhc3NOYW1lOiAnTmVvLmV4YW1wbGVzLmNvbXBvbmVudC5tdWx0aVdpbmRvd0Nvcm9uYUdhbGxlcnkuVmlld3BvcnRDb250cm9sbGVyJ1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBtZW1iZXIge1N0cmluZ1tdfSBjb25uZWN0ZWRBcHBzPVtdXG4gICAgICovXG4gICAgY29ubmVjdGVkQXBwcyA9IFtdXG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqL1xuICAgIGFzeW5jIGNyZWF0ZVBvcHVwV2luZG93KCkge1xuICAgICAgICBsZXQgbWUgICAgICAgICAgICAgICAgICAgICAgICAgPSB0aGlzLFxuICAgICAgICAgICAge3dpbmRvd0lkfSAgICAgICAgICAgICAgICAgPSBtZSxcbiAgICAgICAgICAgIHtjb25maWcsIHdpbmRvd0NvbmZpZ3N9ICAgID0gTmVvLFxuICAgICAgICAgICAge2Vudmlyb25tZW50fSAgICAgICAgICAgICAgPSBjb25maWcsXG4gICAgICAgICAgICBmaXJzdFdpbmRvd0lkICAgICAgICAgICAgICA9IE9iamVjdC5rZXlzKHdpbmRvd0NvbmZpZ3MpWzBdLFxuICAgICAgICAgICAge2Jhc2VQYXRofSAgICAgICAgICAgICAgICAgPSB3aW5kb3dDb25maWdzW2ZpcnN0V2luZG93SWRdLFxuICAgICAgICAgICAgd2lkZ2V0ICAgICAgICAgICAgICAgICAgICAgPSBtZS5nZXRSZWZlcmVuY2UoJ2NvbnRyb2xzLXBhbmVsJyksXG4gICAgICAgICAgICB3aW5EYXRhICAgICAgICAgICAgICAgICAgICA9IGF3YWl0IE5lby5NYWluLmdldFdpbmRvd0RhdGEoe3dpbmRvd0lkfSksXG4gICAgICAgICAgICByZWN0ICAgICAgICAgICAgICAgICAgICAgICA9IGF3YWl0IG1lLmNvbXBvbmVudC5nZXREb21SZWN0KHdpZGdldC5pZCksXG4gICAgICAgICAgICB7aGVpZ2h0LCBsZWZ0LCB0b3AsIHdpZHRofSA9IHJlY3Q7XG5cbiAgICAgICAgaWYgKGVudmlyb25tZW50ICE9PSAnZGV2ZWxvcG1lbnQnKSB7XG4gICAgICAgICAgICBiYXNlUGF0aCA9IGAke2Jhc2VQYXRoICsgZW52aXJvbm1lbnR9L2BcbiAgICAgICAgfVxuXG4gICAgICAgIGhlaWdodCArPSAxOyAvLyBwb3B1cCBoZWFkZXIgaW4gQ2hyb21lID0+IGhlaWdodCArIDEsIHRvcCAtNjNcbiAgICAgICAgbGVmdCAgICs9ICh3aWR0aCArIHdpbkRhdGEuc2NyZWVuTGVmdCk7XG4gICAgICAgIHRvcCAgICArPSAod2luRGF0YS5vdXRlckhlaWdodCAtIHdpbkRhdGEuaW5uZXJIZWlnaHQgKyB3aW5EYXRhLnNjcmVlblRvcCAtIDYzKTtcblxuICAgICAgICAvLyBNb3VudGVkIGluc2lkZSBhIGNvZGUuTGl2ZVByZXZpZXcsIHRoZSBwb3B1cCBoZWFkZXIgc2hvdWxkIGJlIHdpdGhpbiB0aGUgY29udGVudCAoaGVpZ2h0LXdpc2UpXG4gICAgICAgIC8vIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL25lb21qcy9uZW8vaXNzdWVzLzU5OTFcbiAgICAgICAgaWYgKG1lLmNvbXBvbmVudC51cCgnbGl2ZS1wcmV2aWV3JykpIHtcbiAgICAgICAgICAgIGhlaWdodCAtPSA2MztcbiAgICAgICAgICAgIHRvcCAgICArPSA2MztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qXG4gICAgICAgICAqIEZvciB0aGlzIGRlbW8sIHRoZSB1cmwgJy4vY2hpbGRhcHAvJyB3b3VsZCBiZSBzdWZmaWNpZW50LlxuICAgICAgICAgKiBIb3dldmVyLCB3ZSBhbHNvIHdhbnQgdG8gb3BlbiBpdCBmcm9tIHdpdGhpbiBhcHBzL3BvcnRhbC5cbiAgICAgICAgICpcbiAgICAgICAgICogV2UgbWF0Y2ggdGhlIGJhc2VQYXRoIHRvIHRoZSBmaXJzdFdpbmRvd0lkLFxuICAgICAgICAgKiBhc3N1bWluZyB0aGUgZmlyc3QgY29ubmVjdGVkIHdpbmRvdyBpcyB0aGUgKG1haW4pIG9uZSB3aGljaCB3ZSB3YW50IHRvIGJlIGluIGNoYXJnZS5cbiAgICAgICAgICovXG4gICAgICAgIGF3YWl0IE5lby5NYWluLndpbmRvd09wZW4oe1xuICAgICAgICAgICAgdXJsICAgICAgICAgICA6IGJhc2VQYXRoICsgJ2V4YW1wbGVzL2NvbXBvbmVudC9tdWx0aVdpbmRvd0Nvcm9uYUdhbGxlcnkvY2hpbGRhcHAvJyxcbiAgICAgICAgICAgIHdpbmRvd0ZlYXR1cmVzOiBgaGVpZ2h0PSR7aGVpZ2h0fSxsZWZ0PSR7bGVmdH0sdG9wPSR7dG9wfSx3aWR0aD0ke3dpZHRofWAsXG4gICAgICAgICAgICB3aW5kb3dJZCAgICAgIDogZmlyc3RXaW5kb3dJZCxcbiAgICAgICAgICAgIHdpbmRvd05hbWUgICAgOiAnR2FsbGVyeUNvbnRyb2xzJ1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGRhdGEuYXBwTmFtZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBkYXRhLndpbmRvd0lkXG4gICAgICovXG4gICAgYXN5bmMgb25BcHBDb25uZWN0KGRhdGEpIHtcbiAgICAgICAgbGV0IG1lICAgICAgICA9IHRoaXMsXG4gICAgICAgICAgICB7YXBwTmFtZX0gPSBkYXRhO1xuXG4gICAgICAgIGlmIChhcHBOYW1lID09PSAnR2FsbGVyeUNvbnRyb2xzJykge1xuICAgICAgICAgICAgbGV0IHttYWluVmlld30gPSBOZW8uYXBwc1tkYXRhLndpbmRvd0lkXTtcblxuICAgICAgICAgICAgbWUuY29ubmVjdGVkQXBwcy5wdXNoKGFwcE5hbWUpO1xuXG4gICAgICAgICAgICB0aGlzLmdldFJlZmVyZW5jZSgnaGVhZGVyLXRvb2xiYXInKS5oaWRkZW4gPSB0cnVlO1xuXG4gICAgICAgICAgICBtYWluVmlldy5hZGQobWUuZ2V0UmVmZXJlbmNlKCdjb250cm9scy1wYW5lbCcpKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGFcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZGF0YS5hcHBOYW1lXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGRhdGEud2luZG93SWRcbiAgICAgKi9cbiAgICBhc3luYyBvbkFwcERpc2Nvbm5lY3QoZGF0YSkge1xuICAgICAgICBsZXQgbWUgICAgICAgICAgICAgICAgICA9IHRoaXMsXG4gICAgICAgICAgICB7YXBwTmFtZSwgd2luZG93SWR9ID0gZGF0YTtcblxuICAgICAgICBpZiAoYXBwTmFtZSA9PT0gJ0dhbGxlcnlDb250cm9scycpIHtcbiAgICAgICAgICAgIG1lLmdldFJlZmVyZW5jZSgnaGVhZGVyLXRvb2xiYXInKS5oaWRkZW4gPSBmYWxzZTtcblxuICAgICAgICAgICAgbWUuY29tcG9uZW50LmFkZChtZS5nZXRSZWZlcmVuY2UoJ2NvbnRyb2xzLXBhbmVsJykpXG4gICAgICAgIH1cbiAgICAgICAgLy8gQ2xvc2UgcG9wdXAgd2luZG93cyB3aGVuIGNsb3Npbmcgb3IgcmVsb2FkaW5nIHRoZSBtYWluIHdpbmRvd1xuICAgICAgICBlbHNlIGlmIChhcHBOYW1lID09PSAnTmVvLmV4YW1wbGVzLmNvbXBvbmVudC5tdWx0aVdpbmRvd0Nvcm9uYUdhbGxlcnknKSB7XG4gICAgICAgICAgICBOZW8uTWFpbi53aW5kb3dDbG9zZSh7bmFtZXM6IG1lLmNvbm5lY3RlZEFwcHMsIHdpbmRvd0lkfSlcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKlxuICAgICAqL1xuICAgIG9uQ29uc3RydWN0ZWQoKSB7XG4gICAgICAgIHN1cGVyLm9uQ29uc3RydWN0ZWQoKTtcblxuICAgICAgICBsZXQgbWUgPSB0aGlzO1xuXG4gICAgICAgIE5lby5jdXJyZW50V29ya2VyLm9uKHtcbiAgICAgICAgICAgIGNvbm5lY3QgICA6IG1lLm9uQXBwQ29ubmVjdCxcbiAgICAgICAgICAgIGRpc2Nvbm5lY3Q6IG1lLm9uQXBwRGlzY29ubmVjdCxcbiAgICAgICAgICAgIHNjb3BlICAgICA6IG1lXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGFcbiAgICAgKi9cbiAgICBhc3luYyBvbk1heGltaXNlQnV0dG9uQ2xpY2soZGF0YSkge1xuICAgICAgICBhd2FpdCB0aGlzLmNyZWF0ZVBvcHVwV2luZG93KClcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IE5lby5zZXR1cENsYXNzKFZpZXdwb3J0Q29udHJvbGxlcik7XG4iLCJpbXBvcnQgVmlld3BvcnQgZnJvbSAnLi9WaWV3cG9ydC5tanMnO1xuXG5leHBvcnQgY29uc3Qgb25TdGFydCA9ICgpID0+IE5lby5hcHAoe1xuICAgIG1haW5WaWV3OiBWaWV3cG9ydCxcbiAgICBuYW1lICAgIDogJ05lby5leGFtcGxlcy5jb21wb25lbnQubXVsdGlXaW5kb3dDb3JvbmFHYWxsZXJ5J1xufSk7XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9