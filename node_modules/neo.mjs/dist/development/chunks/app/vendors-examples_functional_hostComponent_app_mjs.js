"use strict";
(self["webpackChunkneo_mjs"] = self["webpackChunkneo_mjs"] || []).push([["vendors-examples_functional_hostComponent_app_mjs"],{

/***/ "./examples/functional/hostComponent/Component.mjs":
/*!*********************************************************!*\
  !*** ./examples/functional/hostComponent/Component.mjs ***!
  \*********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _src_functional_export_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../src/functional/_export.mjs */ "./src/functional/_export.mjs");
/* harmony import */ var _src_button_Base_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../src/button/Base.mjs */ "./src/button/Base.mjs");



/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_src_functional_export_mjs__WEBPACK_IMPORTED_MODULE_0__.defineComponent)({
    config: {
        className: 'Neo.examples.functional.hostComponent.Component'
    },
    createVdom() {
        const [count, setCount] = (0,_src_functional_export_mjs__WEBPACK_IMPORTED_MODULE_0__.useConfig)(0);

        const style = {
            display       : 'flex',
            flexDirection : 'column',
            alignItems    : 'center',
            justifyContent: 'center',
            fontSize      : '20px'
        };

        return {style, cn: [
            {
                tag : 'p',
                text: `Button clicked ${count} times`
            }, {
                module : _src_button_Base_mjs__WEBPACK_IMPORTED_MODULE_1__["default"],
                id     : 'myButtonModule',
                theme  : 'neo-theme-neo-light',
                text   : 'Click Me (Neo Button)',
                handler: () => setCount(prev => prev + 1)
            }
        ]}
    }
}));


/***/ }),

/***/ "./examples/functional/hostComponent/MainContainer.mjs":
/*!*************************************************************!*\
  !*** ./examples/functional/hostComponent/MainContainer.mjs ***!
  \*************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _ConfigurationViewport_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../ConfigurationViewport.mjs */ "./examples/ConfigurationViewport.mjs");
/* harmony import */ var _Component_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Component.mjs */ "./examples/functional/hostComponent/Component.mjs");
/* harmony import */ var _src_form_field_Text_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../src/form/field/Text.mjs */ "./src/form/field/Text.mjs");




/**
 * @class Neo.examples.functional.hostComponent.MainContainer
 * @extends Neo.examples.ConfigurationViewport
 */
class MainContainer extends _ConfigurationViewport_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        className           : 'Neo.examples.functional.hostComponent.MainContainer',
        configItemLabelWidth: 120,
        configItemWidth     : 300,
        layout              : {ntype: 'hbox', align: 'stretch'}
    }

    async createConfigurationComponents() {
        // Wait one micro task queue tick, to ensure the fn render Effect is done
        await Promise.resolve();

        const button = Neo.getComponent('myButtonModule');

        return [{
            module    : _src_form_field_Text_mjs__WEBPACK_IMPORTED_MODULE_2__["default"],
            clearable : true,
            labelText : 'Button Text',
            style     : {marginTop: '10px'},
            value     : button.text,

            listeners : {
                change({value}) {
                    button.text = value
                }
            }
        }]
    }

    /**
     * @returns {Neo.functional.Component}
     */
    createExampleComponent() {
        return {
            module: _Component_mjs__WEBPACK_IMPORTED_MODULE_1__["default"]
        }
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(MainContainer));


/***/ }),

/***/ "./examples/functional/hostComponent/app.mjs":
/*!***************************************************!*\
  !*** ./examples/functional/hostComponent/app.mjs ***!
  \***************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   onStart: () => (/* binding */ onStart)
/* harmony export */ });
/* harmony import */ var _MainContainer_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MainContainer.mjs */ "./examples/functional/hostComponent/MainContainer.mjs");


const onStart = () => Neo.app({
    mainView: _MainContainer_mjs__WEBPACK_IMPORTED_MODULE_0__["default"],
    name    : 'Neo.examples.functional.hostComponent'
});


/***/ }),

/***/ "./src/functional/_export.mjs":
/*!************************************!*\
  !*** ./src/functional/_export.mjs ***!
  \************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Component: () => (/* reexport safe */ _component_Base_mjs__WEBPACK_IMPORTED_MODULE_0__["default"]),
/* harmony export */   defineComponent: () => (/* reexport safe */ _defineComponent_mjs__WEBPACK_IMPORTED_MODULE_1__["default"]),
/* harmony export */   html: () => (/* reexport safe */ _util_html_mjs__WEBPACK_IMPORTED_MODULE_2__.html),
/* harmony export */   useConfig: () => (/* reexport safe */ _useConfig_mjs__WEBPACK_IMPORTED_MODULE_3__["default"]),
/* harmony export */   useEvent: () => (/* reexport safe */ _useEvent_mjs__WEBPACK_IMPORTED_MODULE_4__["default"])
/* harmony export */ });
/* harmony import */ var _component_Base_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./component/Base.mjs */ "./src/functional/component/Base.mjs");
/* harmony import */ var _defineComponent_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./defineComponent.mjs */ "./src/functional/defineComponent.mjs");
/* harmony import */ var _util_html_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./util/html.mjs */ "./src/functional/util/html.mjs");
/* harmony import */ var _useConfig_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./useConfig.mjs */ "./src/functional/useConfig.mjs");
/* harmony import */ var _useEvent_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./useEvent.mjs */ "./src/functional/useEvent.mjs");









/***/ }),

/***/ "./src/functional/defineComponent.mjs":
/*!********************************************!*\
  !*** ./src/functional/defineComponent.mjs ***!
  \********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__),
/* harmony export */   defineComponent: () => (/* binding */ defineComponent)
/* harmony export */ });
/* harmony import */ var _component_Base_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./component/Base.mjs */ "./src/functional/component/Base.mjs");


/**
 * Factory function to create a functional component class from a specification object.
 * This enables a "Beginner Mode" for creating components without writing a class,
 * while still providing access to the full class-based feature set.
 *
 * It's important to understand the two ways of managing state:
 *
 * 1.  **Named Configs (Public API):** Defined in the `config` object (e.g., `text_`).
 *     - **Purpose:** Defines the component's public API for external control, similar to props.
 *     - **Use Case:** For data that a parent component will set or change.
 *     - **Features:** Integrates with the full config system (e.g., `afterSetText()` hooks).
 *
 * 2.  **`useConfig()` (Internal State):** Used inside `createVdom` or other methods.
 *     - **Purpose:** Manages private, encapsulated state that is internal to the component.
 *     - **Use Case:** For state that the component manages itself and is not controlled by the parent.
 *     - **Features:** Provides a simple, concise way to handle local reactive state.
 *
 * @param {Object} spec - The specification object for the component.
 * @returns {Neo.functional.component.Base} The generated component class.
 *
 * @example
 * import { defineComponent } from 'neo/functional/defineComponent.mjs';
 * import { useConfig }       from 'neo/functional/useConfig.mjs';
 *
 * const MyComponent = defineComponent({
 *     // 1. Define the Public API via the `config` object.
 *     config: {
 *         className: 'MyApp.MyFunctionalComponent',
 *         ntype    : 'my-functional-component',
 *
 *         // `text_` is a NAMED CONFIG. It's part of the component's public API.
 *         // A parent can create this component with a `text` config.
 *         // It is reactive and will generate `afterSetText()` and `beforeSetText()` hooks.
 *         text_: 'Hello World'
 *     },
 *
 *     // 2. Define the component's logic and VDOM.
 *     createVdom(config) {
 *         // `useConfig` creates ANONYMOUS, INTERNAL STATE.
 *         // The `count` state is private to this component and cannot be set by a parent.
 *         const [count, setCount] = useConfig(0);
 *
 *         return {
 *             tag: 'div',
 *             cn: [{
 *                 tag: 'h1',
 *                 // Access the public, named config via the `config` parameter.
 *                 text: config.text
 *             }, {
 *                 tag: 'p',
 *                 // Access the private, internal state directly.
 *                 text: `You clicked ${count} times`
 *             }, {
 *                 tag: 'button',
 *                 text: 'Click me',
 *                 // The setter from `useConfig` updates the internal state.
 *                 onclick: () => setCount(count + 1)
 *             }]
 *         };
 *     },
 *
 *     // 3. Lifecycle hooks for named configs work automatically.
 *     afterSetText(newValue, oldValue) {
 *         console.log(`Text changed from '${oldValue}' to '${newValue}'`);
 *     }
 * });
 *
 * // The returned MyComponent is a class constructor that can be used with Neo.create()
 * // const instance = Neo.create(MyComponent, {
 * //     text: 'Welcome to Neo.mjs!' // Set the public config on creation.
 * // });
 */
function defineComponent(spec) {
    const configSpec = spec.config;
    delete spec.config;

    if (!configSpec?.className) {
        throw new Error('defineComponent requires a config object with a className.');
    }

    class FunctionalComponent extends _component_Base_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
        static config = {
            ...configSpec
            // We can add our own configurations here
        }
    }

    // Assign instance methods
    Object.entries(spec).forEach(([key, value]) => {
        FunctionalComponent.prototype[key] = value
    });

    // To support multiple envs (like `devmode`, `dist/esm`, `dist/production` in parallel,
    // we must re-assign FunctionalComponent to the setupClass() output.
    FunctionalComponent = Neo.setupClass(FunctionalComponent);

    return FunctionalComponent
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (defineComponent);


/***/ }),

/***/ "./src/functional/useConfig.mjs":
/*!**************************************!*\
  !*** ./src/functional/useConfig.mjs ***!
  \**************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__),
/* harmony export */   useConfig: () => (/* binding */ useConfig)
/* harmony export */ });
/* harmony import */ var _core_Config_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/Config.mjs */ "./src/core/Config.mjs");
/* harmony import */ var _core_EffectManager_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/EffectManager.mjs */ "./src/core/EffectManager.mjs");



const
    hookIndexSymbol = Symbol.for('hookIndex'),
    hooksSymbol     = Symbol.for('hooks');

/**
 * A hook for managing reactive state within a functional component's `createVdom` method.
 * It mirrors the behavior of React's `useState` but is powered by `Neo.core.Config` for reactivity.
 * @param {*} initialValue The initial value for the state.
 * @returns {Array<any>} A tuple containing the current value and a setter function.
 */
function useConfig(initialValue) {
    _core_EffectManager_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].pause();

    const
        effect    = _core_EffectManager_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].getActiveEffect(),
        component = effect && Neo.getComponent(effect.componentId);

    if (!component) {
        throw new Error('useConfig must be called from within a functional component\'s createVdom method.')
    }

    const currentIndex = component[hookIndexSymbol];

    // Increment the index for the next hook call within the same component render cycle.
    component[hookIndexSymbol]++;

    // If this is the first time this hook is being called for this component, initialize its state.
    if (!component[hooksSymbol][currentIndex]) {
        const config = new _core_Config_mjs__WEBPACK_IMPORTED_MODULE_0__["default"](initialValue);

        const customSetter = (newValue) => {
            if (typeof newValue === 'function') {
                newValue = newValue(config.get())
            }
            config.set(newValue)
        };

        component[hooksSymbol][currentIndex] = [config, customSetter]
    }

    const [config, setter] = component[hooksSymbol][currentIndex];

    _core_EffectManager_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].resume();

    // Call config.get() to ensure this component's effect tracks this config as a dependency.
    return [config.get(), setter]
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (useConfig);


/***/ }),

/***/ "./src/functional/useEvent.mjs":
/*!*************************************!*\
  !*** ./src/functional/useEvent.mjs ***!
  \*************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__),
/* harmony export */   useEvent: () => (/* binding */ useEvent)
/* harmony export */ });
/* harmony import */ var _core_EffectManager_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/EffectManager.mjs */ "./src/core/EffectManager.mjs");


const pendingDomEventsSymbol = Symbol.for('pendingDomEvents');

/**
 * A hook for registering DOM event listeners within a functional component.
 * Event listeners registered via this hook will be managed by Neo.mjs's
 * delegated DOM event system, ensuring efficient and proper lifecycle handling.
 *
 * @param {String} eventType - The type of DOM event to listen for (e.g., 'click', 'input').
 * @param {Function} handler - The event handler function. It will receive the event data as its argument.
 * @param {String} [delegate] - An optional CSS selector for event delegation. If provided,
 *                               the handler will only fire if the event target matches this selector.
 */
function useEvent(eventType, handler, delegate) {
    const
        activeEffect = _core_EffectManager_mjs__WEBPACK_IMPORTED_MODULE_0__["default"].getActiveEffect(),
        componentId  = activeEffect?.componentId;

    if (!componentId) {
        throw new Error('useEvent must be called from within a functional component\'s createVdom method.')
    }

    _core_EffectManager_mjs__WEBPACK_IMPORTED_MODULE_0__["default"].pause();
    const component = Neo.getComponent(componentId);
    _core_EffectManager_mjs__WEBPACK_IMPORTED_MODULE_0__["default"].resume();

    if (!component) {
        throw new Error(`Component with id ${componentId} not found for useEvent hook.`);
    }

    // Ensure pendingDomEventsSymbol exists on the component instance
    component[pendingDomEventsSymbol] ??= [];

    // Add the event listener configuration to the component's pending list
    component[pendingDomEventsSymbol].push({
        [eventType]: handler,
        delegate,
        scope      : component // The component instance itself will be the scope
    })
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (useEvent);


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2h1bmtzL2FwcC92ZW5kb3JzLWV4YW1wbGVzX2Z1bmN0aW9uYWxfaG9zdENvbXBvbmVudF9hcHBfbWpzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUErRTtBQUNQOztBQUV4RSxpRUFBZSwyRUFBZTtBQUM5QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0Esa0NBQWtDLHFFQUFTOztBQUUzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBLHdDQUF3QyxPQUFPO0FBQy9DLGFBQWE7QUFDYix5QkFBeUIsNERBQU07QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLENBQUMsRUFBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDL0JpRTtBQUNoQjtBQUNpQjs7QUFFckU7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsa0VBQXFCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9COztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLHdCQUF3QixnRUFBUztBQUNqQztBQUNBO0FBQ0EseUJBQXlCLGtCQUFrQjtBQUMzQzs7QUFFQTtBQUNBLHdCQUF3QixNQUFNO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isc0RBQXFCO0FBQ3pDO0FBQ0E7QUFDQTs7QUFFQSxpRUFBZSw2QkFBNkIsRUFBQzs7Ozs7Ozs7Ozs7Ozs7OztBQy9DRzs7QUFFekM7QUFDUCxjQUFjLDBEQUFhO0FBQzNCO0FBQ0EsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDTGtEO0FBQ0M7QUFDTjtBQUNBO0FBQ0Q7O0FBRWtCOzs7Ozs7Ozs7Ozs7Ozs7OztBQ05iOztBQUVsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxRQUFRO0FBQ25CLGFBQWEsK0JBQStCO0FBQzVDO0FBQ0E7QUFDQSxZQUFZLGtCQUFrQjtBQUM5QixZQUFZLGtCQUFrQjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQSx3Q0FBd0MsT0FBTztBQUMvQyxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLFNBQVMsUUFBUSxTQUFTO0FBQ3ZFO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ087QUFDUDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxzQ0FBc0MsMkRBQWM7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBLGlFQUFlLGVBQWUsRUFBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDckdnQjtBQUNPOztBQUV0RDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsV0FBVyxHQUFHO0FBQ2QsYUFBYSxZQUFZO0FBQ3pCO0FBQ087QUFDUCxJQUFJLCtEQUFhOztBQUVqQjtBQUNBLG9CQUFvQiwrREFBYTtBQUNqQzs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsMkJBQTJCLHdEQUFNOztBQUVqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQSxJQUFJLCtEQUFhOztBQUVqQjtBQUNBO0FBQ0E7O0FBRUEsaUVBQWUsU0FBUyxFQUFDOzs7Ozs7Ozs7Ozs7Ozs7OztBQ25ENkI7O0FBRXREOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsV0FBVyxVQUFVO0FBQ3JCLFdBQVcsUUFBUTtBQUNuQjtBQUNBO0FBQ087QUFDUDtBQUNBLHVCQUF1QiwrREFBYTtBQUNwQzs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsSUFBSSwrREFBYTtBQUNqQjtBQUNBLElBQUksK0RBQWE7O0FBRWpCO0FBQ0EsNkNBQTZDLGFBQWE7QUFDMUQ7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBLGlFQUFlLFFBQVEsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL25lby5tanMvLi9leGFtcGxlcy9mdW5jdGlvbmFsL2hvc3RDb21wb25lbnQvQ29tcG9uZW50Lm1qcyIsIndlYnBhY2s6Ly9uZW8ubWpzLy4vZXhhbXBsZXMvZnVuY3Rpb25hbC9ob3N0Q29tcG9uZW50L01haW5Db250YWluZXIubWpzIiwid2VicGFjazovL25lby5tanMvLi9leGFtcGxlcy9mdW5jdGlvbmFsL2hvc3RDb21wb25lbnQvYXBwLm1qcyIsIndlYnBhY2s6Ly9uZW8ubWpzLy4vc3JjL2Z1bmN0aW9uYWwvX2V4cG9ydC5tanMiLCJ3ZWJwYWNrOi8vbmVvLm1qcy8uL3NyYy9mdW5jdGlvbmFsL2RlZmluZUNvbXBvbmVudC5tanMiLCJ3ZWJwYWNrOi8vbmVvLm1qcy8uL3NyYy9mdW5jdGlvbmFsL3VzZUNvbmZpZy5tanMiLCJ3ZWJwYWNrOi8vbmVvLm1qcy8uL3NyYy9mdW5jdGlvbmFsL3VzZUV2ZW50Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2RlZmluZUNvbXBvbmVudCwgdXNlQ29uZmlnfSBmcm9tICcuLi8uLi8uLi9zcmMvZnVuY3Rpb25hbC9fZXhwb3J0Lm1qcyc7XG5pbXBvcnQgQnV0dG9uICAgICAgICAgICAgICAgICAgICAgICBmcm9tICcuLi8uLi8uLi9zcmMvYnV0dG9uL0Jhc2UubWpzJztcblxuZXhwb3J0IGRlZmF1bHQgZGVmaW5lQ29tcG9uZW50KHtcbiAgICBjb25maWc6IHtcbiAgICAgICAgY2xhc3NOYW1lOiAnTmVvLmV4YW1wbGVzLmZ1bmN0aW9uYWwuaG9zdENvbXBvbmVudC5Db21wb25lbnQnXG4gICAgfSxcbiAgICBjcmVhdGVWZG9tKCkge1xuICAgICAgICBjb25zdCBbY291bnQsIHNldENvdW50XSA9IHVzZUNvbmZpZygwKTtcblxuICAgICAgICBjb25zdCBzdHlsZSA9IHtcbiAgICAgICAgICAgIGRpc3BsYXkgICAgICAgOiAnZmxleCcsXG4gICAgICAgICAgICBmbGV4RGlyZWN0aW9uIDogJ2NvbHVtbicsXG4gICAgICAgICAgICBhbGlnbkl0ZW1zICAgIDogJ2NlbnRlcicsXG4gICAgICAgICAgICBqdXN0aWZ5Q29udGVudDogJ2NlbnRlcicsXG4gICAgICAgICAgICBmb250U2l6ZSAgICAgIDogJzIwcHgnXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHtzdHlsZSwgY246IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0YWcgOiAncCcsXG4gICAgICAgICAgICAgICAgdGV4dDogYEJ1dHRvbiBjbGlja2VkICR7Y291bnR9IHRpbWVzYFxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIG1vZHVsZSA6IEJ1dHRvbixcbiAgICAgICAgICAgICAgICBpZCAgICAgOiAnbXlCdXR0b25Nb2R1bGUnLFxuICAgICAgICAgICAgICAgIHRoZW1lICA6ICduZW8tdGhlbWUtbmVvLWxpZ2h0JyxcbiAgICAgICAgICAgICAgICB0ZXh0ICAgOiAnQ2xpY2sgTWUgKE5lbyBCdXR0b24pJyxcbiAgICAgICAgICAgICAgICBoYW5kbGVyOiAoKSA9PiBzZXRDb3VudChwcmV2ID0+IHByZXYgKyAxKVxuICAgICAgICAgICAgfVxuICAgICAgICBdfVxuICAgIH1cbn0pO1xuIiwiaW1wb3J0IENvbmZpZ3VyYXRpb25WaWV3cG9ydCBmcm9tICcuLi8uLi9Db25maWd1cmF0aW9uVmlld3BvcnQubWpzJztcbmltcG9ydCBNeUZ1bmN0aW9uYWxDb21wb25lbnQgZnJvbSAnLi9Db21wb25lbnQubWpzJztcbmltcG9ydCBUZXh0RmllbGQgICAgICAgICAgICAgZnJvbSAnLi4vLi4vLi4vc3JjL2Zvcm0vZmllbGQvVGV4dC5tanMnO1xuXG4vKipcbiAqIEBjbGFzcyBOZW8uZXhhbXBsZXMuZnVuY3Rpb25hbC5ob3N0Q29tcG9uZW50Lk1haW5Db250YWluZXJcbiAqIEBleHRlbmRzIE5lby5leGFtcGxlcy5Db25maWd1cmF0aW9uVmlld3BvcnRcbiAqL1xuY2xhc3MgTWFpbkNvbnRhaW5lciBleHRlbmRzIENvbmZpZ3VyYXRpb25WaWV3cG9ydCB7XG4gICAgc3RhdGljIGNvbmZpZyA9IHtcbiAgICAgICAgY2xhc3NOYW1lICAgICAgICAgICA6ICdOZW8uZXhhbXBsZXMuZnVuY3Rpb25hbC5ob3N0Q29tcG9uZW50Lk1haW5Db250YWluZXInLFxuICAgICAgICBjb25maWdJdGVtTGFiZWxXaWR0aDogMTIwLFxuICAgICAgICBjb25maWdJdGVtV2lkdGggICAgIDogMzAwLFxuICAgICAgICBsYXlvdXQgICAgICAgICAgICAgIDoge250eXBlOiAnaGJveCcsIGFsaWduOiAnc3RyZXRjaCd9XG4gICAgfVxuXG4gICAgYXN5bmMgY3JlYXRlQ29uZmlndXJhdGlvbkNvbXBvbmVudHMoKSB7XG4gICAgICAgIC8vIFdhaXQgb25lIG1pY3JvIHRhc2sgcXVldWUgdGljaywgdG8gZW5zdXJlIHRoZSBmbiByZW5kZXIgRWZmZWN0IGlzIGRvbmVcbiAgICAgICAgYXdhaXQgUHJvbWlzZS5yZXNvbHZlKCk7XG5cbiAgICAgICAgY29uc3QgYnV0dG9uID0gTmVvLmdldENvbXBvbmVudCgnbXlCdXR0b25Nb2R1bGUnKTtcblxuICAgICAgICByZXR1cm4gW3tcbiAgICAgICAgICAgIG1vZHVsZSAgICA6IFRleHRGaWVsZCxcbiAgICAgICAgICAgIGNsZWFyYWJsZSA6IHRydWUsXG4gICAgICAgICAgICBsYWJlbFRleHQgOiAnQnV0dG9uIFRleHQnLFxuICAgICAgICAgICAgc3R5bGUgICAgIDoge21hcmdpblRvcDogJzEwcHgnfSxcbiAgICAgICAgICAgIHZhbHVlICAgICA6IGJ1dHRvbi50ZXh0LFxuXG4gICAgICAgICAgICBsaXN0ZW5lcnMgOiB7XG4gICAgICAgICAgICAgICAgY2hhbmdlKHt2YWx1ZX0pIHtcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnRleHQgPSB2YWx1ZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfV1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7TmVvLmZ1bmN0aW9uYWwuQ29tcG9uZW50fVxuICAgICAqL1xuICAgIGNyZWF0ZUV4YW1wbGVDb21wb25lbnQoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBtb2R1bGU6IE15RnVuY3Rpb25hbENvbXBvbmVudFxuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBOZW8uc2V0dXBDbGFzcyhNYWluQ29udGFpbmVyKTtcbiIsImltcG9ydCBNYWluQ29udGFpbmVyIGZyb20gJy4vTWFpbkNvbnRhaW5lci5tanMnO1xuXG5leHBvcnQgY29uc3Qgb25TdGFydCA9ICgpID0+IE5lby5hcHAoe1xuICAgIG1haW5WaWV3OiBNYWluQ29udGFpbmVyLFxuICAgIG5hbWUgICAgOiAnTmVvLmV4YW1wbGVzLmZ1bmN0aW9uYWwuaG9zdENvbXBvbmVudCdcbn0pO1xuIiwiaW1wb3J0IENvbXBvbmVudCAgICAgICBmcm9tICcuL2NvbXBvbmVudC9CYXNlLm1qcyc7XG5pbXBvcnQgZGVmaW5lQ29tcG9uZW50IGZyb20gJy4vZGVmaW5lQ29tcG9uZW50Lm1qcyc7XG5pbXBvcnQge2h0bWx9ICAgICAgICAgIGZyb20gJy4vdXRpbC9odG1sLm1qcyc7XG5pbXBvcnQgdXNlQ29uZmlnICAgICAgIGZyb20gJy4vdXNlQ29uZmlnLm1qcyc7XG5pbXBvcnQgdXNlRXZlbnQgICAgICAgIGZyb20gJy4vdXNlRXZlbnQubWpzJztcblxuZXhwb3J0IHtDb21wb25lbnQsIGRlZmluZUNvbXBvbmVudCwgaHRtbCwgdXNlQ29uZmlnLCB1c2VFdmVudH07XG4iLCJpbXBvcnQgRnVuY3Rpb25hbEJhc2UgZnJvbSAnLi9jb21wb25lbnQvQmFzZS5tanMnO1xuXG4vKipcbiAqIEZhY3RvcnkgZnVuY3Rpb24gdG8gY3JlYXRlIGEgZnVuY3Rpb25hbCBjb21wb25lbnQgY2xhc3MgZnJvbSBhIHNwZWNpZmljYXRpb24gb2JqZWN0LlxuICogVGhpcyBlbmFibGVzIGEgXCJCZWdpbm5lciBNb2RlXCIgZm9yIGNyZWF0aW5nIGNvbXBvbmVudHMgd2l0aG91dCB3cml0aW5nIGEgY2xhc3MsXG4gKiB3aGlsZSBzdGlsbCBwcm92aWRpbmcgYWNjZXNzIHRvIHRoZSBmdWxsIGNsYXNzLWJhc2VkIGZlYXR1cmUgc2V0LlxuICpcbiAqIEl0J3MgaW1wb3J0YW50IHRvIHVuZGVyc3RhbmQgdGhlIHR3byB3YXlzIG9mIG1hbmFnaW5nIHN0YXRlOlxuICpcbiAqIDEuICAqKk5hbWVkIENvbmZpZ3MgKFB1YmxpYyBBUEkpOioqIERlZmluZWQgaW4gdGhlIGBjb25maWdgIG9iamVjdCAoZS5nLiwgYHRleHRfYCkuXG4gKiAgICAgLSAqKlB1cnBvc2U6KiogRGVmaW5lcyB0aGUgY29tcG9uZW50J3MgcHVibGljIEFQSSBmb3IgZXh0ZXJuYWwgY29udHJvbCwgc2ltaWxhciB0byBwcm9wcy5cbiAqICAgICAtICoqVXNlIENhc2U6KiogRm9yIGRhdGEgdGhhdCBhIHBhcmVudCBjb21wb25lbnQgd2lsbCBzZXQgb3IgY2hhbmdlLlxuICogICAgIC0gKipGZWF0dXJlczoqKiBJbnRlZ3JhdGVzIHdpdGggdGhlIGZ1bGwgY29uZmlnIHN5c3RlbSAoZS5nLiwgYGFmdGVyU2V0VGV4dCgpYCBob29rcykuXG4gKlxuICogMi4gICoqYHVzZUNvbmZpZygpYCAoSW50ZXJuYWwgU3RhdGUpOioqIFVzZWQgaW5zaWRlIGBjcmVhdGVWZG9tYCBvciBvdGhlciBtZXRob2RzLlxuICogICAgIC0gKipQdXJwb3NlOioqIE1hbmFnZXMgcHJpdmF0ZSwgZW5jYXBzdWxhdGVkIHN0YXRlIHRoYXQgaXMgaW50ZXJuYWwgdG8gdGhlIGNvbXBvbmVudC5cbiAqICAgICAtICoqVXNlIENhc2U6KiogRm9yIHN0YXRlIHRoYXQgdGhlIGNvbXBvbmVudCBtYW5hZ2VzIGl0c2VsZiBhbmQgaXMgbm90IGNvbnRyb2xsZWQgYnkgdGhlIHBhcmVudC5cbiAqICAgICAtICoqRmVhdHVyZXM6KiogUHJvdmlkZXMgYSBzaW1wbGUsIGNvbmNpc2Ugd2F5IHRvIGhhbmRsZSBsb2NhbCByZWFjdGl2ZSBzdGF0ZS5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gc3BlYyAtIFRoZSBzcGVjaWZpY2F0aW9uIG9iamVjdCBmb3IgdGhlIGNvbXBvbmVudC5cbiAqIEByZXR1cm5zIHtOZW8uZnVuY3Rpb25hbC5jb21wb25lbnQuQmFzZX0gVGhlIGdlbmVyYXRlZCBjb21wb25lbnQgY2xhc3MuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGRlZmluZUNvbXBvbmVudCB9IGZyb20gJ25lby9mdW5jdGlvbmFsL2RlZmluZUNvbXBvbmVudC5tanMnO1xuICogaW1wb3J0IHsgdXNlQ29uZmlnIH0gICAgICAgZnJvbSAnbmVvL2Z1bmN0aW9uYWwvdXNlQ29uZmlnLm1qcyc7XG4gKlxuICogY29uc3QgTXlDb21wb25lbnQgPSBkZWZpbmVDb21wb25lbnQoe1xuICogICAgIC8vIDEuIERlZmluZSB0aGUgUHVibGljIEFQSSB2aWEgdGhlIGBjb25maWdgIG9iamVjdC5cbiAqICAgICBjb25maWc6IHtcbiAqICAgICAgICAgY2xhc3NOYW1lOiAnTXlBcHAuTXlGdW5jdGlvbmFsQ29tcG9uZW50JyxcbiAqICAgICAgICAgbnR5cGUgICAgOiAnbXktZnVuY3Rpb25hbC1jb21wb25lbnQnLFxuICpcbiAqICAgICAgICAgLy8gYHRleHRfYCBpcyBhIE5BTUVEIENPTkZJRy4gSXQncyBwYXJ0IG9mIHRoZSBjb21wb25lbnQncyBwdWJsaWMgQVBJLlxuICogICAgICAgICAvLyBBIHBhcmVudCBjYW4gY3JlYXRlIHRoaXMgY29tcG9uZW50IHdpdGggYSBgdGV4dGAgY29uZmlnLlxuICogICAgICAgICAvLyBJdCBpcyByZWFjdGl2ZSBhbmQgd2lsbCBnZW5lcmF0ZSBgYWZ0ZXJTZXRUZXh0KClgIGFuZCBgYmVmb3JlU2V0VGV4dCgpYCBob29rcy5cbiAqICAgICAgICAgdGV4dF86ICdIZWxsbyBXb3JsZCdcbiAqICAgICB9LFxuICpcbiAqICAgICAvLyAyLiBEZWZpbmUgdGhlIGNvbXBvbmVudCdzIGxvZ2ljIGFuZCBWRE9NLlxuICogICAgIGNyZWF0ZVZkb20oY29uZmlnKSB7XG4gKiAgICAgICAgIC8vIGB1c2VDb25maWdgIGNyZWF0ZXMgQU5PTllNT1VTLCBJTlRFUk5BTCBTVEFURS5cbiAqICAgICAgICAgLy8gVGhlIGBjb3VudGAgc3RhdGUgaXMgcHJpdmF0ZSB0byB0aGlzIGNvbXBvbmVudCBhbmQgY2Fubm90IGJlIHNldCBieSBhIHBhcmVudC5cbiAqICAgICAgICAgY29uc3QgW2NvdW50LCBzZXRDb3VudF0gPSB1c2VDb25maWcoMCk7XG4gKlxuICogICAgICAgICByZXR1cm4ge1xuICogICAgICAgICAgICAgdGFnOiAnZGl2JyxcbiAqICAgICAgICAgICAgIGNuOiBbe1xuICogICAgICAgICAgICAgICAgIHRhZzogJ2gxJyxcbiAqICAgICAgICAgICAgICAgICAvLyBBY2Nlc3MgdGhlIHB1YmxpYywgbmFtZWQgY29uZmlnIHZpYSB0aGUgYGNvbmZpZ2AgcGFyYW1ldGVyLlxuICogICAgICAgICAgICAgICAgIHRleHQ6IGNvbmZpZy50ZXh0XG4gKiAgICAgICAgICAgICB9LCB7XG4gKiAgICAgICAgICAgICAgICAgdGFnOiAncCcsXG4gKiAgICAgICAgICAgICAgICAgLy8gQWNjZXNzIHRoZSBwcml2YXRlLCBpbnRlcm5hbCBzdGF0ZSBkaXJlY3RseS5cbiAqICAgICAgICAgICAgICAgICB0ZXh0OiBgWW91IGNsaWNrZWQgJHtjb3VudH0gdGltZXNgXG4gKiAgICAgICAgICAgICB9LCB7XG4gKiAgICAgICAgICAgICAgICAgdGFnOiAnYnV0dG9uJyxcbiAqICAgICAgICAgICAgICAgICB0ZXh0OiAnQ2xpY2sgbWUnLFxuICogICAgICAgICAgICAgICAgIC8vIFRoZSBzZXR0ZXIgZnJvbSBgdXNlQ29uZmlnYCB1cGRhdGVzIHRoZSBpbnRlcm5hbCBzdGF0ZS5cbiAqICAgICAgICAgICAgICAgICBvbmNsaWNrOiAoKSA9PiBzZXRDb3VudChjb3VudCArIDEpXG4gKiAgICAgICAgICAgICB9XVxuICogICAgICAgICB9O1xuICogICAgIH0sXG4gKlxuICogICAgIC8vIDMuIExpZmVjeWNsZSBob29rcyBmb3IgbmFtZWQgY29uZmlncyB3b3JrIGF1dG9tYXRpY2FsbHkuXG4gKiAgICAgYWZ0ZXJTZXRUZXh0KG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuICogICAgICAgICBjb25zb2xlLmxvZyhgVGV4dCBjaGFuZ2VkIGZyb20gJyR7b2xkVmFsdWV9JyB0byAnJHtuZXdWYWx1ZX0nYCk7XG4gKiAgICAgfVxuICogfSk7XG4gKlxuICogLy8gVGhlIHJldHVybmVkIE15Q29tcG9uZW50IGlzIGEgY2xhc3MgY29uc3RydWN0b3IgdGhhdCBjYW4gYmUgdXNlZCB3aXRoIE5lby5jcmVhdGUoKVxuICogLy8gY29uc3QgaW5zdGFuY2UgPSBOZW8uY3JlYXRlKE15Q29tcG9uZW50LCB7XG4gKiAvLyAgICAgdGV4dDogJ1dlbGNvbWUgdG8gTmVvLm1qcyEnIC8vIFNldCB0aGUgcHVibGljIGNvbmZpZyBvbiBjcmVhdGlvbi5cbiAqIC8vIH0pO1xuICovXG5leHBvcnQgZnVuY3Rpb24gZGVmaW5lQ29tcG9uZW50KHNwZWMpIHtcbiAgICBjb25zdCBjb25maWdTcGVjID0gc3BlYy5jb25maWc7XG4gICAgZGVsZXRlIHNwZWMuY29uZmlnO1xuXG4gICAgaWYgKCFjb25maWdTcGVjPy5jbGFzc05hbWUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdkZWZpbmVDb21wb25lbnQgcmVxdWlyZXMgYSBjb25maWcgb2JqZWN0IHdpdGggYSBjbGFzc05hbWUuJyk7XG4gICAgfVxuXG4gICAgY2xhc3MgRnVuY3Rpb25hbENvbXBvbmVudCBleHRlbmRzIEZ1bmN0aW9uYWxCYXNlIHtcbiAgICAgICAgc3RhdGljIGNvbmZpZyA9IHtcbiAgICAgICAgICAgIC4uLmNvbmZpZ1NwZWNcbiAgICAgICAgICAgIC8vIFdlIGNhbiBhZGQgb3VyIG93biBjb25maWd1cmF0aW9ucyBoZXJlXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBBc3NpZ24gaW5zdGFuY2UgbWV0aG9kc1xuICAgIE9iamVjdC5lbnRyaWVzKHNwZWMpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgICBGdW5jdGlvbmFsQ29tcG9uZW50LnByb3RvdHlwZVtrZXldID0gdmFsdWVcbiAgICB9KTtcblxuICAgIC8vIFRvIHN1cHBvcnQgbXVsdGlwbGUgZW52cyAobGlrZSBgZGV2bW9kZWAsIGBkaXN0L2VzbWAsIGBkaXN0L3Byb2R1Y3Rpb25gIGluIHBhcmFsbGVsLFxuICAgIC8vIHdlIG11c3QgcmUtYXNzaWduIEZ1bmN0aW9uYWxDb21wb25lbnQgdG8gdGhlIHNldHVwQ2xhc3MoKSBvdXRwdXQuXG4gICAgRnVuY3Rpb25hbENvbXBvbmVudCA9IE5lby5zZXR1cENsYXNzKEZ1bmN0aW9uYWxDb21wb25lbnQpO1xuXG4gICAgcmV0dXJuIEZ1bmN0aW9uYWxDb21wb25lbnRcbn1cblxuZXhwb3J0IGRlZmF1bHQgZGVmaW5lQ29tcG9uZW50O1xuIiwiaW1wb3J0IENvbmZpZyAgICAgICAgZnJvbSAnLi4vY29yZS9Db25maWcubWpzJztcbmltcG9ydCBFZmZlY3RNYW5hZ2VyIGZyb20gJy4uL2NvcmUvRWZmZWN0TWFuYWdlci5tanMnO1xuXG5jb25zdFxuICAgIGhvb2tJbmRleFN5bWJvbCA9IFN5bWJvbC5mb3IoJ2hvb2tJbmRleCcpLFxuICAgIGhvb2tzU3ltYm9sICAgICA9IFN5bWJvbC5mb3IoJ2hvb2tzJyk7XG5cbi8qKlxuICogQSBob29rIGZvciBtYW5hZ2luZyByZWFjdGl2ZSBzdGF0ZSB3aXRoaW4gYSBmdW5jdGlvbmFsIGNvbXBvbmVudCdzIGBjcmVhdGVWZG9tYCBtZXRob2QuXG4gKiBJdCBtaXJyb3JzIHRoZSBiZWhhdmlvciBvZiBSZWFjdCdzIGB1c2VTdGF0ZWAgYnV0IGlzIHBvd2VyZWQgYnkgYE5lby5jb3JlLkNvbmZpZ2AgZm9yIHJlYWN0aXZpdHkuXG4gKiBAcGFyYW0geyp9IGluaXRpYWxWYWx1ZSBUaGUgaW5pdGlhbCB2YWx1ZSBmb3IgdGhlIHN0YXRlLlxuICogQHJldHVybnMge0FycmF5PGFueT59IEEgdHVwbGUgY29udGFpbmluZyB0aGUgY3VycmVudCB2YWx1ZSBhbmQgYSBzZXR0ZXIgZnVuY3Rpb24uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1c2VDb25maWcoaW5pdGlhbFZhbHVlKSB7XG4gICAgRWZmZWN0TWFuYWdlci5wYXVzZSgpO1xuXG4gICAgY29uc3RcbiAgICAgICAgZWZmZWN0ICAgID0gRWZmZWN0TWFuYWdlci5nZXRBY3RpdmVFZmZlY3QoKSxcbiAgICAgICAgY29tcG9uZW50ID0gZWZmZWN0ICYmIE5lby5nZXRDb21wb25lbnQoZWZmZWN0LmNvbXBvbmVudElkKTtcblxuICAgIGlmICghY29tcG9uZW50KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcigndXNlQ29uZmlnIG11c3QgYmUgY2FsbGVkIGZyb20gd2l0aGluIGEgZnVuY3Rpb25hbCBjb21wb25lbnRcXCdzIGNyZWF0ZVZkb20gbWV0aG9kLicpXG4gICAgfVxuXG4gICAgY29uc3QgY3VycmVudEluZGV4ID0gY29tcG9uZW50W2hvb2tJbmRleFN5bWJvbF07XG5cbiAgICAvLyBJbmNyZW1lbnQgdGhlIGluZGV4IGZvciB0aGUgbmV4dCBob29rIGNhbGwgd2l0aGluIHRoZSBzYW1lIGNvbXBvbmVudCByZW5kZXIgY3ljbGUuXG4gICAgY29tcG9uZW50W2hvb2tJbmRleFN5bWJvbF0rKztcblxuICAgIC8vIElmIHRoaXMgaXMgdGhlIGZpcnN0IHRpbWUgdGhpcyBob29rIGlzIGJlaW5nIGNhbGxlZCBmb3IgdGhpcyBjb21wb25lbnQsIGluaXRpYWxpemUgaXRzIHN0YXRlLlxuICAgIGlmICghY29tcG9uZW50W2hvb2tzU3ltYm9sXVtjdXJyZW50SW5kZXhdKSB7XG4gICAgICAgIGNvbnN0IGNvbmZpZyA9IG5ldyBDb25maWcoaW5pdGlhbFZhbHVlKTtcblxuICAgICAgICBjb25zdCBjdXN0b21TZXR0ZXIgPSAobmV3VmFsdWUpID0+IHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgbmV3VmFsdWUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IG5ld1ZhbHVlKGNvbmZpZy5nZXQoKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbmZpZy5zZXQobmV3VmFsdWUpXG4gICAgICAgIH07XG5cbiAgICAgICAgY29tcG9uZW50W2hvb2tzU3ltYm9sXVtjdXJyZW50SW5kZXhdID0gW2NvbmZpZywgY3VzdG9tU2V0dGVyXVxuICAgIH1cblxuICAgIGNvbnN0IFtjb25maWcsIHNldHRlcl0gPSBjb21wb25lbnRbaG9va3NTeW1ib2xdW2N1cnJlbnRJbmRleF07XG5cbiAgICBFZmZlY3RNYW5hZ2VyLnJlc3VtZSgpO1xuXG4gICAgLy8gQ2FsbCBjb25maWcuZ2V0KCkgdG8gZW5zdXJlIHRoaXMgY29tcG9uZW50J3MgZWZmZWN0IHRyYWNrcyB0aGlzIGNvbmZpZyBhcyBhIGRlcGVuZGVuY3kuXG4gICAgcmV0dXJuIFtjb25maWcuZ2V0KCksIHNldHRlcl1cbn1cblxuZXhwb3J0IGRlZmF1bHQgdXNlQ29uZmlnO1xuIiwiaW1wb3J0IEVmZmVjdE1hbmFnZXIgZnJvbSAnLi4vY29yZS9FZmZlY3RNYW5hZ2VyLm1qcyc7XG5cbmNvbnN0IHBlbmRpbmdEb21FdmVudHNTeW1ib2wgPSBTeW1ib2wuZm9yKCdwZW5kaW5nRG9tRXZlbnRzJyk7XG5cbi8qKlxuICogQSBob29rIGZvciByZWdpc3RlcmluZyBET00gZXZlbnQgbGlzdGVuZXJzIHdpdGhpbiBhIGZ1bmN0aW9uYWwgY29tcG9uZW50LlxuICogRXZlbnQgbGlzdGVuZXJzIHJlZ2lzdGVyZWQgdmlhIHRoaXMgaG9vayB3aWxsIGJlIG1hbmFnZWQgYnkgTmVvLm1qcydzXG4gKiBkZWxlZ2F0ZWQgRE9NIGV2ZW50IHN5c3RlbSwgZW5zdXJpbmcgZWZmaWNpZW50IGFuZCBwcm9wZXIgbGlmZWN5Y2xlIGhhbmRsaW5nLlxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBldmVudFR5cGUgLSBUaGUgdHlwZSBvZiBET00gZXZlbnQgdG8gbGlzdGVuIGZvciAoZS5nLiwgJ2NsaWNrJywgJ2lucHV0JykuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBoYW5kbGVyIC0gVGhlIGV2ZW50IGhhbmRsZXIgZnVuY3Rpb24uIEl0IHdpbGwgcmVjZWl2ZSB0aGUgZXZlbnQgZGF0YSBhcyBpdHMgYXJndW1lbnQuXG4gKiBAcGFyYW0ge1N0cmluZ30gW2RlbGVnYXRlXSAtIEFuIG9wdGlvbmFsIENTUyBzZWxlY3RvciBmb3IgZXZlbnQgZGVsZWdhdGlvbi4gSWYgcHJvdmlkZWQsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGUgaGFuZGxlciB3aWxsIG9ubHkgZmlyZSBpZiB0aGUgZXZlbnQgdGFyZ2V0IG1hdGNoZXMgdGhpcyBzZWxlY3Rvci5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZUV2ZW50KGV2ZW50VHlwZSwgaGFuZGxlciwgZGVsZWdhdGUpIHtcbiAgICBjb25zdFxuICAgICAgICBhY3RpdmVFZmZlY3QgPSBFZmZlY3RNYW5hZ2VyLmdldEFjdGl2ZUVmZmVjdCgpLFxuICAgICAgICBjb21wb25lbnRJZCAgPSBhY3RpdmVFZmZlY3Q/LmNvbXBvbmVudElkO1xuXG4gICAgaWYgKCFjb21wb25lbnRJZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3VzZUV2ZW50IG11c3QgYmUgY2FsbGVkIGZyb20gd2l0aGluIGEgZnVuY3Rpb25hbCBjb21wb25lbnRcXCdzIGNyZWF0ZVZkb20gbWV0aG9kLicpXG4gICAgfVxuXG4gICAgRWZmZWN0TWFuYWdlci5wYXVzZSgpO1xuICAgIGNvbnN0IGNvbXBvbmVudCA9IE5lby5nZXRDb21wb25lbnQoY29tcG9uZW50SWQpO1xuICAgIEVmZmVjdE1hbmFnZXIucmVzdW1lKCk7XG5cbiAgICBpZiAoIWNvbXBvbmVudCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENvbXBvbmVudCB3aXRoIGlkICR7Y29tcG9uZW50SWR9IG5vdCBmb3VuZCBmb3IgdXNlRXZlbnQgaG9vay5gKTtcbiAgICB9XG5cbiAgICAvLyBFbnN1cmUgcGVuZGluZ0RvbUV2ZW50c1N5bWJvbCBleGlzdHMgb24gdGhlIGNvbXBvbmVudCBpbnN0YW5jZVxuICAgIGNvbXBvbmVudFtwZW5kaW5nRG9tRXZlbnRzU3ltYm9sXSA/Pz0gW107XG5cbiAgICAvLyBBZGQgdGhlIGV2ZW50IGxpc3RlbmVyIGNvbmZpZ3VyYXRpb24gdG8gdGhlIGNvbXBvbmVudCdzIHBlbmRpbmcgbGlzdFxuICAgIGNvbXBvbmVudFtwZW5kaW5nRG9tRXZlbnRzU3ltYm9sXS5wdXNoKHtcbiAgICAgICAgW2V2ZW50VHlwZV06IGhhbmRsZXIsXG4gICAgICAgIGRlbGVnYXRlLFxuICAgICAgICBzY29wZSAgICAgIDogY29tcG9uZW50IC8vIFRoZSBjb21wb25lbnQgaW5zdGFuY2UgaXRzZWxmIHdpbGwgYmUgdGhlIHNjb3BlXG4gICAgfSlcbn1cblxuZXhwb3J0IGRlZmF1bHQgdXNlRXZlbnQ7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=