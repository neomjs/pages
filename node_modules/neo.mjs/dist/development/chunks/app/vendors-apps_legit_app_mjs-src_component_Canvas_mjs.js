export const __webpack_esm_id__ = "vendors-apps_legit_app_mjs-src_component_Canvas_mjs";
export const __webpack_esm_ids__ = ["vendors-apps_legit_app_mjs-src_component_Canvas_mjs"];
export const __webpack_esm_modules__ = {

/***/ "./apps/legit/app.mjs"
/*!****************************!*\
  !*** ./apps/legit/app.mjs ***!
  \****************************/
(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   onStart: () => (/* binding */ onStart)
/* harmony export */ });
/* harmony import */ var _view_Viewport_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./view/Viewport.mjs */ "./apps/legit/view/Viewport.mjs");


const onStart = () => Neo.app({
    mainView: _view_Viewport_mjs__WEBPACK_IMPORTED_MODULE_0__["default"],
    name    : 'Legit'
});

/***/ },

/***/ "./apps/legit/model/Commit.mjs"
/*!*************************************!*\
  !*** ./apps/legit/model/Commit.mjs ***!
  \*************************************/
(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _src_data_Model_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../src/data/Model.mjs */ "./src/data/Model.mjs");


/**
 * @class Legit.model.Commit
 * @extends Neo.data.Model
 */
class Commit extends _src_data_Model_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Legit.model.Commit'
         * @protected
         */
        className: 'Legit.model.Commit',
        /**
         * @member {Object[]} fields
         */
        fields: [{
            name: 'oid',
            type: 'String'
        }, {
            name: 'message',
            type: 'String'
        }, {
            name: 'author',
            type: 'Object'
        }, {
            name: 'timestamp',
            type: 'Integer'
        }]
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(Commit));


/***/ },

/***/ "./apps/legit/model/File.mjs"
/*!***********************************!*\
  !*** ./apps/legit/model/File.mjs ***!
  \***********************************/
(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _src_data_Model_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../src/data/Model.mjs */ "./src/data/Model.mjs");


/**
 * @class Legit.model.File
 * @extends Neo.data.Model
 */
class File extends _src_data_Model_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Legit.model.File'
         * @protected
         */
        className: 'Legit.model.File',
        /**
         * @member {Object[]} fields
         */
        fields: [{
            name: 'className',
            type: 'String'
        }, {
            name: 'collapsed',
            type: 'Boolean'
        }, {
            name: 'hidden',
            type: 'Boolean'
        }, {
            name: 'id',
            type: 'String'
        }, {
            name        : 'isLeaf',
            type        : 'Boolean',
            defaultValue: true
        }, {
            name: 'name',
            type: 'String'
        }, {
            name: 'parentId',
            type: 'String'
        }]
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(File));


/***/ },

/***/ "./apps/legit/service/Legit.mjs"
/*!**************************************!*\
  !*** ./apps/legit/service/Legit.mjs ***!
  \**************************************/
(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _src_core_Base_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../src/core/Base.mjs */ "./src/core/Base.mjs");


/**
 * @summary A singleton service that provides a virtual file system layer for the Legit IDE.
 *
 * This service acts as the central hub for file system operations within the Legit application.
 * It abstracts the underlying storage mechanism (using `memfs`) and provides a git-like interface
 * for interacting with file trees and commits (using `@legit-sdk/core`).
 *
 * Key responsibilities include:
 * - **Initialization:** Dynamically loading external dependencies (`memfs`, `@legit-sdk/core`) to ensure the app remains lightweight until needed.
 * - **File System Seeding:** Populating the in-memory file system with initial demo content.
 * - **Git Operations:** Providing methods to load file trees (`loadTree`) and calculate deltas between commits (`loadTreeDelta`).
 * - **File I/O:** Exposing standard file system methods (`readFile`, `writeFile`, `readdir`, `stat`) that automatically await the service's ready state.
 *
 * This service is designed to be robust against initialization failures and provides a safe, asynchronous API for the `ViewportController` to consume.
 *
 * @class Legit.service.Legit
 * @extends Neo.core.Base
 * @singleton
 */
class Legit extends _src_core_Base_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Legit.service.Legit'
         * @protected
         */
        className: 'Legit.service.Legit',
        /**
         * @member {Object|null} fs=null
         */
        fs: null,
        /**
         * @member {Object|null} legitFs=null
         */
        legitFs: null,
        /**
         * @member {String} path='/.legit/branches/anonymous'
         */
        path: '/.legit/branches/anonymous',
        /**
         * @member {Boolean} singleton=true
         * @protected
         */
        singleton: true
    }

    /**
     * Initializes the service by dynamically importing dependencies and setting up the file system.
     * @returns {Promise<void>}
     */
    async initAsync() {
        await super.initAsync();

        const me = this;

        try {
            const {openLegitFs} = await import(/* webpackIgnore: true */ 'https://esm.sh/@legit-sdk/core');
            const fsModule      = await import(/* webpackIgnore: true */ 'https://esm.sh/memfs');

            me.fs = fsModule.default;

            me.legitFs = await openLegitFs({
                storageFs: me.fs,
                gitRoot  : '/',
                serverUrl: 'http://localhost:9999/',
                // publicKey: process.env.NEXT_PUBLIC_LEGIT_PUBLIC_KEY,
            });

            // For debugging
            globalThis.legitFs = me.legitFs;

            await me.#seedFileSystem();
        } catch (e) {
            console.error('Failed to initialize Legit Service', e);
        }
    }

    /**
     * Retrieves the commit history for a given branch.
     * @param {String} [branch='anonymous'] The branch name to load history for.
     * @returns {Promise<Object[]>} An array of commit objects.
     */
    async loadHistory(branch='anonymous') {
        await this.ready();

        try {
            const historyJson = await this.legitFs.readFile(`/.legit/branches/${branch}/.legit/history`, 'utf-8');
            return JSON.parse(historyJson);
        } catch (e) {
            console.warn(`Failed to load history for branch ${branch}`, e);
            return [];
        }
    }

    /**
     * Recursively loads the file tree structure from a given path.
     * @param {String} treePath The path to start loading the tree from.
     * @returns {Promise<{hash: string, subEntries: {}}>} The tree structure with hashes.
     */
    async loadTree(treePath) {
        await this.ready();

        const
            me         = this,
            subEntries = {},
            pathEntries = await me.readdir(treePath);

        for (const entryName of pathEntries) {
            const stat = await me.stat(treePath + entryName);

            if (stat.isDirectory()) {
                subEntries[entryName] = await me.loadTree(treePath + entryName + '/');
            } else {
                const contenHash = await crypto.subtle.digest("SHA-1", await me.readFile(treePath + entryName));

                subEntries[entryName] = {
                    // for now its the content instead of the hash
                    hash: contenHash,
                    name: entryName,
                };
            }
        }

        return {
            hash: '',
            subEntries
        }
    }

    /**
     * Calculates the difference between two tree states (commits).
     * Useful for identifying added, deleted, and modified files.
     * @param {String} currentState The hash or path of the current state.
     * @param {String} newState The hash or path of the new state.
     * @returns {Promise<{deleted: String[], added: String[], modified: String[]}>} An object containing arrays of changed file paths.
     */
    async loadTreeDelta(currentState, newState) {
        await this.ready();

        const me = this;

        const prefixNewState = newState.slice(0, 2);
        const suffixNewState = newState.slice(2);

        let currentstateTree = {}

        if (currentState) {
            const prefixCurrentState = currentState.slice(0, 2);
            const suffixCurrentState = currentState.slice(2);

            currentstateTree = await me.loadTree('/.legit/commits/' + prefixCurrentState + '/' + suffixCurrentState + '/');
        }
        const newStateTree = await me.loadTree('/.legit/commits/' + prefixNewState + '/' + suffixNewState + '/');

        const deleted  = [];
        const added    = [];
        const modified = [];

        function flattenTree(tree, path = '') {
            const result = {};

            if (tree.subEntries) {
                for (const [key, value] of Object.entries(tree.subEntries)) {
                    const currentPath = path ? `${path}/${key}` : key;

                    if (value.subEntries) {
                        Object.assign(result, flattenTree(value, currentPath));
                    } else {
                        result[currentPath] = value.hash;
                    }
                }
            }

            return result;
        }

        const currentStateFlat = currentState !== '' ? flattenTree(currentstateTree) : {};
        const newStateFlat     = flattenTree(newStateTree);

        // Find deleted (in current but not in new)
        for (const path in currentStateFlat) {
            if (!(path in newStateFlat)) {
                deleted.push(path);
            }
        }

        // Find added (in new but not in current)
        for (const path in newStateFlat) {
            if (!(path in currentStateFlat)) {
                added.push(path);
            }
        }

        // Find modified (in both but hash differs)
        for (const path in newStateFlat) {
            if (path in currentStateFlat) {
                const currentHash = new Uint8Array(currentStateFlat[path]);
                const newHash     = new Uint8Array(newStateFlat[path]);

                if (currentHash.length !== newHash.length ||
                    !currentHash.every((byte, i) => byte === newHash[i])) {
                    modified.push(path);
                }
            }
        }

        return {
            deleted,
            added,
            modified
        }
    }

    /**
     * Reads the content of a file.
     * @param {String} path The file path.
     * @param {Object} [options] Read options.
     * @returns {Promise<*>} The file content.
     */
    async readFile(path, options) {
        await this.ready();
        return this.legitFs.readFile(path, options)
    }

    /**
     * Reads the contents of a directory.
     * @param {String} path The directory path.
     * @returns {Promise<String[]>} An array of file names.
     */
    async readdir(path) {
        await this.ready();
        return this.legitFs.readdir(path)
    }

    /**
     * Seeds the in-memory file system with initial demo content.
     * This method bypasses the `ready()` check to avoid deadlocks during initialization.
     * @returns {Promise<void>}
     * @private
     */
    async #seedFileSystem() {
        const me = this;

        let mdFile = await fetch('../../learn/benefits/FormsEngine.md');
        mdFile = await mdFile.text();

        await me.writeFile({
            data     : mdFile,
            path     : `${me.path}/FormsEngine.md`,
            skipReady: true
        });

        mdFile = await fetch('../../learn/benefits/OffTheMainThread.md');
        mdFile = await mdFile.text();

        await me.writeFile({
            data     : mdFile,
            path     : `${me.path}/OffTheMainThread.md`,
            skipReady: true
        });

        await me.writeFile({
            data: [
                "import Viewport from '../../examples/component/multiWindowHelix/Viewport.mjs';",
                "",
                "class MainView extends Viewport {",
                "    static config = {",
                "        className           : 'Portal.view.MultiWindowHelix',",
                "        showGitHubStarButton: false,",
                "        theme               : 'neo-theme-dark'",
                "    }",
                "}",
                "",
                "MainView = Neo.setupClass(MainView);"
            ].join('\n'),
            path     : `${me.path}/Helix.mjs`,
            skipReady: true
        });

        await me.writeFile({
            data: [
                "import Viewport from '../../examples/component/multiWindowCoronaGallery/Viewport.mjs';",
                "",
                "class MainView extends Viewport {",
                "    static config = {",
                "        className           : 'Portal.view.MultiWindowHelix',",
                "        showGitHubStarButton: false,",
                "        theme               : 'neo-theme-dark'",
                "    }",
                "}",
                "",
                "MainView = Neo.setupClass(MainView);"
            ].join('\n'),
            path     : `${me.path}/Gallery.mjs`,
            skipReady: true
        });
    }

    /**
     * Retrieves file statistics.
     * @param {String} path The file or directory path.
     * @returns {Promise<Object>} The file statistics object.
     */
    async stat(path) {
        await this.ready();
        return this.legitFs.stat(path)
    }

    /**
     * Writes data to a file.
     * @param {Object}        config Configuration object.
     * @param {String|Buffer} config.data The data to write.
     * @param {Object}        [config.options] Write options.
     * @param {String}        config.path The file path.
     * @param {Boolean}       [config.skipReady=false] If true, bypasses the `await this.ready()` check.
     * @returns {Promise<*>}
     */
    async writeFile({data, options, path, skipReady=false}) {
        !skipReady && await this.ready();
        return this.legitFs.writeFile(path, data, options)
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(Legit));


/***/ },

/***/ "./apps/legit/store/Commits.mjs"
/*!**************************************!*\
  !*** ./apps/legit/store/Commits.mjs ***!
  \**************************************/
(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _model_Commit_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../model/Commit.mjs */ "./apps/legit/model/Commit.mjs");
/* harmony import */ var _src_data_Store_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../src/data/Store.mjs */ "./src/data/Store.mjs");



/**
 * @class Legit.store.Commits
 * @extends Neo.data.Store
 */
class Commits extends _src_data_Store_mjs__WEBPACK_IMPORTED_MODULE_1__["default"] {
    static config = {
        /**
         * @member {String} className='Legit.store.Commits'
         * @protected
         */
        className: 'Legit.store.Commits',
        /**
         * @member {Neo.data.Model} model=CommitModel
         * @reactive
         */
        model: _model_Commit_mjs__WEBPACK_IMPORTED_MODULE_0__["default"],
        /**
         * @member {Object[]} sorters=[{property:'timestamp',direction:'DESC'}]
         * @reactive
         */
        sorters: [{
            property : 'timestamp',
            direction: 'DESC'
        }]
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(Commits));


/***/ },

/***/ "./apps/legit/store/Files.mjs"
/*!************************************!*\
  !*** ./apps/legit/store/Files.mjs ***!
  \************************************/
(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _model_File_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../model/File.mjs */ "./apps/legit/model/File.mjs");
/* harmony import */ var _src_data_Store_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../src/data/Store.mjs */ "./src/data/Store.mjs");



/**
 * @class Legit.store.Files
 * @extends Neo.data.Store
 */
class Files extends _src_data_Store_mjs__WEBPACK_IMPORTED_MODULE_1__["default"] {
    static config = {
        /**
         * @member {String} className='Legit.store.Files'
         * @protected
         */
        className: 'Legit.store.Files',
        /**
         * @member {Neo.data.Model} model=FileModel
         * @reactive
         */
        model: _model_File_mjs__WEBPACK_IMPORTED_MODULE_0__["default"]
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(Files));


/***/ },

/***/ "./apps/legit/view/CommitGrid.mjs"
/*!****************************************!*\
  !*** ./apps/legit/view/CommitGrid.mjs ***!
  \****************************************/
(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _src_grid_Container_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../src/grid/Container.mjs */ "./src/grid/Container.mjs");


/**
 * @class Legit.view.CommitGrid
 * @extends Neo.grid.Container
 */
class CommitGrid extends _src_grid_Container_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Legit.view.CommitGrid'
         * @protected
         */
        className: 'Legit.view.CommitGrid',
        /**
         * @member {String[]} baseCls=['legit-commit-grid','neo-grid-container']
         * @protected
         */
        baseCls: ['legit-commit-grid', 'neo-grid-container'],
        /**
         * @member {Object} bind={store:'stores.commitStore'}
         */
        bind: {store: 'stores.commitStore'},
        /**
         * @member {Object} columnDefaults={renderer:'onCommitColumnRenderer'}
         */
        columnDefaults: {
            renderer: 'onCommitColumnRenderer'
        },
        /**
         * @member {Object[]} columns
         */
        columns: [{
            dataField: 'timestamp',
            text     : 'Timestamp',
            width    : 150
        }, {
            dataField: 'author',
            text     : 'Author',
            width    : 150
        }, {
            dataField: 'message',
            text     : 'Message',
            flex     : 1
        }, {
            dataField: 'oid',
            text     : 'OID',
            width    : 300
        }]
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(CommitGrid));


/***/ },

/***/ "./apps/legit/view/Viewport.mjs"
/*!**************************************!*\
  !*** ./apps/legit/view/Viewport.mjs ***!
  \**************************************/
(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _src_container_Viewport_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../src/container/Viewport.mjs */ "./src/container/Viewport.mjs");
/* harmony import */ var _src_button_Base_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../src/button/Base.mjs */ "./src/button/Base.mjs");
/* harmony import */ var _CommitGrid_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./CommitGrid.mjs */ "./apps/legit/view/CommitGrid.mjs");
/* harmony import */ var _src_container_Base_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../src/container/Base.mjs */ "./src/container/Base.mjs");
/* harmony import */ var _src_code_LivePreview_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../src/code/LivePreview.mjs */ "./src/code/LivePreview.mjs");
/* harmony import */ var _src_container_Panel_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../src/container/Panel.mjs */ "./src/container/Panel.mjs");
/* harmony import */ var _src_tree_List_mjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../src/tree/List.mjs */ "./src/tree/List.mjs");
/* harmony import */ var _src_component_Splitter_mjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../src/component/Splitter.mjs */ "./src/component/Splitter.mjs");
/* harmony import */ var _src_toolbar_Base_mjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../src/toolbar/Base.mjs */ "./src/toolbar/Base.mjs");
/* harmony import */ var _ViewportController_mjs__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./ViewportController.mjs */ "./apps/legit/view/ViewportController.mjs");
/* harmony import */ var _ViewportStateProvider_mjs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./ViewportStateProvider.mjs */ "./apps/legit/view/ViewportStateProvider.mjs");












/**
 * @class Legit.view.Viewport
 * @extends Neo.container.Viewport
 */
class Viewport extends _src_container_Viewport_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Legit.view.Viewport'
         * @protected
         */
        className: 'Legit.view.Viewport',
        /**
         * @member {String[]} cls=['legit-viewport']
         * @reactive
         */
        cls: ['legit-viewport'],
        /**
         * @member {Neo.controller.Component} controller=ViewportController
         * @reactive
         */
        controller: _ViewportController_mjs__WEBPACK_IMPORTED_MODULE_9__["default"],
        /**
         * @member {Neo.state.Provider} stateProvider=ViewportStateProvider
         * @reactive
         */
        stateProvider: _ViewportStateProvider_mjs__WEBPACK_IMPORTED_MODULE_10__["default"],
        /*
         * @member {Object} layout={ntype:'hbox',align:'stretch'}
         */
        layout: {ntype: 'hbox', align: 'stretch'},
        /**
         * @member {Object[]} items
         */
        items: [{
            module                    : _src_tree_List_mjs__WEBPACK_IMPORTED_MODULE_6__["default"],
            bind                      : {store: 'stores.fileStore'},
            cls                       : ['legit-files-tree'],
            listeners                 : {leafItemClick: 'onFileItemClick', select: 'onTreeListSelect'},
            reference                 : 'files-tree',
            showCollapseExpandAllIcons: false,
            width                     : 300,
        }, {
            module      : _src_component_Splitter_mjs__WEBPACK_IMPORTED_MODULE_7__["default"],
            resizeTarget: 'previous',
            size        : 5
        }, {
            module: _src_container_Base_mjs__WEBPACK_IMPORTED_MODULE_3__["default"],
            flex  : 1,
            layout: {ntype: 'vbox', align: 'stretch'},
            items: [{
                module: _src_toolbar_Base_mjs__WEBPACK_IMPORTED_MODULE_8__["default"],
                flex  : 'none',
                style : {marginRight: '15px'},
                items :['->', {
                    module   : _src_button_Base_mjs__WEBPACK_IMPORTED_MODULE_1__["default"],
                    disabled : true,
                    handler  : 'onNewFileButtonClick',
                    iconCls  : 'fa fa-plus',
                    reference: 'new-file-button',
                    text     : 'New File'
                }, {
                    module   : _src_button_Base_mjs__WEBPACK_IMPORTED_MODULE_1__["default"],
                    disabled : true,
                    handler  : 'onSaveButtonClick',
                    iconCls  : 'fa fa-cloud-upload',
                    reference: 'save-button',
                    style    : {marginLeft: '.5em'},
                    text     : 'Save'
                }]
            }, {
                module   : _src_code_LivePreview_mjs__WEBPACK_IMPORTED_MODULE_4__["default"],
                flex     : 3,
                language : 'markdown',
                listeners: {editorChange: 'onEditorChange'},
                reference: 'code-live-preview',
                style : {margin: '20px'}
            }, {
                module      : _src_component_Splitter_mjs__WEBPACK_IMPORTED_MODULE_7__["default"],
                direction   : 'horizontal',
                resizeTarget: 'previous',
                size        : 5
            }, {
                module: _src_container_Panel_mjs__WEBPACK_IMPORTED_MODULE_5__["default"],
                cls   : ['legit-commit-grid-panel'],
                flex  : 1,
                style : {margin: '20px'},
                headers: [{
                    dock: 'top',
                    text: 'Legit History'
                }],
                items : [{
                    module      : _CommitGrid_mjs__WEBPACK_IMPORTED_MODULE_2__["default"],
                    wrapperStyle: {minHeight: '200px'}
                }]
            }]
        }]
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(Viewport));


/***/ },

/***/ "./apps/legit/view/ViewportController.mjs"
/*!************************************************!*\
  !*** ./apps/legit/view/ViewportController.mjs ***!
  \************************************************/
(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _src_controller_Component_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../src/controller/Component.mjs */ "./src/controller/Component.mjs");
/* harmony import */ var _service_Legit_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../service/Legit.mjs */ "./apps/legit/service/Legit.mjs");



/**
 * @class Legit.view.ViewportController
 * @extends Neo.controller.Component
 */
class ViewportController extends _src_controller_Component_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Legit.view.ViewportController'
         * @protected
         */
        className: 'Legit.view.ViewportController',
        /**
         * @member {Number} pollingInterval=1000
         */
        pollingInterval: 1000
    }

    /**
     * @member {Neo.dialog.Base|null}
     */
    addDialog = null
    /**
     * @member {String} currentTreeState=null
     */
    currentTreeState = null
    /**
     * @member {Boolean} running=false
     */
    running = false

    /**
     * @returns {Promise<void>}
     */
    async initAsync() {
        await super.initAsync();

        const me = this;

        await _service_Legit_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].ready();

        me.getReference('new-file-button').disabled = false;
        me.getReference('save-button')    .disabled = false;

        setInterval(me.poll.bind(me), me.pollingInterval)
    }

    /**
     * @param {Object} data
     */
    async onAddFileDialogSave(data) {
        const
            me        = this,
            dialog    = me.addDialog,
            textField = dialog.getReference('filename'),
            filePath  = `${_service_Legit_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].path}/${textField.value}`;

        dialog.hide();

        console.log('onAddFileDialogSave', textField.value);
        await _service_Legit_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].writeFile({
            data: '',
            path: filePath
        });

        me.setState({currentFile: filePath});
    }

    /**
     * @param {Object} data
     */
    onCommitColumnRenderer(data) {
        if (data.dataField === 'author') {
            return data.value.name;
        }

        if (data.dataField === 'timestamp') {
            return new Intl.DateTimeFormat('default', {
                hour: 'numeric',
                minute: 'numeric',
                second: 'numeric'
            }).format(new Date(data.value * 1000));
        }

        return data.value;
    }

    /**
     * @param {Record} record
     */
    onFileItemClick(record) {
        console.log('onFileItemClick', record)
    }

    /**
     * @param data
     * @returns {Promise<void>}
     */
    async onEditorChange(data) {
        // console.log('onEditorChange', data);
    }

    /**
     * @param data
     * @returns {Promise<void>}
     */
    async onNewFileButtonClick(data) {
        let me          = this,
            {addDialog} = me,
            button      = data.component,
            {appName, theme, windowId} = button;

        button.disabled = true;

        if (!addDialog) {
            Promise.all(/*! import() */[__webpack_require__.e("vendors-src_dialog_Base_mjs"), __webpack_require__.e("vendors-src_form_Container_mjs"), __webpack_require__.e("apps_legit_view_AddFileDialog_mjs")]).then(__webpack_require__.bind(__webpack_require__, /*! ./AddFileDialog.mjs */ "./apps/legit/view/AddFileDialog.mjs")).then(module => {
                me.addDialog = Neo.create({
                    module         : module.default,
                    animateTargetId: button.id,
                    appName,
                    listeners      : {hide: data => {button.disabled = false}},
                    parentComponent: me.component,
                    theme,
                    windowId
                })
            })
        } else {
            addDialog.show()
        }
    }

    /**
     * @param {Object} data
     */
    async onSaveButtonClick(data) {
        const
            me          = this,
            livePreview = me.getReference('code-live-preview'),
            currentFile = me.getState('currentFile');

        console.log('onSaveButtonClick', me.getState('currentFile'), livePreview.value);

        await _service_Legit_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].writeFile({
            data: livePreview.value,
            path: `${_service_Legit_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].path}/${currentFile}`
        });
    }

    /**
     * @param {Object}   data
     * @param {Record[]} data.records
     * @param {String[]} data.selection // selected dom node ids
     * @param {String}   data.source    // id of the event-firing instance
     */
    async onTreeListSelect({records}) {
        const
            livePreview = this.getReference('code-live-preview'),
            record      = records?.[0],
            language    = record.id.includes('.md') ? 'markdown' : 'neomjs';

        if (record?.isLeaf) {
            this.setState({currentFile: record.id});

            const value = await _service_Legit_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].readFile(`${_service_Legit_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].path}/${record.id}`, 'utf-8');

            await livePreview.set({language, value});
        }
    }

    /**
     * @returns {Promise<void>}
     */
    async poll() {
        let me = this;

        if (me.running) {
            return
        }

        try {
            me.running = true;

            let newState = await _service_Legit_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].readFile(_service_Legit_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].path + '/.legit/head', 'utf-8');

            if (me.currentTreeState === newState) {
                return;
            }

            const commitStore = me.getStore('commitStore');
            const fileStore   = me.getStore('fileStore');
            const treeDelta   = await _service_Legit_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].loadTreeDelta(me.currentTreeState, newState);

            commitStore.data = await _service_Legit_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].loadHistory();

            console.log('TREE DELTA:', treeDelta);
            for (const deletedEntry of treeDelta.deleted) {
                console.log('Deleted FROM TREE: ' + deletedEntry);
                fileStore.remove(deletedEntry)
            }

            for (const addedEntry of treeDelta.added) {
                console.log('Added From Tree:' + addedEntry);
                fileStore.insert(0, {
                    id      : addedEntry,
                    name    : addedEntry,
                    parentId: null
                })
            }

            for (const modifiedEntry of treeDelta.modified) {
                // const newItem = await legitFs.readFile(path + '/' + addedEntry, 'utf8');
                // todo update item in tree store
                console.log('MODIFIED From Tree:' + modifiedEntry);
            }

            me.currentTreeState = newState;
        } finally {
            me.running = false;

            let selectionModel = me.getReference('files-tree').selectionModel;

            if (!selectionModel.hasSelection()) {
                selectionModel.selectAt(0)
            }
        }
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(ViewportController));


/***/ },

/***/ "./apps/legit/view/ViewportStateProvider.mjs"
/*!***************************************************!*\
  !*** ./apps/legit/view/ViewportStateProvider.mjs ***!
  \***************************************************/
(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _store_Commits_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../store/Commits.mjs */ "./apps/legit/store/Commits.mjs");
/* harmony import */ var _store_Files_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../store/Files.mjs */ "./apps/legit/store/Files.mjs");
/* harmony import */ var _src_state_Provider_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../src/state/Provider.mjs */ "./src/state/Provider.mjs");




/**
 * @class Legit.view.ViewportStateProvider
 * @extends Neo.state.Provider
 */
class ViewportStateProvider extends _src_state_Provider_mjs__WEBPACK_IMPORTED_MODULE_2__["default"] {
    static config = {
        /**
         * @member {String} className='Legit.view.ViewportStateProvider'
         * @protected
         */
        className: 'Legit.view.ViewportStateProvider',
        /**
         * @member {Object} data
         */
        data: {
            /**
             * @member {String|null} data.currentFile=null
             */
            currentFile: null
        },
        /**
         * @member {Object} stores
         */
        stores: {
            commitStore: _store_Commits_mjs__WEBPACK_IMPORTED_MODULE_0__["default"],
            fileStore  : _store_Files_mjs__WEBPACK_IMPORTED_MODULE_1__["default"]
        }
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(ViewportStateProvider));

/***/ },

/***/ "./src/component/Canvas.mjs"
/*!**********************************!*\
  !*** ./src/component/Canvas.mjs ***!
  \**********************************/
(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _Base_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Base.mjs */ "./src/component/Base.mjs");


/**
 * @class Neo.component.Canvas
 * @extends Neo.component.Base
 */
class Canvas extends _Base_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.component.Canvas'
         * @protected
         */
        className: 'Neo.component.Canvas',
        /**
         * @member {String} ntype='canvas'
         * @protected
         */
        ntype: 'canvas',
        /**
         * true applies a main.addon.ResizeObserver and fires a custom resize event
         * which other instances can subscribe to.
         * @member {Boolean} monitorSize_=true
         * @reactive
         */
        monitorSize_: true,
        /**
         * @member {Boolean} offscreen=true
         */
        offscreen: true,
        /**
         * Only applicable if offscreen === true.
         * true once the ownership of the canvas node got transferred to worker.Canvas.
         * @member {Boolean} offscreenRegistered_=false
         * @reactive
         */
        offscreenRegistered_: false,
        /**
         * @member {Object} _vdom={tag: 'canvas'}
         */
        _vdom:
        {tag: 'canvas'}
    }

    /**
     * Triggered after the mounted config got changed
     * @param {Boolean} value
     * @param {Boolean} oldValue
     * @protected
     */
    async afterSetMounted(value, oldValue) {
        super.afterSetMounted(value, oldValue);

        let me                    = this,
            id                    = me.getCanvasId(),
            {offscreen, windowId} = me;

        if (value) {
            await me.timeout(30); // next rAF tick

            if (me.monitorSize) {
                me.addDomListeners([{
                    delegate: `#${me.getMonitorTargetId()}`,
                    resize  : me.onDomResize,
                    scope   : me
                }])
            }

            if (offscreen) {
                let data,
                    delay = 50;

                while (me.mounted && !me.offscreenRegistered && !me.isDestroyed) {
                    data = await Neo.main.DomAccess.getOffscreenCanvas({
                        nodeId: id,
                        windowId
                    });

                    if (data.offscreen) {
                        await Neo.worker.Canvas.registerCanvas({
                            node  : data.offscreen,
                            nodeId: id,
                            windowId
                        }, [data.offscreen]);

                        me.offscreenRegistered = true;
                        break
                    } else if (data.transferred) {
                        if (Neo.config.useSharedWorkers) {
                            let retrieveData = await Neo.worker.Canvas.retrieveCanvas({
                                nodeId: id,
                                windowId
                            });

                            if (retrieveData.hasCanvas) {
                                me.offscreenRegistered = true;
                                break
                            }
                        }
                    }

                    await me.timeout(delay);

                    if (delay < 1000) {
                        delay *= 2
                    }
                }
            }
        } else if (offscreen) {
            if (me.offscreenRegistered) {
                Neo.worker.Canvas.unregisterCanvas({
                    nodeId: id
                })
            }

            me.offscreenRegistered = false
        }
    }


    /**
     * Triggered after the windowId config got changed
     * @param {String|null} value
     * @param {String|null} oldValue
     * @protected
     */
    afterSetWindowId(value, oldValue) {
        super.afterSetWindowId(value, oldValue);

        if (oldValue) {
            this.offscreenRegistered = false
        }
    }

    /**
     * @param {...*} args
     */
    destroy(...args) {
        if (this.offscreenRegistered) {
            Neo.worker.Canvas.unregisterCanvas({
                nodeId: this.id
            })
        }

        super.destroy(...args)
    }

    /**
     * Override this method when using wrappers (e.g. D3)
     * @returns {String}
     */
    getCanvasId() {
        return this.id
    }

    /**
     * The DOM node ID that should trigger the canvas resize updates.
     * By default, this is the component's top-level wrapper ID.
     * Subclasses can override this to observe a different node (e.g. a parent container).
     * @returns {String}
     */
    getMonitorTargetId() {
        return this.vdom.id
    }

    /**
     * @param {Object} data
     */
    onDomResize(data) {
        this.fire('resize', data)
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(Canvas));


/***/ },

/***/ "./src/component/Label.mjs"
/*!*********************************!*\
  !*** ./src/component/Label.mjs ***!
  \*********************************/
(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _Base_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Base.mjs */ "./src/component/Base.mjs");


/**
 * Convenience class to render a label with a text
 * @class Neo.component.Label
 * @extends Neo.component.Base
 */
class Label extends _Base_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.component.Label'
         * @protected
         */
        className: 'Neo.component.Label',
        /**
         * @member {String} ntype='label'
         * @protected
         */
        ntype: 'label',
        /**
         * @member {String[]} baseCls=['neo-label']
         */
        baseCls: ['neo-label'],
        /**
         * @member {String} tag='label'
         * @protected
         * @reactive
         */
        tag: 'label'
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(Label));


/***/ },

/***/ "./src/container/Panel.mjs"
/*!*********************************!*\
  !*** ./src/container/Panel.mjs ***!
  \*********************************/
(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _Base_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Base.mjs */ "./src/container/Base.mjs");
/* harmony import */ var _toolbar_Base_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../toolbar/Base.mjs */ "./src/toolbar/Base.mjs");



/**
 * An extended Container supporting multiple docked header toolbars
 * @class Neo.container.Panel
 * @extends Neo.container.Base
 */
class Panel extends _Base_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.container.Panel'
         * @protected
         */
        className: 'Neo.container.Panel',
        /**
         * @member {String} ntype='panel'
         * @protected
         */
        ntype: 'panel',
        /**
         * @member {String[]} baseCls=['neo-panel','neo-container']
         */
        baseCls: ['neo-panel', 'neo-container'],
        /**
         * @member {Object} containerConfig=null
         */
        containerConfig: null,
        /**
         * @member {Object} headerDefaults=null
         */
        headerDefaults: null,
        /**
         * @member {Array} headers=null
         */
        headers: null,
        /**
         * @member {Object} items={ntype: 'vbox', align: 'stretch'}
         * @reactive
         */
        _layout: {
            ntype: 'vbox',
            align: 'stretch'
        },
        /**
         * @member {Boolean} verticalHeadersFirst=false
         */
        verticalHeadersFirst: false
    }

    /**
     * @param {Object} config
     */
    construct(config) {
        super.construct(config);

        let me = this;

        if (me.hasHeaders() && me.verticalHeadersFirst === true) {
            me.layout = {
                ntype: 'hbox',
                align: 'stretch'
            };
        }
    }

    /**
     * @param {Object} header the header config
     * @returns {Object}
     */
    static createHeaderConfig(header) {
        if (Neo.typeOf(header) === 'NeoInstance') {
            return header;
        }

        let config = {
            flex: '0 1 auto'
        };

        if (!header.module && !header.ntype) {
            config.cls   = ['neo-panel-header-toolbar', 'neo-toolbar'];
            config.ntype = 'toolbar';
        }

        if (header.text) {
            config.items = [{
                ntype: 'label',
                cls  : ['neo-panel-header-text', 'neo-label'],
                text : header.text
            }];

            delete header.text;
        }

        // assuming all labels inside a Panel Header are meant to be titles -> look the same way
        if (Array.isArray(header.items)) {
            header.items.forEach(item => {
                if (item.ntype === 'label') {
                    item.cls = ['neo-panel-header-text', 'neo-label'];
                }
            });
        }

        return {...config, ...header}
    }

    /**
     *
     */
    createItems() {
        let me              = this,
            containerConfig = me.containerConfig;

        if (!me.hasHeaders()) {
            containerConfig && me.set(containerConfig);
            super.createItems();
        } else {
            let hf                   = me.verticalHeadersFirst === false,
                headers              = me.headers || [],
                bottomHeaders        = headers.filter(header => {return header.dock === (hf ?'bottom': 'right')}),
                leftHeaders          = headers.filter(header => {return header.dock === (hf ?'left'  : 'top')}),
                rightHeaders         = headers.filter(header => {return header.dock === (hf ?'right' : 'bottom')}),
                topHeaders           = headers.filter(header => {return header.dock === (hf ?'top'   : 'left')}),
                hasHorizontalHeaders = bottomHeaders.length > 0 || topHeaders  .length > 0,
                hasVerticalHeaders   = leftHeaders  .length > 0 || rightHeaders.length > 0,
                {items}              = me,
                horizontalItems      = [],
                verticalItems        = [],
                config;

            topHeaders.forEach(header => {
                verticalItems.push(Panel.createHeaderConfig(header))
            });

            if (hasVerticalHeaders && (hf && hasHorizontalHeaders || !hf && hasHorizontalHeaders)) {
                leftHeaders.forEach(header => {
                    horizontalItems.push(Panel.createHeaderConfig(header))
                });

                config = {
                    ntype       : 'container',
                    flex        : 1,
                    items,
                    itemDefaults: me.itemDefaults,
                    ...containerConfig
                };

                horizontalItems.push({...me.headerDefaults, ...config});

                rightHeaders.forEach(header => {
                    horizontalItems.push(Panel.createHeaderConfig(header))
                });

                verticalItems.push({
                    ntype    : 'container',
                    items    : horizontalItems,
                    layout   : {ntype: (hf ? 'hbox' : 'vbox'), align: 'stretch'},
                    reference: 'bodyContainer'
                });
            } else {
                config = {
                    ntype       : 'container',
                    flex        : 1,
                    items,
                    itemDefaults: me.itemDefaults,
                    reference   : 'bodyContainer',
                    ...containerConfig
                };

                verticalItems.push({...me.headerDefaults, ...config})
            }

            bottomHeaders.forEach(header => {
                verticalItems.push(Panel.createHeaderConfig(header))
            });

            me.items = verticalItems;

            me.itemDefaults = null;

            super.createItems()
        }
    }

    /**
     * @returns {Boolean}
     */
    hasHeaders() {
        return Array.isArray(this.headers) && this.headers.length > 0
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(Panel));


/***/ },

/***/ "./src/container/Viewport.mjs"
/*!************************************!*\
  !*** ./src/container/Viewport.mjs ***!
  \************************************/
(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _Base_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Base.mjs */ "./src/container/Base.mjs");


/**
 * @class Neo.container.Viewport
 * @extends Neo.container.Base
 */
class Viewport extends _Base_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.container.Viewport'
         * @protected
         */
        className: 'Neo.container.Viewport',
        /**
         * @member {String} ntype='viewport'
         * @protected
         */
        ntype: 'viewport',
        /**
         * true applies 'neo-body-viewport' to the document.body
         * @member {Boolean} applyBodyCls=true
         */
        applyBodyCls: true,
        /**
         * Assuming that a Viewport is the top level view of your app, and you want to mount it right away.
         * Could be without any items. Use false otherwise.
         * @member {Boolean} autoMount=true
         */
        autoMount: true,
        /**
         * @member {String[]} baseCls=['neo-viewport']
         */
        baseCls: ['neo-viewport'],
        /**
         * true applies a main.addon.ResizeObserver and fires a custom resize event
         * which other instances can subscribe to.
         * @member {Boolean} monitorSize_=false
         * @reactive
         */
        monitorSize_: false
    }

    /**
     * Triggered after the mounted config got changed
     * @param {Boolean} value
     * @param {Boolean} oldValue
     * @protected
     */
    afterSetMounted(value, oldValue) {
        super.afterSetMounted(value, oldValue);

        let me = this;

        if (value && me.monitorSize) {
            me.addDomListeners([{resize: me.onDomResize, scope: me}])
        }
    }

    /**
     *
     */
    onConstructed() {
        super.onConstructed();

        let {windowId} = this;

        this.applyBodyCls && Neo.main.DomAccess.applyBodyCls({
            cls: ['neo-body-viewport'],
            windowId
        })
    }

    /**
     * @param {Object} data
     */
    onDomResize(data) {
        this.fire('resize', data)
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(Viewport));


/***/ },

/***/ "./src/controller/Component.mjs"
/*!**************************************!*\
  !*** ./src/controller/Component.mjs ***!
  \**************************************/
(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _Base_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Base.mjs */ "./src/controller/Base.mjs");
/* harmony import */ var _util_Function_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/Function.mjs */ "./src/util/Function.mjs");



/**
 * @class Neo.controller.Component
 * @extends Neo.controller.Base
 */
class Component extends _Base_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.controller.Component'
         * @protected
         */
        className: 'Neo.controller.Component',
        /**
         * @member {String} ntype='component-controller'
         * @protected
         */
        ntype: 'component-controller',
        /**
         * @member {Neo.component.Base|null} component=null
         * @protected
         */
        component: null,
        /**
         * @member {Neo.controller.Component|null} parent_=null
         * @reactive
         */
        parent_: null,
        /**
         * @member {Object} references=null
         * @protected
         */
        references: null,
        /**
         * @member {String|null} windowId=null
         */
        windowId: null
    }

    /**
     * @param {Object} config
     */
    construct(config) {
        super.construct(config);

        let me          = this,
            {component} = me;

        me.references = {};

        if (component.isConstructed) {
            me.onComponentConstructed()
        } else {
            component.on('constructed', () => {
                me.onComponentConstructed()
            }, me, {once: true})
        }
    }

    /**
     * Triggered before the parent config gets changed
     * @param {Neo.controller.Component|null} value
     * @param {Neo.controller.Component|null} oldValue
     * @protected
     */
    beforeSetParent(value, oldValue) {
        return value || this.getParent()
    }

    /**
     * @param {String} handlerName
     * @param {Neo.component.Base|null} [component]
     * @returns {Neo.controller.Component|Boolean|null}
     */
    getHandlerScope(handlerName, component) {
        let me       = this,
            {parent} = me,
            handlerCb;

        if (component) {
            // Look for ths function *name* first in the Component itself.
            // If we find it, return true so calling code knows not to continue to search.
            handlerCb = (0,_util_Function_mjs__WEBPACK_IMPORTED_MODULE_1__.resolveCallback)(handlerName, component);

            // Handler fn is resolved in the Component or its own parent chain.
            // Return a status indicating that we do not need an early binding
            if (handlerCb.fn) {
                return true
            }
        }

        return Neo.isFunction(me[handlerName]) ?
            me : parent?.getHandlerScope(handlerName) || null
    }

    /**
     * Get the closest controller inside the components parent tree
     * @returns {Neo.controller.Component|null}
     */
    getParent() {
        let me       = this,
            {parent} = me;

        if (parent) {
            return parent
        }

        return me.component.parent?.getController() || null
    }

    /**
     * todo: update changed references (e.g. container.remove() then container.add() using the same key)
     * @param {String} name
     * @returns {*}
     */
    getReference(name) {
        let me        = this,
            component = me.references[name];

        if (!component) {
            component = me.component.down({reference: name});

            if (component) {
                me.references[name] = component
            }
        }

        return component || null
    }

    /**
     * Convenience shortcut
     * @param args
     * @returns {*}
     */
    getState(...args) {
        return this.getStateProvider().getData(...args)
    }

    /**
     * sameLevelOnly=false will return the closest stateProvider inside the component parent tree,
     * in case there is none on the same level.
     * @param {Boolean} [sameLevelOnly=false]
     */
    getStateProvider(sameLevelOnly=false) {
        let {component} = this;
        return sameLevelOnly ? component.stateProvider : component.getStateProvider()
    }

    /**
     * Convenience shortcut for accessing state.Provider based data.Stores
     * @param {String} key
     * @returns {Neo.data.Store}
     */
    getStore(key) {
        return this.getStateProvider().getStore(key)
    }

    /**
     * Override this method inside your view controllers as a starting point in case you need references
     * (instead of using onConstructed() inside your controller)
     */
    onComponentConstructed() {}

    /**
     * Will get called by component.Base: destroy() in case the component has a reference config
     * @param {Neo.component.Base} component
     */
    removeReference(component) {
        let me           = this,
            {references} = me,
            key;

        for (key in references) {
            if (component === references[key]) {
                delete references[key];
                break
            }
        }

        me.getParent()?.removeReference(component)
    }

    /**
     * Convenience shortcut
     * @param args
     */
    setState(...args) {
        this.getStateProvider().setData(...args)
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(Component));


/***/ },

/***/ "./src/toolbar/Base.mjs"
/*!******************************!*\
  !*** ./src/toolbar/Base.mjs ***!
  \******************************/
(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _button_Base_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../button/Base.mjs */ "./src/button/Base.mjs");
/* harmony import */ var _component_Base_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../component/Base.mjs */ "./src/component/Base.mjs");
/* harmony import */ var _container_Base_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../container/Base.mjs */ "./src/container/Base.mjs");
/* harmony import */ var _component_Label_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../component/Label.mjs */ "./src/component/Label.mjs");
/* harmony import */ var _util_Array_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../util/Array.mjs */ "./src/util/Array.mjs");






/**
 * @class Neo.toolbar.Base
 * @extends Neo.container.Base
 */
class Toolbar extends _container_Base_mjs__WEBPACK_IMPORTED_MODULE_2__["default"] {
    /**
     * Valid values for dock
     * @member {String[]} dockPositions=['top','right','bottom','left', null]
     * @static
     */
    static dockPositions = ['top', 'right', 'bottom', 'left', null]

    static config = {
        /**
         * @member {String} className='Neo.toolbar.Base'
         * @protected
         */
        className: 'Neo.toolbar.Base',
        /**
         * @member {String} ntype='toolbar'
         * @protected
         */
        ntype: 'toolbar',
        /**
         * @member {String[]} baseCls=['neo-toolbar']
         */
        baseCls: ['neo-toolbar'],
        /**
         * @member {String|null} dock_=null
         * @reactive
         */
        dock_: null,
        /**
         * @member {Object} itemDefaults={ntype:'button'}
         * @reactive
         */
        itemDefaults: {
            ntype: 'button'
        },
        /**
         * @member {Object} layout={ntype:'flexbox',align:'center',direction: 'row', pack:'start'}
         * @reactive
         */
        layout: {
            ntype    : 'flexbox',
            align    : 'center',
            direction: 'row',
            pack     : 'start'
        }
    }

    /**
     * Triggered after the dock config got changed
     * @param {String} value
     * @param {String} oldValue
     * @protected
     */
    afterSetDock(value, oldValue) {
        if (!value && !oldValue) {
            return
        }

        let me            = this,
            {cls}         = me,
            dockPositions = me.getStaticConfig('dockPositions'),
            layoutConfig  = me.getLayoutConfig();

        dockPositions.forEach(key => {
            key !== null && _util_Array_mjs__WEBPACK_IMPORTED_MODULE_4__["default"].toggle(cls, 'neo-dock-' + key, key === value)
        });

        if (!me.layout) {
            layoutConfig.ntype = 'flexbox';
            me.set({cls, layout: layoutConfig})
        } else {
            me.layout.set(layoutConfig);
            me.cls = cls;
        }
    }

    /**
     * Checks if the new dock position matches a value of the static dockPositions config
     * @param {String} value
     * @param {String} oldValue
     * @returns {String} value
     * @protected
     */
    beforeSetDock(value, oldValue) {
        return this.beforeSetEnumValue(value, oldValue, 'dock', 'dockPositions')
    }

    /**
     *
     */
    createItems() {
        let items = this._items;

        if (Array.isArray(items)) {
            this._items = items.map(item => this.replaceSpacer(item))
        }

        return super.createItems()
    }

    /**
     * Creates a layout config depending on this.dock
     * @returns {Object} layoutConfig
     */
    getLayoutConfig() {
        let me = this,
            layoutConfig;

        if (me.dock) {
            switch (me.dock) {
                case 'bottom':
                case 'top':
                    layoutConfig = {
                        align    : 'center',
                        direction: 'row',
                        pack     : 'start'
                    };
                    break
                case 'left':
                    layoutConfig = {
                        align    : 'center',
                        direction: 'column-reverse',
                        pack     : 'start'
                    };
                    break
                case 'right':
                    layoutConfig = {
                        align    : 'center',
                        direction: 'column',
                        pack     : 'start'
                    };
                    break
            }
        }

        return layoutConfig || me.layout
    }

    /**
     * Inserts an item or array of items at a specific index
     * @param {Number} index
     * @param {Array|Object} item
     * @param {Boolean} [silent=false]
     * @returns {Neo.component.Base|Neo.component.Base[]}
     */
    insert(index, item, silent=false) {
        if (Array.isArray(item)) {
            item = item.map(item => this.replaceSpacer(item))
        } else {
            item = this.replaceSpacer(item)
        }

        return super.insert(index, item, silent)
    }

    /**
     * @param {Array|Object|String} item
     * @returns {Array|Object}
     */
    replaceSpacer(item) {
        return item === '->' ? {module: _component_Base_mjs__WEBPACK_IMPORTED_MODULE_1__["default"], flex: 1} : item
    }

    /**
     * @returns {Object}
     */
    toJSON() {
        return {
            ...super.toJSON(),
            dock: this.dock
        }
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(Toolbar));


/***/ }

};

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2h1bmtzL2FwcC92ZW5kb3JzLWFwcHNfbGVnaXRfYXBwX21qcy1zcmNfY29tcG9uZW50X0NhbnZhc19tanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQTJDOztBQUVwQztBQUNQLGNBQWMsMERBQVE7QUFDdEI7QUFDQSxDQUFDLEU7Ozs7Ozs7Ozs7Ozs7OztBQ0wrQzs7QUFFaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsMkRBQUs7QUFDMUI7QUFDQTtBQUNBLG9CQUFvQixRQUFRO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLFVBQVU7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQSxpRUFBZSxzQkFBc0IsRUFBQzs7Ozs7Ozs7Ozs7Ozs7OztBQ2hDVTs7QUFFaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsMkRBQUs7QUFDeEI7QUFDQTtBQUNBLG9CQUFvQixRQUFRO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLFVBQVU7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBLGlFQUFlLG9CQUFvQixFQUFDOzs7Ozs7Ozs7Ozs7Ozs7O0FDMUNVOztBQUU5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwwREFBSTtBQUN4QjtBQUNBO0FBQ0Esb0JBQW9CLFFBQVE7QUFDNUI7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QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxjQUFjO0FBQzdCLGVBQWUsU0FBUztBQUN4QixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsZUFBZSxxQkFBcUI7QUFDcEMsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxnQ0FBZ0MsUUFBUSwyREFBUyxXQUFXO0FBQzVEOztBQUVBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsaUVBQWUsdUJBQXVCLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZW8ubWpzLy4vYXBwcy9sZWdpdC9hcHAubWpzIiwid2VicGFjazovL25lby5tanMvLi9hcHBzL2xlZ2l0L21vZGVsL0NvbW1pdC5tanMiLCJ3ZWJwYWNrOi8vbmVvLm1qcy8uL2FwcHMvbGVnaXQvbW9kZWwvRmlsZS5tanMiLCJ3ZWJwYWNrOi8vbmVvLm1qcy8uL2FwcHMvbGVnaXQvc2VydmljZS9MZWdpdC5tanMiLCJ3ZWJwYWNrOi8vbmVvLm1qcy8uL2FwcHMvbGVnaXQvc3RvcmUvQ29tbWl0cy5tanMiLCJ3ZWJwYWNrOi8vbmVvLm1qcy8uL2FwcHMvbGVnaXQvc3RvcmUvRmlsZXMubWpzIiwid2VicGFjazovL25lby5tanMvLi9hcHBzL2xlZ2l0L3ZpZXcvQ29tbWl0R3JpZC5tanMiLCJ3ZWJwYWNrOi8vbmVvLm1qcy8uL2FwcHMvbGVnaXQvdmlldy9WaWV3cG9ydC5tanMiLCJ3ZWJwYWNrOi8vbmVvLm1qcy8uL2FwcHMvbGVnaXQvdmlldy9WaWV3cG9ydENvbnRyb2xsZXIubWpzIiwid2VicGFjazovL25lby5tanMvLi9hcHBzL2xlZ2l0L3ZpZXcvVmlld3BvcnRTdGF0ZVByb3ZpZGVyLm1qcyIsIndlYnBhY2s6Ly9uZW8ubWpzLy4vc3JjL2NvbXBvbmVudC9DYW52YXMubWpzIiwid2VicGFjazovL25lby5tanMvLi9zcmMvY29tcG9uZW50L0xhYmVsLm1qcyIsIndlYnBhY2s6Ly9uZW8ubWpzLy4vc3JjL2NvbnRhaW5lci9QYW5lbC5tanMiLCJ3ZWJwYWNrOi8vbmVvLm1qcy8uL3NyYy9jb250YWluZXIvVmlld3BvcnQubWpzIiwid2VicGFjazovL25lby5tanMvLi9zcmMvY29udHJvbGxlci9Db21wb25lbnQubWpzIiwid2VicGFjazovL25lby5tanMvLi9zcmMvdG9vbGJhci9CYXNlLm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgVmlld3BvcnQgZnJvbSAnLi92aWV3L1ZpZXdwb3J0Lm1qcyc7XG5cbmV4cG9ydCBjb25zdCBvblN0YXJ0ID0gKCkgPT4gTmVvLmFwcCh7XG4gICAgbWFpblZpZXc6IFZpZXdwb3J0LFxuICAgIG5hbWUgICAgOiAnTGVnaXQnXG59KTsiLCJpbXBvcnQgTW9kZWwgZnJvbSAnLi4vLi4vLi4vc3JjL2RhdGEvTW9kZWwubWpzJztcblxuLyoqXG4gKiBAY2xhc3MgTGVnaXQubW9kZWwuQ29tbWl0XG4gKiBAZXh0ZW5kcyBOZW8uZGF0YS5Nb2RlbFxuICovXG5jbGFzcyBDb21taXQgZXh0ZW5kcyBNb2RlbCB7XG4gICAgc3RhdGljIGNvbmZpZyA9IHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gY2xhc3NOYW1lPSdMZWdpdC5tb2RlbC5Db21taXQnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ0xlZ2l0Lm1vZGVsLkNvbW1pdCcsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtPYmplY3RbXX0gZmllbGRzXG4gICAgICAgICAqL1xuICAgICAgICBmaWVsZHM6IFt7XG4gICAgICAgICAgICBuYW1lOiAnb2lkJyxcbiAgICAgICAgICAgIHR5cGU6ICdTdHJpbmcnXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIG5hbWU6ICdtZXNzYWdlJyxcbiAgICAgICAgICAgIHR5cGU6ICdTdHJpbmcnXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIG5hbWU6ICdhdXRob3InLFxuICAgICAgICAgICAgdHlwZTogJ09iamVjdCdcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgbmFtZTogJ3RpbWVzdGFtcCcsXG4gICAgICAgICAgICB0eXBlOiAnSW50ZWdlcidcbiAgICAgICAgfV1cbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IE5lby5zZXR1cENsYXNzKENvbW1pdCk7XG4iLCJpbXBvcnQgTW9kZWwgZnJvbSAnLi4vLi4vLi4vc3JjL2RhdGEvTW9kZWwubWpzJztcblxuLyoqXG4gKiBAY2xhc3MgTGVnaXQubW9kZWwuRmlsZVxuICogQGV4dGVuZHMgTmVvLmRhdGEuTW9kZWxcbiAqL1xuY2xhc3MgRmlsZSBleHRlbmRzIE1vZGVsIHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J0xlZ2l0Lm1vZGVsLkZpbGUnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ0xlZ2l0Lm1vZGVsLkZpbGUnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7T2JqZWN0W119IGZpZWxkc1xuICAgICAgICAgKi9cbiAgICAgICAgZmllbGRzOiBbe1xuICAgICAgICAgICAgbmFtZTogJ2NsYXNzTmFtZScsXG4gICAgICAgICAgICB0eXBlOiAnU3RyaW5nJ1xuICAgICAgICB9LCB7XG4gICAgICAgICAgICBuYW1lOiAnY29sbGFwc2VkJyxcbiAgICAgICAgICAgIHR5cGU6ICdCb29sZWFuJ1xuICAgICAgICB9LCB7XG4gICAgICAgICAgICBuYW1lOiAnaGlkZGVuJyxcbiAgICAgICAgICAgIHR5cGU6ICdCb29sZWFuJ1xuICAgICAgICB9LCB7XG4gICAgICAgICAgICBuYW1lOiAnaWQnLFxuICAgICAgICAgICAgdHlwZTogJ1N0cmluZydcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgbmFtZSAgICAgICAgOiAnaXNMZWFmJyxcbiAgICAgICAgICAgIHR5cGUgICAgICAgIDogJ0Jvb2xlYW4nLFxuICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiB0cnVlXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIG5hbWU6ICduYW1lJyxcbiAgICAgICAgICAgIHR5cGU6ICdTdHJpbmcnXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIG5hbWU6ICdwYXJlbnRJZCcsXG4gICAgICAgICAgICB0eXBlOiAnU3RyaW5nJ1xuICAgICAgICB9XVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgTmVvLnNldHVwQ2xhc3MoRmlsZSk7XG4iLCJpbXBvcnQgQmFzZSBmcm9tICcuLi8uLi8uLi9zcmMvY29yZS9CYXNlLm1qcyc7XG5cbi8qKlxuICogQHN1bW1hcnkgQSBzaW5nbGV0b24gc2VydmljZSB0aGF0IHByb3ZpZGVzIGEgdmlydHVhbCBmaWxlIHN5c3RlbSBsYXllciBmb3IgdGhlIExlZ2l0IElERS5cbiAqXG4gKiBUaGlzIHNlcnZpY2UgYWN0cyBhcyB0aGUgY2VudHJhbCBodWIgZm9yIGZpbGUgc3lzdGVtIG9wZXJhdGlvbnMgd2l0aGluIHRoZSBMZWdpdCBhcHBsaWNhdGlvbi5cbiAqIEl0IGFic3RyYWN0cyB0aGUgdW5kZXJseWluZyBzdG9yYWdlIG1lY2hhbmlzbSAodXNpbmcgYG1lbWZzYCkgYW5kIHByb3ZpZGVzIGEgZ2l0LWxpa2UgaW50ZXJmYWNlXG4gKiBmb3IgaW50ZXJhY3Rpbmcgd2l0aCBmaWxlIHRyZWVzIGFuZCBjb21taXRzICh1c2luZyBgQGxlZ2l0LXNkay9jb3JlYCkuXG4gKlxuICogS2V5IHJlc3BvbnNpYmlsaXRpZXMgaW5jbHVkZTpcbiAqIC0gKipJbml0aWFsaXphdGlvbjoqKiBEeW5hbWljYWxseSBsb2FkaW5nIGV4dGVybmFsIGRlcGVuZGVuY2llcyAoYG1lbWZzYCwgYEBsZWdpdC1zZGsvY29yZWApIHRvIGVuc3VyZSB0aGUgYXBwIHJlbWFpbnMgbGlnaHR3ZWlnaHQgdW50aWwgbmVlZGVkLlxuICogLSAqKkZpbGUgU3lzdGVtIFNlZWRpbmc6KiogUG9wdWxhdGluZyB0aGUgaW4tbWVtb3J5IGZpbGUgc3lzdGVtIHdpdGggaW5pdGlhbCBkZW1vIGNvbnRlbnQuXG4gKiAtICoqR2l0IE9wZXJhdGlvbnM6KiogUHJvdmlkaW5nIG1ldGhvZHMgdG8gbG9hZCBmaWxlIHRyZWVzIChgbG9hZFRyZWVgKSBhbmQgY2FsY3VsYXRlIGRlbHRhcyBiZXR3ZWVuIGNvbW1pdHMgKGBsb2FkVHJlZURlbHRhYCkuXG4gKiAtICoqRmlsZSBJL086KiogRXhwb3Npbmcgc3RhbmRhcmQgZmlsZSBzeXN0ZW0gbWV0aG9kcyAoYHJlYWRGaWxlYCwgYHdyaXRlRmlsZWAsIGByZWFkZGlyYCwgYHN0YXRgKSB0aGF0IGF1dG9tYXRpY2FsbHkgYXdhaXQgdGhlIHNlcnZpY2UncyByZWFkeSBzdGF0ZS5cbiAqXG4gKiBUaGlzIHNlcnZpY2UgaXMgZGVzaWduZWQgdG8gYmUgcm9idXN0IGFnYWluc3QgaW5pdGlhbGl6YXRpb24gZmFpbHVyZXMgYW5kIHByb3ZpZGVzIGEgc2FmZSwgYXN5bmNocm9ub3VzIEFQSSBmb3IgdGhlIGBWaWV3cG9ydENvbnRyb2xsZXJgIHRvIGNvbnN1bWUuXG4gKlxuICogQGNsYXNzIExlZ2l0LnNlcnZpY2UuTGVnaXRcbiAqIEBleHRlbmRzIE5lby5jb3JlLkJhc2VcbiAqIEBzaW5nbGV0b25cbiAqL1xuY2xhc3MgTGVnaXQgZXh0ZW5kcyBCYXNlIHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J0xlZ2l0LnNlcnZpY2UuTGVnaXQnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ0xlZ2l0LnNlcnZpY2UuTGVnaXQnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7T2JqZWN0fG51bGx9IGZzPW51bGxcbiAgICAgICAgICovXG4gICAgICAgIGZzOiBudWxsLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7T2JqZWN0fG51bGx9IGxlZ2l0RnM9bnVsbFxuICAgICAgICAgKi9cbiAgICAgICAgbGVnaXRGczogbnVsbCxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gcGF0aD0nLy5sZWdpdC9icmFuY2hlcy9hbm9ueW1vdXMnXG4gICAgICAgICAqL1xuICAgICAgICBwYXRoOiAnLy5sZWdpdC9icmFuY2hlcy9hbm9ueW1vdXMnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7Qm9vbGVhbn0gc2luZ2xldG9uPXRydWVcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgc2luZ2xldG9uOiB0cnVlXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZXMgdGhlIHNlcnZpY2UgYnkgZHluYW1pY2FsbHkgaW1wb3J0aW5nIGRlcGVuZGVuY2llcyBhbmQgc2V0dGluZyB1cCB0aGUgZmlsZSBzeXN0ZW0uXG4gICAgICogQHJldHVybnMge1Byb21pc2U8dm9pZD59XG4gICAgICovXG4gICAgYXN5bmMgaW5pdEFzeW5jKCkge1xuICAgICAgICBhd2FpdCBzdXBlci5pbml0QXN5bmMoKTtcblxuICAgICAgICBjb25zdCBtZSA9IHRoaXM7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHtvcGVuTGVnaXRGc30gPSBhd2FpdCBpbXBvcnQoLyogd2VicGFja0lnbm9yZTogdHJ1ZSAqLyAnaHR0cHM6Ly9lc20uc2gvQGxlZ2l0LXNkay9jb3JlJyk7XG4gICAgICAgICAgICBjb25zdCBmc01vZHVsZSAgICAgID0gYXdhaXQgaW1wb3J0KC8qIHdlYnBhY2tJZ25vcmU6IHRydWUgKi8gJ2h0dHBzOi8vZXNtLnNoL21lbWZzJyk7XG5cbiAgICAgICAgICAgIG1lLmZzID0gZnNNb2R1bGUuZGVmYXVsdDtcblxuICAgICAgICAgICAgbWUubGVnaXRGcyA9IGF3YWl0IG9wZW5MZWdpdEZzKHtcbiAgICAgICAgICAgICAgICBzdG9yYWdlRnM6IG1lLmZzLFxuICAgICAgICAgICAgICAgIGdpdFJvb3QgIDogJy8nLFxuICAgICAgICAgICAgICAgIHNlcnZlclVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6OTk5OS8nLFxuICAgICAgICAgICAgICAgIC8vIHB1YmxpY0tleTogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfTEVHSVRfUFVCTElDX0tFWSxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBGb3IgZGVidWdnaW5nXG4gICAgICAgICAgICBnbG9iYWxUaGlzLmxlZ2l0RnMgPSBtZS5sZWdpdEZzO1xuXG4gICAgICAgICAgICBhd2FpdCBtZS4jc2VlZEZpbGVTeXN0ZW0oKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGluaXRpYWxpemUgTGVnaXQgU2VydmljZScsIGUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIHRoZSBjb21taXQgaGlzdG9yeSBmb3IgYSBnaXZlbiBicmFuY2guXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IFticmFuY2g9J2Fub255bW91cyddIFRoZSBicmFuY2ggbmFtZSB0byBsb2FkIGhpc3RvcnkgZm9yLlxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPE9iamVjdFtdPn0gQW4gYXJyYXkgb2YgY29tbWl0IG9iamVjdHMuXG4gICAgICovXG4gICAgYXN5bmMgbG9hZEhpc3RvcnkoYnJhbmNoPSdhbm9ueW1vdXMnKSB7XG4gICAgICAgIGF3YWl0IHRoaXMucmVhZHkoKTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgaGlzdG9yeUpzb24gPSBhd2FpdCB0aGlzLmxlZ2l0RnMucmVhZEZpbGUoYC8ubGVnaXQvYnJhbmNoZXMvJHticmFuY2h9Ly5sZWdpdC9oaXN0b3J5YCwgJ3V0Zi04Jyk7XG4gICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShoaXN0b3J5SnNvbik7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgRmFpbGVkIHRvIGxvYWQgaGlzdG9yeSBmb3IgYnJhbmNoICR7YnJhbmNofWAsIGUpO1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVjdXJzaXZlbHkgbG9hZHMgdGhlIGZpbGUgdHJlZSBzdHJ1Y3R1cmUgZnJvbSBhIGdpdmVuIHBhdGguXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHRyZWVQYXRoIFRoZSBwYXRoIHRvIHN0YXJ0IGxvYWRpbmcgdGhlIHRyZWUgZnJvbS5cbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx7aGFzaDogc3RyaW5nLCBzdWJFbnRyaWVzOiB7fX0+fSBUaGUgdHJlZSBzdHJ1Y3R1cmUgd2l0aCBoYXNoZXMuXG4gICAgICovXG4gICAgYXN5bmMgbG9hZFRyZWUodHJlZVBhdGgpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5yZWFkeSgpO1xuXG4gICAgICAgIGNvbnN0XG4gICAgICAgICAgICBtZSAgICAgICAgID0gdGhpcyxcbiAgICAgICAgICAgIHN1YkVudHJpZXMgPSB7fSxcbiAgICAgICAgICAgIHBhdGhFbnRyaWVzID0gYXdhaXQgbWUucmVhZGRpcih0cmVlUGF0aCk7XG5cbiAgICAgICAgZm9yIChjb25zdCBlbnRyeU5hbWUgb2YgcGF0aEVudHJpZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHN0YXQgPSBhd2FpdCBtZS5zdGF0KHRyZWVQYXRoICsgZW50cnlOYW1lKTtcblxuICAgICAgICAgICAgaWYgKHN0YXQuaXNEaXJlY3RvcnkoKSkge1xuICAgICAgICAgICAgICAgIHN1YkVudHJpZXNbZW50cnlOYW1lXSA9IGF3YWl0IG1lLmxvYWRUcmVlKHRyZWVQYXRoICsgZW50cnlOYW1lICsgJy8nKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29udGVuSGFzaCA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuZGlnZXN0KFwiU0hBLTFcIiwgYXdhaXQgbWUucmVhZEZpbGUodHJlZVBhdGggKyBlbnRyeU5hbWUpKTtcblxuICAgICAgICAgICAgICAgIHN1YkVudHJpZXNbZW50cnlOYW1lXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZm9yIG5vdyBpdHMgdGhlIGNvbnRlbnQgaW5zdGVhZCBvZiB0aGUgaGFzaFxuICAgICAgICAgICAgICAgICAgICBoYXNoOiBjb250ZW5IYXNoLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBlbnRyeU5hbWUsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBoYXNoOiAnJyxcbiAgICAgICAgICAgIHN1YkVudHJpZXNcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGN1bGF0ZXMgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0d28gdHJlZSBzdGF0ZXMgKGNvbW1pdHMpLlxuICAgICAqIFVzZWZ1bCBmb3IgaWRlbnRpZnlpbmcgYWRkZWQsIGRlbGV0ZWQsIGFuZCBtb2RpZmllZCBmaWxlcy5cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gY3VycmVudFN0YXRlIFRoZSBoYXNoIG9yIHBhdGggb2YgdGhlIGN1cnJlbnQgc3RhdGUuXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG5ld1N0YXRlIFRoZSBoYXNoIG9yIHBhdGggb2YgdGhlIG5ldyBzdGF0ZS5cbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx7ZGVsZXRlZDogU3RyaW5nW10sIGFkZGVkOiBTdHJpbmdbXSwgbW9kaWZpZWQ6IFN0cmluZ1tdfT59IEFuIG9iamVjdCBjb250YWluaW5nIGFycmF5cyBvZiBjaGFuZ2VkIGZpbGUgcGF0aHMuXG4gICAgICovXG4gICAgYXN5bmMgbG9hZFRyZWVEZWx0YShjdXJyZW50U3RhdGUsIG5ld1N0YXRlKSB7XG4gICAgICAgIGF3YWl0IHRoaXMucmVhZHkoKTtcblxuICAgICAgICBjb25zdCBtZSA9IHRoaXM7XG5cbiAgICAgICAgY29uc3QgcHJlZml4TmV3U3RhdGUgPSBuZXdTdGF0ZS5zbGljZSgwLCAyKTtcbiAgICAgICAgY29uc3Qgc3VmZml4TmV3U3RhdGUgPSBuZXdTdGF0ZS5zbGljZSgyKTtcblxuICAgICAgICBsZXQgY3VycmVudHN0YXRlVHJlZSA9IHt9XG5cbiAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSkge1xuICAgICAgICAgICAgY29uc3QgcHJlZml4Q3VycmVudFN0YXRlID0gY3VycmVudFN0YXRlLnNsaWNlKDAsIDIpO1xuICAgICAgICAgICAgY29uc3Qgc3VmZml4Q3VycmVudFN0YXRlID0gY3VycmVudFN0YXRlLnNsaWNlKDIpO1xuXG4gICAgICAgICAgICBjdXJyZW50c3RhdGVUcmVlID0gYXdhaXQgbWUubG9hZFRyZWUoJy8ubGVnaXQvY29tbWl0cy8nICsgcHJlZml4Q3VycmVudFN0YXRlICsgJy8nICsgc3VmZml4Q3VycmVudFN0YXRlICsgJy8nKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBuZXdTdGF0ZVRyZWUgPSBhd2FpdCBtZS5sb2FkVHJlZSgnLy5sZWdpdC9jb21taXRzLycgKyBwcmVmaXhOZXdTdGF0ZSArICcvJyArIHN1ZmZpeE5ld1N0YXRlICsgJy8nKTtcblxuICAgICAgICBjb25zdCBkZWxldGVkICA9IFtdO1xuICAgICAgICBjb25zdCBhZGRlZCAgICA9IFtdO1xuICAgICAgICBjb25zdCBtb2RpZmllZCA9IFtdO1xuXG4gICAgICAgIGZ1bmN0aW9uIGZsYXR0ZW5UcmVlKHRyZWUsIHBhdGggPSAnJykge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge307XG5cbiAgICAgICAgICAgIGlmICh0cmVlLnN1YkVudHJpZXMpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyh0cmVlLnN1YkVudHJpZXMpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRQYXRoID0gcGF0aCA/IGAke3BhdGh9LyR7a2V5fWAgOiBrZXk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlLnN1YkVudHJpZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24ocmVzdWx0LCBmbGF0dGVuVHJlZSh2YWx1ZSwgY3VycmVudFBhdGgpKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtjdXJyZW50UGF0aF0gPSB2YWx1ZS5oYXNoO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY3VycmVudFN0YXRlRmxhdCA9IGN1cnJlbnRTdGF0ZSAhPT0gJycgPyBmbGF0dGVuVHJlZShjdXJyZW50c3RhdGVUcmVlKSA6IHt9O1xuICAgICAgICBjb25zdCBuZXdTdGF0ZUZsYXQgICAgID0gZmxhdHRlblRyZWUobmV3U3RhdGVUcmVlKTtcblxuICAgICAgICAvLyBGaW5kIGRlbGV0ZWQgKGluIGN1cnJlbnQgYnV0IG5vdCBpbiBuZXcpXG4gICAgICAgIGZvciAoY29uc3QgcGF0aCBpbiBjdXJyZW50U3RhdGVGbGF0KSB7XG4gICAgICAgICAgICBpZiAoIShwYXRoIGluIG5ld1N0YXRlRmxhdCkpIHtcbiAgICAgICAgICAgICAgICBkZWxldGVkLnB1c2gocGF0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGaW5kIGFkZGVkIChpbiBuZXcgYnV0IG5vdCBpbiBjdXJyZW50KVxuICAgICAgICBmb3IgKGNvbnN0IHBhdGggaW4gbmV3U3RhdGVGbGF0KSB7XG4gICAgICAgICAgICBpZiAoIShwYXRoIGluIGN1cnJlbnRTdGF0ZUZsYXQpKSB7XG4gICAgICAgICAgICAgICAgYWRkZWQucHVzaChwYXRoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZpbmQgbW9kaWZpZWQgKGluIGJvdGggYnV0IGhhc2ggZGlmZmVycylcbiAgICAgICAgZm9yIChjb25zdCBwYXRoIGluIG5ld1N0YXRlRmxhdCkge1xuICAgICAgICAgICAgaWYgKHBhdGggaW4gY3VycmVudFN0YXRlRmxhdCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRIYXNoID0gbmV3IFVpbnQ4QXJyYXkoY3VycmVudFN0YXRlRmxhdFtwYXRoXSk7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3SGFzaCAgICAgPSBuZXcgVWludDhBcnJheShuZXdTdGF0ZUZsYXRbcGF0aF0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRIYXNoLmxlbmd0aCAhPT0gbmV3SGFzaC5sZW5ndGggfHxcbiAgICAgICAgICAgICAgICAgICAgIWN1cnJlbnRIYXNoLmV2ZXJ5KChieXRlLCBpKSA9PiBieXRlID09PSBuZXdIYXNoW2ldKSkge1xuICAgICAgICAgICAgICAgICAgICBtb2RpZmllZC5wdXNoKHBhdGgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBkZWxldGVkLFxuICAgICAgICAgICAgYWRkZWQsXG4gICAgICAgICAgICBtb2RpZmllZFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVhZHMgdGhlIGNvbnRlbnQgb2YgYSBmaWxlLlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBwYXRoIFRoZSBmaWxlIHBhdGguXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXSBSZWFkIG9wdGlvbnMuXG4gICAgICogQHJldHVybnMge1Byb21pc2U8Kj59IFRoZSBmaWxlIGNvbnRlbnQuXG4gICAgICovXG4gICAgYXN5bmMgcmVhZEZpbGUocGF0aCwgb3B0aW9ucykge1xuICAgICAgICBhd2FpdCB0aGlzLnJlYWR5KCk7XG4gICAgICAgIHJldHVybiB0aGlzLmxlZ2l0RnMucmVhZEZpbGUocGF0aCwgb3B0aW9ucylcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZWFkcyB0aGUgY29udGVudHMgb2YgYSBkaXJlY3RvcnkuXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHBhdGggVGhlIGRpcmVjdG9yeSBwYXRoLlxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPFN0cmluZ1tdPn0gQW4gYXJyYXkgb2YgZmlsZSBuYW1lcy5cbiAgICAgKi9cbiAgICBhc3luYyByZWFkZGlyKHBhdGgpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5yZWFkeSgpO1xuICAgICAgICByZXR1cm4gdGhpcy5sZWdpdEZzLnJlYWRkaXIocGF0aClcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZWVkcyB0aGUgaW4tbWVtb3J5IGZpbGUgc3lzdGVtIHdpdGggaW5pdGlhbCBkZW1vIGNvbnRlbnQuXG4gICAgICogVGhpcyBtZXRob2QgYnlwYXNzZXMgdGhlIGByZWFkeSgpYCBjaGVjayB0byBhdm9pZCBkZWFkbG9ja3MgZHVyaW5nIGluaXRpYWxpemF0aW9uLlxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPHZvaWQ+fVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgYXN5bmMgI3NlZWRGaWxlU3lzdGVtKCkge1xuICAgICAgICBjb25zdCBtZSA9IHRoaXM7XG5cbiAgICAgICAgbGV0IG1kRmlsZSA9IGF3YWl0IGZldGNoKCcuLi8uLi9sZWFybi9iZW5lZml0cy9Gb3Jtc0VuZ2luZS5tZCcpO1xuICAgICAgICBtZEZpbGUgPSBhd2FpdCBtZEZpbGUudGV4dCgpO1xuXG4gICAgICAgIGF3YWl0IG1lLndyaXRlRmlsZSh7XG4gICAgICAgICAgICBkYXRhICAgICA6IG1kRmlsZSxcbiAgICAgICAgICAgIHBhdGggICAgIDogYCR7bWUucGF0aH0vRm9ybXNFbmdpbmUubWRgLFxuICAgICAgICAgICAgc2tpcFJlYWR5OiB0cnVlXG4gICAgICAgIH0pO1xuXG4gICAgICAgIG1kRmlsZSA9IGF3YWl0IGZldGNoKCcuLi8uLi9sZWFybi9iZW5lZml0cy9PZmZUaGVNYWluVGhyZWFkLm1kJyk7XG4gICAgICAgIG1kRmlsZSA9IGF3YWl0IG1kRmlsZS50ZXh0KCk7XG5cbiAgICAgICAgYXdhaXQgbWUud3JpdGVGaWxlKHtcbiAgICAgICAgICAgIGRhdGEgICAgIDogbWRGaWxlLFxuICAgICAgICAgICAgcGF0aCAgICAgOiBgJHttZS5wYXRofS9PZmZUaGVNYWluVGhyZWFkLm1kYCxcbiAgICAgICAgICAgIHNraXBSZWFkeTogdHJ1ZVxuICAgICAgICB9KTtcblxuICAgICAgICBhd2FpdCBtZS53cml0ZUZpbGUoe1xuICAgICAgICAgICAgZGF0YTogW1xuICAgICAgICAgICAgICAgIFwiaW1wb3J0IFZpZXdwb3J0IGZyb20gJy4uLy4uL2V4YW1wbGVzL2NvbXBvbmVudC9tdWx0aVdpbmRvd0hlbGl4L1ZpZXdwb3J0Lm1qcyc7XCIsXG4gICAgICAgICAgICAgICAgXCJcIixcbiAgICAgICAgICAgICAgICBcImNsYXNzIE1haW5WaWV3IGV4dGVuZHMgVmlld3BvcnQge1wiLFxuICAgICAgICAgICAgICAgIFwiICAgIHN0YXRpYyBjb25maWcgPSB7XCIsXG4gICAgICAgICAgICAgICAgXCIgICAgICAgIGNsYXNzTmFtZSAgICAgICAgICAgOiAnUG9ydGFsLnZpZXcuTXVsdGlXaW5kb3dIZWxpeCcsXCIsXG4gICAgICAgICAgICAgICAgXCIgICAgICAgIHNob3dHaXRIdWJTdGFyQnV0dG9uOiBmYWxzZSxcIixcbiAgICAgICAgICAgICAgICBcIiAgICAgICAgdGhlbWUgICAgICAgICAgICAgICA6ICduZW8tdGhlbWUtZGFyaydcIixcbiAgICAgICAgICAgICAgICBcIiAgICB9XCIsXG4gICAgICAgICAgICAgICAgXCJ9XCIsXG4gICAgICAgICAgICAgICAgXCJcIixcbiAgICAgICAgICAgICAgICBcIk1haW5WaWV3ID0gTmVvLnNldHVwQ2xhc3MoTWFpblZpZXcpO1wiXG4gICAgICAgICAgICBdLmpvaW4oJ1xcbicpLFxuICAgICAgICAgICAgcGF0aCAgICAgOiBgJHttZS5wYXRofS9IZWxpeC5tanNgLFxuICAgICAgICAgICAgc2tpcFJlYWR5OiB0cnVlXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGF3YWl0IG1lLndyaXRlRmlsZSh7XG4gICAgICAgICAgICBkYXRhOiBbXG4gICAgICAgICAgICAgICAgXCJpbXBvcnQgVmlld3BvcnQgZnJvbSAnLi4vLi4vZXhhbXBsZXMvY29tcG9uZW50L211bHRpV2luZG93Q29yb25hR2FsbGVyeS9WaWV3cG9ydC5tanMnO1wiLFxuICAgICAgICAgICAgICAgIFwiXCIsXG4gICAgICAgICAgICAgICAgXCJjbGFzcyBNYWluVmlldyBleHRlbmRzIFZpZXdwb3J0IHtcIixcbiAgICAgICAgICAgICAgICBcIiAgICBzdGF0aWMgY29uZmlnID0ge1wiLFxuICAgICAgICAgICAgICAgIFwiICAgICAgICBjbGFzc05hbWUgICAgICAgICAgIDogJ1BvcnRhbC52aWV3Lk11bHRpV2luZG93SGVsaXgnLFwiLFxuICAgICAgICAgICAgICAgIFwiICAgICAgICBzaG93R2l0SHViU3RhckJ1dHRvbjogZmFsc2UsXCIsXG4gICAgICAgICAgICAgICAgXCIgICAgICAgIHRoZW1lICAgICAgICAgICAgICAgOiAnbmVvLXRoZW1lLWRhcmsnXCIsXG4gICAgICAgICAgICAgICAgXCIgICAgfVwiLFxuICAgICAgICAgICAgICAgIFwifVwiLFxuICAgICAgICAgICAgICAgIFwiXCIsXG4gICAgICAgICAgICAgICAgXCJNYWluVmlldyA9IE5lby5zZXR1cENsYXNzKE1haW5WaWV3KTtcIlxuICAgICAgICAgICAgXS5qb2luKCdcXG4nKSxcbiAgICAgICAgICAgIHBhdGggICAgIDogYCR7bWUucGF0aH0vR2FsbGVyeS5tanNgLFxuICAgICAgICAgICAgc2tpcFJlYWR5OiB0cnVlXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlcyBmaWxlIHN0YXRpc3RpY3MuXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHBhdGggVGhlIGZpbGUgb3IgZGlyZWN0b3J5IHBhdGguXG4gICAgICogQHJldHVybnMge1Byb21pc2U8T2JqZWN0Pn0gVGhlIGZpbGUgc3RhdGlzdGljcyBvYmplY3QuXG4gICAgICovXG4gICAgYXN5bmMgc3RhdChwYXRoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMucmVhZHkoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMubGVnaXRGcy5zdGF0KHBhdGgpXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogV3JpdGVzIGRhdGEgdG8gYSBmaWxlLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSAgICAgICAgY29uZmlnIENvbmZpZ3VyYXRpb24gb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfEJ1ZmZlcn0gY29uZmlnLmRhdGEgVGhlIGRhdGEgdG8gd3JpdGUuXG4gICAgICogQHBhcmFtIHtPYmplY3R9ICAgICAgICBbY29uZmlnLm9wdGlvbnNdIFdyaXRlIG9wdGlvbnMuXG4gICAgICogQHBhcmFtIHtTdHJpbmd9ICAgICAgICBjb25maWcucGF0aCBUaGUgZmlsZSBwYXRoLlxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gICAgICAgW2NvbmZpZy5za2lwUmVhZHk9ZmFsc2VdIElmIHRydWUsIGJ5cGFzc2VzIHRoZSBgYXdhaXQgdGhpcy5yZWFkeSgpYCBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTwqPn1cbiAgICAgKi9cbiAgICBhc3luYyB3cml0ZUZpbGUoe2RhdGEsIG9wdGlvbnMsIHBhdGgsIHNraXBSZWFkeT1mYWxzZX0pIHtcbiAgICAgICAgIXNraXBSZWFkeSAmJiBhd2FpdCB0aGlzLnJlYWR5KCk7XG4gICAgICAgIHJldHVybiB0aGlzLmxlZ2l0RnMud3JpdGVGaWxlKHBhdGgsIGRhdGEsIG9wdGlvbnMpXG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBOZW8uc2V0dXBDbGFzcyhMZWdpdCk7XG4iLCJpbXBvcnQgQ29tbWl0TW9kZWwgZnJvbSAnLi4vbW9kZWwvQ29tbWl0Lm1qcyc7XG5pbXBvcnQgU3RvcmUgICAgICAgZnJvbSAnLi4vLi4vLi4vc3JjL2RhdGEvU3RvcmUubWpzJztcblxuLyoqXG4gKiBAY2xhc3MgTGVnaXQuc3RvcmUuQ29tbWl0c1xuICogQGV4dGVuZHMgTmVvLmRhdGEuU3RvcmVcbiAqL1xuY2xhc3MgQ29tbWl0cyBleHRlbmRzIFN0b3JlIHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J0xlZ2l0LnN0b3JlLkNvbW1pdHMnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ0xlZ2l0LnN0b3JlLkNvbW1pdHMnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7TmVvLmRhdGEuTW9kZWx9IG1vZGVsPUNvbW1pdE1vZGVsXG4gICAgICAgICAqIEByZWFjdGl2ZVxuICAgICAgICAgKi9cbiAgICAgICAgbW9kZWw6IENvbW1pdE1vZGVsLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7T2JqZWN0W119IHNvcnRlcnM9W3twcm9wZXJ0eTondGltZXN0YW1wJyxkaXJlY3Rpb246J0RFU0MnfV1cbiAgICAgICAgICogQHJlYWN0aXZlXG4gICAgICAgICAqL1xuICAgICAgICBzb3J0ZXJzOiBbe1xuICAgICAgICAgICAgcHJvcGVydHkgOiAndGltZXN0YW1wJyxcbiAgICAgICAgICAgIGRpcmVjdGlvbjogJ0RFU0MnXG4gICAgICAgIH1dXG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBOZW8uc2V0dXBDbGFzcyhDb21taXRzKTtcbiIsImltcG9ydCBGaWxlTW9kZWwgZnJvbSAnLi4vbW9kZWwvRmlsZS5tanMnO1xuaW1wb3J0IFN0b3JlICAgICBmcm9tICcuLi8uLi8uLi9zcmMvZGF0YS9TdG9yZS5tanMnO1xuXG4vKipcbiAqIEBjbGFzcyBMZWdpdC5zdG9yZS5GaWxlc1xuICogQGV4dGVuZHMgTmVvLmRhdGEuU3RvcmVcbiAqL1xuY2xhc3MgRmlsZXMgZXh0ZW5kcyBTdG9yZSB7XG4gICAgc3RhdGljIGNvbmZpZyA9IHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gY2xhc3NOYW1lPSdMZWdpdC5zdG9yZS5GaWxlcydcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgY2xhc3NOYW1lOiAnTGVnaXQuc3RvcmUuRmlsZXMnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7TmVvLmRhdGEuTW9kZWx9IG1vZGVsPUZpbGVNb2RlbFxuICAgICAgICAgKiBAcmVhY3RpdmVcbiAgICAgICAgICovXG4gICAgICAgIG1vZGVsOiBGaWxlTW9kZWxcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IE5lby5zZXR1cENsYXNzKEZpbGVzKTtcbiIsImltcG9ydCBHcmlkIGZyb20gJy4uLy4uLy4uL3NyYy9ncmlkL0NvbnRhaW5lci5tanMnO1xuXG4vKipcbiAqIEBjbGFzcyBMZWdpdC52aWV3LkNvbW1pdEdyaWRcbiAqIEBleHRlbmRzIE5lby5ncmlkLkNvbnRhaW5lclxuICovXG5jbGFzcyBDb21taXRHcmlkIGV4dGVuZHMgR3JpZCB7XG4gICAgc3RhdGljIGNvbmZpZyA9IHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gY2xhc3NOYW1lPSdMZWdpdC52aWV3LkNvbW1pdEdyaWQnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ0xlZ2l0LnZpZXcuQ29tbWl0R3JpZCcsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmdbXX0gYmFzZUNscz1bJ2xlZ2l0LWNvbW1pdC1ncmlkJywnbmVvLWdyaWQtY29udGFpbmVyJ11cbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgYmFzZUNsczogWydsZWdpdC1jb21taXQtZ3JpZCcsICduZW8tZ3JpZC1jb250YWluZXInXSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge09iamVjdH0gYmluZD17c3RvcmU6J3N0b3Jlcy5jb21taXRTdG9yZSd9XG4gICAgICAgICAqL1xuICAgICAgICBiaW5kOiB7c3RvcmU6ICdzdG9yZXMuY29tbWl0U3RvcmUnfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge09iamVjdH0gY29sdW1uRGVmYXVsdHM9e3JlbmRlcmVyOidvbkNvbW1pdENvbHVtblJlbmRlcmVyJ31cbiAgICAgICAgICovXG4gICAgICAgIGNvbHVtbkRlZmF1bHRzOiB7XG4gICAgICAgICAgICByZW5kZXJlcjogJ29uQ29tbWl0Q29sdW1uUmVuZGVyZXInXG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtPYmplY3RbXX0gY29sdW1uc1xuICAgICAgICAgKi9cbiAgICAgICAgY29sdW1uczogW3tcbiAgICAgICAgICAgIGRhdGFGaWVsZDogJ3RpbWVzdGFtcCcsXG4gICAgICAgICAgICB0ZXh0ICAgICA6ICdUaW1lc3RhbXAnLFxuICAgICAgICAgICAgd2lkdGggICAgOiAxNTBcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgZGF0YUZpZWxkOiAnYXV0aG9yJyxcbiAgICAgICAgICAgIHRleHQgICAgIDogJ0F1dGhvcicsXG4gICAgICAgICAgICB3aWR0aCAgICA6IDE1MFxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBkYXRhRmllbGQ6ICdtZXNzYWdlJyxcbiAgICAgICAgICAgIHRleHQgICAgIDogJ01lc3NhZ2UnLFxuICAgICAgICAgICAgZmxleCAgICAgOiAxXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGRhdGFGaWVsZDogJ29pZCcsXG4gICAgICAgICAgICB0ZXh0ICAgICA6ICdPSUQnLFxuICAgICAgICAgICAgd2lkdGggICAgOiAzMDBcbiAgICAgICAgfV1cbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IE5lby5zZXR1cENsYXNzKENvbW1pdEdyaWQpO1xuIiwiaW1wb3J0IEJhc2VWaWV3cG9ydCAgICAgICAgICBmcm9tICcuLi8uLi8uLi9zcmMvY29udGFpbmVyL1ZpZXdwb3J0Lm1qcyc7XG5pbXBvcnQgQnV0dG9uICAgICAgICAgICAgICAgIGZyb20gJy4uLy4uLy4uL3NyYy9idXR0b24vQmFzZS5tanMnO1xuaW1wb3J0IENvbW1pdEdyaWQgICAgICAgICAgICBmcm9tICcuL0NvbW1pdEdyaWQubWpzJztcbmltcG9ydCBDb250YWluZXIgICAgICAgICAgICAgZnJvbSAnLi4vLi4vLi4vc3JjL2NvbnRhaW5lci9CYXNlLm1qcyc7XG5pbXBvcnQgTGl2ZVByZXZpZXcgICAgICAgICAgIGZyb20gJy4uLy4uLy4uL3NyYy9jb2RlL0xpdmVQcmV2aWV3Lm1qcyc7XG5pbXBvcnQgUGFuZWwgICAgICAgICAgICAgICAgIGZyb20gJy4uLy4uLy4uL3NyYy9jb250YWluZXIvUGFuZWwubWpzJztcbmltcG9ydCBUcmVlTGlzdCAgICAgICAgICAgICAgZnJvbSAnLi4vLi4vLi4vc3JjL3RyZWUvTGlzdC5tanMnO1xuaW1wb3J0IFNwbGl0dGVyICAgICAgICAgICAgICBmcm9tICcuLi8uLi8uLi9zcmMvY29tcG9uZW50L1NwbGl0dGVyLm1qcyc7XG5pbXBvcnQgVG9vbGJhciAgICAgICAgICAgICAgIGZyb20gJy4uLy4uLy4uL3NyYy90b29sYmFyL0Jhc2UubWpzJztcbmltcG9ydCBWaWV3cG9ydENvbnRyb2xsZXIgICAgZnJvbSAnLi9WaWV3cG9ydENvbnRyb2xsZXIubWpzJztcbmltcG9ydCBWaWV3cG9ydFN0YXRlUHJvdmlkZXIgZnJvbSAnLi9WaWV3cG9ydFN0YXRlUHJvdmlkZXIubWpzJztcblxuLyoqXG4gKiBAY2xhc3MgTGVnaXQudmlldy5WaWV3cG9ydFxuICogQGV4dGVuZHMgTmVvLmNvbnRhaW5lci5WaWV3cG9ydFxuICovXG5jbGFzcyBWaWV3cG9ydCBleHRlbmRzIEJhc2VWaWV3cG9ydCB7XG4gICAgc3RhdGljIGNvbmZpZyA9IHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gY2xhc3NOYW1lPSdMZWdpdC52aWV3LlZpZXdwb3J0J1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBjbGFzc05hbWU6ICdMZWdpdC52aWV3LlZpZXdwb3J0JyxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ1tdfSBjbHM9WydsZWdpdC12aWV3cG9ydCddXG4gICAgICAgICAqIEByZWFjdGl2ZVxuICAgICAgICAgKi9cbiAgICAgICAgY2xzOiBbJ2xlZ2l0LXZpZXdwb3J0J10sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtOZW8uY29udHJvbGxlci5Db21wb25lbnR9IGNvbnRyb2xsZXI9Vmlld3BvcnRDb250cm9sbGVyXG4gICAgICAgICAqIEByZWFjdGl2ZVxuICAgICAgICAgKi9cbiAgICAgICAgY29udHJvbGxlcjogVmlld3BvcnRDb250cm9sbGVyLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7TmVvLnN0YXRlLlByb3ZpZGVyfSBzdGF0ZVByb3ZpZGVyPVZpZXdwb3J0U3RhdGVQcm92aWRlclxuICAgICAgICAgKiBAcmVhY3RpdmVcbiAgICAgICAgICovXG4gICAgICAgIHN0YXRlUHJvdmlkZXI6IFZpZXdwb3J0U3RhdGVQcm92aWRlcixcbiAgICAgICAgLypcbiAgICAgICAgICogQG1lbWJlciB7T2JqZWN0fSBsYXlvdXQ9e250eXBlOidoYm94JyxhbGlnbjonc3RyZXRjaCd9XG4gICAgICAgICAqL1xuICAgICAgICBsYXlvdXQ6IHtudHlwZTogJ2hib3gnLCBhbGlnbjogJ3N0cmV0Y2gnfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge09iamVjdFtdfSBpdGVtc1xuICAgICAgICAgKi9cbiAgICAgICAgaXRlbXM6IFt7XG4gICAgICAgICAgICBtb2R1bGUgICAgICAgICAgICAgICAgICAgIDogVHJlZUxpc3QsXG4gICAgICAgICAgICBiaW5kICAgICAgICAgICAgICAgICAgICAgIDoge3N0b3JlOiAnc3RvcmVzLmZpbGVTdG9yZSd9LFxuICAgICAgICAgICAgY2xzICAgICAgICAgICAgICAgICAgICAgICA6IFsnbGVnaXQtZmlsZXMtdHJlZSddLFxuICAgICAgICAgICAgbGlzdGVuZXJzICAgICAgICAgICAgICAgICA6IHtsZWFmSXRlbUNsaWNrOiAnb25GaWxlSXRlbUNsaWNrJywgc2VsZWN0OiAnb25UcmVlTGlzdFNlbGVjdCd9LFxuICAgICAgICAgICAgcmVmZXJlbmNlICAgICAgICAgICAgICAgICA6ICdmaWxlcy10cmVlJyxcbiAgICAgICAgICAgIHNob3dDb2xsYXBzZUV4cGFuZEFsbEljb25zOiBmYWxzZSxcbiAgICAgICAgICAgIHdpZHRoICAgICAgICAgICAgICAgICAgICAgOiAzMDAsXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIG1vZHVsZSAgICAgIDogU3BsaXR0ZXIsXG4gICAgICAgICAgICByZXNpemVUYXJnZXQ6ICdwcmV2aW91cycsXG4gICAgICAgICAgICBzaXplICAgICAgICA6IDVcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgbW9kdWxlOiBDb250YWluZXIsXG4gICAgICAgICAgICBmbGV4ICA6IDEsXG4gICAgICAgICAgICBsYXlvdXQ6IHtudHlwZTogJ3Zib3gnLCBhbGlnbjogJ3N0cmV0Y2gnfSxcbiAgICAgICAgICAgIGl0ZW1zOiBbe1xuICAgICAgICAgICAgICAgIG1vZHVsZTogVG9vbGJhcixcbiAgICAgICAgICAgICAgICBmbGV4ICA6ICdub25lJyxcbiAgICAgICAgICAgICAgICBzdHlsZSA6IHttYXJnaW5SaWdodDogJzE1cHgnfSxcbiAgICAgICAgICAgICAgICBpdGVtcyA6WyctPicsIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kdWxlICAgOiBCdXR0b24sXG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkIDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlciAgOiAnb25OZXdGaWxlQnV0dG9uQ2xpY2snLFxuICAgICAgICAgICAgICAgICAgICBpY29uQ2xzICA6ICdmYSBmYS1wbHVzJyxcbiAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlOiAnbmV3LWZpbGUtYnV0dG9uJyxcbiAgICAgICAgICAgICAgICAgICAgdGV4dCAgICAgOiAnTmV3IEZpbGUnXG4gICAgICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgICAgICBtb2R1bGUgICA6IEJ1dHRvbixcbiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQgOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVyICA6ICdvblNhdmVCdXR0b25DbGljaycsXG4gICAgICAgICAgICAgICAgICAgIGljb25DbHMgIDogJ2ZhIGZhLWNsb3VkLXVwbG9hZCcsXG4gICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZTogJ3NhdmUtYnV0dG9uJyxcbiAgICAgICAgICAgICAgICAgICAgc3R5bGUgICAgOiB7bWFyZ2luTGVmdDogJy41ZW0nfSxcbiAgICAgICAgICAgICAgICAgICAgdGV4dCAgICAgOiAnU2F2ZSdcbiAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIG1vZHVsZSAgIDogTGl2ZVByZXZpZXcsXG4gICAgICAgICAgICAgICAgZmxleCAgICAgOiAzLFxuICAgICAgICAgICAgICAgIGxhbmd1YWdlIDogJ21hcmtkb3duJyxcbiAgICAgICAgICAgICAgICBsaXN0ZW5lcnM6IHtlZGl0b3JDaGFuZ2U6ICdvbkVkaXRvckNoYW5nZSd9LFxuICAgICAgICAgICAgICAgIHJlZmVyZW5jZTogJ2NvZGUtbGl2ZS1wcmV2aWV3JyxcbiAgICAgICAgICAgICAgICBzdHlsZSA6IHttYXJnaW46ICcyMHB4J31cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBtb2R1bGUgICAgICA6IFNwbGl0dGVyLFxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbiAgIDogJ2hvcml6b250YWwnLFxuICAgICAgICAgICAgICAgIHJlc2l6ZVRhcmdldDogJ3ByZXZpb3VzJyxcbiAgICAgICAgICAgICAgICBzaXplICAgICAgICA6IDVcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBtb2R1bGU6IFBhbmVsLFxuICAgICAgICAgICAgICAgIGNscyAgIDogWydsZWdpdC1jb21taXQtZ3JpZC1wYW5lbCddLFxuICAgICAgICAgICAgICAgIGZsZXggIDogMSxcbiAgICAgICAgICAgICAgICBzdHlsZSA6IHttYXJnaW46ICcyMHB4J30sXG4gICAgICAgICAgICAgICAgaGVhZGVyczogW3tcbiAgICAgICAgICAgICAgICAgICAgZG9jazogJ3RvcCcsXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdMZWdpdCBIaXN0b3J5J1xuICAgICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICAgIGl0ZW1zIDogW3tcbiAgICAgICAgICAgICAgICAgICAgbW9kdWxlICAgICAgOiBDb21taXRHcmlkLFxuICAgICAgICAgICAgICAgICAgICB3cmFwcGVyU3R5bGU6IHttaW5IZWlnaHQ6ICcyMDBweCd9XG4gICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgIH1dXG4gICAgICAgIH1dXG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBOZW8uc2V0dXBDbGFzcyhWaWV3cG9ydCk7XG4iLCJpbXBvcnQgQ29tcG9uZW50ICAgIGZyb20gJy4uLy4uLy4uL3NyYy9jb250cm9sbGVyL0NvbXBvbmVudC5tanMnO1xuaW1wb3J0IExlZ2l0U2VydmljZSBmcm9tICcuLi9zZXJ2aWNlL0xlZ2l0Lm1qcyc7XG5cbi8qKlxuICogQGNsYXNzIExlZ2l0LnZpZXcuVmlld3BvcnRDb250cm9sbGVyXG4gKiBAZXh0ZW5kcyBOZW8uY29udHJvbGxlci5Db21wb25lbnRcbiAqL1xuY2xhc3MgVmlld3BvcnRDb250cm9sbGVyIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J0xlZ2l0LnZpZXcuVmlld3BvcnRDb250cm9sbGVyJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBjbGFzc05hbWU6ICdMZWdpdC52aWV3LlZpZXdwb3J0Q29udHJvbGxlcicsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtOdW1iZXJ9IHBvbGxpbmdJbnRlcnZhbD0xMDAwXG4gICAgICAgICAqL1xuICAgICAgICBwb2xsaW5nSW50ZXJ2YWw6IDEwMDBcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAbWVtYmVyIHtOZW8uZGlhbG9nLkJhc2V8bnVsbH1cbiAgICAgKi9cbiAgICBhZGREaWFsb2cgPSBudWxsXG4gICAgLyoqXG4gICAgICogQG1lbWJlciB7U3RyaW5nfSBjdXJyZW50VHJlZVN0YXRlPW51bGxcbiAgICAgKi9cbiAgICBjdXJyZW50VHJlZVN0YXRlID0gbnVsbFxuICAgIC8qKlxuICAgICAqIEBtZW1iZXIge0Jvb2xlYW59IHJ1bm5pbmc9ZmFsc2VcbiAgICAgKi9cbiAgICBydW5uaW5nID0gZmFsc2VcblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPHZvaWQ+fVxuICAgICAqL1xuICAgIGFzeW5jIGluaXRBc3luYygpIHtcbiAgICAgICAgYXdhaXQgc3VwZXIuaW5pdEFzeW5jKCk7XG5cbiAgICAgICAgY29uc3QgbWUgPSB0aGlzO1xuXG4gICAgICAgIGF3YWl0IExlZ2l0U2VydmljZS5yZWFkeSgpO1xuXG4gICAgICAgIG1lLmdldFJlZmVyZW5jZSgnbmV3LWZpbGUtYnV0dG9uJykuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgbWUuZ2V0UmVmZXJlbmNlKCdzYXZlLWJ1dHRvbicpICAgIC5kaXNhYmxlZCA9IGZhbHNlO1xuXG4gICAgICAgIHNldEludGVydmFsKG1lLnBvbGwuYmluZChtZSksIG1lLnBvbGxpbmdJbnRlcnZhbClcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqL1xuICAgIGFzeW5jIG9uQWRkRmlsZURpYWxvZ1NhdmUoZGF0YSkge1xuICAgICAgICBjb25zdFxuICAgICAgICAgICAgbWUgICAgICAgID0gdGhpcyxcbiAgICAgICAgICAgIGRpYWxvZyAgICA9IG1lLmFkZERpYWxvZyxcbiAgICAgICAgICAgIHRleHRGaWVsZCA9IGRpYWxvZy5nZXRSZWZlcmVuY2UoJ2ZpbGVuYW1lJyksXG4gICAgICAgICAgICBmaWxlUGF0aCAgPSBgJHtMZWdpdFNlcnZpY2UucGF0aH0vJHt0ZXh0RmllbGQudmFsdWV9YDtcblxuICAgICAgICBkaWFsb2cuaGlkZSgpO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCdvbkFkZEZpbGVEaWFsb2dTYXZlJywgdGV4dEZpZWxkLnZhbHVlKTtcbiAgICAgICAgYXdhaXQgTGVnaXRTZXJ2aWNlLndyaXRlRmlsZSh7XG4gICAgICAgICAgICBkYXRhOiAnJyxcbiAgICAgICAgICAgIHBhdGg6IGZpbGVQYXRoXG4gICAgICAgIH0pO1xuXG4gICAgICAgIG1lLnNldFN0YXRlKHtjdXJyZW50RmlsZTogZmlsZVBhdGh9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqL1xuICAgIG9uQ29tbWl0Q29sdW1uUmVuZGVyZXIoZGF0YSkge1xuICAgICAgICBpZiAoZGF0YS5kYXRhRmllbGQgPT09ICdhdXRob3InKSB7XG4gICAgICAgICAgICByZXR1cm4gZGF0YS52YWx1ZS5uYW1lO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRhdGEuZGF0YUZpZWxkID09PSAndGltZXN0YW1wJykge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBJbnRsLkRhdGVUaW1lRm9ybWF0KCdkZWZhdWx0Jywge1xuICAgICAgICAgICAgICAgIGhvdXI6ICdudW1lcmljJyxcbiAgICAgICAgICAgICAgICBtaW51dGU6ICdudW1lcmljJyxcbiAgICAgICAgICAgICAgICBzZWNvbmQ6ICdudW1lcmljJ1xuICAgICAgICAgICAgfSkuZm9ybWF0KG5ldyBEYXRlKGRhdGEudmFsdWUgKiAxMDAwKSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZGF0YS52YWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge1JlY29yZH0gcmVjb3JkXG4gICAgICovXG4gICAgb25GaWxlSXRlbUNsaWNrKHJlY29yZCkge1xuICAgICAgICBjb25zb2xlLmxvZygnb25GaWxlSXRlbUNsaWNrJywgcmVjb3JkKVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSBkYXRhXG4gICAgICogQHJldHVybnMge1Byb21pc2U8dm9pZD59XG4gICAgICovXG4gICAgYXN5bmMgb25FZGl0b3JDaGFuZ2UoZGF0YSkge1xuICAgICAgICAvLyBjb25zb2xlLmxvZygnb25FZGl0b3JDaGFuZ2UnLCBkYXRhKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gZGF0YVxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPHZvaWQ+fVxuICAgICAqL1xuICAgIGFzeW5jIG9uTmV3RmlsZUJ1dHRvbkNsaWNrKGRhdGEpIHtcbiAgICAgICAgbGV0IG1lICAgICAgICAgID0gdGhpcyxcbiAgICAgICAgICAgIHthZGREaWFsb2d9ID0gbWUsXG4gICAgICAgICAgICBidXR0b24gICAgICA9IGRhdGEuY29tcG9uZW50LFxuICAgICAgICAgICAge2FwcE5hbWUsIHRoZW1lLCB3aW5kb3dJZH0gPSBidXR0b247XG5cbiAgICAgICAgYnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcblxuICAgICAgICBpZiAoIWFkZERpYWxvZykge1xuICAgICAgICAgICAgaW1wb3J0KCcuL0FkZEZpbGVEaWFsb2cubWpzJykudGhlbihtb2R1bGUgPT4ge1xuICAgICAgICAgICAgICAgIG1lLmFkZERpYWxvZyA9IE5lby5jcmVhdGUoe1xuICAgICAgICAgICAgICAgICAgICBtb2R1bGUgICAgICAgICA6IG1vZHVsZS5kZWZhdWx0LFxuICAgICAgICAgICAgICAgICAgICBhbmltYXRlVGFyZ2V0SWQ6IGJ1dHRvbi5pZCxcbiAgICAgICAgICAgICAgICAgICAgYXBwTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgbGlzdGVuZXJzICAgICAgOiB7aGlkZTogZGF0YSA9PiB7YnV0dG9uLmRpc2FibGVkID0gZmFsc2V9fSxcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50Q29tcG9uZW50OiBtZS5jb21wb25lbnQsXG4gICAgICAgICAgICAgICAgICAgIHRoZW1lLFxuICAgICAgICAgICAgICAgICAgICB3aW5kb3dJZFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYWRkRGlhbG9nLnNob3coKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGFcbiAgICAgKi9cbiAgICBhc3luYyBvblNhdmVCdXR0b25DbGljayhkYXRhKSB7XG4gICAgICAgIGNvbnN0XG4gICAgICAgICAgICBtZSAgICAgICAgICA9IHRoaXMsXG4gICAgICAgICAgICBsaXZlUHJldmlldyA9IG1lLmdldFJlZmVyZW5jZSgnY29kZS1saXZlLXByZXZpZXcnKSxcbiAgICAgICAgICAgIGN1cnJlbnRGaWxlID0gbWUuZ2V0U3RhdGUoJ2N1cnJlbnRGaWxlJyk7XG5cbiAgICAgICAgY29uc29sZS5sb2coJ29uU2F2ZUJ1dHRvbkNsaWNrJywgbWUuZ2V0U3RhdGUoJ2N1cnJlbnRGaWxlJyksIGxpdmVQcmV2aWV3LnZhbHVlKTtcblxuICAgICAgICBhd2FpdCBMZWdpdFNlcnZpY2Uud3JpdGVGaWxlKHtcbiAgICAgICAgICAgIGRhdGE6IGxpdmVQcmV2aWV3LnZhbHVlLFxuICAgICAgICAgICAgcGF0aDogYCR7TGVnaXRTZXJ2aWNlLnBhdGh9LyR7Y3VycmVudEZpbGV9YFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gICBkYXRhXG4gICAgICogQHBhcmFtIHtSZWNvcmRbXX0gZGF0YS5yZWNvcmRzXG4gICAgICogQHBhcmFtIHtTdHJpbmdbXX0gZGF0YS5zZWxlY3Rpb24gLy8gc2VsZWN0ZWQgZG9tIG5vZGUgaWRzXG4gICAgICogQHBhcmFtIHtTdHJpbmd9ICAgZGF0YS5zb3VyY2UgICAgLy8gaWQgb2YgdGhlIGV2ZW50LWZpcmluZyBpbnN0YW5jZVxuICAgICAqL1xuICAgIGFzeW5jIG9uVHJlZUxpc3RTZWxlY3Qoe3JlY29yZHN9KSB7XG4gICAgICAgIGNvbnN0XG4gICAgICAgICAgICBsaXZlUHJldmlldyA9IHRoaXMuZ2V0UmVmZXJlbmNlKCdjb2RlLWxpdmUtcHJldmlldycpLFxuICAgICAgICAgICAgcmVjb3JkICAgICAgPSByZWNvcmRzPy5bMF0sXG4gICAgICAgICAgICBsYW5ndWFnZSAgICA9IHJlY29yZC5pZC5pbmNsdWRlcygnLm1kJykgPyAnbWFya2Rvd24nIDogJ25lb21qcyc7XG5cbiAgICAgICAgaWYgKHJlY29yZD8uaXNMZWFmKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtjdXJyZW50RmlsZTogcmVjb3JkLmlkfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gYXdhaXQgTGVnaXRTZXJ2aWNlLnJlYWRGaWxlKGAke0xlZ2l0U2VydmljZS5wYXRofS8ke3JlY29yZC5pZH1gLCAndXRmLTgnKTtcblxuICAgICAgICAgICAgYXdhaXQgbGl2ZVByZXZpZXcuc2V0KHtsYW5ndWFnZSwgdmFsdWV9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPHZvaWQ+fVxuICAgICAqL1xuICAgIGFzeW5jIHBvbGwoKSB7XG4gICAgICAgIGxldCBtZSA9IHRoaXM7XG5cbiAgICAgICAgaWYgKG1lLnJ1bm5pbmcpIHtcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIG1lLnJ1bm5pbmcgPSB0cnVlO1xuXG4gICAgICAgICAgICBsZXQgbmV3U3RhdGUgPSBhd2FpdCBMZWdpdFNlcnZpY2UucmVhZEZpbGUoTGVnaXRTZXJ2aWNlLnBhdGggKyAnLy5sZWdpdC9oZWFkJywgJ3V0Zi04Jyk7XG5cbiAgICAgICAgICAgIGlmIChtZS5jdXJyZW50VHJlZVN0YXRlID09PSBuZXdTdGF0ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgY29tbWl0U3RvcmUgPSBtZS5nZXRTdG9yZSgnY29tbWl0U3RvcmUnKTtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVTdG9yZSAgID0gbWUuZ2V0U3RvcmUoJ2ZpbGVTdG9yZScpO1xuICAgICAgICAgICAgY29uc3QgdHJlZURlbHRhICAgPSBhd2FpdCBMZWdpdFNlcnZpY2UubG9hZFRyZWVEZWx0YShtZS5jdXJyZW50VHJlZVN0YXRlLCBuZXdTdGF0ZSk7XG5cbiAgICAgICAgICAgIGNvbW1pdFN0b3JlLmRhdGEgPSBhd2FpdCBMZWdpdFNlcnZpY2UubG9hZEhpc3RvcnkoKTtcblxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1RSRUUgREVMVEE6JywgdHJlZURlbHRhKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZGVsZXRlZEVudHJ5IG9mIHRyZWVEZWx0YS5kZWxldGVkKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0RlbGV0ZWQgRlJPTSBUUkVFOiAnICsgZGVsZXRlZEVudHJ5KTtcbiAgICAgICAgICAgICAgICBmaWxlU3RvcmUucmVtb3ZlKGRlbGV0ZWRFbnRyeSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9yIChjb25zdCBhZGRlZEVudHJ5IG9mIHRyZWVEZWx0YS5hZGRlZCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdBZGRlZCBGcm9tIFRyZWU6JyArIGFkZGVkRW50cnkpO1xuICAgICAgICAgICAgICAgIGZpbGVTdG9yZS5pbnNlcnQoMCwge1xuICAgICAgICAgICAgICAgICAgICBpZCAgICAgIDogYWRkZWRFbnRyeSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZSAgICA6IGFkZGVkRW50cnksXG4gICAgICAgICAgICAgICAgICAgIHBhcmVudElkOiBudWxsXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9yIChjb25zdCBtb2RpZmllZEVudHJ5IG9mIHRyZWVEZWx0YS5tb2RpZmllZCkge1xuICAgICAgICAgICAgICAgIC8vIGNvbnN0IG5ld0l0ZW0gPSBhd2FpdCBsZWdpdEZzLnJlYWRGaWxlKHBhdGggKyAnLycgKyBhZGRlZEVudHJ5LCAndXRmOCcpO1xuICAgICAgICAgICAgICAgIC8vIHRvZG8gdXBkYXRlIGl0ZW0gaW4gdHJlZSBzdG9yZVxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdNT0RJRklFRCBGcm9tIFRyZWU6JyArIG1vZGlmaWVkRW50cnkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBtZS5jdXJyZW50VHJlZVN0YXRlID0gbmV3U3RhdGU7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICBtZS5ydW5uaW5nID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGxldCBzZWxlY3Rpb25Nb2RlbCA9IG1lLmdldFJlZmVyZW5jZSgnZmlsZXMtdHJlZScpLnNlbGVjdGlvbk1vZGVsO1xuXG4gICAgICAgICAgICBpZiAoIXNlbGVjdGlvbk1vZGVsLmhhc1NlbGVjdGlvbigpKSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uTW9kZWwuc2VsZWN0QXQoMClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgTmVvLnNldHVwQ2xhc3MoVmlld3BvcnRDb250cm9sbGVyKTtcbiIsImltcG9ydCBDb21taXRTdG9yZSBmcm9tICcuLi9zdG9yZS9Db21taXRzLm1qcyc7XG5pbXBvcnQgRmlsZVN0b3JlICAgZnJvbSAnLi4vc3RvcmUvRmlsZXMubWpzJztcbmltcG9ydCBQcm92aWRlciAgICBmcm9tICcuLi8uLi8uLi9zcmMvc3RhdGUvUHJvdmlkZXIubWpzJztcblxuLyoqXG4gKiBAY2xhc3MgTGVnaXQudmlldy5WaWV3cG9ydFN0YXRlUHJvdmlkZXJcbiAqIEBleHRlbmRzIE5lby5zdGF0ZS5Qcm92aWRlclxuICovXG5jbGFzcyBWaWV3cG9ydFN0YXRlUHJvdmlkZXIgZXh0ZW5kcyBQcm92aWRlciB7XG4gICAgc3RhdGljIGNvbmZpZyA9IHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gY2xhc3NOYW1lPSdMZWdpdC52aWV3LlZpZXdwb3J0U3RhdGVQcm92aWRlcidcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgY2xhc3NOYW1lOiAnTGVnaXQudmlldy5WaWV3cG9ydFN0YXRlUHJvdmlkZXInLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7T2JqZWN0fSBkYXRhXG4gICAgICAgICAqL1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEBtZW1iZXIge1N0cmluZ3xudWxsfSBkYXRhLmN1cnJlbnRGaWxlPW51bGxcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgY3VycmVudEZpbGU6IG51bGxcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge09iamVjdH0gc3RvcmVzXG4gICAgICAgICAqL1xuICAgICAgICBzdG9yZXM6IHtcbiAgICAgICAgICAgIGNvbW1pdFN0b3JlOiBDb21taXRTdG9yZSxcbiAgICAgICAgICAgIGZpbGVTdG9yZSAgOiBGaWxlU3RvcmVcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgTmVvLnNldHVwQ2xhc3MoVmlld3BvcnRTdGF0ZVByb3ZpZGVyKTsiLCJpbXBvcnQgQ29tcG9uZW50IGZyb20gJy4vQmFzZS5tanMnO1xuXG4vKipcbiAqIEBjbGFzcyBOZW8uY29tcG9uZW50LkNhbnZhc1xuICogQGV4dGVuZHMgTmVvLmNvbXBvbmVudC5CYXNlXG4gKi9cbmNsYXNzIENhbnZhcyBleHRlbmRzIENvbXBvbmVudCB7XG4gICAgc3RhdGljIGNvbmZpZyA9IHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gY2xhc3NOYW1lPSdOZW8uY29tcG9uZW50LkNhbnZhcydcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgY2xhc3NOYW1lOiAnTmVvLmNvbXBvbmVudC5DYW52YXMnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBudHlwZT0nY2FudmFzJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBudHlwZTogJ2NhbnZhcycsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiB0cnVlIGFwcGxpZXMgYSBtYWluLmFkZG9uLlJlc2l6ZU9ic2VydmVyIGFuZCBmaXJlcyBhIGN1c3RvbSByZXNpemUgZXZlbnRcbiAgICAgICAgICogd2hpY2ggb3RoZXIgaW5zdGFuY2VzIGNhbiBzdWJzY3JpYmUgdG8uXG4gICAgICAgICAqIEBtZW1iZXIge0Jvb2xlYW59IG1vbml0b3JTaXplXz10cnVlXG4gICAgICAgICAqIEByZWFjdGl2ZVxuICAgICAgICAgKi9cbiAgICAgICAgbW9uaXRvclNpemVfOiB0cnVlLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7Qm9vbGVhbn0gb2Zmc2NyZWVuPXRydWVcbiAgICAgICAgICovXG4gICAgICAgIG9mZnNjcmVlbjogdHJ1ZSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE9ubHkgYXBwbGljYWJsZSBpZiBvZmZzY3JlZW4gPT09IHRydWUuXG4gICAgICAgICAqIHRydWUgb25jZSB0aGUgb3duZXJzaGlwIG9mIHRoZSBjYW52YXMgbm9kZSBnb3QgdHJhbnNmZXJyZWQgdG8gd29ya2VyLkNhbnZhcy5cbiAgICAgICAgICogQG1lbWJlciB7Qm9vbGVhbn0gb2Zmc2NyZWVuUmVnaXN0ZXJlZF89ZmFsc2VcbiAgICAgICAgICogQHJlYWN0aXZlXG4gICAgICAgICAqL1xuICAgICAgICBvZmZzY3JlZW5SZWdpc3RlcmVkXzogZmFsc2UsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtPYmplY3R9IF92ZG9tPXt0YWc6ICdjYW52YXMnfVxuICAgICAgICAgKi9cbiAgICAgICAgX3Zkb206XG4gICAgICAgIHt0YWc6ICdjYW52YXMnfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRyaWdnZXJlZCBhZnRlciB0aGUgbW91bnRlZCBjb25maWcgZ290IGNoYW5nZWRcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IHZhbHVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBvbGRWYWx1ZVxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBhc3luYyBhZnRlclNldE1vdW50ZWQodmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgICAgIHN1cGVyLmFmdGVyU2V0TW91bnRlZCh2YWx1ZSwgb2xkVmFsdWUpO1xuXG4gICAgICAgIGxldCBtZSAgICAgICAgICAgICAgICAgICAgPSB0aGlzLFxuICAgICAgICAgICAgaWQgICAgICAgICAgICAgICAgICAgID0gbWUuZ2V0Q2FudmFzSWQoKSxcbiAgICAgICAgICAgIHtvZmZzY3JlZW4sIHdpbmRvd0lkfSA9IG1lO1xuXG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgYXdhaXQgbWUudGltZW91dCgzMCk7IC8vIG5leHQgckFGIHRpY2tcblxuICAgICAgICAgICAgaWYgKG1lLm1vbml0b3JTaXplKSB7XG4gICAgICAgICAgICAgICAgbWUuYWRkRG9tTGlzdGVuZXJzKFt7XG4gICAgICAgICAgICAgICAgICAgIGRlbGVnYXRlOiBgIyR7bWUuZ2V0TW9uaXRvclRhcmdldElkKCl9YCxcbiAgICAgICAgICAgICAgICAgICAgcmVzaXplICA6IG1lLm9uRG9tUmVzaXplLFxuICAgICAgICAgICAgICAgICAgICBzY29wZSAgIDogbWVcbiAgICAgICAgICAgICAgICB9XSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG9mZnNjcmVlbikge1xuICAgICAgICAgICAgICAgIGxldCBkYXRhLFxuICAgICAgICAgICAgICAgICAgICBkZWxheSA9IDUwO1xuXG4gICAgICAgICAgICAgICAgd2hpbGUgKG1lLm1vdW50ZWQgJiYgIW1lLm9mZnNjcmVlblJlZ2lzdGVyZWQgJiYgIW1lLmlzRGVzdHJveWVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBhd2FpdCBOZW8ubWFpbi5Eb21BY2Nlc3MuZ2V0T2Zmc2NyZWVuQ2FudmFzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZDogaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3dJZFxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5vZmZzY3JlZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IE5lby53b3JrZXIuQ2FudmFzLnJlZ2lzdGVyQ2FudmFzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlICA6IGRhdGEub2Zmc2NyZWVuLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZDogaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93SWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIFtkYXRhLm9mZnNjcmVlbl0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBtZS5vZmZzY3JlZW5SZWdpc3RlcmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YS50cmFuc2ZlcnJlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKE5lby5jb25maWcudXNlU2hhcmVkV29ya2Vycykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXRyaWV2ZURhdGEgPSBhd2FpdCBOZW8ud29ya2VyLkNhbnZhcy5yZXRyaWV2ZUNhbnZhcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVJZDogaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvd0lkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmV0cmlldmVEYXRhLmhhc0NhbnZhcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZS5vZmZzY3JlZW5SZWdpc3RlcmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBtZS50aW1lb3V0KGRlbGF5KTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoZGVsYXkgPCAxMDAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxheSAqPSAyXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAob2Zmc2NyZWVuKSB7XG4gICAgICAgICAgICBpZiAobWUub2Zmc2NyZWVuUmVnaXN0ZXJlZCkge1xuICAgICAgICAgICAgICAgIE5lby53b3JrZXIuQ2FudmFzLnVucmVnaXN0ZXJDYW52YXMoe1xuICAgICAgICAgICAgICAgICAgICBub2RlSWQ6IGlkXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbWUub2Zmc2NyZWVuUmVnaXN0ZXJlZCA9IGZhbHNlXG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIFRyaWdnZXJlZCBhZnRlciB0aGUgd2luZG93SWQgY29uZmlnIGdvdCBjaGFuZ2VkXG4gICAgICogQHBhcmFtIHtTdHJpbmd8bnVsbH0gdmFsdWVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ3xudWxsfSBvbGRWYWx1ZVxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBhZnRlclNldFdpbmRvd0lkKHZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICBzdXBlci5hZnRlclNldFdpbmRvd0lkKHZhbHVlLCBvbGRWYWx1ZSk7XG5cbiAgICAgICAgaWYgKG9sZFZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLm9mZnNjcmVlblJlZ2lzdGVyZWQgPSBmYWxzZVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHsuLi4qfSBhcmdzXG4gICAgICovXG4gICAgZGVzdHJveSguLi5hcmdzKSB7XG4gICAgICAgIGlmICh0aGlzLm9mZnNjcmVlblJlZ2lzdGVyZWQpIHtcbiAgICAgICAgICAgIE5lby53b3JrZXIuQ2FudmFzLnVucmVnaXN0ZXJDYW52YXMoe1xuICAgICAgICAgICAgICAgIG5vZGVJZDogdGhpcy5pZFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuXG4gICAgICAgIHN1cGVyLmRlc3Ryb3koLi4uYXJncylcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPdmVycmlkZSB0aGlzIG1ldGhvZCB3aGVuIHVzaW5nIHdyYXBwZXJzIChlLmcuIEQzKVxuICAgICAqIEByZXR1cm5zIHtTdHJpbmd9XG4gICAgICovXG4gICAgZ2V0Q2FudmFzSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlkXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIERPTSBub2RlIElEIHRoYXQgc2hvdWxkIHRyaWdnZXIgdGhlIGNhbnZhcyByZXNpemUgdXBkYXRlcy5cbiAgICAgKiBCeSBkZWZhdWx0LCB0aGlzIGlzIHRoZSBjb21wb25lbnQncyB0b3AtbGV2ZWwgd3JhcHBlciBJRC5cbiAgICAgKiBTdWJjbGFzc2VzIGNhbiBvdmVycmlkZSB0aGlzIHRvIG9ic2VydmUgYSBkaWZmZXJlbnQgbm9kZSAoZS5nLiBhIHBhcmVudCBjb250YWluZXIpLlxuICAgICAqIEByZXR1cm5zIHtTdHJpbmd9XG4gICAgICovXG4gICAgZ2V0TW9uaXRvclRhcmdldElkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy52ZG9tLmlkXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGFcbiAgICAgKi9cbiAgICBvbkRvbVJlc2l6ZShkYXRhKSB7XG4gICAgICAgIHRoaXMuZmlyZSgncmVzaXplJywgZGF0YSlcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IE5lby5zZXR1cENsYXNzKENhbnZhcyk7XG4iLCJpbXBvcnQgQ29tcG9uZW50IGZyb20gJy4vQmFzZS5tanMnO1xuXG4vKipcbiAqIENvbnZlbmllbmNlIGNsYXNzIHRvIHJlbmRlciBhIGxhYmVsIHdpdGggYSB0ZXh0XG4gKiBAY2xhc3MgTmVvLmNvbXBvbmVudC5MYWJlbFxuICogQGV4dGVuZHMgTmVvLmNvbXBvbmVudC5CYXNlXG4gKi9cbmNsYXNzIExhYmVsIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J05lby5jb21wb25lbnQuTGFiZWwnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ05lby5jb21wb25lbnQuTGFiZWwnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBudHlwZT0nbGFiZWwnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIG50eXBlOiAnbGFiZWwnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nW119IGJhc2VDbHM9WyduZW8tbGFiZWwnXVxuICAgICAgICAgKi9cbiAgICAgICAgYmFzZUNsczogWyduZW8tbGFiZWwnXSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gdGFnPSdsYWJlbCdcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKiBAcmVhY3RpdmVcbiAgICAgICAgICovXG4gICAgICAgIHRhZzogJ2xhYmVsJ1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgTmVvLnNldHVwQ2xhc3MoTGFiZWwpO1xuIiwiaW1wb3J0IENvbnRhaW5lciBmcm9tICcuL0Jhc2UubWpzJztcbmltcG9ydCBUb29sYmFyICAgZnJvbSAnLi4vdG9vbGJhci9CYXNlLm1qcyc7XG5cbi8qKlxuICogQW4gZXh0ZW5kZWQgQ29udGFpbmVyIHN1cHBvcnRpbmcgbXVsdGlwbGUgZG9ja2VkIGhlYWRlciB0b29sYmFyc1xuICogQGNsYXNzIE5lby5jb250YWluZXIuUGFuZWxcbiAqIEBleHRlbmRzIE5lby5jb250YWluZXIuQmFzZVxuICovXG5jbGFzcyBQYW5lbCBleHRlbmRzIENvbnRhaW5lciB7XG4gICAgc3RhdGljIGNvbmZpZyA9IHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gY2xhc3NOYW1lPSdOZW8uY29udGFpbmVyLlBhbmVsJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBjbGFzc05hbWU6ICdOZW8uY29udGFpbmVyLlBhbmVsJyxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gbnR5cGU9J3BhbmVsJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBudHlwZTogJ3BhbmVsJyxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ1tdfSBiYXNlQ2xzPVsnbmVvLXBhbmVsJywnbmVvLWNvbnRhaW5lciddXG4gICAgICAgICAqL1xuICAgICAgICBiYXNlQ2xzOiBbJ25lby1wYW5lbCcsICduZW8tY29udGFpbmVyJ10sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtPYmplY3R9IGNvbnRhaW5lckNvbmZpZz1udWxsXG4gICAgICAgICAqL1xuICAgICAgICBjb250YWluZXJDb25maWc6IG51bGwsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtPYmplY3R9IGhlYWRlckRlZmF1bHRzPW51bGxcbiAgICAgICAgICovXG4gICAgICAgIGhlYWRlckRlZmF1bHRzOiBudWxsLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7QXJyYXl9IGhlYWRlcnM9bnVsbFxuICAgICAgICAgKi9cbiAgICAgICAgaGVhZGVyczogbnVsbCxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge09iamVjdH0gaXRlbXM9e250eXBlOiAndmJveCcsIGFsaWduOiAnc3RyZXRjaCd9XG4gICAgICAgICAqIEByZWFjdGl2ZVxuICAgICAgICAgKi9cbiAgICAgICAgX2xheW91dDoge1xuICAgICAgICAgICAgbnR5cGU6ICd2Ym94JyxcbiAgICAgICAgICAgIGFsaWduOiAnc3RyZXRjaCdcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge0Jvb2xlYW59IHZlcnRpY2FsSGVhZGVyc0ZpcnN0PWZhbHNlXG4gICAgICAgICAqL1xuICAgICAgICB2ZXJ0aWNhbEhlYWRlcnNGaXJzdDogZmFsc2VcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnXG4gICAgICovXG4gICAgY29uc3RydWN0KGNvbmZpZykge1xuICAgICAgICBzdXBlci5jb25zdHJ1Y3QoY29uZmlnKTtcblxuICAgICAgICBsZXQgbWUgPSB0aGlzO1xuXG4gICAgICAgIGlmIChtZS5oYXNIZWFkZXJzKCkgJiYgbWUudmVydGljYWxIZWFkZXJzRmlyc3QgPT09IHRydWUpIHtcbiAgICAgICAgICAgIG1lLmxheW91dCA9IHtcbiAgICAgICAgICAgICAgICBudHlwZTogJ2hib3gnLFxuICAgICAgICAgICAgICAgIGFsaWduOiAnc3RyZXRjaCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gaGVhZGVyIHRoZSBoZWFkZXIgY29uZmlnXG4gICAgICogQHJldHVybnMge09iamVjdH1cbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlYXRlSGVhZGVyQ29uZmlnKGhlYWRlcikge1xuICAgICAgICBpZiAoTmVvLnR5cGVPZihoZWFkZXIpID09PSAnTmVvSW5zdGFuY2UnKSB7XG4gICAgICAgICAgICByZXR1cm4gaGVhZGVyO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGNvbmZpZyA9IHtcbiAgICAgICAgICAgIGZsZXg6ICcwIDEgYXV0bydcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoIWhlYWRlci5tb2R1bGUgJiYgIWhlYWRlci5udHlwZSkge1xuICAgICAgICAgICAgY29uZmlnLmNscyAgID0gWyduZW8tcGFuZWwtaGVhZGVyLXRvb2xiYXInLCAnbmVvLXRvb2xiYXInXTtcbiAgICAgICAgICAgIGNvbmZpZy5udHlwZSA9ICd0b29sYmFyJztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChoZWFkZXIudGV4dCkge1xuICAgICAgICAgICAgY29uZmlnLml0ZW1zID0gW3tcbiAgICAgICAgICAgICAgICBudHlwZTogJ2xhYmVsJyxcbiAgICAgICAgICAgICAgICBjbHMgIDogWyduZW8tcGFuZWwtaGVhZGVyLXRleHQnLCAnbmVvLWxhYmVsJ10sXG4gICAgICAgICAgICAgICAgdGV4dCA6IGhlYWRlci50ZXh0XG4gICAgICAgICAgICB9XTtcblxuICAgICAgICAgICAgZGVsZXRlIGhlYWRlci50ZXh0O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gYXNzdW1pbmcgYWxsIGxhYmVscyBpbnNpZGUgYSBQYW5lbCBIZWFkZXIgYXJlIG1lYW50IHRvIGJlIHRpdGxlcyAtPiBsb29rIHRoZSBzYW1lIHdheVxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShoZWFkZXIuaXRlbXMpKSB7XG4gICAgICAgICAgICBoZWFkZXIuaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoaXRlbS5udHlwZSA9PT0gJ2xhYmVsJykge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLmNscyA9IFsnbmVvLXBhbmVsLWhlYWRlci10ZXh0JywgJ25lby1sYWJlbCddO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsuLi5jb25maWcsIC4uLmhlYWRlcn1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqL1xuICAgIGNyZWF0ZUl0ZW1zKCkge1xuICAgICAgICBsZXQgbWUgICAgICAgICAgICAgID0gdGhpcyxcbiAgICAgICAgICAgIGNvbnRhaW5lckNvbmZpZyA9IG1lLmNvbnRhaW5lckNvbmZpZztcblxuICAgICAgICBpZiAoIW1lLmhhc0hlYWRlcnMoKSkge1xuICAgICAgICAgICAgY29udGFpbmVyQ29uZmlnICYmIG1lLnNldChjb250YWluZXJDb25maWcpO1xuICAgICAgICAgICAgc3VwZXIuY3JlYXRlSXRlbXMoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCBoZiAgICAgICAgICAgICAgICAgICA9IG1lLnZlcnRpY2FsSGVhZGVyc0ZpcnN0ID09PSBmYWxzZSxcbiAgICAgICAgICAgICAgICBoZWFkZXJzICAgICAgICAgICAgICA9IG1lLmhlYWRlcnMgfHwgW10sXG4gICAgICAgICAgICAgICAgYm90dG9tSGVhZGVycyAgICAgICAgPSBoZWFkZXJzLmZpbHRlcihoZWFkZXIgPT4ge3JldHVybiBoZWFkZXIuZG9jayA9PT0gKGhmID8nYm90dG9tJzogJ3JpZ2h0Jyl9KSxcbiAgICAgICAgICAgICAgICBsZWZ0SGVhZGVycyAgICAgICAgICA9IGhlYWRlcnMuZmlsdGVyKGhlYWRlciA9PiB7cmV0dXJuIGhlYWRlci5kb2NrID09PSAoaGYgPydsZWZ0JyAgOiAndG9wJyl9KSxcbiAgICAgICAgICAgICAgICByaWdodEhlYWRlcnMgICAgICAgICA9IGhlYWRlcnMuZmlsdGVyKGhlYWRlciA9PiB7cmV0dXJuIGhlYWRlci5kb2NrID09PSAoaGYgPydyaWdodCcgOiAnYm90dG9tJyl9KSxcbiAgICAgICAgICAgICAgICB0b3BIZWFkZXJzICAgICAgICAgICA9IGhlYWRlcnMuZmlsdGVyKGhlYWRlciA9PiB7cmV0dXJuIGhlYWRlci5kb2NrID09PSAoaGYgPyd0b3AnICAgOiAnbGVmdCcpfSksXG4gICAgICAgICAgICAgICAgaGFzSG9yaXpvbnRhbEhlYWRlcnMgPSBib3R0b21IZWFkZXJzLmxlbmd0aCA+IDAgfHwgdG9wSGVhZGVycyAgLmxlbmd0aCA+IDAsXG4gICAgICAgICAgICAgICAgaGFzVmVydGljYWxIZWFkZXJzICAgPSBsZWZ0SGVhZGVycyAgLmxlbmd0aCA+IDAgfHwgcmlnaHRIZWFkZXJzLmxlbmd0aCA+IDAsXG4gICAgICAgICAgICAgICAge2l0ZW1zfSAgICAgICAgICAgICAgPSBtZSxcbiAgICAgICAgICAgICAgICBob3Jpem9udGFsSXRlbXMgICAgICA9IFtdLFxuICAgICAgICAgICAgICAgIHZlcnRpY2FsSXRlbXMgICAgICAgID0gW10sXG4gICAgICAgICAgICAgICAgY29uZmlnO1xuXG4gICAgICAgICAgICB0b3BIZWFkZXJzLmZvckVhY2goaGVhZGVyID0+IHtcbiAgICAgICAgICAgICAgICB2ZXJ0aWNhbEl0ZW1zLnB1c2goUGFuZWwuY3JlYXRlSGVhZGVyQ29uZmlnKGhlYWRlcikpXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKGhhc1ZlcnRpY2FsSGVhZGVycyAmJiAoaGYgJiYgaGFzSG9yaXpvbnRhbEhlYWRlcnMgfHwgIWhmICYmIGhhc0hvcml6b250YWxIZWFkZXJzKSkge1xuICAgICAgICAgICAgICAgIGxlZnRIZWFkZXJzLmZvckVhY2goaGVhZGVyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaG9yaXpvbnRhbEl0ZW1zLnB1c2goUGFuZWwuY3JlYXRlSGVhZGVyQ29uZmlnKGhlYWRlcikpXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBjb25maWcgPSB7XG4gICAgICAgICAgICAgICAgICAgIG50eXBlICAgICAgIDogJ2NvbnRhaW5lcicsXG4gICAgICAgICAgICAgICAgICAgIGZsZXggICAgICAgIDogMSxcbiAgICAgICAgICAgICAgICAgICAgaXRlbXMsXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1EZWZhdWx0czogbWUuaXRlbURlZmF1bHRzLFxuICAgICAgICAgICAgICAgICAgICAuLi5jb250YWluZXJDb25maWdcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgaG9yaXpvbnRhbEl0ZW1zLnB1c2goey4uLm1lLmhlYWRlckRlZmF1bHRzLCAuLi5jb25maWd9KTtcblxuICAgICAgICAgICAgICAgIHJpZ2h0SGVhZGVycy5mb3JFYWNoKGhlYWRlciA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGhvcml6b250YWxJdGVtcy5wdXNoKFBhbmVsLmNyZWF0ZUhlYWRlckNvbmZpZyhoZWFkZXIpKVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdmVydGljYWxJdGVtcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgbnR5cGUgICAgOiAnY29udGFpbmVyJyxcbiAgICAgICAgICAgICAgICAgICAgaXRlbXMgICAgOiBob3Jpem9udGFsSXRlbXMsXG4gICAgICAgICAgICAgICAgICAgIGxheW91dCAgIDoge250eXBlOiAoaGYgPyAnaGJveCcgOiAndmJveCcpLCBhbGlnbjogJ3N0cmV0Y2gnfSxcbiAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlOiAnYm9keUNvbnRhaW5lcidcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uZmlnID0ge1xuICAgICAgICAgICAgICAgICAgICBudHlwZSAgICAgICA6ICdjb250YWluZXInLFxuICAgICAgICAgICAgICAgICAgICBmbGV4ICAgICAgICA6IDEsXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zLFxuICAgICAgICAgICAgICAgICAgICBpdGVtRGVmYXVsdHM6IG1lLml0ZW1EZWZhdWx0cyxcbiAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlICAgOiAnYm9keUNvbnRhaW5lcicsXG4gICAgICAgICAgICAgICAgICAgIC4uLmNvbnRhaW5lckNvbmZpZ1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB2ZXJ0aWNhbEl0ZW1zLnB1c2goey4uLm1lLmhlYWRlckRlZmF1bHRzLCAuLi5jb25maWd9KVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBib3R0b21IZWFkZXJzLmZvckVhY2goaGVhZGVyID0+IHtcbiAgICAgICAgICAgICAgICB2ZXJ0aWNhbEl0ZW1zLnB1c2goUGFuZWwuY3JlYXRlSGVhZGVyQ29uZmlnKGhlYWRlcikpXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgbWUuaXRlbXMgPSB2ZXJ0aWNhbEl0ZW1zO1xuXG4gICAgICAgICAgICBtZS5pdGVtRGVmYXVsdHMgPSBudWxsO1xuXG4gICAgICAgICAgICBzdXBlci5jcmVhdGVJdGVtcygpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAgKi9cbiAgICBoYXNIZWFkZXJzKCkge1xuICAgICAgICByZXR1cm4gQXJyYXkuaXNBcnJheSh0aGlzLmhlYWRlcnMpICYmIHRoaXMuaGVhZGVycy5sZW5ndGggPiAwXG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBOZW8uc2V0dXBDbGFzcyhQYW5lbCk7XG4iLCJpbXBvcnQgQ29udGFpbmVyIGZyb20gJy4vQmFzZS5tanMnO1xuXG4vKipcbiAqIEBjbGFzcyBOZW8uY29udGFpbmVyLlZpZXdwb3J0XG4gKiBAZXh0ZW5kcyBOZW8uY29udGFpbmVyLkJhc2VcbiAqL1xuY2xhc3MgVmlld3BvcnQgZXh0ZW5kcyBDb250YWluZXIge1xuICAgIHN0YXRpYyBjb25maWcgPSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IGNsYXNzTmFtZT0nTmVvLmNvbnRhaW5lci5WaWV3cG9ydCdcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgY2xhc3NOYW1lOiAnTmVvLmNvbnRhaW5lci5WaWV3cG9ydCcsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IG50eXBlPSd2aWV3cG9ydCdcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgbnR5cGU6ICd2aWV3cG9ydCcsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiB0cnVlIGFwcGxpZXMgJ25lby1ib2R5LXZpZXdwb3J0JyB0byB0aGUgZG9jdW1lbnQuYm9keVxuICAgICAgICAgKiBAbWVtYmVyIHtCb29sZWFufSBhcHBseUJvZHlDbHM9dHJ1ZVxuICAgICAgICAgKi9cbiAgICAgICAgYXBwbHlCb2R5Q2xzOiB0cnVlLFxuICAgICAgICAvKipcbiAgICAgICAgICogQXNzdW1pbmcgdGhhdCBhIFZpZXdwb3J0IGlzIHRoZSB0b3AgbGV2ZWwgdmlldyBvZiB5b3VyIGFwcCwgYW5kIHlvdSB3YW50IHRvIG1vdW50IGl0IHJpZ2h0IGF3YXkuXG4gICAgICAgICAqIENvdWxkIGJlIHdpdGhvdXQgYW55IGl0ZW1zLiBVc2UgZmFsc2Ugb3RoZXJ3aXNlLlxuICAgICAgICAgKiBAbWVtYmVyIHtCb29sZWFufSBhdXRvTW91bnQ9dHJ1ZVxuICAgICAgICAgKi9cbiAgICAgICAgYXV0b01vdW50OiB0cnVlLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nW119IGJhc2VDbHM9WyduZW8tdmlld3BvcnQnXVxuICAgICAgICAgKi9cbiAgICAgICAgYmFzZUNsczogWyduZW8tdmlld3BvcnQnXSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIHRydWUgYXBwbGllcyBhIG1haW4uYWRkb24uUmVzaXplT2JzZXJ2ZXIgYW5kIGZpcmVzIGEgY3VzdG9tIHJlc2l6ZSBldmVudFxuICAgICAgICAgKiB3aGljaCBvdGhlciBpbnN0YW5jZXMgY2FuIHN1YnNjcmliZSB0by5cbiAgICAgICAgICogQG1lbWJlciB7Qm9vbGVhbn0gbW9uaXRvclNpemVfPWZhbHNlXG4gICAgICAgICAqIEByZWFjdGl2ZVxuICAgICAgICAgKi9cbiAgICAgICAgbW9uaXRvclNpemVfOiBmYWxzZVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRyaWdnZXJlZCBhZnRlciB0aGUgbW91bnRlZCBjb25maWcgZ290IGNoYW5nZWRcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IHZhbHVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBvbGRWYWx1ZVxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBhZnRlclNldE1vdW50ZWQodmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgICAgIHN1cGVyLmFmdGVyU2V0TW91bnRlZCh2YWx1ZSwgb2xkVmFsdWUpO1xuXG4gICAgICAgIGxldCBtZSA9IHRoaXM7XG5cbiAgICAgICAgaWYgKHZhbHVlICYmIG1lLm1vbml0b3JTaXplKSB7XG4gICAgICAgICAgICBtZS5hZGREb21MaXN0ZW5lcnMoW3tyZXNpemU6IG1lLm9uRG9tUmVzaXplLCBzY29wZTogbWV9XSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqXG4gICAgICovXG4gICAgb25Db25zdHJ1Y3RlZCgpIHtcbiAgICAgICAgc3VwZXIub25Db25zdHJ1Y3RlZCgpO1xuXG4gICAgICAgIGxldCB7d2luZG93SWR9ID0gdGhpcztcblxuICAgICAgICB0aGlzLmFwcGx5Qm9keUNscyAmJiBOZW8ubWFpbi5Eb21BY2Nlc3MuYXBwbHlCb2R5Q2xzKHtcbiAgICAgICAgICAgIGNsczogWyduZW8tYm9keS12aWV3cG9ydCddLFxuICAgICAgICAgICAgd2luZG93SWRcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqL1xuICAgIG9uRG9tUmVzaXplKGRhdGEpIHtcbiAgICAgICAgdGhpcy5maXJlKCdyZXNpemUnLCBkYXRhKVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgTmVvLnNldHVwQ2xhc3MoVmlld3BvcnQpO1xuIiwiaW1wb3J0IEJhc2UgICAgICAgICAgICAgIGZyb20gJy4vQmFzZS5tanMnO1xuaW1wb3J0IHtyZXNvbHZlQ2FsbGJhY2t9IGZyb20gJy4uL3V0aWwvRnVuY3Rpb24ubWpzJztcblxuLyoqXG4gKiBAY2xhc3MgTmVvLmNvbnRyb2xsZXIuQ29tcG9uZW50XG4gKiBAZXh0ZW5kcyBOZW8uY29udHJvbGxlci5CYXNlXG4gKi9cbmNsYXNzIENvbXBvbmVudCBleHRlbmRzIEJhc2Uge1xuICAgIHN0YXRpYyBjb25maWcgPSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IGNsYXNzTmFtZT0nTmVvLmNvbnRyb2xsZXIuQ29tcG9uZW50J1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBjbGFzc05hbWU6ICdOZW8uY29udHJvbGxlci5Db21wb25lbnQnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBudHlwZT0nY29tcG9uZW50LWNvbnRyb2xsZXInXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIG50eXBlOiAnY29tcG9uZW50LWNvbnRyb2xsZXInLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7TmVvLmNvbXBvbmVudC5CYXNlfG51bGx9IGNvbXBvbmVudD1udWxsXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNvbXBvbmVudDogbnVsbCxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge05lby5jb250cm9sbGVyLkNvbXBvbmVudHxudWxsfSBwYXJlbnRfPW51bGxcbiAgICAgICAgICogQHJlYWN0aXZlXG4gICAgICAgICAqL1xuICAgICAgICBwYXJlbnRfOiBudWxsLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7T2JqZWN0fSByZWZlcmVuY2VzPW51bGxcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgcmVmZXJlbmNlczogbnVsbCxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ3xudWxsfSB3aW5kb3dJZD1udWxsXG4gICAgICAgICAqL1xuICAgICAgICB3aW5kb3dJZDogbnVsbFxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3QoY29uZmlnKSB7XG4gICAgICAgIHN1cGVyLmNvbnN0cnVjdChjb25maWcpO1xuXG4gICAgICAgIGxldCBtZSAgICAgICAgICA9IHRoaXMsXG4gICAgICAgICAgICB7Y29tcG9uZW50fSA9IG1lO1xuXG4gICAgICAgIG1lLnJlZmVyZW5jZXMgPSB7fTtcblxuICAgICAgICBpZiAoY29tcG9uZW50LmlzQ29uc3RydWN0ZWQpIHtcbiAgICAgICAgICAgIG1lLm9uQ29tcG9uZW50Q29uc3RydWN0ZWQoKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29tcG9uZW50Lm9uKCdjb25zdHJ1Y3RlZCcsICgpID0+IHtcbiAgICAgICAgICAgICAgICBtZS5vbkNvbXBvbmVudENvbnN0cnVjdGVkKClcbiAgICAgICAgICAgIH0sIG1lLCB7b25jZTogdHJ1ZX0pXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcmlnZ2VyZWQgYmVmb3JlIHRoZSBwYXJlbnQgY29uZmlnIGdldHMgY2hhbmdlZFxuICAgICAqIEBwYXJhbSB7TmVvLmNvbnRyb2xsZXIuQ29tcG9uZW50fG51bGx9IHZhbHVlXG4gICAgICogQHBhcmFtIHtOZW8uY29udHJvbGxlci5Db21wb25lbnR8bnVsbH0gb2xkVmFsdWVcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgYmVmb3JlU2V0UGFyZW50KHZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICByZXR1cm4gdmFsdWUgfHwgdGhpcy5nZXRQYXJlbnQoKVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBoYW5kbGVyTmFtZVxuICAgICAqIEBwYXJhbSB7TmVvLmNvbXBvbmVudC5CYXNlfG51bGx9IFtjb21wb25lbnRdXG4gICAgICogQHJldHVybnMge05lby5jb250cm9sbGVyLkNvbXBvbmVudHxCb29sZWFufG51bGx9XG4gICAgICovXG4gICAgZ2V0SGFuZGxlclNjb3BlKGhhbmRsZXJOYW1lLCBjb21wb25lbnQpIHtcbiAgICAgICAgbGV0IG1lICAgICAgID0gdGhpcyxcbiAgICAgICAgICAgIHtwYXJlbnR9ID0gbWUsXG4gICAgICAgICAgICBoYW5kbGVyQ2I7XG5cbiAgICAgICAgaWYgKGNvbXBvbmVudCkge1xuICAgICAgICAgICAgLy8gTG9vayBmb3IgdGhzIGZ1bmN0aW9uICpuYW1lKiBmaXJzdCBpbiB0aGUgQ29tcG9uZW50IGl0c2VsZi5cbiAgICAgICAgICAgIC8vIElmIHdlIGZpbmQgaXQsIHJldHVybiB0cnVlIHNvIGNhbGxpbmcgY29kZSBrbm93cyBub3QgdG8gY29udGludWUgdG8gc2VhcmNoLlxuICAgICAgICAgICAgaGFuZGxlckNiID0gcmVzb2x2ZUNhbGxiYWNrKGhhbmRsZXJOYW1lLCBjb21wb25lbnQpO1xuXG4gICAgICAgICAgICAvLyBIYW5kbGVyIGZuIGlzIHJlc29sdmVkIGluIHRoZSBDb21wb25lbnQgb3IgaXRzIG93biBwYXJlbnQgY2hhaW4uXG4gICAgICAgICAgICAvLyBSZXR1cm4gYSBzdGF0dXMgaW5kaWNhdGluZyB0aGF0IHdlIGRvIG5vdCBuZWVkIGFuIGVhcmx5IGJpbmRpbmdcbiAgICAgICAgICAgIGlmIChoYW5kbGVyQ2IuZm4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIE5lby5pc0Z1bmN0aW9uKG1lW2hhbmRsZXJOYW1lXSkgP1xuICAgICAgICAgICAgbWUgOiBwYXJlbnQ/LmdldEhhbmRsZXJTY29wZShoYW5kbGVyTmFtZSkgfHwgbnVsbFxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgY2xvc2VzdCBjb250cm9sbGVyIGluc2lkZSB0aGUgY29tcG9uZW50cyBwYXJlbnQgdHJlZVxuICAgICAqIEByZXR1cm5zIHtOZW8uY29udHJvbGxlci5Db21wb25lbnR8bnVsbH1cbiAgICAgKi9cbiAgICBnZXRQYXJlbnQoKSB7XG4gICAgICAgIGxldCBtZSAgICAgICA9IHRoaXMsXG4gICAgICAgICAgICB7cGFyZW50fSA9IG1lO1xuXG4gICAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBwYXJlbnRcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBtZS5jb21wb25lbnQucGFyZW50Py5nZXRDb250cm9sbGVyKCkgfHwgbnVsbFxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHRvZG86IHVwZGF0ZSBjaGFuZ2VkIHJlZmVyZW5jZXMgKGUuZy4gY29udGFpbmVyLnJlbW92ZSgpIHRoZW4gY29udGFpbmVyLmFkZCgpIHVzaW5nIHRoZSBzYW1lIGtleSlcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZVxuICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAqL1xuICAgIGdldFJlZmVyZW5jZShuYW1lKSB7XG4gICAgICAgIGxldCBtZSAgICAgICAgPSB0aGlzLFxuICAgICAgICAgICAgY29tcG9uZW50ID0gbWUucmVmZXJlbmNlc1tuYW1lXTtcblxuICAgICAgICBpZiAoIWNvbXBvbmVudCkge1xuICAgICAgICAgICAgY29tcG9uZW50ID0gbWUuY29tcG9uZW50LmRvd24oe3JlZmVyZW5jZTogbmFtZX0pO1xuXG4gICAgICAgICAgICBpZiAoY29tcG9uZW50KSB7XG4gICAgICAgICAgICAgICAgbWUucmVmZXJlbmNlc1tuYW1lXSA9IGNvbXBvbmVudFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNvbXBvbmVudCB8fCBudWxsXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29udmVuaWVuY2Ugc2hvcnRjdXRcbiAgICAgKiBAcGFyYW0gYXJnc1xuICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAqL1xuICAgIGdldFN0YXRlKC4uLmFyZ3MpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U3RhdGVQcm92aWRlcigpLmdldERhdGEoLi4uYXJncylcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBzYW1lTGV2ZWxPbmx5PWZhbHNlIHdpbGwgcmV0dXJuIHRoZSBjbG9zZXN0IHN0YXRlUHJvdmlkZXIgaW5zaWRlIHRoZSBjb21wb25lbnQgcGFyZW50IHRyZWUsXG4gICAgICogaW4gY2FzZSB0aGVyZSBpcyBub25lIG9uIHRoZSBzYW1lIGxldmVsLlxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW3NhbWVMZXZlbE9ubHk9ZmFsc2VdXG4gICAgICovXG4gICAgZ2V0U3RhdGVQcm92aWRlcihzYW1lTGV2ZWxPbmx5PWZhbHNlKSB7XG4gICAgICAgIGxldCB7Y29tcG9uZW50fSA9IHRoaXM7XG4gICAgICAgIHJldHVybiBzYW1lTGV2ZWxPbmx5ID8gY29tcG9uZW50LnN0YXRlUHJvdmlkZXIgOiBjb21wb25lbnQuZ2V0U3RhdGVQcm92aWRlcigpXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29udmVuaWVuY2Ugc2hvcnRjdXQgZm9yIGFjY2Vzc2luZyBzdGF0ZS5Qcm92aWRlciBiYXNlZCBkYXRhLlN0b3Jlc1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBrZXlcbiAgICAgKiBAcmV0dXJucyB7TmVvLmRhdGEuU3RvcmV9XG4gICAgICovXG4gICAgZ2V0U3RvcmUoa2V5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFN0YXRlUHJvdmlkZXIoKS5nZXRTdG9yZShrZXkpXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogT3ZlcnJpZGUgdGhpcyBtZXRob2QgaW5zaWRlIHlvdXIgdmlldyBjb250cm9sbGVycyBhcyBhIHN0YXJ0aW5nIHBvaW50IGluIGNhc2UgeW91IG5lZWQgcmVmZXJlbmNlc1xuICAgICAqIChpbnN0ZWFkIG9mIHVzaW5nIG9uQ29uc3RydWN0ZWQoKSBpbnNpZGUgeW91ciBjb250cm9sbGVyKVxuICAgICAqL1xuICAgIG9uQ29tcG9uZW50Q29uc3RydWN0ZWQoKSB7fVxuXG4gICAgLyoqXG4gICAgICogV2lsbCBnZXQgY2FsbGVkIGJ5IGNvbXBvbmVudC5CYXNlOiBkZXN0cm95KCkgaW4gY2FzZSB0aGUgY29tcG9uZW50IGhhcyBhIHJlZmVyZW5jZSBjb25maWdcbiAgICAgKiBAcGFyYW0ge05lby5jb21wb25lbnQuQmFzZX0gY29tcG9uZW50XG4gICAgICovXG4gICAgcmVtb3ZlUmVmZXJlbmNlKGNvbXBvbmVudCkge1xuICAgICAgICBsZXQgbWUgICAgICAgICAgID0gdGhpcyxcbiAgICAgICAgICAgIHtyZWZlcmVuY2VzfSA9IG1lLFxuICAgICAgICAgICAga2V5O1xuXG4gICAgICAgIGZvciAoa2V5IGluIHJlZmVyZW5jZXMpIHtcbiAgICAgICAgICAgIGlmIChjb21wb25lbnQgPT09IHJlZmVyZW5jZXNba2V5XSkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSByZWZlcmVuY2VzW2tleV07XG4gICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIG1lLmdldFBhcmVudCgpPy5yZW1vdmVSZWZlcmVuY2UoY29tcG9uZW50KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbnZlbmllbmNlIHNob3J0Y3V0XG4gICAgICogQHBhcmFtIGFyZ3NcbiAgICAgKi9cbiAgICBzZXRTdGF0ZSguLi5hcmdzKSB7XG4gICAgICAgIHRoaXMuZ2V0U3RhdGVQcm92aWRlcigpLnNldERhdGEoLi4uYXJncylcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IE5lby5zZXR1cENsYXNzKENvbXBvbmVudCk7XG4iLCJpbXBvcnQgQnV0dG9uICAgIGZyb20gJy4uL2J1dHRvbi9CYXNlLm1qcyc7XG5pbXBvcnQgQ29tcG9uZW50IGZyb20gJy4uL2NvbXBvbmVudC9CYXNlLm1qcyc7XG5pbXBvcnQgQ29udGFpbmVyIGZyb20gJy4uL2NvbnRhaW5lci9CYXNlLm1qcyc7XG5pbXBvcnQgTGFiZWwgICAgIGZyb20gJy4uL2NvbXBvbmVudC9MYWJlbC5tanMnO1xuaW1wb3J0IE5lb0FycmF5ICBmcm9tICcuLi91dGlsL0FycmF5Lm1qcyc7XG5cbi8qKlxuICogQGNsYXNzIE5lby50b29sYmFyLkJhc2VcbiAqIEBleHRlbmRzIE5lby5jb250YWluZXIuQmFzZVxuICovXG5jbGFzcyBUb29sYmFyIGV4dGVuZHMgQ29udGFpbmVyIHtcbiAgICAvKipcbiAgICAgKiBWYWxpZCB2YWx1ZXMgZm9yIGRvY2tcbiAgICAgKiBAbWVtYmVyIHtTdHJpbmdbXX0gZG9ja1Bvc2l0aW9ucz1bJ3RvcCcsJ3JpZ2h0JywnYm90dG9tJywnbGVmdCcsIG51bGxdXG4gICAgICogQHN0YXRpY1xuICAgICAqL1xuICAgIHN0YXRpYyBkb2NrUG9zaXRpb25zID0gWyd0b3AnLCAncmlnaHQnLCAnYm90dG9tJywgJ2xlZnQnLCBudWxsXVxuXG4gICAgc3RhdGljIGNvbmZpZyA9IHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gY2xhc3NOYW1lPSdOZW8udG9vbGJhci5CYXNlJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBjbGFzc05hbWU6ICdOZW8udG9vbGJhci5CYXNlJyxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gbnR5cGU9J3Rvb2xiYXInXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIG50eXBlOiAndG9vbGJhcicsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmdbXX0gYmFzZUNscz1bJ25lby10b29sYmFyJ11cbiAgICAgICAgICovXG4gICAgICAgIGJhc2VDbHM6IFsnbmVvLXRvb2xiYXInXSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ3xudWxsfSBkb2NrXz1udWxsXG4gICAgICAgICAqIEByZWFjdGl2ZVxuICAgICAgICAgKi9cbiAgICAgICAgZG9ja186IG51bGwsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtPYmplY3R9IGl0ZW1EZWZhdWx0cz17bnR5cGU6J2J1dHRvbid9XG4gICAgICAgICAqIEByZWFjdGl2ZVxuICAgICAgICAgKi9cbiAgICAgICAgaXRlbURlZmF1bHRzOiB7XG4gICAgICAgICAgICBudHlwZTogJ2J1dHRvbidcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge09iamVjdH0gbGF5b3V0PXtudHlwZTonZmxleGJveCcsYWxpZ246J2NlbnRlcicsZGlyZWN0aW9uOiAncm93JywgcGFjazonc3RhcnQnfVxuICAgICAgICAgKiBAcmVhY3RpdmVcbiAgICAgICAgICovXG4gICAgICAgIGxheW91dDoge1xuICAgICAgICAgICAgbnR5cGUgICAgOiAnZmxleGJveCcsXG4gICAgICAgICAgICBhbGlnbiAgICA6ICdjZW50ZXInLFxuICAgICAgICAgICAgZGlyZWN0aW9uOiAncm93JyxcbiAgICAgICAgICAgIHBhY2sgICAgIDogJ3N0YXJ0J1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJpZ2dlcmVkIGFmdGVyIHRoZSBkb2NrIGNvbmZpZyBnb3QgY2hhbmdlZFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB2YWx1ZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBvbGRWYWx1ZVxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBhZnRlclNldERvY2sodmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgICAgIGlmICghdmFsdWUgJiYgIW9sZFZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBtZSAgICAgICAgICAgID0gdGhpcyxcbiAgICAgICAgICAgIHtjbHN9ICAgICAgICAgPSBtZSxcbiAgICAgICAgICAgIGRvY2tQb3NpdGlvbnMgPSBtZS5nZXRTdGF0aWNDb25maWcoJ2RvY2tQb3NpdGlvbnMnKSxcbiAgICAgICAgICAgIGxheW91dENvbmZpZyAgPSBtZS5nZXRMYXlvdXRDb25maWcoKTtcblxuICAgICAgICBkb2NrUG9zaXRpb25zLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgICAgIGtleSAhPT0gbnVsbCAmJiBOZW9BcnJheS50b2dnbGUoY2xzLCAnbmVvLWRvY2stJyArIGtleSwga2V5ID09PSB2YWx1ZSlcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKCFtZS5sYXlvdXQpIHtcbiAgICAgICAgICAgIGxheW91dENvbmZpZy5udHlwZSA9ICdmbGV4Ym94JztcbiAgICAgICAgICAgIG1lLnNldCh7Y2xzLCBsYXlvdXQ6IGxheW91dENvbmZpZ30pXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtZS5sYXlvdXQuc2V0KGxheW91dENvbmZpZyk7XG4gICAgICAgICAgICBtZS5jbHMgPSBjbHM7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgdGhlIG5ldyBkb2NrIHBvc2l0aW9uIG1hdGNoZXMgYSB2YWx1ZSBvZiB0aGUgc3RhdGljIGRvY2tQb3NpdGlvbnMgY29uZmlnXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHZhbHVlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG9sZFZhbHVlXG4gICAgICogQHJldHVybnMge1N0cmluZ30gdmFsdWVcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgYmVmb3JlU2V0RG9jayh2YWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmVmb3JlU2V0RW51bVZhbHVlKHZhbHVlLCBvbGRWYWx1ZSwgJ2RvY2snLCAnZG9ja1Bvc2l0aW9ucycpXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKi9cbiAgICBjcmVhdGVJdGVtcygpIHtcbiAgICAgICAgbGV0IGl0ZW1zID0gdGhpcy5faXRlbXM7XG5cbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaXRlbXMpKSB7XG4gICAgICAgICAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zLm1hcChpdGVtID0+IHRoaXMucmVwbGFjZVNwYWNlcihpdGVtKSlcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzdXBlci5jcmVhdGVJdGVtcygpXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGxheW91dCBjb25maWcgZGVwZW5kaW5nIG9uIHRoaXMuZG9ja1xuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IGxheW91dENvbmZpZ1xuICAgICAqL1xuICAgIGdldExheW91dENvbmZpZygpIHtcbiAgICAgICAgbGV0IG1lID0gdGhpcyxcbiAgICAgICAgICAgIGxheW91dENvbmZpZztcblxuICAgICAgICBpZiAobWUuZG9jaykge1xuICAgICAgICAgICAgc3dpdGNoIChtZS5kb2NrKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnYm90dG9tJzpcbiAgICAgICAgICAgICAgICBjYXNlICd0b3AnOlxuICAgICAgICAgICAgICAgICAgICBsYXlvdXRDb25maWcgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbGlnbiAgICA6ICdjZW50ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uOiAncm93JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhY2sgICAgIDogJ3N0YXJ0J1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIGNhc2UgJ2xlZnQnOlxuICAgICAgICAgICAgICAgICAgICBsYXlvdXRDb25maWcgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbGlnbiAgICA6ICdjZW50ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uOiAnY29sdW1uLXJldmVyc2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGFjayAgICAgOiAnc3RhcnQnXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgY2FzZSAncmlnaHQnOlxuICAgICAgICAgICAgICAgICAgICBsYXlvdXRDb25maWcgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbGlnbiAgICA6ICdjZW50ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uOiAnY29sdW1uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhY2sgICAgIDogJ3N0YXJ0J1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGxheW91dENvbmZpZyB8fCBtZS5sYXlvdXRcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbnNlcnRzIGFuIGl0ZW0gb3IgYXJyYXkgb2YgaXRlbXMgYXQgYSBzcGVjaWZpYyBpbmRleFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBpbmRleFxuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fSBpdGVtXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbc2lsZW50PWZhbHNlXVxuICAgICAqIEByZXR1cm5zIHtOZW8uY29tcG9uZW50LkJhc2V8TmVvLmNvbXBvbmVudC5CYXNlW119XG4gICAgICovXG4gICAgaW5zZXJ0KGluZGV4LCBpdGVtLCBzaWxlbnQ9ZmFsc2UpIHtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaXRlbSkpIHtcbiAgICAgICAgICAgIGl0ZW0gPSBpdGVtLm1hcChpdGVtID0+IHRoaXMucmVwbGFjZVNwYWNlcihpdGVtKSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGl0ZW0gPSB0aGlzLnJlcGxhY2VTcGFjZXIoaXRlbSlcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzdXBlci5pbnNlcnQoaW5kZXgsIGl0ZW0sIHNpbGVudClcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdHxTdHJpbmd9IGl0ZW1cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl8T2JqZWN0fVxuICAgICAqL1xuICAgIHJlcGxhY2VTcGFjZXIoaXRlbSkge1xuICAgICAgICByZXR1cm4gaXRlbSA9PT0gJy0+JyA/IHttb2R1bGU6IENvbXBvbmVudCwgZmxleDogMX0gOiBpdGVtXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHJldHVybnMge09iamVjdH1cbiAgICAgKi9cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5zdXBlci50b0pTT04oKSxcbiAgICAgICAgICAgIGRvY2s6IHRoaXMuZG9ja1xuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBOZW8uc2V0dXBDbGFzcyhUb29sYmFyKTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==