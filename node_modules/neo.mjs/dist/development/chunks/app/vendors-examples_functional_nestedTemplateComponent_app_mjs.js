"use strict";
(self["webpackChunkneo_mjs"] = self["webpackChunkneo_mjs"] || []).push([["vendors-examples_functional_nestedTemplateComponent_app_mjs"],{

/***/ "./examples/functional/nestedTemplateComponent/Component.mjs":
/*!*******************************************************************!*\
  !*** ./examples/functional/nestedTemplateComponent/Component.mjs ***!
  \*******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _src_button_Base_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../src/button/Base.mjs */ "./src/button/Base.mjs");
/* harmony import */ var _src_functional_export_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../src/functional/_export.mjs */ "./src/functional/_export.mjs");


/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_src_functional_export_mjs__WEBPACK_IMPORTED_MODULE_1__.defineComponent)({
  config: {
    className: 'Neo.examples.functional.nestedTemplateComponent.Component',
    detailsText_: 'Here are some more details!',
    enableHtmlTemplates: true,
    greeting_: 'Hello',
    jobTitle_: 'Neo.mjs Developer'
  },
  createVdom(config) {
    const [isActive, setIsActive] = (0,_src_functional_export_mjs__WEBPACK_IMPORTED_MODULE_1__.useConfig)(true);
    const [showDetails, setShowDetails] = (0,_src_functional_export_mjs__WEBPACK_IMPORTED_MODULE_1__.useConfig)(false);
    (0,_src_functional_export_mjs__WEBPACK_IMPORTED_MODULE_1__.useEvent)('click', event => {
      console.log(event.component);
      if (event.target.id === 'details-button') {
        return false;
      } else {
        setIsActive(prev => !prev);
      }
    });
    const onButtonClick = () => {
      setShowDetails(prev => !prev);
    };
    const cardStyle = {
      border: '1px solid #eee',
      borderRadius: '8px',
      boxShadow: '0 2px 4px rgba(0,0,0,0.1)',
      cursor: 'pointer',
      padding: '16px',
      textAlign: 'center'
    };
    const statusStyle = {
      backgroundColor: isActive ? '#28a745' : '#dc3545',
      borderRadius: '12px',
      color: 'white',
      display: 'inline-block',
      fontSize: '12px',
      marginTop: '10px',
      padding: '4px 8px'
    };
    const detailsTemplate = {
      tag: "div",
      style: "margin-top: 15px; padding: 10px; border-top: 1px solid #eee;",
      cn: [{
        tag: "p",
        text: config.detailsText
      }]
    };
    return {
      tag: "div",
      style: cardStyle,
      cn: [{
        tag: "h2",
        text: config.greeting + ', Neo!'
      }, {
        tag: "p",
        text: config.jobTitle
      }, {
        module: _src_button_Base_mjs__WEBPACK_IMPORTED_MODULE_0__["default"],
        handler: onButtonClick,
        id: "details-button",
        text: (showDetails ? 'Hide' : 'Show') + ' Details'
      }, showDetails && detailsTemplate, {
        tag: "div",
        style: statusStyle,
        text: isActive ? 'Active' : 'Inactive'
      }]
    };
  }
}));


/***/ }),

/***/ "./examples/functional/nestedTemplateComponent/MainContainer.mjs":
/*!***********************************************************************!*\
  !*** ./examples/functional/nestedTemplateComponent/MainContainer.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _ConfigurationViewport_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../ConfigurationViewport.mjs */ "./examples/ConfigurationViewport.mjs");
/* harmony import */ var _Component_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Component.mjs */ "./examples/functional/nestedTemplateComponent/Component.mjs");
/* harmony import */ var _src_form_field_Text_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../src/form/field/Text.mjs */ "./src/form/field/Text.mjs");




/**
 * @class Neo.examples.functional.nestedTemplateComponent.MainContainer
 * @extends Neo.examples.ConfigurationViewport
 */
class MainContainer extends _ConfigurationViewport_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        className           : 'Neo.examples.functional.nestedTemplateComponent.MainContainer',
        configItemLabelWidth: 160,
        configItemWidth     : 280,
        layout              : {ntype: 'hbox', align: 'stretch'}
    }

    createConfigurationComponents() {
        let me = this;

        return [{
            module    : _src_form_field_Text_mjs__WEBPACK_IMPORTED_MODULE_2__["default"],
            clearable : true,
            labelText : 'greeting',
            listeners : {change: me.onConfigChange.bind(me, 'greeting')},
            style     : {marginTop: '10px'},
            value     : me.exampleComponent.greeting
        }, {
            module    : _src_form_field_Text_mjs__WEBPACK_IMPORTED_MODULE_2__["default"],
            clearable : true,
            labelText : 'jobTitle',
            listeners : {change: me.onConfigChange.bind(me, 'jobTitle')},
            style     : {marginTop: '10px'},
            value     : me.exampleComponent.jobTitle
        }]
    }

    /**
     * @returns {Neo.functional.Component}
     */
    createExampleComponent() {
        return {
            module  : _Component_mjs__WEBPACK_IMPORTED_MODULE_1__["default"],
            greeting: 'Hi'
        }
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(MainContainer));


/***/ }),

/***/ "./examples/functional/nestedTemplateComponent/app.mjs":
/*!*************************************************************!*\
  !*** ./examples/functional/nestedTemplateComponent/app.mjs ***!
  \*************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   onStart: () => (/* binding */ onStart)
/* harmony export */ });
/* harmony import */ var _MainContainer_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MainContainer.mjs */ "./examples/functional/nestedTemplateComponent/MainContainer.mjs");


const onStart = () => Neo.app({
    mainView: _MainContainer_mjs__WEBPACK_IMPORTED_MODULE_0__["default"],
    name    : 'Neo.examples.functional.nestedTemplateComponent'
});


/***/ }),

/***/ "./src/functional/_export.mjs":
/*!************************************!*\
  !*** ./src/functional/_export.mjs ***!
  \************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Component: () => (/* reexport safe */ _component_Base_mjs__WEBPACK_IMPORTED_MODULE_0__["default"]),
/* harmony export */   defineComponent: () => (/* reexport safe */ _defineComponent_mjs__WEBPACK_IMPORTED_MODULE_1__["default"]),
/* harmony export */   html: () => (/* reexport safe */ _util_html_mjs__WEBPACK_IMPORTED_MODULE_2__.html),
/* harmony export */   useConfig: () => (/* reexport safe */ _useConfig_mjs__WEBPACK_IMPORTED_MODULE_3__["default"]),
/* harmony export */   useEvent: () => (/* reexport safe */ _useEvent_mjs__WEBPACK_IMPORTED_MODULE_4__["default"])
/* harmony export */ });
/* harmony import */ var _component_Base_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./component/Base.mjs */ "./src/functional/component/Base.mjs");
/* harmony import */ var _defineComponent_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./defineComponent.mjs */ "./src/functional/defineComponent.mjs");
/* harmony import */ var _util_html_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./util/html.mjs */ "./src/functional/util/html.mjs");
/* harmony import */ var _useConfig_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./useConfig.mjs */ "./src/functional/useConfig.mjs");
/* harmony import */ var _useEvent_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./useEvent.mjs */ "./src/functional/useEvent.mjs");









/***/ }),

/***/ "./src/functional/defineComponent.mjs":
/*!********************************************!*\
  !*** ./src/functional/defineComponent.mjs ***!
  \********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__),
/* harmony export */   defineComponent: () => (/* binding */ defineComponent)
/* harmony export */ });
/* harmony import */ var _component_Base_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./component/Base.mjs */ "./src/functional/component/Base.mjs");


/**
 * Factory function to create a functional component class from a specification object.
 * This enables a "Beginner Mode" for creating components without writing a class,
 * while still providing access to the full class-based feature set.
 *
 * It's important to understand the two ways of managing state:
 *
 * 1.  **Named Configs (Public API):** Defined in the `config` object (e.g., `text_`).
 *     - **Purpose:** Defines the component's public API for external control, similar to props.
 *     - **Use Case:** For data that a parent component will set or change.
 *     - **Features:** Integrates with the full config system (e.g., `afterSetText()` hooks).
 *
 * 2.  **`useConfig()` (Internal State):** Used inside `createVdom` or other methods.
 *     - **Purpose:** Manages private, encapsulated state that is internal to the component.
 *     - **Use Case:** For state that the component manages itself and is not controlled by the parent.
 *     - **Features:** Provides a simple, concise way to handle local reactive state.
 *
 * @param {Object} spec - The specification object for the component.
 * @returns {Neo.functional.component.Base} The generated component class.
 *
 * @example
 * import { defineComponent } from 'neo/functional/defineComponent.mjs';
 * import { useConfig }       from 'neo/functional/useConfig.mjs';
 *
 * const MyComponent = defineComponent({
 *     // 1. Define the Public API via the `config` object.
 *     config: {
 *         className: 'MyApp.MyFunctionalComponent',
 *         ntype    : 'my-functional-component',
 *
 *         // `text_` is a NAMED CONFIG. It's part of the component's public API.
 *         // A parent can create this component with a `text` config.
 *         // It is reactive and will generate `afterSetText()` and `beforeSetText()` hooks.
 *         text_: 'Hello World'
 *     },
 *
 *     // 2. Define the component's logic and VDOM.
 *     createVdom(config) {
 *         // `useConfig` creates ANONYMOUS, INTERNAL STATE.
 *         // The `count` state is private to this component and cannot be set by a parent.
 *         const [count, setCount] = useConfig(0);
 *
 *         return {
 *             tag: 'div',
 *             cn: [{
 *                 tag: 'h1',
 *                 // Access the public, named config via the `config` parameter.
 *                 text: config.text
 *             }, {
 *                 tag: 'p',
 *                 // Access the private, internal state directly.
 *                 text: `You clicked ${count} times`
 *             }, {
 *                 tag: 'button',
 *                 text: 'Click me',
 *                 // The setter from `useConfig` updates the internal state.
 *                 onclick: () => setCount(count + 1)
 *             }]
 *         };
 *     },
 *
 *     // 3. Lifecycle hooks for named configs work automatically.
 *     afterSetText(newValue, oldValue) {
 *         console.log(`Text changed from '${oldValue}' to '${newValue}'`);
 *     }
 * });
 *
 * // The returned MyComponent is a class constructor that can be used with Neo.create()
 * // const instance = Neo.create(MyComponent, {
 * //     text: 'Welcome to Neo.mjs!' // Set the public config on creation.
 * // });
 */
function defineComponent(spec) {
    const configSpec = spec.config;
    delete spec.config;

    if (!configSpec?.className) {
        throw new Error('defineComponent requires a config object with a className.');
    }

    class FunctionalComponent extends _component_Base_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
        static config = {
            ...configSpec
            // We can add our own configurations here
        }
    }

    // Assign instance methods
    Object.entries(spec).forEach(([key, value]) => {
        FunctionalComponent.prototype[key] = value
    });

    // To support multiple envs (like `devmode`, `dist/esm`, `dist/production` in parallel,
    // we must re-assign FunctionalComponent to the setupClass() output.
    FunctionalComponent = Neo.setupClass(FunctionalComponent);

    return FunctionalComponent
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (defineComponent);


/***/ }),

/***/ "./src/functional/useConfig.mjs":
/*!**************************************!*\
  !*** ./src/functional/useConfig.mjs ***!
  \**************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__),
/* harmony export */   useConfig: () => (/* binding */ useConfig)
/* harmony export */ });
/* harmony import */ var _core_Config_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/Config.mjs */ "./src/core/Config.mjs");
/* harmony import */ var _core_EffectManager_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../core/EffectManager.mjs */ "./src/core/EffectManager.mjs");



const
    hookIndexSymbol = Symbol.for('hookIndex'),
    hooksSymbol     = Symbol.for('hooks');

/**
 * A hook for managing reactive state within a functional component's `createVdom` method.
 * It mirrors the behavior of React's `useState` but is powered by `Neo.core.Config` for reactivity.
 * @param {*} initialValue The initial value for the state.
 * @returns {Array<any>} A tuple containing the current value and a setter function.
 */
function useConfig(initialValue) {
    _core_EffectManager_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].pause();

    const
        effect    = _core_EffectManager_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].getActiveEffect(),
        component = effect && Neo.getComponent(effect.componentId);

    if (!component) {
        throw new Error('useConfig must be called from within a functional component\'s createVdom method.')
    }

    const currentIndex = component[hookIndexSymbol];

    // Increment the index for the next hook call within the same component render cycle.
    component[hookIndexSymbol]++;

    // If this is the first time this hook is being called for this component, initialize its state.
    if (!component[hooksSymbol][currentIndex]) {
        const config = new _core_Config_mjs__WEBPACK_IMPORTED_MODULE_0__["default"](initialValue);

        const customSetter = (newValue) => {
            if (typeof newValue === 'function') {
                newValue = newValue(config.get())
            }
            config.set(newValue)
        };

        component[hooksSymbol][currentIndex] = [config, customSetter]
    }

    const [config, setter] = component[hooksSymbol][currentIndex];

    _core_EffectManager_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].resume();

    // Call config.get() to ensure this component's effect tracks this config as a dependency.
    return [config.get(), setter]
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (useConfig);


/***/ }),

/***/ "./src/functional/useEvent.mjs":
/*!*************************************!*\
  !*** ./src/functional/useEvent.mjs ***!
  \*************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__),
/* harmony export */   useEvent: () => (/* binding */ useEvent)
/* harmony export */ });
/* harmony import */ var _core_EffectManager_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/EffectManager.mjs */ "./src/core/EffectManager.mjs");


const pendingDomEventsSymbol = Symbol.for('pendingDomEvents');

/**
 * A hook for registering DOM event listeners within a functional component.
 * Event listeners registered via this hook will be managed by Neo.mjs's
 * delegated DOM event system, ensuring efficient and proper lifecycle handling.
 *
 * @param {String} eventType - The type of DOM event to listen for (e.g., 'click', 'input').
 * @param {Function} handler - The event handler function. It will receive the event data as its argument.
 * @param {String} [delegate] - An optional CSS selector for event delegation. If provided,
 *                               the handler will only fire if the event target matches this selector.
 */
function useEvent(eventType, handler, delegate) {
    const
        activeEffect = _core_EffectManager_mjs__WEBPACK_IMPORTED_MODULE_0__["default"].getActiveEffect(),
        componentId  = activeEffect?.componentId;

    if (!componentId) {
        throw new Error('useEvent must be called from within a functional component\'s createVdom method.')
    }

    _core_EffectManager_mjs__WEBPACK_IMPORTED_MODULE_0__["default"].pause();
    const component = Neo.getComponent(componentId);
    _core_EffectManager_mjs__WEBPACK_IMPORTED_MODULE_0__["default"].resume();

    if (!component) {
        throw new Error(`Component with id ${componentId} not found for useEvent hook.`);
    }

    // Ensure pendingDomEventsSymbol exists on the component instance
    component[pendingDomEventsSymbol] ??= [];

    // Add the event listener configuration to the component's pending list
    component[pendingDomEventsSymbol].push({
        [eventType]: handler,
        delegate,
        scope      : component // The component instance itself will be the scope
    })
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (useEvent);


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2h1bmtzL2FwcC92ZW5kb3JzLWV4YW1wbGVzX2Z1bmN0aW9uYWxfbmVzdGVkVGVtcGxhdGVDb21wb25lbnRfYXBwX21qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBa0Q7QUFDNkM7QUFDL0YsaUVBQWUsMkVBQWU7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esb0NBQW9DLHFFQUFTO0FBQzdDLDBDQUEwQyxxRUFBUztBQUNuRCxJQUFJLG9FQUFRO0FBQ1o7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsZUFBZSwyQkFBMkI7QUFDMUU7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsZ0JBQWdCLDREQUFNO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLENBQUMsQ0FBQyxFQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUN0RWlFO0FBQ2hCO0FBQ2lCOztBQUVyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixrRUFBcUI7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0I7QUFDL0I7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLHdCQUF3QixnRUFBUztBQUNqQztBQUNBO0FBQ0EseUJBQXlCLCtDQUErQztBQUN4RSx5QkFBeUIsa0JBQWtCO0FBQzNDO0FBQ0EsU0FBUztBQUNULHdCQUF3QixnRUFBUztBQUNqQztBQUNBO0FBQ0EseUJBQXlCLCtDQUErQztBQUN4RSx5QkFBeUIsa0JBQWtCO0FBQzNDO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixzREFBcUI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsaUVBQWUsNkJBQTZCLEVBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7QUMvQ0c7O0FBRXpDO0FBQ1AsY0FBYywwREFBYTtBQUMzQjtBQUNBLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ0xrRDtBQUNDO0FBQ047QUFDQTtBQUNEOztBQUVrQjs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNOYjs7QUFFbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixhQUFhLCtCQUErQjtBQUM1QztBQUNBO0FBQ0EsWUFBWSxrQkFBa0I7QUFDOUIsWUFBWSxrQkFBa0I7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0Esd0NBQXdDLE9BQU87QUFDL0MsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QyxTQUFTLFFBQVEsU0FBUztBQUN2RTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsc0NBQXNDLDJEQUFjO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxpRUFBZSxlQUFlLEVBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3JHZ0I7QUFDTzs7QUFFdEQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsR0FBRztBQUNkLGFBQWEsWUFBWTtBQUN6QjtBQUNPO0FBQ1AsSUFBSSwrREFBYTs7QUFFakI7QUFDQSxvQkFBb0IsK0RBQWE7QUFDakM7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDJCQUEyQix3REFBTTs7QUFFakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUEsSUFBSSwrREFBYTs7QUFFakI7QUFDQTtBQUNBOztBQUVBLGlFQUFlLFNBQVMsRUFBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNuRDZCOztBQUV0RDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxRQUFRO0FBQ25CLFdBQVcsVUFBVTtBQUNyQixXQUFXLFFBQVE7QUFDbkI7QUFDQTtBQUNPO0FBQ1A7QUFDQSx1QkFBdUIsK0RBQWE7QUFDcEM7O0FBRUE7QUFDQTtBQUNBOztBQUVBLElBQUksK0RBQWE7QUFDakI7QUFDQSxJQUFJLCtEQUFhOztBQUVqQjtBQUNBLDZDQUE2QyxhQUFhO0FBQzFEOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQSxpRUFBZSxRQUFRLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZW8ubWpzLy4vZXhhbXBsZXMvZnVuY3Rpb25hbC9uZXN0ZWRUZW1wbGF0ZUNvbXBvbmVudC9Db21wb25lbnQubWpzIiwid2VicGFjazovL25lby5tanMvLi9leGFtcGxlcy9mdW5jdGlvbmFsL25lc3RlZFRlbXBsYXRlQ29tcG9uZW50L01haW5Db250YWluZXIubWpzIiwid2VicGFjazovL25lby5tanMvLi9leGFtcGxlcy9mdW5jdGlvbmFsL25lc3RlZFRlbXBsYXRlQ29tcG9uZW50L2FwcC5tanMiLCJ3ZWJwYWNrOi8vbmVvLm1qcy8uL3NyYy9mdW5jdGlvbmFsL19leHBvcnQubWpzIiwid2VicGFjazovL25lby5tanMvLi9zcmMvZnVuY3Rpb25hbC9kZWZpbmVDb21wb25lbnQubWpzIiwid2VicGFjazovL25lby5tanMvLi9zcmMvZnVuY3Rpb25hbC91c2VDb25maWcubWpzIiwid2VicGFjazovL25lby5tanMvLi9zcmMvZnVuY3Rpb25hbC91c2VFdmVudC5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEJ1dHRvbiBmcm9tICcuLi8uLi8uLi9zcmMvYnV0dG9uL0Jhc2UubWpzJztcbmltcG9ydCB7ZGVmaW5lQ29tcG9uZW50LCBodG1sLCB1c2VDb25maWcsIHVzZUV2ZW50fSBmcm9tICcuLi8uLi8uLi9zcmMvZnVuY3Rpb25hbC9fZXhwb3J0Lm1qcyc7XG5leHBvcnQgZGVmYXVsdCBkZWZpbmVDb21wb25lbnQoe1xuICBjb25maWc6IHtcbiAgICBjbGFzc05hbWU6ICdOZW8uZXhhbXBsZXMuZnVuY3Rpb25hbC5uZXN0ZWRUZW1wbGF0ZUNvbXBvbmVudC5Db21wb25lbnQnLFxuICAgIGRldGFpbHNUZXh0XzogJ0hlcmUgYXJlIHNvbWUgbW9yZSBkZXRhaWxzIScsXG4gICAgZW5hYmxlSHRtbFRlbXBsYXRlczogdHJ1ZSxcbiAgICBncmVldGluZ186ICdIZWxsbycsXG4gICAgam9iVGl0bGVfOiAnTmVvLm1qcyBEZXZlbG9wZXInXG4gIH0sXG4gIGNyZWF0ZVZkb20oY29uZmlnKSB7XG4gICAgY29uc3QgW2lzQWN0aXZlLCBzZXRJc0FjdGl2ZV0gPSB1c2VDb25maWcodHJ1ZSk7XG4gICAgY29uc3QgW3Nob3dEZXRhaWxzLCBzZXRTaG93RGV0YWlsc10gPSB1c2VDb25maWcoZmFsc2UpO1xuICAgIHVzZUV2ZW50KCdjbGljaycsIGV2ZW50ID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGV2ZW50LmNvbXBvbmVudCk7XG4gICAgICBpZiAoZXZlbnQudGFyZ2V0LmlkID09PSAnZGV0YWlscy1idXR0b24nKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNldElzQWN0aXZlKHByZXYgPT4gIXByZXYpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGNvbnN0IG9uQnV0dG9uQ2xpY2sgPSAoKSA9PiB7XG4gICAgICBzZXRTaG93RGV0YWlscyhwcmV2ID0+ICFwcmV2KTtcbiAgICB9O1xuICAgIGNvbnN0IGNhcmRTdHlsZSA9IHtcbiAgICAgIGJvcmRlcjogJzFweCBzb2xpZCAjZWVlJyxcbiAgICAgIGJvcmRlclJhZGl1czogJzhweCcsXG4gICAgICBib3hTaGFkb3c6ICcwIDJweCA0cHggcmdiYSgwLDAsMCwwLjEpJyxcbiAgICAgIGN1cnNvcjogJ3BvaW50ZXInLFxuICAgICAgcGFkZGluZzogJzE2cHgnLFxuICAgICAgdGV4dEFsaWduOiAnY2VudGVyJ1xuICAgIH07XG4gICAgY29uc3Qgc3RhdHVzU3R5bGUgPSB7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IGlzQWN0aXZlID8gJyMyOGE3NDUnIDogJyNkYzM1NDUnLFxuICAgICAgYm9yZGVyUmFkaXVzOiAnMTJweCcsXG4gICAgICBjb2xvcjogJ3doaXRlJyxcbiAgICAgIGRpc3BsYXk6ICdpbmxpbmUtYmxvY2snLFxuICAgICAgZm9udFNpemU6ICcxMnB4JyxcbiAgICAgIG1hcmdpblRvcDogJzEwcHgnLFxuICAgICAgcGFkZGluZzogJzRweCA4cHgnXG4gICAgfTtcbiAgICBjb25zdCBkZXRhaWxzVGVtcGxhdGUgPSB7XG4gICAgICB0YWc6IFwiZGl2XCIsXG4gICAgICBzdHlsZTogXCJtYXJnaW4tdG9wOiAxNXB4OyBwYWRkaW5nOiAxMHB4OyBib3JkZXItdG9wOiAxcHggc29saWQgI2VlZTtcIixcbiAgICAgIGNuOiBbe1xuICAgICAgICB0YWc6IFwicFwiLFxuICAgICAgICB0ZXh0OiBjb25maWcuZGV0YWlsc1RleHRcbiAgICAgIH1dXG4gICAgfTtcbiAgICByZXR1cm4ge1xuICAgICAgdGFnOiBcImRpdlwiLFxuICAgICAgc3R5bGU6IGNhcmRTdHlsZSxcbiAgICAgIGNuOiBbe1xuICAgICAgICB0YWc6IFwiaDJcIixcbiAgICAgICAgdGV4dDogY29uZmlnLmdyZWV0aW5nICsgJywgTmVvISdcbiAgICAgIH0sIHtcbiAgICAgICAgdGFnOiBcInBcIixcbiAgICAgICAgdGV4dDogY29uZmlnLmpvYlRpdGxlXG4gICAgICB9LCB7XG4gICAgICAgIG1vZHVsZTogQnV0dG9uLFxuICAgICAgICBoYW5kbGVyOiBvbkJ1dHRvbkNsaWNrLFxuICAgICAgICBpZDogXCJkZXRhaWxzLWJ1dHRvblwiLFxuICAgICAgICB0ZXh0OiAoc2hvd0RldGFpbHMgPyAnSGlkZScgOiAnU2hvdycpICsgJyBEZXRhaWxzJ1xuICAgICAgfSwgc2hvd0RldGFpbHMgJiYgZGV0YWlsc1RlbXBsYXRlLCB7XG4gICAgICAgIHRhZzogXCJkaXZcIixcbiAgICAgICAgc3R5bGU6IHN0YXR1c1N0eWxlLFxuICAgICAgICB0ZXh0OiBpc0FjdGl2ZSA/ICdBY3RpdmUnIDogJ0luYWN0aXZlJ1xuICAgICAgfV1cbiAgICB9O1xuICB9XG59KTtcbiIsImltcG9ydCBDb25maWd1cmF0aW9uVmlld3BvcnQgZnJvbSAnLi4vLi4vQ29uZmlndXJhdGlvblZpZXdwb3J0Lm1qcyc7XG5pbXBvcnQgTXlGdW5jdGlvbmFsQ29tcG9uZW50IGZyb20gJy4vQ29tcG9uZW50Lm1qcyc7XG5pbXBvcnQgVGV4dEZpZWxkICAgICAgICAgICAgIGZyb20gJy4uLy4uLy4uL3NyYy9mb3JtL2ZpZWxkL1RleHQubWpzJztcblxuLyoqXG4gKiBAY2xhc3MgTmVvLmV4YW1wbGVzLmZ1bmN0aW9uYWwubmVzdGVkVGVtcGxhdGVDb21wb25lbnQuTWFpbkNvbnRhaW5lclxuICogQGV4dGVuZHMgTmVvLmV4YW1wbGVzLkNvbmZpZ3VyYXRpb25WaWV3cG9ydFxuICovXG5jbGFzcyBNYWluQ29udGFpbmVyIGV4dGVuZHMgQ29uZmlndXJhdGlvblZpZXdwb3J0IHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICBjbGFzc05hbWUgICAgICAgICAgIDogJ05lby5leGFtcGxlcy5mdW5jdGlvbmFsLm5lc3RlZFRlbXBsYXRlQ29tcG9uZW50Lk1haW5Db250YWluZXInLFxuICAgICAgICBjb25maWdJdGVtTGFiZWxXaWR0aDogMTYwLFxuICAgICAgICBjb25maWdJdGVtV2lkdGggICAgIDogMjgwLFxuICAgICAgICBsYXlvdXQgICAgICAgICAgICAgIDoge250eXBlOiAnaGJveCcsIGFsaWduOiAnc3RyZXRjaCd9XG4gICAgfVxuXG4gICAgY3JlYXRlQ29uZmlndXJhdGlvbkNvbXBvbmVudHMoKSB7XG4gICAgICAgIGxldCBtZSA9IHRoaXM7XG5cbiAgICAgICAgcmV0dXJuIFt7XG4gICAgICAgICAgICBtb2R1bGUgICAgOiBUZXh0RmllbGQsXG4gICAgICAgICAgICBjbGVhcmFibGUgOiB0cnVlLFxuICAgICAgICAgICAgbGFiZWxUZXh0IDogJ2dyZWV0aW5nJyxcbiAgICAgICAgICAgIGxpc3RlbmVycyA6IHtjaGFuZ2U6IG1lLm9uQ29uZmlnQ2hhbmdlLmJpbmQobWUsICdncmVldGluZycpfSxcbiAgICAgICAgICAgIHN0eWxlICAgICA6IHttYXJnaW5Ub3A6ICcxMHB4J30sXG4gICAgICAgICAgICB2YWx1ZSAgICAgOiBtZS5leGFtcGxlQ29tcG9uZW50LmdyZWV0aW5nXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIG1vZHVsZSAgICA6IFRleHRGaWVsZCxcbiAgICAgICAgICAgIGNsZWFyYWJsZSA6IHRydWUsXG4gICAgICAgICAgICBsYWJlbFRleHQgOiAnam9iVGl0bGUnLFxuICAgICAgICAgICAgbGlzdGVuZXJzIDoge2NoYW5nZTogbWUub25Db25maWdDaGFuZ2UuYmluZChtZSwgJ2pvYlRpdGxlJyl9LFxuICAgICAgICAgICAgc3R5bGUgICAgIDoge21hcmdpblRvcDogJzEwcHgnfSxcbiAgICAgICAgICAgIHZhbHVlICAgICA6IG1lLmV4YW1wbGVDb21wb25lbnQuam9iVGl0bGVcbiAgICAgICAgfV1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7TmVvLmZ1bmN0aW9uYWwuQ29tcG9uZW50fVxuICAgICAqL1xuICAgIGNyZWF0ZUV4YW1wbGVDb21wb25lbnQoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBtb2R1bGUgIDogTXlGdW5jdGlvbmFsQ29tcG9uZW50LFxuICAgICAgICAgICAgZ3JlZXRpbmc6ICdIaSdcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgTmVvLnNldHVwQ2xhc3MoTWFpbkNvbnRhaW5lcik7XG4iLCJpbXBvcnQgTWFpbkNvbnRhaW5lciBmcm9tICcuL01haW5Db250YWluZXIubWpzJztcblxuZXhwb3J0IGNvbnN0IG9uU3RhcnQgPSAoKSA9PiBOZW8uYXBwKHtcbiAgICBtYWluVmlldzogTWFpbkNvbnRhaW5lcixcbiAgICBuYW1lICAgIDogJ05lby5leGFtcGxlcy5mdW5jdGlvbmFsLm5lc3RlZFRlbXBsYXRlQ29tcG9uZW50J1xufSk7XG4iLCJpbXBvcnQgQ29tcG9uZW50ICAgICAgIGZyb20gJy4vY29tcG9uZW50L0Jhc2UubWpzJztcbmltcG9ydCBkZWZpbmVDb21wb25lbnQgZnJvbSAnLi9kZWZpbmVDb21wb25lbnQubWpzJztcbmltcG9ydCB7aHRtbH0gICAgICAgICAgZnJvbSAnLi91dGlsL2h0bWwubWpzJztcbmltcG9ydCB1c2VDb25maWcgICAgICAgZnJvbSAnLi91c2VDb25maWcubWpzJztcbmltcG9ydCB1c2VFdmVudCAgICAgICAgZnJvbSAnLi91c2VFdmVudC5tanMnO1xuXG5leHBvcnQge0NvbXBvbmVudCwgZGVmaW5lQ29tcG9uZW50LCBodG1sLCB1c2VDb25maWcsIHVzZUV2ZW50fTtcbiIsImltcG9ydCBGdW5jdGlvbmFsQmFzZSBmcm9tICcuL2NvbXBvbmVudC9CYXNlLm1qcyc7XG5cbi8qKlxuICogRmFjdG9yeSBmdW5jdGlvbiB0byBjcmVhdGUgYSBmdW5jdGlvbmFsIGNvbXBvbmVudCBjbGFzcyBmcm9tIGEgc3BlY2lmaWNhdGlvbiBvYmplY3QuXG4gKiBUaGlzIGVuYWJsZXMgYSBcIkJlZ2lubmVyIE1vZGVcIiBmb3IgY3JlYXRpbmcgY29tcG9uZW50cyB3aXRob3V0IHdyaXRpbmcgYSBjbGFzcyxcbiAqIHdoaWxlIHN0aWxsIHByb3ZpZGluZyBhY2Nlc3MgdG8gdGhlIGZ1bGwgY2xhc3MtYmFzZWQgZmVhdHVyZSBzZXQuXG4gKlxuICogSXQncyBpbXBvcnRhbnQgdG8gdW5kZXJzdGFuZCB0aGUgdHdvIHdheXMgb2YgbWFuYWdpbmcgc3RhdGU6XG4gKlxuICogMS4gICoqTmFtZWQgQ29uZmlncyAoUHVibGljIEFQSSk6KiogRGVmaW5lZCBpbiB0aGUgYGNvbmZpZ2Agb2JqZWN0IChlLmcuLCBgdGV4dF9gKS5cbiAqICAgICAtICoqUHVycG9zZToqKiBEZWZpbmVzIHRoZSBjb21wb25lbnQncyBwdWJsaWMgQVBJIGZvciBleHRlcm5hbCBjb250cm9sLCBzaW1pbGFyIHRvIHByb3BzLlxuICogICAgIC0gKipVc2UgQ2FzZToqKiBGb3IgZGF0YSB0aGF0IGEgcGFyZW50IGNvbXBvbmVudCB3aWxsIHNldCBvciBjaGFuZ2UuXG4gKiAgICAgLSAqKkZlYXR1cmVzOioqIEludGVncmF0ZXMgd2l0aCB0aGUgZnVsbCBjb25maWcgc3lzdGVtIChlLmcuLCBgYWZ0ZXJTZXRUZXh0KClgIGhvb2tzKS5cbiAqXG4gKiAyLiAgKipgdXNlQ29uZmlnKClgIChJbnRlcm5hbCBTdGF0ZSk6KiogVXNlZCBpbnNpZGUgYGNyZWF0ZVZkb21gIG9yIG90aGVyIG1ldGhvZHMuXG4gKiAgICAgLSAqKlB1cnBvc2U6KiogTWFuYWdlcyBwcml2YXRlLCBlbmNhcHN1bGF0ZWQgc3RhdGUgdGhhdCBpcyBpbnRlcm5hbCB0byB0aGUgY29tcG9uZW50LlxuICogICAgIC0gKipVc2UgQ2FzZToqKiBGb3Igc3RhdGUgdGhhdCB0aGUgY29tcG9uZW50IG1hbmFnZXMgaXRzZWxmIGFuZCBpcyBub3QgY29udHJvbGxlZCBieSB0aGUgcGFyZW50LlxuICogICAgIC0gKipGZWF0dXJlczoqKiBQcm92aWRlcyBhIHNpbXBsZSwgY29uY2lzZSB3YXkgdG8gaGFuZGxlIGxvY2FsIHJlYWN0aXZlIHN0YXRlLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBzcGVjIC0gVGhlIHNwZWNpZmljYXRpb24gb2JqZWN0IGZvciB0aGUgY29tcG9uZW50LlxuICogQHJldHVybnMge05lby5mdW5jdGlvbmFsLmNvbXBvbmVudC5CYXNlfSBUaGUgZ2VuZXJhdGVkIGNvbXBvbmVudCBjbGFzcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZGVmaW5lQ29tcG9uZW50IH0gZnJvbSAnbmVvL2Z1bmN0aW9uYWwvZGVmaW5lQ29tcG9uZW50Lm1qcyc7XG4gKiBpbXBvcnQgeyB1c2VDb25maWcgfSAgICAgICBmcm9tICduZW8vZnVuY3Rpb25hbC91c2VDb25maWcubWpzJztcbiAqXG4gKiBjb25zdCBNeUNvbXBvbmVudCA9IGRlZmluZUNvbXBvbmVudCh7XG4gKiAgICAgLy8gMS4gRGVmaW5lIHRoZSBQdWJsaWMgQVBJIHZpYSB0aGUgYGNvbmZpZ2Agb2JqZWN0LlxuICogICAgIGNvbmZpZzoge1xuICogICAgICAgICBjbGFzc05hbWU6ICdNeUFwcC5NeUZ1bmN0aW9uYWxDb21wb25lbnQnLFxuICogICAgICAgICBudHlwZSAgICA6ICdteS1mdW5jdGlvbmFsLWNvbXBvbmVudCcsXG4gKlxuICogICAgICAgICAvLyBgdGV4dF9gIGlzIGEgTkFNRUQgQ09ORklHLiBJdCdzIHBhcnQgb2YgdGhlIGNvbXBvbmVudCdzIHB1YmxpYyBBUEkuXG4gKiAgICAgICAgIC8vIEEgcGFyZW50IGNhbiBjcmVhdGUgdGhpcyBjb21wb25lbnQgd2l0aCBhIGB0ZXh0YCBjb25maWcuXG4gKiAgICAgICAgIC8vIEl0IGlzIHJlYWN0aXZlIGFuZCB3aWxsIGdlbmVyYXRlIGBhZnRlclNldFRleHQoKWAgYW5kIGBiZWZvcmVTZXRUZXh0KClgIGhvb2tzLlxuICogICAgICAgICB0ZXh0XzogJ0hlbGxvIFdvcmxkJ1xuICogICAgIH0sXG4gKlxuICogICAgIC8vIDIuIERlZmluZSB0aGUgY29tcG9uZW50J3MgbG9naWMgYW5kIFZET00uXG4gKiAgICAgY3JlYXRlVmRvbShjb25maWcpIHtcbiAqICAgICAgICAgLy8gYHVzZUNvbmZpZ2AgY3JlYXRlcyBBTk9OWU1PVVMsIElOVEVSTkFMIFNUQVRFLlxuICogICAgICAgICAvLyBUaGUgYGNvdW50YCBzdGF0ZSBpcyBwcml2YXRlIHRvIHRoaXMgY29tcG9uZW50IGFuZCBjYW5ub3QgYmUgc2V0IGJ5IGEgcGFyZW50LlxuICogICAgICAgICBjb25zdCBbY291bnQsIHNldENvdW50XSA9IHVzZUNvbmZpZygwKTtcbiAqXG4gKiAgICAgICAgIHJldHVybiB7XG4gKiAgICAgICAgICAgICB0YWc6ICdkaXYnLFxuICogICAgICAgICAgICAgY246IFt7XG4gKiAgICAgICAgICAgICAgICAgdGFnOiAnaDEnLFxuICogICAgICAgICAgICAgICAgIC8vIEFjY2VzcyB0aGUgcHVibGljLCBuYW1lZCBjb25maWcgdmlhIHRoZSBgY29uZmlnYCBwYXJhbWV0ZXIuXG4gKiAgICAgICAgICAgICAgICAgdGV4dDogY29uZmlnLnRleHRcbiAqICAgICAgICAgICAgIH0sIHtcbiAqICAgICAgICAgICAgICAgICB0YWc6ICdwJyxcbiAqICAgICAgICAgICAgICAgICAvLyBBY2Nlc3MgdGhlIHByaXZhdGUsIGludGVybmFsIHN0YXRlIGRpcmVjdGx5LlxuICogICAgICAgICAgICAgICAgIHRleHQ6IGBZb3UgY2xpY2tlZCAke2NvdW50fSB0aW1lc2BcbiAqICAgICAgICAgICAgIH0sIHtcbiAqICAgICAgICAgICAgICAgICB0YWc6ICdidXR0b24nLFxuICogICAgICAgICAgICAgICAgIHRleHQ6ICdDbGljayBtZScsXG4gKiAgICAgICAgICAgICAgICAgLy8gVGhlIHNldHRlciBmcm9tIGB1c2VDb25maWdgIHVwZGF0ZXMgdGhlIGludGVybmFsIHN0YXRlLlxuICogICAgICAgICAgICAgICAgIG9uY2xpY2s6ICgpID0+IHNldENvdW50KGNvdW50ICsgMSlcbiAqICAgICAgICAgICAgIH1dXG4gKiAgICAgICAgIH07XG4gKiAgICAgfSxcbiAqXG4gKiAgICAgLy8gMy4gTGlmZWN5Y2xlIGhvb2tzIGZvciBuYW1lZCBjb25maWdzIHdvcmsgYXV0b21hdGljYWxseS5cbiAqICAgICBhZnRlclNldFRleHQobmV3VmFsdWUsIG9sZFZhbHVlKSB7XG4gKiAgICAgICAgIGNvbnNvbGUubG9nKGBUZXh0IGNoYW5nZWQgZnJvbSAnJHtvbGRWYWx1ZX0nIHRvICcke25ld1ZhbHVlfSdgKTtcbiAqICAgICB9XG4gKiB9KTtcbiAqXG4gKiAvLyBUaGUgcmV0dXJuZWQgTXlDb21wb25lbnQgaXMgYSBjbGFzcyBjb25zdHJ1Y3RvciB0aGF0IGNhbiBiZSB1c2VkIHdpdGggTmVvLmNyZWF0ZSgpXG4gKiAvLyBjb25zdCBpbnN0YW5jZSA9IE5lby5jcmVhdGUoTXlDb21wb25lbnQsIHtcbiAqIC8vICAgICB0ZXh0OiAnV2VsY29tZSB0byBOZW8ubWpzIScgLy8gU2V0IHRoZSBwdWJsaWMgY29uZmlnIG9uIGNyZWF0aW9uLlxuICogLy8gfSk7XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZWZpbmVDb21wb25lbnQoc3BlYykge1xuICAgIGNvbnN0IGNvbmZpZ1NwZWMgPSBzcGVjLmNvbmZpZztcbiAgICBkZWxldGUgc3BlYy5jb25maWc7XG5cbiAgICBpZiAoIWNvbmZpZ1NwZWM/LmNsYXNzTmFtZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2RlZmluZUNvbXBvbmVudCByZXF1aXJlcyBhIGNvbmZpZyBvYmplY3Qgd2l0aCBhIGNsYXNzTmFtZS4nKTtcbiAgICB9XG5cbiAgICBjbGFzcyBGdW5jdGlvbmFsQ29tcG9uZW50IGV4dGVuZHMgRnVuY3Rpb25hbEJhc2Uge1xuICAgICAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAgICAgLi4uY29uZmlnU3BlY1xuICAgICAgICAgICAgLy8gV2UgY2FuIGFkZCBvdXIgb3duIGNvbmZpZ3VyYXRpb25zIGhlcmVcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIEFzc2lnbiBpbnN0YW5jZSBtZXRob2RzXG4gICAgT2JqZWN0LmVudHJpZXMoc3BlYykuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICAgIEZ1bmN0aW9uYWxDb21wb25lbnQucHJvdG90eXBlW2tleV0gPSB2YWx1ZVxuICAgIH0pO1xuXG4gICAgLy8gVG8gc3VwcG9ydCBtdWx0aXBsZSBlbnZzIChsaWtlIGBkZXZtb2RlYCwgYGRpc3QvZXNtYCwgYGRpc3QvcHJvZHVjdGlvbmAgaW4gcGFyYWxsZWwsXG4gICAgLy8gd2UgbXVzdCByZS1hc3NpZ24gRnVuY3Rpb25hbENvbXBvbmVudCB0byB0aGUgc2V0dXBDbGFzcygpIG91dHB1dC5cbiAgICBGdW5jdGlvbmFsQ29tcG9uZW50ID0gTmVvLnNldHVwQ2xhc3MoRnVuY3Rpb25hbENvbXBvbmVudCk7XG5cbiAgICByZXR1cm4gRnVuY3Rpb25hbENvbXBvbmVudFxufVxuXG5leHBvcnQgZGVmYXVsdCBkZWZpbmVDb21wb25lbnQ7XG4iLCJpbXBvcnQgQ29uZmlnICAgICAgICBmcm9tICcuLi9jb3JlL0NvbmZpZy5tanMnO1xuaW1wb3J0IEVmZmVjdE1hbmFnZXIgZnJvbSAnLi4vY29yZS9FZmZlY3RNYW5hZ2VyLm1qcyc7XG5cbmNvbnN0XG4gICAgaG9va0luZGV4U3ltYm9sID0gU3ltYm9sLmZvcignaG9va0luZGV4JyksXG4gICAgaG9va3NTeW1ib2wgICAgID0gU3ltYm9sLmZvcignaG9va3MnKTtcblxuLyoqXG4gKiBBIGhvb2sgZm9yIG1hbmFnaW5nIHJlYWN0aXZlIHN0YXRlIHdpdGhpbiBhIGZ1bmN0aW9uYWwgY29tcG9uZW50J3MgYGNyZWF0ZVZkb21gIG1ldGhvZC5cbiAqIEl0IG1pcnJvcnMgdGhlIGJlaGF2aW9yIG9mIFJlYWN0J3MgYHVzZVN0YXRlYCBidXQgaXMgcG93ZXJlZCBieSBgTmVvLmNvcmUuQ29uZmlnYCBmb3IgcmVhY3Rpdml0eS5cbiAqIEBwYXJhbSB7Kn0gaW5pdGlhbFZhbHVlIFRoZSBpbml0aWFsIHZhbHVlIGZvciB0aGUgc3RhdGUuXG4gKiBAcmV0dXJucyB7QXJyYXk8YW55Pn0gQSB0dXBsZSBjb250YWluaW5nIHRoZSBjdXJyZW50IHZhbHVlIGFuZCBhIHNldHRlciBmdW5jdGlvbi5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVzZUNvbmZpZyhpbml0aWFsVmFsdWUpIHtcbiAgICBFZmZlY3RNYW5hZ2VyLnBhdXNlKCk7XG5cbiAgICBjb25zdFxuICAgICAgICBlZmZlY3QgICAgPSBFZmZlY3RNYW5hZ2VyLmdldEFjdGl2ZUVmZmVjdCgpLFxuICAgICAgICBjb21wb25lbnQgPSBlZmZlY3QgJiYgTmVvLmdldENvbXBvbmVudChlZmZlY3QuY29tcG9uZW50SWQpO1xuXG4gICAgaWYgKCFjb21wb25lbnQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCd1c2VDb25maWcgbXVzdCBiZSBjYWxsZWQgZnJvbSB3aXRoaW4gYSBmdW5jdGlvbmFsIGNvbXBvbmVudFxcJ3MgY3JlYXRlVmRvbSBtZXRob2QuJylcbiAgICB9XG5cbiAgICBjb25zdCBjdXJyZW50SW5kZXggPSBjb21wb25lbnRbaG9va0luZGV4U3ltYm9sXTtcblxuICAgIC8vIEluY3JlbWVudCB0aGUgaW5kZXggZm9yIHRoZSBuZXh0IGhvb2sgY2FsbCB3aXRoaW4gdGhlIHNhbWUgY29tcG9uZW50IHJlbmRlciBjeWNsZS5cbiAgICBjb21wb25lbnRbaG9va0luZGV4U3ltYm9sXSsrO1xuXG4gICAgLy8gSWYgdGhpcyBpcyB0aGUgZmlyc3QgdGltZSB0aGlzIGhvb2sgaXMgYmVpbmcgY2FsbGVkIGZvciB0aGlzIGNvbXBvbmVudCwgaW5pdGlhbGl6ZSBpdHMgc3RhdGUuXG4gICAgaWYgKCFjb21wb25lbnRbaG9va3NTeW1ib2xdW2N1cnJlbnRJbmRleF0pIHtcbiAgICAgICAgY29uc3QgY29uZmlnID0gbmV3IENvbmZpZyhpbml0aWFsVmFsdWUpO1xuXG4gICAgICAgIGNvbnN0IGN1c3RvbVNldHRlciA9IChuZXdWYWx1ZSkgPT4ge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBuZXdWYWx1ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gbmV3VmFsdWUoY29uZmlnLmdldCgpKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uZmlnLnNldChuZXdWYWx1ZSlcbiAgICAgICAgfTtcblxuICAgICAgICBjb21wb25lbnRbaG9va3NTeW1ib2xdW2N1cnJlbnRJbmRleF0gPSBbY29uZmlnLCBjdXN0b21TZXR0ZXJdXG4gICAgfVxuXG4gICAgY29uc3QgW2NvbmZpZywgc2V0dGVyXSA9IGNvbXBvbmVudFtob29rc1N5bWJvbF1bY3VycmVudEluZGV4XTtcblxuICAgIEVmZmVjdE1hbmFnZXIucmVzdW1lKCk7XG5cbiAgICAvLyBDYWxsIGNvbmZpZy5nZXQoKSB0byBlbnN1cmUgdGhpcyBjb21wb25lbnQncyBlZmZlY3QgdHJhY2tzIHRoaXMgY29uZmlnIGFzIGEgZGVwZW5kZW5jeS5cbiAgICByZXR1cm4gW2NvbmZpZy5nZXQoKSwgc2V0dGVyXVxufVxuXG5leHBvcnQgZGVmYXVsdCB1c2VDb25maWc7XG4iLCJpbXBvcnQgRWZmZWN0TWFuYWdlciBmcm9tICcuLi9jb3JlL0VmZmVjdE1hbmFnZXIubWpzJztcblxuY29uc3QgcGVuZGluZ0RvbUV2ZW50c1N5bWJvbCA9IFN5bWJvbC5mb3IoJ3BlbmRpbmdEb21FdmVudHMnKTtcblxuLyoqXG4gKiBBIGhvb2sgZm9yIHJlZ2lzdGVyaW5nIERPTSBldmVudCBsaXN0ZW5lcnMgd2l0aGluIGEgZnVuY3Rpb25hbCBjb21wb25lbnQuXG4gKiBFdmVudCBsaXN0ZW5lcnMgcmVnaXN0ZXJlZCB2aWEgdGhpcyBob29rIHdpbGwgYmUgbWFuYWdlZCBieSBOZW8ubWpzJ3NcbiAqIGRlbGVnYXRlZCBET00gZXZlbnQgc3lzdGVtLCBlbnN1cmluZyBlZmZpY2llbnQgYW5kIHByb3BlciBsaWZlY3ljbGUgaGFuZGxpbmcuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50VHlwZSAtIFRoZSB0eXBlIG9mIERPTSBldmVudCB0byBsaXN0ZW4gZm9yIChlLmcuLCAnY2xpY2snLCAnaW5wdXQnKS5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZXIgLSBUaGUgZXZlbnQgaGFuZGxlciBmdW5jdGlvbi4gSXQgd2lsbCByZWNlaXZlIHRoZSBldmVudCBkYXRhIGFzIGl0cyBhcmd1bWVudC5cbiAqIEBwYXJhbSB7U3RyaW5nfSBbZGVsZWdhdGVdIC0gQW4gb3B0aW9uYWwgQ1NTIHNlbGVjdG9yIGZvciBldmVudCBkZWxlZ2F0aW9uLiBJZiBwcm92aWRlZCxcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZSBoYW5kbGVyIHdpbGwgb25seSBmaXJlIGlmIHRoZSBldmVudCB0YXJnZXQgbWF0Y2hlcyB0aGlzIHNlbGVjdG9yLlxuICovXG5leHBvcnQgZnVuY3Rpb24gdXNlRXZlbnQoZXZlbnRUeXBlLCBoYW5kbGVyLCBkZWxlZ2F0ZSkge1xuICAgIGNvbnN0XG4gICAgICAgIGFjdGl2ZUVmZmVjdCA9IEVmZmVjdE1hbmFnZXIuZ2V0QWN0aXZlRWZmZWN0KCksXG4gICAgICAgIGNvbXBvbmVudElkICA9IGFjdGl2ZUVmZmVjdD8uY29tcG9uZW50SWQ7XG5cbiAgICBpZiAoIWNvbXBvbmVudElkKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcigndXNlRXZlbnQgbXVzdCBiZSBjYWxsZWQgZnJvbSB3aXRoaW4gYSBmdW5jdGlvbmFsIGNvbXBvbmVudFxcJ3MgY3JlYXRlVmRvbSBtZXRob2QuJylcbiAgICB9XG5cbiAgICBFZmZlY3RNYW5hZ2VyLnBhdXNlKCk7XG4gICAgY29uc3QgY29tcG9uZW50ID0gTmVvLmdldENvbXBvbmVudChjb21wb25lbnRJZCk7XG4gICAgRWZmZWN0TWFuYWdlci5yZXN1bWUoKTtcblxuICAgIGlmICghY29tcG9uZW50KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQ29tcG9uZW50IHdpdGggaWQgJHtjb21wb25lbnRJZH0gbm90IGZvdW5kIGZvciB1c2VFdmVudCBob29rLmApO1xuICAgIH1cblxuICAgIC8vIEVuc3VyZSBwZW5kaW5nRG9tRXZlbnRzU3ltYm9sIGV4aXN0cyBvbiB0aGUgY29tcG9uZW50IGluc3RhbmNlXG4gICAgY29tcG9uZW50W3BlbmRpbmdEb21FdmVudHNTeW1ib2xdID8/PSBbXTtcblxuICAgIC8vIEFkZCB0aGUgZXZlbnQgbGlzdGVuZXIgY29uZmlndXJhdGlvbiB0byB0aGUgY29tcG9uZW50J3MgcGVuZGluZyBsaXN0XG4gICAgY29tcG9uZW50W3BlbmRpbmdEb21FdmVudHNTeW1ib2xdLnB1c2goe1xuICAgICAgICBbZXZlbnRUeXBlXTogaGFuZGxlcixcbiAgICAgICAgZGVsZWdhdGUsXG4gICAgICAgIHNjb3BlICAgICAgOiBjb21wb25lbnQgLy8gVGhlIGNvbXBvbmVudCBpbnN0YW5jZSBpdHNlbGYgd2lsbCBiZSB0aGUgc2NvcGVcbiAgICB9KVxufVxuXG5leHBvcnQgZGVmYXVsdCB1c2VFdmVudDtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==