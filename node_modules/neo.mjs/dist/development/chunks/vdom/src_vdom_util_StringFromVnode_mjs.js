export const __webpack_esm_id__ = "src_vdom_util_StringFromVnode_mjs";
export const __webpack_esm_ids__ = ["src_vdom_util_StringFromVnode_mjs"];
export const __webpack_esm_modules__ = {

/***/ "./src/vdom/util/StringFromVnode.mjs"
/*!*******************************************!*\
  !*** ./src/vdom/util/StringFromVnode.mjs ***!
  \*******************************************/
(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _util_String_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../util/String.mjs */ "./src/util/String.mjs");
/* harmony import */ var _domConstants_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../domConstants.mjs */ "./src/vdom/domConstants.mjs");



/**
 * @summary Utility to convert VNode trees into HTML strings.
 *
 * This singleton provides the core logic for the string-based rendering path. It traverses
 * a VNode tree and generates the corresponding `outerHTML` string. This is used when the
 * `Neo.config.useDomApiRenderer` is set to false, or for server-side rendering (SSR) scenarios.
 *
 * In addition to string generation, it acts as a visitor to collect nodes that require
 * special handling after being mounted to the DOM (e.g., restoring scroll state), as these
 * properties cannot be set via HTML attributes.
 *
 * @class Neo.vdom.util.StringFromVnode
 * @singleton
 */
const StringFromVnode = {
    /**
     * @param {Object} vnode
     * @returns {String}
     * @protected
     */
    createCloseTag(vnode) {
        return _domConstants_mjs__WEBPACK_IMPORTED_MODULE_1__.voidElements.has(vnode.nodeName) ? '' : '</' + vnode.nodeName + '>'
    },

    /**
     * @param {Object} vnode
     * @returns {String}
     * @protected
     */
    createOpenTag(vnode) {
        let string       = '<' + vnode.nodeName,
            {attributes} = vnode,
            cls          = vnode.className,
            style;

        if (vnode.style) {
            style = Neo.createStyles(vnode.style);

            if (style !== '') {
                string += ` style="${style}"`
            }
        }

        if (cls) {
            if (Array.isArray(cls)) {
                cls = cls.join(' ')
            }

            if (cls !== '') {
                string += ` class="${cls}"`
            }
        }

        if (vnode.id) {
            if (Neo.config.useDomIds) {
                string += ` id="${vnode.id}"`
            } else {
                string += ` data-neo-id="${vnode.id}"`
            }
        }

        Object.entries(attributes).forEach(([key, value]) => {
            if (_domConstants_mjs__WEBPACK_IMPORTED_MODULE_1__.voidAttributes.has(key)) {
                if (value === 'true') { // vnode attribute values get converted into strings
                    string += ` ${key}`
                }
            } else if (key !== 'removeDom') {
                if (key === 'value') {
                    value = _util_String_mjs__WEBPACK_IMPORTED_MODULE_0__["default"].escapeHtml(value)
                }

                string += ` ${key}="${value?.replaceAll?.('"', '&quot;') ?? value}"`
            }
        });

        return string + '>'
    },

    /**
     * Creates an HTML string from a VNode tree.
     * Skips nodes present in the optional movedNodes map.
     *
     * Uses a visitor pattern to collect `postMountUpdates`:
     * As it traverses the tree to build the string, it identifies nodes with properties
     * that cannot be represented in HTML (like `scrollTop` and `scrollLeft`).
     * These are pushed into the passed `postMountUpdates` array, allowing the main thread
     * renderer to apply them after the HTML has been inserted into the document.
     *
     * @param {Neo.vdom.VNode} vnode
     * @param {Map}            [movedNodes]
     * @param {Object[]}       [postMountUpdates=[]]
     * @returns {String}
     */
    create(vnode, movedNodes, postMountUpdates=[]) {
        let me = this,
            id = vnode?.id;

        // If a content node will get moved by a delta update OP, there is no need to regenerate it. Opt out.
        if (id && movedNodes?.get(id)) {
            return ''
        }

        switch (vnode.vtype) {
            case 'root':
                return me.create(vnode.childNodes[0], movedNodes, postMountUpdates)
            case 'text':
                // For text VNodes, `vnode.textContent` holds the HTML-escaped content.
                // Add the comment wrappers here for string output, aligning with main.mixin.DeltaUpdates.createDomTree().
                // `vnode.textContent || ''` ensures robustness in case vnode.textContent is not a string (e.g., a number or null).
                return `<!-- ${vnode.id} -->${vnode.textContent}<!-- /neo-vtext -->`
            case 'vnode':
                if (vnode.nodeName === 'fragment') {
                    return `<!-- ${vnode.id}-start -->` + me.createTagContent(vnode, movedNodes, postMountUpdates) + `<!-- ${vnode.id}-end -->`
                }

                if (vnode.scrollTop || vnode.scrollLeft) {
                    let update = {id};

                    if (vnode.scrollLeft) {update.scrollLeft = vnode.scrollLeft}
                    if (vnode.scrollTop)  {update.scrollTop  = vnode.scrollTop}

                    postMountUpdates.push(update)
                }

                return me.createOpenTag(vnode) + me.createTagContent(vnode, movedNodes, postMountUpdates) + me.createCloseTag(vnode)
            default:
                return ''
        }
    },

    /**
     * Creates the inner HTML content for a VNode tag.
     * @param {Neo.vdom.VNode} vnode
     * @param {Map}            [movedNodes]
     * @param {Object[]}       [postMountUpdates]
     * @returns {String}
     * @protected
     */
    createTagContent(vnode, movedNodes, postMountUpdates) {
        const hasContent = vnode.innerHTML || vnode.textContent;

        if (hasContent) {
            return hasContent
        }

        let string = '',
            len    = vnode.childNodes ? vnode.childNodes.length : 0,
            i      = 0,
            childNode;

        for (; i < len; i++) {
            childNode = vnode.childNodes[i];
            string += this.create(childNode, movedNodes, postMountUpdates)
        }

        return string
    }
};

const ns = Neo.ns('Neo.vdom.util', true);
ns.StringFromVnode = StringFromVnode;

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (StringFromVnode);


/***/ }

};

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2h1bmtzL3Zkb20vc3JjX3Zkb21fdXRpbF9TdHJpbmdGcm9tVm5vZGVfbWpzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBbUU7QUFDRjs7QUFFakU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLGVBQWUsMkRBQVk7QUFDM0IsS0FBSzs7QUFFTDtBQUNBLGVBQWUsUUFBUTtBQUN2QixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLFlBQVk7QUFDekI7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EscUNBQXFDLE1BQU07QUFDM0M7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHFDQUFxQyxJQUFJO0FBQ3pDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGtDQUFrQyxTQUFTO0FBQzNDLGNBQWM7QUFDZCwyQ0FBMkMsU0FBUztBQUNwRDtBQUNBOztBQUVBO0FBQ0EsZ0JBQWdCLDZEQUFjO0FBQzlCLHdDQUF3QztBQUN4QyxrQ0FBa0MsSUFBSTtBQUN0QztBQUNBLGNBQWM7QUFDZDtBQUNBLDRCQUE0Qix3REFBUztBQUNyQzs7QUFFQSw4QkFBOEIsSUFBSSxJQUFJLGdDQUFnQyxZQUFZO0FBQ2xGO0FBQ0EsU0FBUzs7QUFFVDtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGdCQUFnQjtBQUMvQixlQUFlLGdCQUFnQjtBQUMvQixlQUFlLGdCQUFnQjtBQUMvQixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsVUFBVSxLQUFLLGtCQUFrQjtBQUNoRTtBQUNBO0FBQ0EsbUNBQW1DLFNBQVMsaUZBQWlGLFNBQVM7QUFDdEk7O0FBRUE7QUFDQSxrQ0FBa0M7O0FBRWxDLDJDQUEyQztBQUMzQywyQ0FBMkM7O0FBRTNDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQSxlQUFlLGdCQUFnQjtBQUMvQixlQUFlLGdCQUFnQjtBQUMvQixlQUFlLGdCQUFnQjtBQUMvQixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGVBQWUsU0FBUztBQUN4QjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsaUVBQWUsZUFBZSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmVvLm1qcy8uL3NyYy92ZG9tL3V0aWwvU3RyaW5nRnJvbVZub2RlLm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgTmVvU3RyaW5nICAgICAgICAgICAgICAgICAgICAgIGZyb20gJy4uLy4uL3V0aWwvU3RyaW5nLm1qcyc7XG5pbXBvcnQge3ZvaWRBdHRyaWJ1dGVzLCB2b2lkRWxlbWVudHN9IGZyb20gJy4uL2RvbUNvbnN0YW50cy5tanMnO1xuXG4vKipcbiAqIEBzdW1tYXJ5IFV0aWxpdHkgdG8gY29udmVydCBWTm9kZSB0cmVlcyBpbnRvIEhUTUwgc3RyaW5ncy5cbiAqXG4gKiBUaGlzIHNpbmdsZXRvbiBwcm92aWRlcyB0aGUgY29yZSBsb2dpYyBmb3IgdGhlIHN0cmluZy1iYXNlZCByZW5kZXJpbmcgcGF0aC4gSXQgdHJhdmVyc2VzXG4gKiBhIFZOb2RlIHRyZWUgYW5kIGdlbmVyYXRlcyB0aGUgY29ycmVzcG9uZGluZyBgb3V0ZXJIVE1MYCBzdHJpbmcuIFRoaXMgaXMgdXNlZCB3aGVuIHRoZVxuICogYE5lby5jb25maWcudXNlRG9tQXBpUmVuZGVyZXJgIGlzIHNldCB0byBmYWxzZSwgb3IgZm9yIHNlcnZlci1zaWRlIHJlbmRlcmluZyAoU1NSKSBzY2VuYXJpb3MuXG4gKlxuICogSW4gYWRkaXRpb24gdG8gc3RyaW5nIGdlbmVyYXRpb24sIGl0IGFjdHMgYXMgYSB2aXNpdG9yIHRvIGNvbGxlY3Qgbm9kZXMgdGhhdCByZXF1aXJlXG4gKiBzcGVjaWFsIGhhbmRsaW5nIGFmdGVyIGJlaW5nIG1vdW50ZWQgdG8gdGhlIERPTSAoZS5nLiwgcmVzdG9yaW5nIHNjcm9sbCBzdGF0ZSksIGFzIHRoZXNlXG4gKiBwcm9wZXJ0aWVzIGNhbm5vdCBiZSBzZXQgdmlhIEhUTUwgYXR0cmlidXRlcy5cbiAqXG4gKiBAY2xhc3MgTmVvLnZkb20udXRpbC5TdHJpbmdGcm9tVm5vZGVcbiAqIEBzaW5nbGV0b25cbiAqL1xuY29uc3QgU3RyaW5nRnJvbVZub2RlID0ge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSB2bm9kZVxuICAgICAqIEByZXR1cm5zIHtTdHJpbmd9XG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIGNyZWF0ZUNsb3NlVGFnKHZub2RlKSB7XG4gICAgICAgIHJldHVybiB2b2lkRWxlbWVudHMuaGFzKHZub2RlLm5vZGVOYW1lKSA/ICcnIDogJzwvJyArIHZub2RlLm5vZGVOYW1lICsgJz4nXG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSB2bm9kZVxuICAgICAqIEByZXR1cm5zIHtTdHJpbmd9XG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIGNyZWF0ZU9wZW5UYWcodm5vZGUpIHtcbiAgICAgICAgbGV0IHN0cmluZyAgICAgICA9ICc8JyArIHZub2RlLm5vZGVOYW1lLFxuICAgICAgICAgICAge2F0dHJpYnV0ZXN9ID0gdm5vZGUsXG4gICAgICAgICAgICBjbHMgICAgICAgICAgPSB2bm9kZS5jbGFzc05hbWUsXG4gICAgICAgICAgICBzdHlsZTtcblxuICAgICAgICBpZiAodm5vZGUuc3R5bGUpIHtcbiAgICAgICAgICAgIHN0eWxlID0gTmVvLmNyZWF0ZVN0eWxlcyh2bm9kZS5zdHlsZSk7XG5cbiAgICAgICAgICAgIGlmIChzdHlsZSAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICBzdHJpbmcgKz0gYCBzdHlsZT1cIiR7c3R5bGV9XCJgXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2xzKSB7XG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShjbHMpKSB7XG4gICAgICAgICAgICAgICAgY2xzID0gY2xzLmpvaW4oJyAnKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY2xzICE9PSAnJykge1xuICAgICAgICAgICAgICAgIHN0cmluZyArPSBgIGNsYXNzPVwiJHtjbHN9XCJgXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodm5vZGUuaWQpIHtcbiAgICAgICAgICAgIGlmIChOZW8uY29uZmlnLnVzZURvbUlkcykge1xuICAgICAgICAgICAgICAgIHN0cmluZyArPSBgIGlkPVwiJHt2bm9kZS5pZH1cImBcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc3RyaW5nICs9IGAgZGF0YS1uZW8taWQ9XCIke3Zub2RlLmlkfVwiYFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgT2JqZWN0LmVudHJpZXMoYXR0cmlidXRlcykuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICAgICAgICBpZiAodm9pZEF0dHJpYnV0ZXMuaGFzKGtleSkpIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT09ICd0cnVlJykgeyAvLyB2bm9kZSBhdHRyaWJ1dGUgdmFsdWVzIGdldCBjb252ZXJ0ZWQgaW50byBzdHJpbmdzXG4gICAgICAgICAgICAgICAgICAgIHN0cmluZyArPSBgICR7a2V5fWBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGtleSAhPT0gJ3JlbW92ZURvbScpIHtcbiAgICAgICAgICAgICAgICBpZiAoa2V5ID09PSAndmFsdWUnKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gTmVvU3RyaW5nLmVzY2FwZUh0bWwodmFsdWUpXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc3RyaW5nICs9IGAgJHtrZXl9PVwiJHt2YWx1ZT8ucmVwbGFjZUFsbD8uKCdcIicsICcmcXVvdDsnKSA/PyB2YWx1ZX1cImBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHN0cmluZyArICc+J1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIEhUTUwgc3RyaW5nIGZyb20gYSBWTm9kZSB0cmVlLlxuICAgICAqIFNraXBzIG5vZGVzIHByZXNlbnQgaW4gdGhlIG9wdGlvbmFsIG1vdmVkTm9kZXMgbWFwLlxuICAgICAqXG4gICAgICogVXNlcyBhIHZpc2l0b3IgcGF0dGVybiB0byBjb2xsZWN0IGBwb3N0TW91bnRVcGRhdGVzYDpcbiAgICAgKiBBcyBpdCB0cmF2ZXJzZXMgdGhlIHRyZWUgdG8gYnVpbGQgdGhlIHN0cmluZywgaXQgaWRlbnRpZmllcyBub2RlcyB3aXRoIHByb3BlcnRpZXNcbiAgICAgKiB0aGF0IGNhbm5vdCBiZSByZXByZXNlbnRlZCBpbiBIVE1MIChsaWtlIGBzY3JvbGxUb3BgIGFuZCBgc2Nyb2xsTGVmdGApLlxuICAgICAqIFRoZXNlIGFyZSBwdXNoZWQgaW50byB0aGUgcGFzc2VkIGBwb3N0TW91bnRVcGRhdGVzYCBhcnJheSwgYWxsb3dpbmcgdGhlIG1haW4gdGhyZWFkXG4gICAgICogcmVuZGVyZXIgdG8gYXBwbHkgdGhlbSBhZnRlciB0aGUgSFRNTCBoYXMgYmVlbiBpbnNlcnRlZCBpbnRvIHRoZSBkb2N1bWVudC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7TmVvLnZkb20uVk5vZGV9IHZub2RlXG4gICAgICogQHBhcmFtIHtNYXB9ICAgICAgICAgICAgW21vdmVkTm9kZXNdXG4gICAgICogQHBhcmFtIHtPYmplY3RbXX0gICAgICAgW3Bvc3RNb3VudFVwZGF0ZXM9W11dXG4gICAgICogQHJldHVybnMge1N0cmluZ31cbiAgICAgKi9cbiAgICBjcmVhdGUodm5vZGUsIG1vdmVkTm9kZXMsIHBvc3RNb3VudFVwZGF0ZXM9W10pIHtcbiAgICAgICAgbGV0IG1lID0gdGhpcyxcbiAgICAgICAgICAgIGlkID0gdm5vZGU/LmlkO1xuXG4gICAgICAgIC8vIElmIGEgY29udGVudCBub2RlIHdpbGwgZ2V0IG1vdmVkIGJ5IGEgZGVsdGEgdXBkYXRlIE9QLCB0aGVyZSBpcyBubyBuZWVkIHRvIHJlZ2VuZXJhdGUgaXQuIE9wdCBvdXQuXG4gICAgICAgIGlmIChpZCAmJiBtb3ZlZE5vZGVzPy5nZXQoaWQpKSB7XG4gICAgICAgICAgICByZXR1cm4gJydcbiAgICAgICAgfVxuXG4gICAgICAgIHN3aXRjaCAodm5vZGUudnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ3Jvb3QnOlxuICAgICAgICAgICAgICAgIHJldHVybiBtZS5jcmVhdGUodm5vZGUuY2hpbGROb2Rlc1swXSwgbW92ZWROb2RlcywgcG9zdE1vdW50VXBkYXRlcylcbiAgICAgICAgICAgIGNhc2UgJ3RleHQnOlxuICAgICAgICAgICAgICAgIC8vIEZvciB0ZXh0IFZOb2RlcywgYHZub2RlLnRleHRDb250ZW50YCBob2xkcyB0aGUgSFRNTC1lc2NhcGVkIGNvbnRlbnQuXG4gICAgICAgICAgICAgICAgLy8gQWRkIHRoZSBjb21tZW50IHdyYXBwZXJzIGhlcmUgZm9yIHN0cmluZyBvdXRwdXQsIGFsaWduaW5nIHdpdGggbWFpbi5taXhpbi5EZWx0YVVwZGF0ZXMuY3JlYXRlRG9tVHJlZSgpLlxuICAgICAgICAgICAgICAgIC8vIGB2bm9kZS50ZXh0Q29udGVudCB8fCAnJ2AgZW5zdXJlcyByb2J1c3RuZXNzIGluIGNhc2Ugdm5vZGUudGV4dENvbnRlbnQgaXMgbm90IGEgc3RyaW5nIChlLmcuLCBhIG51bWJlciBvciBudWxsKS5cbiAgICAgICAgICAgICAgICByZXR1cm4gYDwhLS0gJHt2bm9kZS5pZH0gLS0+JHt2bm9kZS50ZXh0Q29udGVudH08IS0tIC9uZW8tdnRleHQgLS0+YFxuICAgICAgICAgICAgY2FzZSAndm5vZGUnOlxuICAgICAgICAgICAgICAgIGlmICh2bm9kZS5ub2RlTmFtZSA9PT0gJ2ZyYWdtZW50Jykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYDwhLS0gJHt2bm9kZS5pZH0tc3RhcnQgLS0+YCArIG1lLmNyZWF0ZVRhZ0NvbnRlbnQodm5vZGUsIG1vdmVkTm9kZXMsIHBvc3RNb3VudFVwZGF0ZXMpICsgYDwhLS0gJHt2bm9kZS5pZH0tZW5kIC0tPmBcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodm5vZGUuc2Nyb2xsVG9wIHx8IHZub2RlLnNjcm9sbExlZnQpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHVwZGF0ZSA9IHtpZH07XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHZub2RlLnNjcm9sbExlZnQpIHt1cGRhdGUuc2Nyb2xsTGVmdCA9IHZub2RlLnNjcm9sbExlZnR9XG4gICAgICAgICAgICAgICAgICAgIGlmICh2bm9kZS5zY3JvbGxUb3ApICB7dXBkYXRlLnNjcm9sbFRvcCAgPSB2bm9kZS5zY3JvbGxUb3B9XG5cbiAgICAgICAgICAgICAgICAgICAgcG9zdE1vdW50VXBkYXRlcy5wdXNoKHVwZGF0ZSlcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gbWUuY3JlYXRlT3BlblRhZyh2bm9kZSkgKyBtZS5jcmVhdGVUYWdDb250ZW50KHZub2RlLCBtb3ZlZE5vZGVzLCBwb3N0TW91bnRVcGRhdGVzKSArIG1lLmNyZWF0ZUNsb3NlVGFnKHZub2RlKVxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gJydcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIHRoZSBpbm5lciBIVE1MIGNvbnRlbnQgZm9yIGEgVk5vZGUgdGFnLlxuICAgICAqIEBwYXJhbSB7TmVvLnZkb20uVk5vZGV9IHZub2RlXG4gICAgICogQHBhcmFtIHtNYXB9ICAgICAgICAgICAgW21vdmVkTm9kZXNdXG4gICAgICogQHBhcmFtIHtPYmplY3RbXX0gICAgICAgW3Bvc3RNb3VudFVwZGF0ZXNdXG4gICAgICogQHJldHVybnMge1N0cmluZ31cbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgY3JlYXRlVGFnQ29udGVudCh2bm9kZSwgbW92ZWROb2RlcywgcG9zdE1vdW50VXBkYXRlcykge1xuICAgICAgICBjb25zdCBoYXNDb250ZW50ID0gdm5vZGUuaW5uZXJIVE1MIHx8IHZub2RlLnRleHRDb250ZW50O1xuXG4gICAgICAgIGlmIChoYXNDb250ZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gaGFzQ29udGVudFxuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHN0cmluZyA9ICcnLFxuICAgICAgICAgICAgbGVuICAgID0gdm5vZGUuY2hpbGROb2RlcyA/IHZub2RlLmNoaWxkTm9kZXMubGVuZ3RoIDogMCxcbiAgICAgICAgICAgIGkgICAgICA9IDAsXG4gICAgICAgICAgICBjaGlsZE5vZGU7XG5cbiAgICAgICAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgY2hpbGROb2RlID0gdm5vZGUuY2hpbGROb2Rlc1tpXTtcbiAgICAgICAgICAgIHN0cmluZyArPSB0aGlzLmNyZWF0ZShjaGlsZE5vZGUsIG1vdmVkTm9kZXMsIHBvc3RNb3VudFVwZGF0ZXMpXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc3RyaW5nXG4gICAgfVxufTtcblxuY29uc3QgbnMgPSBOZW8ubnMoJ05lby52ZG9tLnV0aWwnLCB0cnVlKTtcbm5zLlN0cmluZ0Zyb21Wbm9kZSA9IFN0cmluZ0Zyb21Wbm9kZTtcblxuZXhwb3J0IGRlZmF1bHQgU3RyaW5nRnJvbVZub2RlO1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==