{"classData":[{"comment":"/**\n * @summary The central WebSocket Hub (Bridge) for Neural Link.\n *\n * This standalone service runs as a background process and acts as a message broker between:\n * 1.  **Apps (Browsers):** Running Neo.mjs applications (App Workers).\n * 2.  **Agents (MCP Servers):** AI Agents that want to inspect/control the apps.\n *\n * It listens on a single WebSocket port (default 8081). Clients identify their role via the\n * `role` query parameter ('app' or 'agent').\n *\n * **Routing Logic:**\n * - **App -> Agents:** Messages from an App are broadcast to ALL connected Agents.\n * - **Agent -> App:** Agents must wrap their message in a routing envelope:\n *   `{ target: 'appWorkerId', message: { ...jsonrpc... } }`\n *\n * @class Neo.ai.mcp.server.neural-link.Bridge\n * @extends Neo.core.Base\n * @singleton\n */","meta":{"filename":"Bridge.mjs","lineno":5,"columnno":0,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/neural-link","code":{}},"summary":"The central WebSocket Hub (Bridge) for Neural Link.\n\nThis standalone service runs as a background process and acts as a message broker between:\n1.  **Apps (Browsers):** Running Neo.mjs applications (App Workers).\n2.  **Agents (MCP Servers):** AI Agents that want to inspect/control the apps.\n\nIt listens on a single WebSocket port (default 8081). Clients identify their role via the\n`role` query parameter ('app' or 'agent').\n\n**Routing Logic:**\n- **App -> Agents:** Messages from an App are broadcast to ALL connected Agents.\n- **Agent -> App:** Agents must wrap their message in a routing envelope:\n  `{ target: 'appWorkerId', message: { ...jsonrpc... } }`","kind":"class","name":"Bridge","augments":["Neo.core.Base"],"tags":[{"originalTitle":"singleton","title":"singleton","text":""}],"memberof":"Neo.ai.mcp.server.neural-link","longname":"Neo.ai.mcp.server.neural-link.Bridge","scope":"static","$longname":"Neo.ai.mcp.server.neural-link.Bridge","$kind":"class","id":6382,"neoClassName":"Neo.ai.mcp.server.neural-link.Bridge"},{"comment":"/**\n         * @member {String} className='Neo.ai.mcp.server.neural-link.Bridge'\n         * @protected\n         */","meta":{"filename":"Bridge.mjs","lineno":30,"columnno":8,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/neural-link","code":{}},"kind":"member","name":"className","type":{"names":["String"]},"defaultvalue":"'Neo.ai.mcp.server.neural-link.Bridge'","access":"protected","longname":"className","scope":"global","$longname":"className","$kind":"property","id":6383,"neoClassName":"Neo.ai.mcp.server.neural-link.Bridge"},{"comment":"/**\n         * @member {Number} port=8081\n         * @protected\n         */","meta":{"filename":"Bridge.mjs","lineno":35,"columnno":8,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/neural-link","code":{}},"kind":"member","name":"port","type":{"names":["Number"]},"defaultvalue":8081,"access":"protected","longname":"port","scope":"global","$longname":"port","$kind":"property","id":6384,"neoClassName":"Neo.ai.mcp.server.neural-link.Bridge"},{"comment":"/**\n         * @member {Boolean} singleton=true\n         * @protected\n         */","meta":{"filename":"Bridge.mjs","lineno":40,"columnno":8,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/neural-link","code":{}},"kind":"member","name":"singleton","type":{"names":["Boolean"]},"defaultvalue":true,"access":"protected","longname":"singleton","scope":"global","$longname":"singleton","$kind":"property","id":6385,"neoClassName":"Neo.ai.mcp.server.neural-link.Bridge"},{"comment":"/**\n     * Active Agent sessions (MCP Servers).\n     * Map<agentId, WebSocket>\n     */","meta":{"range":[1500,1518],"filename":"Bridge.mjs","lineno":51,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/neural-link","code":{"id":"astnode100009324","name":"agents","type":"ClassProperty"}},"description":"<p>Active Agent sessions (MCP Servers).\nMap&lt;agentId, WebSocket&gt;</p>\n","name":"agents","longname":"Bridge#agents","kind":"member","memberof":"Bridge","scope":"instance","$longname":"Bridge#agents","$kind":"property","id":6386,"neoClassName":"Neo.ai.mcp.server.neural-link.Bridge"},{"comment":"/**\n     * Active App sessions (Browsers).\n     * Map<appWorkerId, WebSocket>\n     */","meta":{"range":[1613,1629],"filename":"Bridge.mjs","lineno":56,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/neural-link","code":{"id":"astnode100009327","name":"apps","type":"ClassProperty"}},"description":"<p>Active App sessions (Browsers).\nMap&lt;appWorkerId, WebSocket&gt;</p>\n","name":"apps","longname":"Bridge#apps","kind":"member","memberof":"Bridge","scope":"instance","$longname":"Bridge#apps","$kind":"property","id":6387,"neoClassName":"Neo.ai.mcp.server.neural-link.Bridge"},{"comment":"/**\n     * WebSocket Server instance.\n     */","meta":{"range":[1684,1694],"filename":"Bridge.mjs","lineno":59,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/neural-link","code":{"id":"astnode100009330","name":"wss","type":"ClassProperty"}},"description":"<p>WebSocket Server instance.</p>\n","name":"wss","longname":"Bridge#wss","kind":"member","memberof":"Bridge","scope":"instance","$longname":"Bridge#wss","$kind":"property","id":6388,"neoClassName":"Neo.ai.mcp.server.neural-link.Bridge"},{"comment":"/**\n     * Async initialization.\n     * @returns {Promise<void>}\n     */","meta":{"range":[1777,1836],"filename":"Bridge.mjs","lineno":62,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/neural-link","code":{"id":"astnode100009332","name":"Bridge#initAsync","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Async initialization.</p>\n","returns":[{"type":{"names":["Promise.<void>"]}}],"name":"initAsync","longname":"Bridge#initAsync","kind":"function","memberof":"Bridge","scope":"instance","params":[],"async":true,"$longname":"Bridge#initAsync","$kind":"method","id":6389,"neoClassName":"Neo.ai.mcp.server.neural-link.Bridge"},{"comment":"/**\n     * Starts the WebSocket server.\n     * @returns {Promise<void>}\n     */","meta":{"range":[1926,2720],"filename":"Bridge.mjs","lineno":70,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/neural-link","code":{"id":"astnode100009342","name":"Bridge#startServer","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Starts the WebSocket server.</p>\n","returns":[{"type":{"names":["Promise.<void>"]}}],"name":"startServer","longname":"Bridge#startServer","kind":"function","memberof":"Bridge","scope":"instance","params":[],"async":true,"$longname":"Bridge#startServer","$kind":"method","id":6390,"neoClassName":"Neo.ai.mcp.server.neural-link.Bridge"},{"comment":"/**\n     * Stops the server.\n     */","meta":{"range":[2767,3249],"filename":"Bridge.mjs","lineno":99,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/neural-link","code":{"id":"astnode100009452","name":"Bridge#stopServer","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Stops the server.</p>\n","name":"stopServer","longname":"Bridge#stopServer","kind":"function","memberof":"Bridge","scope":"instance","params":[],"async":true,"$longname":"Bridge#stopServer","$kind":"method","id":6391,"neoClassName":"Neo.ai.mcp.server.neural-link.Bridge"},{"comment":"/**\n     * Handles new connections.\n     * @param {WebSocket} ws\n     * @param {IncomingMessage} req\n     */","meta":{"range":[3368,4320],"filename":"Bridge.mjs","lineno":124,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/neural-link","code":{"id":"astnode100009538","name":"Bridge#handleConnection","type":"MethodDefinition","paramnames":["ws","req"]},"vars":{"":null}},"description":"<p>Handles new connections.</p>\n","params":[{"type":{"names":["WebSocket"]},"name":"ws"},{"type":{"names":["IncomingMessage"]},"name":"req"}],"name":"handleConnection","longname":"Bridge#handleConnection","kind":"function","memberof":"Bridge","scope":"instance","$longname":"Bridge#handleConnection","$kind":"method","id":6392,"neoClassName":"Neo.ai.mcp.server.neural-link.Bridge"},{"comment":"/**\n     * @param {String} id\n     * @param {WebSocket} ws\n     */","meta":{"range":[4397,5087],"filename":"Bridge.mjs","lineno":154,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/neural-link","code":{"id":"astnode100009654","name":"Bridge#registerAgent","type":"MethodDefinition","paramnames":["id","ws"]},"vars":{"":null}},"params":[{"type":{"names":["String"]},"name":"id"},{"type":{"names":["WebSocket"]},"name":"ws"}],"name":"registerAgent","longname":"Bridge#registerAgent","kind":"function","memberof":"Bridge","scope":"instance","$longname":"Bridge#registerAgent","$kind":"method","id":6393,"neoClassName":"Neo.ai.mcp.server.neural-link.Bridge"},{"comment":"/**\n     * @param {String} id\n     * @param {WebSocket} ws\n     * @param {String} [appName='Unknown']\n     */","meta":{"range":[5207,6181],"filename":"Bridge.mjs","lineno":181,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/neural-link","code":{"id":"astnode100009754","name":"Bridge#registerApp","type":"MethodDefinition","paramnames":["id","ws","appName"]},"vars":{"":null}},"params":[{"type":{"names":["String"]},"name":"id"},{"type":{"names":["WebSocket"]},"name":"ws"},{"type":{"names":["String"]},"optional":true,"defaultvalue":"'Unknown'","name":"appName"}],"name":"registerApp","longname":"Bridge#registerApp","kind":"function","memberof":"Bridge","scope":"instance","$longname":"Bridge#registerApp","$kind":"method","id":6394,"neoClassName":"Neo.ai.mcp.server.neural-link.Bridge"},{"comment":"/**\n     * Handles message from an Agent.\n     * Expects: { target: 'appWorkerId', message: { ... } }\n     * @param {String} agentId\n     * @param {Buffer} data\n     */","meta":{"range":[6360,7763],"filename":"Bridge.mjs","lineno":217,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/neural-link","code":{"id":"astnode100009892","name":"Bridge#handleAgentMessage","type":"MethodDefinition","paramnames":["agentId","data"]},"vars":{"":null}},"description":"<p>Handles message from an Agent.\nExpects: { target: &#39;appWorkerId&#39;, message: { ... } }</p>\n","params":[{"type":{"names":["String"]},"name":"agentId"},{"type":{"names":["Buffer"]},"name":"data"}],"name":"handleAgentMessage","longname":"Bridge#handleAgentMessage","kind":"function","memberof":"Bridge","scope":"instance","$longname":"Bridge#handleAgentMessage","$kind":"method","id":6395,"neoClassName":"Neo.ai.mcp.server.neural-link.Bridge"},{"comment":"/**\n     * Handles message from an App.\n     * Broadcasts to all Agents wrapped in an envelope.\n     * @param {String} appId\n     * @param {Buffer} data\n     */","meta":{"range":[7934,8375],"filename":"Bridge.mjs","lineno":261,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/neural-link","code":{"id":"astnode100010025","name":"Bridge#handleAppMessage","type":"MethodDefinition","paramnames":["appId","data"]},"vars":{"":null}},"description":"<p>Handles message from an App.\nBroadcasts to all Agents wrapped in an envelope.</p>\n","params":[{"type":{"names":["String"]},"name":"appId"},{"type":{"names":["Buffer"]},"name":"data"}],"name":"handleAppMessage","longname":"Bridge#handleAppMessage","kind":"function","memberof":"Bridge","scope":"instance","$longname":"Bridge#handleAppMessage","$kind":"method","id":6396,"neoClassName":"Neo.ai.mcp.server.neural-link.Bridge"},{"comment":"/**\n     * Sends a message to all connected Agents.\n     * @param {Object} payload\n     */","meta":{"range":[8476,8642],"filename":"Bridge.mjs","lineno":281,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/neural-link","code":{"id":"astnode100010067","name":"Bridge#broadcastToAgents","type":"MethodDefinition","paramnames":["payload"]},"vars":{"":null}},"description":"<p>Sends a message to all connected Agents.</p>\n","params":[{"type":{"names":["Object"]},"name":"payload"}],"name":"broadcastToAgents","longname":"Bridge#broadcastToAgents","kind":"function","memberof":"Bridge","scope":"instance","$longname":"Bridge#broadcastToAgents","$kind":"method","id":6397,"neoClassName":"Neo.ai.mcp.server.neural-link.Bridge"}]}