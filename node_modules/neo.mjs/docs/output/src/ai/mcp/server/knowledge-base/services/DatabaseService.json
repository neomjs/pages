{"classData":[{"comment":"/**\n * @summary Core engine for building and maintaining the AI's knowledge base.\n *\n * This service is the core engine for building and maintaining the AI's knowledge base.\n * It orchestrates the entire ETL (Extract, Transform, Load) process for knowledge and\n * ensures the database is synchronized on application startup.\n *\n * ### Key Responsibilities:\n * 1.  **Autonomous Startup:** On initialization, it automatically checks if the knowledge base\n *     is synchronized with the source files and runs the necessary embedding or creation\n *     processes to bring it up-to-date.\n * 2.  **ETL Pipeline:**\n *     - **Extract:** Reads from diverse source-of-truth files (`createKnowledgeBase`).\n *     - **Transform:** Parses and structures data into a unified JSONL format.\n *     - **Load:** Delegates embedding and vector storage to `VectorService`.\n * 3.  **Lifecycle Management:** Provides methods for the full lifecycle of the knowledge base,\n *     from creation and synchronization to deletion.\n *\n * @class Neo.ai.mcp.server.knowledge-base.services.DatabaseService\n * @extends Neo.core.Base\n * @singleton\n */","meta":{"filename":"DatabaseService.mjs","lineno":24,"columnno":0,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/knowledge-base/services","code":{}},"summary":"Core engine for building and maintaining the AI's knowledge base.\n\nThis service is the core engine for building and maintaining the AI's knowledge base.\nIt orchestrates the entire ETL (Extract, Transform, Load) process for knowledge and\nensures the database is synchronized on application startup.\n\n### Key Responsibilities:\n1.  **Autonomous Startup:** On initialization, it automatically checks if the knowledge base\n    is synchronized with the source files and runs the necessary embedding or creation\n    processes to bring it up-to-date.\n2.  **ETL Pipeline:**\n    - **Extract:** Reads from diverse source-of-truth files (`createKnowledgeBase`).\n    - **Transform:** Parses and structures data into a unified JSONL format.\n    - **Load:** Delegates embedding and vector storage to `VectorService`.\n3.  **Lifecycle Management:** Provides methods for the full lifecycle of the knowledge base,\n    from creation and synchronization to deletion.","kind":"class","name":"DatabaseService","augments":["Neo.core.Base"],"tags":[{"originalTitle":"singleton","title":"singleton","text":""}],"memberof":"Neo.ai.mcp.server.knowledge-base.services","longname":"Neo.ai.mcp.server.knowledge-base.services.DatabaseService","scope":"static","$longname":"Neo.ai.mcp.server.knowledge-base.services.DatabaseService","$kind":"class","id":6601,"neoClassName":"Neo.ai.mcp.server.knowledge-base.services.DatabaseService"},{"comment":"/**\n         * @member {String} className='Neo.ai.mcp.server.knowledge-base.services.DatabaseService'\n         * @protected\n         */","meta":{"filename":"DatabaseService.mjs","lineno":52,"columnno":8,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/knowledge-base/services","code":{}},"kind":"member","name":"className","type":{"names":["String"]},"defaultvalue":"'Neo.ai.mcp.server.knowledge-base.services.DatabaseService'","access":"protected","longname":"className","scope":"global","$longname":"className","$kind":"property","id":6602,"neoClassName":"Neo.ai.mcp.server.knowledge-base.services.DatabaseService"},{"comment":"/**\n         * @member {Boolean} singleton=true\n         * @protected\n         */","meta":{"filename":"DatabaseService.mjs","lineno":57,"columnno":8,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/knowledge-base/services","code":{}},"kind":"member","name":"singleton","type":{"names":["Boolean"]},"defaultvalue":true,"access":"protected","longname":"singleton","scope":"global","$longname":"singleton","$kind":"property","id":6603,"neoClassName":"Neo.ai.mcp.server.knowledge-base.services.DatabaseService"},{"comment":"/**\n     * Creates a SHA-256 hash from a stable JSON string representation of a chunk's content.\n     * This hash is used to detect changes in content without having to compare the full text.\n     * @param {Object} chunk The chunk object.\n     * @returns {String} The hexadecimal hash string.\n     * @private\n     */","meta":{"range":[2825,3315],"filename":"DatabaseService.mjs","lineno":67,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/knowledge-base/services","code":{"id":"astnode100029465","name":"DatabaseService#createContentHash","type":"MethodDefinition","paramnames":["chunk"]},"vars":{"":null}},"description":"<p>Creates a SHA-256 hash from a stable JSON string representation of a chunk&#39;s content.\nThis hash is used to detect changes in content without having to compare the full text.</p>\n","params":[{"type":{"names":["Object"]},"description":"<p>The chunk object.</p>\n","name":"chunk"}],"returns":[{"type":{"names":["String"]},"description":"The hexadecimal hash string."}],"access":"private","name":"createContentHash","longname":"DatabaseService#createContentHash","kind":"function","memberof":"DatabaseService","scope":"instance","$longname":"DatabaseService#createContentHash","$kind":"method","id":6604,"neoClassName":"Neo.ai.mcp.server.knowledge-base.services.DatabaseService"},{"comment":"/**\n     * Manages knowledge base data operations based on the provided action.\n     * @param {Object} params\n     * @param {String} params.action - 'sync', 'create', 'embed', or 'delete'\n     * @returns {Promise<Object>}\n     */","meta":{"range":[3555,4062],"filename":"DatabaseService.mjs","lineno":87,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/knowledge-base/services","code":{"id":"astnode100029524","name":"DatabaseService#manageKnowledgeBase","type":"MethodDefinition","paramnames":[""]},"vars":{"":null}},"description":"<p>Manages knowledge base data operations based on the provided action.</p>\n","params":[{"type":{"names":["Object"]},"name":"params"},{"type":{"names":["String"]},"description":"<p>&#39;sync&#39;, &#39;create&#39;, &#39;embed&#39;, or &#39;delete&#39;</p>\n","name":"params.action"}],"returns":[{"type":{"names":["Promise.<Object>"]}}],"name":"manageKnowledgeBase","longname":"DatabaseService#manageKnowledgeBase","kind":"function","memberof":"DatabaseService","scope":"instance","async":true,"$longname":"DatabaseService#manageKnowledgeBase","$kind":"method","id":6605,"neoClassName":"Neo.ai.mcp.server.knowledge-base.services.DatabaseService"},{"comment":"/**\n     * Parses all knowledge sources (JSDoc, guides, release notes, tickets) and generates\n     * a structured JSONL file at `dist/ai-knowledge-base.jsonl`.\n     *\n     * This function acts as the \"compiler\" for the knowledge base. Its primary role is to\n     * read from various source-of-truth files and convert them into a unified, structured format.\n     * It uses a write stream to handle potentially large amounts of data efficiently without\n     * holding everything in memory at once.\n     *\n     * ### Key Characteristics:\n     * - **Input:** Reads from `docs/output/all.json` for API data and `learn/tree.json` for the guide structure.\n     * - **Processing:** It breaks down the content into logical \"chunks\" (e.g., a class, a method, a section of a guide).\n     * - **Output:** It streams each chunk as a JSON object into the `dist/ai-knowledge-base.jsonl` file.\n     *\n     * @returns {Promise<object>} A promise that resolves to a success message with the total chunk count.\n     */","meta":{"range":[5072,6226],"filename":"DatabaseService.mjs","lineno":118,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/knowledge-base/services","code":{"id":"astnode100029569","name":"DatabaseService#createKnowledgeBase","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Parses all knowledge sources (JSDoc, guides, release notes, tickets) and generates\na structured JSONL file at <code>dist/ai-knowledge-base.jsonl</code>.</p>\n<p>This function acts as the &quot;compiler&quot; for the knowledge base. Its primary role is to\nread from various source-of-truth files and convert them into a unified, structured format.\nIt uses a write stream to handle potentially large amounts of data efficiently without\nholding everything in memory at once.</p>\n<h3>Key Characteristics:</h3>\n<ul>\n<li><strong>Input:</strong> Reads from <code>docs/output/all.json</code> for API data and <code>learn/tree.json</code> for the guide structure.</li>\n<li><strong>Processing:</strong> It breaks down the content into logical &quot;chunks&quot; (e.g., a class, a method, a section of a guide).</li>\n<li><strong>Output:</strong> It streams each chunk as a JSON object into the <code>dist/ai-knowledge-base.jsonl</code> file.</li>\n</ul>\n","returns":[{"type":{"names":["Promise.<object>"]},"description":"A promise that resolves to a success message with the total chunk count."}],"name":"createKnowledgeBase","longname":"DatabaseService#createKnowledgeBase","kind":"function","memberof":"DatabaseService","scope":"instance","params":[],"async":true,"$longname":"DatabaseService#createKnowledgeBase","$kind":"method","id":6606,"neoClassName":"Neo.ai.mcp.server.knowledge-base.services.DatabaseService"},{"comment":"/**\n     * Permanently deletes the entire knowledge base collection from ChromaDB.\n     * Delegates to VectorService.\n     * @returns {Promise<object>} A promise that resolves to a success message.\n     */","meta":{"range":[6442,6527],"filename":"DatabaseService.mjs","lineno":157,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/knowledge-base/services","code":{"id":"astnode100029711","name":"DatabaseService#deleteDatabase","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Permanently deletes the entire knowledge base collection from ChromaDB.\nDelegates to VectorService.</p>\n","returns":[{"type":{"names":["Promise.<object>"]},"description":"A promise that resolves to a success message."}],"name":"deleteDatabase","longname":"DatabaseService#deleteDatabase","kind":"function","memberof":"DatabaseService","scope":"instance","params":[],"async":true,"$longname":"DatabaseService#deleteDatabase","$kind":"method","id":6607,"neoClassName":"Neo.ai.mcp.server.knowledge-base.services.DatabaseService"},{"comment":"/**\n     * Reads the generated JSONL file and upserts the data into the ChromaDB collection.\n     * Delegates to VectorService.\n     * @returns {Promise<object>} A promise that resolves to a success message.\n     */","meta":{"range":[6753,6848],"filename":"DatabaseService.mjs","lineno":166,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/knowledge-base/services","code":{"id":"astnode100029721","name":"DatabaseService#embedKnowledgeBase","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Reads the generated JSONL file and upserts the data into the ChromaDB collection.\nDelegates to VectorService.</p>\n","returns":[{"type":{"names":["Promise.<object>"]},"description":"A promise that resolves to a success message."}],"name":"embedKnowledgeBase","longname":"DatabaseService#embedKnowledgeBase","kind":"function","memberof":"DatabaseService","scope":"instance","params":[],"async":true,"$longname":"DatabaseService#embedKnowledgeBase","$kind":"method","id":6608,"neoClassName":"Neo.ai.mcp.server.knowledge-base.services.DatabaseService"},{"comment":"/**\n     * Orchestrates the automated startup synchronization of the knowledge base.\n     *\n     * This method is called automatically by the framework after the service is constructed.\n     * It ensures that the knowledge base is ready and up-to-date before the application\n     * proceeds.\n     *\n     * The logic is as follows:\n     * 1. It first waits for the underlying database connection to be ready.\n     * 2. It then checks for the existence of the `ai-knowledge-base.jsonl` file.\n     * 3. If the file does not exist, it triggers a full `syncDatabase()` (create + embed).\n     * 4. If the file exists, it triggers `embedKnowledgeBase()` to process any new or changed content.\n     *\n     * This entire process is awaited via the `ready()` promise on the service, ensuring\n     * that dependent services or startup sequences only proceed once the knowledge base is\n     * fully initialized.\n     * @protected\n     */","meta":{"range":[7784,8822],"filename":"DatabaseService.mjs","lineno":188,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/knowledge-base/services","code":{"id":"astnode100029734","name":"DatabaseService#initAsync","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Orchestrates the automated startup synchronization of the knowledge base.</p>\n<p>This method is called automatically by the framework after the service is constructed.\nIt ensures that the knowledge base is ready and up-to-date before the application\nproceeds.</p>\n<p>The logic is as follows:</p>\n<ol>\n<li>It first waits for the underlying database connection to be ready.</li>\n<li>It then checks for the existence of the <code>ai-knowledge-base.jsonl</code> file.</li>\n<li>If the file does not exist, it triggers a full <code>syncDatabase()</code> (create + embed).</li>\n<li>If the file exists, it triggers <code>embedKnowledgeBase()</code> to process any new or changed content.</li>\n</ol>\n<p>This entire process is awaited via the <code>ready()</code> promise on the service, ensuring\nthat dependent services or startup sequences only proceed once the knowledge base is\nfully initialized.</p>\n","access":"protected","name":"initAsync","longname":"DatabaseService#initAsync","kind":"function","memberof":"DatabaseService","scope":"instance","params":[],"async":true,"$longname":"DatabaseService#initAsync","$kind":"method","id":6609,"neoClassName":"Neo.ai.mcp.server.knowledge-base.services.DatabaseService"},{"comment":"/**\n     * A convenience orchestrator that runs the entire knowledge base synchronization process.\n     * It first creates the knowledge base file and then embeds its contents into the vector database.\n     * This provides a simple, single-command way to update the knowledge base from scratch.\n     * @returns {Promise<object>} A promise that resolves to the final success message from the embedding step.\n     */","meta":{"range":[9247,9430],"filename":"DatabaseService.mjs","lineno":219,"columnno":4,"path":"/Users/Shared/github/neomjs/pages/node_modules/neo.mjs/ai/mcp/server/knowledge-base/services","code":{"id":"astnode100029824","name":"DatabaseService#syncDatabase","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>A convenience orchestrator that runs the entire knowledge base synchronization process.\nIt first creates the knowledge base file and then embeds its contents into the vector database.\nThis provides a simple, single-command way to update the knowledge base from scratch.</p>\n","returns":[{"type":{"names":["Promise.<object>"]},"description":"A promise that resolves to the final success message from the embedding step."}],"name":"syncDatabase","longname":"DatabaseService#syncDatabase","kind":"function","memberof":"DatabaseService","scope":"instance","params":[],"async":true,"$longname":"DatabaseService#syncDatabase","$kind":"method","id":6610,"neoClassName":"Neo.ai.mcp.server.knowledge-base.services.DatabaseService"}]}